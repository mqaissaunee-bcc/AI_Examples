<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Cryptography &amp; PKI — Interactive Lesson</title>
<style>
/* ===== CSS VARIABLES / THEME ===== */
:root {
  --navy: #003366;
  --navy-dark: #001a33;
  --teal: #006666;
  --teal-light: #008080;
  --gold: #CC9900;
  --gold-light: #FFCC00;
  --white: #FFFFFF;
  --off-white: #F0F0F0;
  --light-gray: #D9D9D9;
  --mid-gray: #666666;
  --dark-gray: #333333;
  --red-err: #CC0000;
  --green-ok: #006600;
  --sky: #336699;
  --sky-light: #99CCFF;
  --section-bg: #F5F5F0;
  --card-shadow: 0 4px 16px rgba(0,0,0,.12);
  --focus-ring: 0 0 0 3px rgba(0,102,102,.5);
  --radius: 8px;
  --transition: .3s ease;
  --font-heading: 'Georgia', 'Times New Roman', serif;
  --font-body: 'Verdana', 'Geneva', sans-serif;
  --font-mono: 'Courier New', Courier, monospace;
}

/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body {
  font-family: var(--font-body);
  color: var(--dark-gray);
  background: var(--off-white);
  line-height: 1.7;
  -webkit-font-smoothing: antialiased;
}

/* ===== SKIP LINK (ADA) ===== */
.skip-link {
  position: absolute; top: -100%; left: 16px;
  background: var(--gold); color: var(--navy-dark);
  padding: 8px 18px; border-radius: var(--radius);
  font-weight: 700; z-index: 9999; text-decoration: none;
}
.skip-link:focus { top: 12px; }

/* ===== FOCUS STYLES ===== */
:focus-visible { outline: none; box-shadow: var(--focus-ring); }
a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
  outline: 3px solid var(--teal); outline-offset: 2px;
}

/* ===== HEADER ===== */
header {
  background: linear-gradient(135deg, var(--navy-dark) 0%, var(--navy) 50%, var(--teal) 100%);
  color: var(--white); padding: 0; position: sticky; top: 0; z-index: 1000;
  box-shadow: 0 2px 12px rgba(0,0,0,.3);
}
.header-inner {
  max-width: 1280px; margin: 0 auto; padding: 16px 24px;
  display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;
}
.header-brand { display: flex; align-items: center; gap: 14px; }
.header-icon {
  width: 48px; height: 48px; background: var(--gold);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-size: 24px; color: var(--navy-dark); flex-shrink: 0; font-weight: 700;
}
.header-brand h1 {
  font-family: var(--font-heading); font-size: clamp(1.1rem, 2.5vw, 1.6rem);
  font-weight: 700; letter-spacing: .02em; line-height: 1.25;
}
.header-brand p { font-size: .78rem; opacity: .85; margin-top: 2px; }

/* Progress bar */
.progress-wrap {
  width: 100%; max-width: 320px;
  display: flex; align-items: center; gap: 10px;
}
.progress-wrap label { font-size: .75rem; white-space: nowrap; font-weight: 600; }
.progress-bar-outer {
  flex: 1; height: 10px; background: rgba(255,255,255,.2);
  border-radius: 5px; overflow: hidden; position: relative;
}
.progress-bar-inner {
  height: 100%; background: var(--gold); border-radius: 5px;
  width: 0%; transition: width .5s ease;
}
.progress-pct { font-size: .75rem; font-weight: 700; min-width: 36px; text-align: right; }

/* ===== NAV ===== */
nav {
  background: var(--navy);
  border-bottom: 3px solid var(--gold);
}
.nav-inner {
  max-width: 1280px; margin: 0 auto; padding: 0 24px;
  display: flex; align-items: stretch; gap: 0; overflow-x: auto;
}
.nav-inner::-webkit-scrollbar { height: 3px; }
.nav-inner::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 4px; }
.nav-btn {
  background: none; border: none; color: rgba(255,255,255,.75);
  font-family: var(--font-body); font-size: .8rem; font-weight: 600;
  padding: 12px 18px; cursor: pointer; white-space: nowrap;
  border-bottom: 3px solid transparent; transition: var(--transition);
  position: relative;
}
.nav-btn:hover, .nav-btn:focus { color: var(--white); background: rgba(255,255,255,.07); }
.nav-btn.active {
  color: var(--gold); border-bottom-color: var(--gold);
  background: rgba(255,255,255,.05);
}
.nav-btn .nav-num {
  display: inline-block; background: var(--teal); color: var(--white);
  width: 20px; height: 20px; border-radius: 50%; font-size: .68rem;
  line-height: 20px; text-align: center; margin-right: 6px;
}
.nav-btn.active .nav-num { background: var(--gold); color: var(--navy-dark); }
.nav-btn.completed .nav-num { background: var(--green-ok); }

/* ===== MAIN ===== */
main { max-width: 1280px; margin: 0 auto; padding: 24px; }

/* ===== SECTIONS ===== */
.lesson-section { display: none; animation: fadeUp .5s ease; }
.lesson-section.active { display: block; }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== TYPOGRAPHY ===== */
.section-header {
  background: linear-gradient(135deg, var(--navy) 0%, var(--teal) 100%);
  color: var(--white); padding: 28px 32px; border-radius: var(--radius) var(--radius) 0 0;
  margin-bottom: 0;
}
.section-header h2 {
  font-family: var(--font-heading); font-size: clamp(1.4rem, 3vw, 2rem);
  font-weight: 700; line-height: 1.25;
}
.section-header .obj-tag {
  display: inline-block; background: var(--gold); color: var(--navy-dark);
  padding: 3px 12px; border-radius: 20px; font-size: .72rem;
  font-weight: 700; margin-top: 8px; letter-spacing: .04em;
}

.section-body {
  background: var(--white); padding: 32px;
  border-radius: 0 0 var(--radius) var(--radius);
  box-shadow: var(--card-shadow); margin-bottom: 32px;
}
.section-body h3 {
  font-family: var(--font-heading); font-size: 1.3rem;
  color: var(--navy); margin: 28px 0 12px; padding-bottom: 6px;
  border-bottom: 2px solid var(--gold-light);
}
.section-body h3:first-child { margin-top: 0; }
.section-body h4 {
  font-size: 1.05rem; color: var(--teal); margin: 20px 0 8px; font-weight: 700;
}
.section-body p { margin-bottom: 14px; }
.section-body ul, .section-body ol { margin: 0 0 14px 24px; }
.section-body li { margin-bottom: 6px; }

/* ===== CARDS ===== */
.card-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px; margin: 20px 0;
}
.info-card {
  background: var(--section-bg); border-left: 4px solid var(--teal);
  padding: 20px; border-radius: 0 var(--radius) var(--radius) 0;
  transition: var(--transition);
}
.info-card:hover { box-shadow: var(--card-shadow); transform: translateY(-2px); }
.info-card h4 { color: var(--navy); margin: 0 0 8px; font-size: 1rem; }
.info-card p { font-size: .88rem; margin: 0; }

.highlight-card {
  background: linear-gradient(135deg, #fffff0, #fffde0);
  border: 2px solid var(--gold); border-radius: var(--radius);
  padding: 20px 24px; margin: 20px 0;
}
.highlight-card .card-label {
  display: inline-block; background: var(--gold); color: var(--navy-dark);
  padding: 2px 10px; border-radius: 12px; font-size: .72rem;
  font-weight: 700; margin-bottom: 8px; text-transform: uppercase;
}

/* ===== INTERACTIVE DIAGRAMS ===== */
.diagram-wrap {
  background: var(--navy-dark); border-radius: var(--radius);
  padding: 24px; margin: 20px 0; overflow-x: auto;
  color: var(--white);
}
.diagram-wrap h4 { color: var(--gold); margin-bottom: 16px; border: none; }

.pki-hierarchy {
  display: flex; flex-direction: column; align-items: center; gap: 12px;
}
.pki-node {
  background: linear-gradient(135deg, var(--teal), var(--teal-light));
  border: 2px solid var(--gold); border-radius: var(--radius);
  padding: 12px 24px; text-align: center; cursor: pointer;
  transition: var(--transition); min-width: 160px; position: relative;
}
.pki-node:hover, .pki-node:focus { transform: scale(1.05); box-shadow: 0 0 20px rgba(204,153,0,.4); }
.pki-node.root { background: linear-gradient(135deg, var(--gold), #e6b800); color: var(--navy-dark); font-weight: 700; }
.pki-node .node-label { font-weight: 700; font-size: .95rem; }
.pki-node .node-desc { font-size: .75rem; opacity: .85; margin-top: 4px; }
.pki-connector { width: 2px; height: 20px; background: var(--gold); }
.pki-row { display: flex; gap: 24px; flex-wrap: wrap; justify-content: center; }
.pki-branch { display: flex; flex-direction: column; align-items: center; gap: 12px; }

/* Node detail popover */
.node-detail {
  display: none; background: var(--white); color: var(--dark-gray);
  padding: 16px; border-radius: var(--radius); margin-top: 8px;
  box-shadow: var(--card-shadow); font-size: .85rem; max-width: 320px;
  text-align: left; border: 2px solid var(--gold);
}
.node-detail.visible { display: block; animation: fadeUp .3s ease; }

/* ===== INTERACTIVE DEMO: ENCRYPTION ===== */
.demo-box {
  background: var(--section-bg); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 24px; margin: 20px 0;
}
.demo-box h4 { color: var(--navy); margin-bottom: 12px; font-size: 1.05rem; }
.demo-row { display: flex; gap: 16px; flex-wrap: wrap; align-items: flex-start; margin-bottom: 16px; }
.demo-field { flex: 1; min-width: 200px; }
.demo-field label {
  display: block; font-weight: 700; font-size: .82rem;
  margin-bottom: 4px; color: var(--navy);
}
.demo-field input, .demo-field select, .demo-field textarea {
  width: 100%; padding: 10px 12px; border: 2px solid var(--light-gray);
  border-radius: var(--radius); font-family: var(--font-body);
  font-size: .9rem; transition: var(--transition); background: var(--white);
}
.demo-field input:focus, .demo-field select:focus, .demo-field textarea:focus {
  border-color: var(--teal); box-shadow: var(--focus-ring);
}
.demo-field textarea { min-height: 70px; resize: vertical; font-family: var(--font-mono); }
.demo-output {
  background: var(--navy-dark); color: #66ff66; padding: 14px 18px;
  border-radius: var(--radius); font-family: var(--font-mono);
  font-size: .82rem; word-break: break-all; min-height: 48px;
  border: 2px solid var(--teal);
}
.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 10px 22px; border: none; border-radius: var(--radius);
  font-family: var(--font-body); font-size: .88rem; font-weight: 700;
  cursor: pointer; transition: var(--transition); text-decoration: none;
}
.btn-primary { background: var(--teal); color: var(--white); }
.btn-primary:hover { background: var(--teal-light); }
.btn-gold { background: var(--gold); color: var(--navy-dark); }
.btn-gold:hover { background: var(--gold-light); }
.btn-navy { background: var(--navy); color: var(--white); }
.btn-navy:hover { background: var(--sky); }
.btn-outline { background: none; border: 2px solid var(--teal); color: var(--teal); }
.btn-outline:hover { background: var(--teal); color: var(--white); }
.btn:disabled { opacity: .5; cursor: not-allowed; }

/* ===== TABS (sub-tabs inside sections) ===== */
.sub-tabs { display: flex; gap: 0; margin-bottom: 0; border-bottom: 2px solid var(--light-gray); }
.sub-tab-btn {
  background: var(--section-bg); border: none; padding: 10px 20px;
  font-family: var(--font-body); font-size: .85rem; font-weight: 600;
  cursor: pointer; color: var(--mid-gray); transition: var(--transition);
  border-bottom: 3px solid transparent;
}
.sub-tab-btn:hover { color: var(--navy); }
.sub-tab-btn.active { color: var(--teal); border-bottom-color: var(--teal); background: var(--white); }
.sub-tab-content { display: none; padding: 20px 0; }
.sub-tab-content.active { display: block; animation: fadeUp .3s ease; }

/* ===== ACCORDION ===== */
.accordion { margin: 16px 0; }
.accordion-item { border: 1px solid var(--light-gray); border-radius: var(--radius); margin-bottom: 8px; overflow: hidden; }
.accordion-header {
  width: 100%; background: var(--section-bg); border: none;
  padding: 14px 20px; font-family: var(--font-body); font-size: .92rem;
  font-weight: 700; color: var(--navy); cursor: pointer;
  display: flex; justify-content: space-between; align-items: center;
  transition: var(--transition); text-align: left;
}
.accordion-header:hover { background: var(--light-gray); }
.accordion-header .acc-icon {
  font-size: 1.2rem; transition: transform .3s ease; flex-shrink: 0;
}
.accordion-item.open .accordion-header { background: var(--navy); color: var(--white); }
.accordion-item.open .acc-icon { transform: rotate(180deg); color: var(--gold); }
.accordion-body { padding: 0 20px; max-height: 0; overflow: hidden; transition: max-height .4s ease, padding .4s ease; }
.accordion-item.open .accordion-body { max-height: 2000px; padding: 16px 20px; }

/* ===== QUIZ ===== */
.quiz-container { margin: 20px 0; }
.quiz-question {
  background: var(--white); border: 2px solid var(--light-gray);
  border-radius: var(--radius); padding: 20px; margin-bottom: 16px;
  transition: var(--transition);
}
.quiz-question.correct { border-color: var(--green-ok); background: #f0fff0; }
.quiz-question.incorrect { border-color: var(--red-err); background: #fff5f5; }
.quiz-question .q-number {
  display: inline-block; background: var(--navy); color: var(--white);
  width: 28px; height: 28px; border-radius: 50%; text-align: center;
  line-height: 28px; font-size: .82rem; font-weight: 700; margin-right: 8px;
}
.quiz-question .q-text { font-weight: 700; margin-bottom: 12px; font-size: .95rem; }
.quiz-option {
  display: block; padding: 10px 14px; margin-bottom: 6px;
  border: 2px solid var(--light-gray); border-radius: var(--radius);
  cursor: pointer; transition: var(--transition); font-size: .88rem;
  background: var(--white);
}
.quiz-option:hover { border-color: var(--teal); background: #f0fafa; }
.quiz-option input { margin-right: 8px; }
.quiz-option.selected { border-color: var(--teal); background: #e0f0f0; }
.quiz-option.right { border-color: var(--green-ok); background: #e0ffe0; }
.quiz-option.wrong { border-color: var(--red-err); background: #ffe0e0; }
.quiz-feedback {
  margin-top: 8px; padding: 10px 14px; border-radius: var(--radius);
  font-size: .85rem; display: none;
}
.quiz-feedback.show { display: block; animation: fadeUp .3s ease; }
.quiz-feedback.correct-fb { background: #e0ffe0; color: var(--green-ok); border: 1px solid var(--green-ok); }
.quiz-feedback.incorrect-fb { background: #ffe0e0; color: var(--red-err); border: 1px solid var(--red-err); }

.quiz-score {
  background: linear-gradient(135deg, var(--navy), var(--teal));
  color: var(--white); padding: 24px; border-radius: var(--radius);
  text-align: center; margin-top: 24px;
}
.quiz-score .score-num { font-size: 2.5rem; font-weight: 700; font-family: var(--font-heading); }
.quiz-score .score-label { font-size: .9rem; opacity: .85; }

/* ===== FLASHCARD ===== */
.flashcard-deck { display: flex; flex-direction: column; align-items: center; gap: 16px; margin: 20px 0; }
.flashcard {
  width: 100%; max-width: 500px; min-height: 200px;
  perspective: 1000px; cursor: pointer;
}
.flashcard-inner {
  position: relative; width: 100%; height: 200px;
  transition: transform .6s; transform-style: preserve-3d;
}
.flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
.flashcard-face {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  backface-visibility: hidden; border-radius: var(--radius);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 24px; text-align: center;
}
.flashcard-front {
  background: linear-gradient(135deg, var(--navy), var(--teal));
  color: var(--white); font-weight: 700; font-size: 1.05rem;
  border: 3px solid var(--gold);
}
.flashcard-front .fc-label { font-size: .72rem; opacity: .7; margin-bottom: 8px; text-transform: uppercase; letter-spacing: .06em; }
.flashcard-back {
  background: var(--white); color: var(--dark-gray);
  transform: rotateY(180deg); font-size: .9rem; line-height: 1.6;
  border: 3px solid var(--teal);
}
.fc-controls { display: flex; gap: 12px; align-items: center; }
.fc-counter { font-size: .85rem; color: var(--mid-gray); font-weight: 600; min-width: 80px; text-align: center; }

/* ===== EMBEDDED VIDEO PLAYERS (click-to-play facade) ===== */
.yt-embed-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
  gap: 24px; margin: 20px 0 32px;
}
@media (max-width: 520px) {
  .yt-embed-grid { grid-template-columns: 1fr; }
}
.yt-embed-card {
  background: var(--white); border-radius: var(--radius);
  overflow: hidden; box-shadow: var(--card-shadow);
  transition: var(--transition);
  border: 2px solid transparent;
}
.yt-embed-card:hover { border-color: var(--teal); box-shadow: 0 8px 24px rgba(0,0,0,.15); }
.yt-embed-card:focus-within { border-color: var(--gold); box-shadow: 0 4px 16px rgba(204,153,0,.25); }
.yt-embed-wrap {
  position: relative; width: 100%; padding-bottom: 56.25%; /* 16:9 */
  background: #000; cursor: pointer; overflow: hidden;
}
.yt-embed-wrap iframe {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;
}
/* Thumbnail facade — shown before click */
.yt-facade {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  background-size: cover; background-position: center; background-repeat: no-repeat;
  cursor: pointer; border: 0; padding: 0; margin: 0;
}
.yt-facade::before {
  content: ""; position: absolute; inset: 0;
  background: linear-gradient(0deg, rgba(0,0,0,.45) 0%, rgba(0,0,0,.12) 50%, rgba(0,0,0,.30) 100%);
  transition: background .25s ease;
}
.yt-facade:hover::before { background: rgba(0,0,0,.35); }
/* YouTube-style red play button */
.yt-facade .yt-play-btn {
  position: relative; z-index: 2; width: 68px; height: 48px;
  background: #CC0000; border-radius: 14px; border: 0;
  display: flex; align-items: center; justify-content: center;
  transition: background .2s ease, transform .2s ease;
  box-shadow: 0 4px 16px rgba(0,0,0,.4); pointer-events: none;
}
.yt-facade:hover .yt-play-btn { background: #FF0000; transform: scale(1.1); }
.yt-facade:focus-visible { outline: 3px solid var(--gold); outline-offset: -3px; }
.yt-play-btn svg { width: 24px; height: 24px; fill: #FFFFFF; margin-left: 3px; }
/* Duration badge */
.yt-duration {
  position: absolute; bottom: 8px; right: 8px; z-index: 2;
  background: rgba(0,0,0,.82); color: #FFFFFF; font-size: .72rem;
  font-family: var(--sans); padding: 2px 6px; border-radius: 3px;
  font-weight: 600; letter-spacing: .3px;
}
/* Info area below video */
.yt-embed-info { padding: 14px 16px; }
.yt-embed-info h4 { font-size: .9rem; color: var(--navy); margin: 0 0 4px; }
.yt-embed-info p { font-size: .78rem; color: var(--mid-gray); margin: 0; }
.yt-embed-info .yt-channel {
  display: inline-block; margin-top: 6px;
  font-size: .72rem; font-weight: 700; color: var(--teal);
  font-family: var(--sans); text-transform: uppercase; letter-spacing: .5px;
}
.yt-section-label {
  display: flex; align-items: center; gap: 10px;
  margin-bottom: 8px; font-family: var(--sans);
}
.yt-section-label .yt-icon {
  display: inline-flex; align-items: center; justify-content: center;
  width: 36px; height: 36px; border-radius: 8px;
  background: #CC0000; color: var(--white); font-size: 1.1rem; font-weight: 700;
}
.yt-section-label span { font-size: .85rem; color: var(--mid-gray); }
/* Badge shown on thumbnails when opened from file:// */
.yt-ext-badge {
  position: absolute; top: 10px; left: 10px; z-index: 3;
  background: rgba(204,153,0,.92); color: #0D1B2A;
  font-size: .68rem; font-family: var(--sans); font-weight: 700;
  padding: 3px 10px; border-radius: 12px; letter-spacing: .4px;
  text-transform: uppercase; pointer-events: none;
}
/* ===== VIDEO / RESOURCE CARDS ===== */
.video-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px; margin: 20px 0;
}
.video-card {
  background: var(--white); border-radius: var(--radius);
  overflow: hidden; box-shadow: var(--card-shadow);
  transition: var(--transition); cursor: pointer;
  text-decoration: none; color: inherit; display: block;
  border: 2px solid transparent;
}
.video-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,.15); border-color: var(--teal); }
.video-card:focus-visible { outline: 3px solid var(--gold); outline-offset: 2px; }
.video-thumb {
  width: 100%; aspect-ratio: 16/9; background: var(--navy-dark);
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  color: var(--gold); font-size: 3rem; position: relative;
}
.video-thumb .play-icon {
  width: 64px; height: 64px; background: rgba(204,153,0,.92);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  color: var(--navy-dark); font-size: 1.6rem;
  transition: var(--transition);
}
.video-card:hover .play-icon { transform: scale(1.12); background: var(--gold); }
.video-thumb .source-badge {
  position: absolute; top: 10px; right: 10px;
  background: var(--teal); color: var(--white); font-size: .65rem;
  padding: 3px 10px; border-radius: 12px; font-family: var(--sans);
  font-weight: 700; text-transform: uppercase; letter-spacing: .5px;
}
.video-thumb .source-badge.article { background: var(--gold); color: var(--navy-dark); }
.video-thumb .source-badge.reference { background: #336666; }
.video-thumb .type-label {
  margin-top: 8px; font-size: .72rem; font-family: var(--sans);
  color: rgba(255,255,255,.7); letter-spacing: .5px; text-transform: uppercase;
}
.video-card-body { padding: 16px; }
.video-card-body h4 { font-size: .92rem; color: var(--navy); margin-bottom: 4px; }
.video-card-body p { font-size: .8rem; color: var(--mid-gray); margin: 0; }
.video-card-body .video-link {
  display: inline-block; margin-top: 8px; color: var(--teal);
  font-weight: 700; font-size: .82rem; text-decoration: none;
}
.video-card-body .video-link:hover { text-decoration: underline; }
.yt-search-bar {
  background: var(--light-gray); padding: 14px 20px; border-radius: var(--radius);
  margin-bottom: 24px; display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
}
.yt-search-bar span { font-size: .85rem; color: var(--navy); font-weight: 700; font-family: var(--sans); }
.yt-search-bar a {
  display: inline-flex; align-items: center; gap: 6px;
  background: var(--navy); color: var(--white); padding: 6px 14px;
  border-radius: 20px; font-size: .78rem; text-decoration: none;
  font-weight: 600; font-family: var(--sans); transition: var(--transition);
}
.yt-search-bar a:hover { background: var(--teal); }
.yt-search-bar a:focus-visible { outline: 3px solid var(--gold); outline-offset: 2px; }

/* ===== TABLE ===== */
.resp-table-wrap { overflow-x: auto; margin: 16px 0; }
.resp-table {
  width: 100%; border-collapse: collapse; font-size: .85rem;
}
.resp-table th {
  background: var(--navy); color: var(--white); padding: 12px 14px;
  text-align: left; font-weight: 700; white-space: nowrap;
}
.resp-table td { padding: 10px 14px; border-bottom: 1px solid var(--light-gray); }
.resp-table tr:nth-child(even) { background: var(--section-bg); }
.resp-table tr:hover { background: #e8f0f0; }

/* ===== CERT LIFECYCLE ANIMATION ===== */
.lifecycle-track {
  display: flex; align-items: center; gap: 0; margin: 20px 0;
  overflow-x: auto; padding: 12px 0;
}
.lifecycle-step {
  display: flex; flex-direction: column; align-items: center;
  min-width: 100px; text-align: center; position: relative;
}
.lifecycle-circle {
  width: 50px; height: 50px; border-radius: 50%;
  background: var(--light-gray); color: var(--dark-gray);
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: .85rem; transition: var(--transition);
  cursor: pointer; border: 3px solid transparent;
}
.lifecycle-circle:hover, .lifecycle-circle.active {
  background: var(--teal); color: var(--white); border-color: var(--gold);
  transform: scale(1.15);
}
.lifecycle-label { font-size: .72rem; margin-top: 6px; font-weight: 600; color: var(--navy); }
.lifecycle-arrow { font-size: 1.2rem; color: var(--gold); margin: 0 4px; flex-shrink: 0; }
.lifecycle-detail {
  background: var(--section-bg); border: 2px solid var(--teal); border-radius: var(--radius);
  padding: 16px; margin-top: 12px; font-size: .88rem; display: none;
}
.lifecycle-detail.visible { display: block; animation: fadeUp .3s ease; }

/* ===== COMPARISON SLIDER ===== */
.compare-columns {
  display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;
}
.compare-col {
  background: var(--white); border-radius: var(--radius); padding: 20px;
  box-shadow: var(--card-shadow); border-top: 4px solid var(--teal);
}
.compare-col.sym { border-top-color: var(--navy); }
.compare-col.asym { border-top-color: var(--gold); }
.compare-col h4 { margin-bottom: 12px; }

/* ===== PRINT ===== */
@media print {
  header, nav, .progress-wrap, .btn, .quiz-container, .demo-box, .flashcard-deck { display: none; }
  .lesson-section { display: block !important; }
  .section-body { box-shadow: none; border: 1px solid #ccc; }
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .header-inner { flex-direction: column; text-align: center; }
  .progress-wrap { max-width: 100%; }
  .nav-inner { justify-content: flex-start; }
  .section-body { padding: 20px 16px; }
  .compare-columns { grid-template-columns: 1fr; }
  .card-grid { grid-template-columns: 1fr; }
  .video-grid { grid-template-columns: 1fr; }
  .demo-row { flex-direction: column; }
  .pki-row { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>

<!-- Skip Nav (ADA) -->
<a href="#main-content" class="skip-link">Skip to main content</a>

<!-- ===== HEADER ===== -->
<header role="banner">
  <div class="header-inner">
    <div class="header-brand">
      <div class="header-icon" aria-hidden="true">&#128274;</div>
      <div>
        <h1>Advanced Cryptography &amp; PKI</h1>
        <p>Interactive Security Lesson</p>
      </div>
    </div>
    <div class="progress-wrap" role="status" aria-live="polite">
      <label for="lessonProgress">Progress:</label>
      <div class="progress-bar-outer" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-bar-inner" id="progressBarInner"></div>
      </div>
      <span class="progress-pct" id="progressPct">0%</span>
    </div>
  </div>
</header>

<!-- ===== NAV ===== -->
<nav role="navigation" aria-label="Lesson sections">
  <div class="nav-inner" id="navInner">
    <button class="nav-btn active" data-section="0" aria-current="true">
      <span class="nav-num">1</span>Overview
    </button>
    <button class="nav-btn" data-section="1">
      <span class="nav-num">2</span>Implementing Cryptography
    </button>
    <button class="nav-btn" data-section="2">
      <span class="nav-num">3</span>Digital Certificates
    </button>
    <button class="nav-btn" data-section="3">
      <span class="nav-num">4</span>PKI Components
    </button>
    <button class="nav-btn" data-section="4">
      <span class="nav-num">5</span>Transport Encryption
    </button>
    <button class="nav-btn" data-section="5">
      <span class="nav-num">6</span>Interactive Lab
    </button>
    <button class="nav-btn" data-section="6">
      <span class="nav-num">7</span>Flashcards
    </button>
    <button class="nav-btn" data-section="7">
      <span class="nav-num">8</span>Knowledge Check
    </button>
    <button class="nav-btn" data-section="8">
      <span class="nav-num">9</span>Resources
    </button>
  </div>
</nav>

<!-- ===== MAIN CONTENT ===== -->
<main id="main-content" role="main">

<!-- ============================================================ -->
<!-- SECTION 0: OVERVIEW -->
<!-- ============================================================ -->
<section class="lesson-section active" id="section-0" aria-label="Lesson Overview">
  <div class="section-header">
    <h2>Lesson Overview: Advanced Cryptography &amp; Public Key Infrastructure</h2>
    <span class="obj-tag">Security+ SY0-701 &bull; Objective 1.4</span>
  </div>
  <div class="section-body">
    <h3>Welcome</h3>
    <p>Cryptography is the backbone of information security. In this lesson you will explore practical methods for applying cryptographic solutions, understand digital certificates and how they establish trust, examine the components of Public Key Infrastructure (PKI), and learn about transport encryption protocols that protect data in transit.</p>
    <p>This lesson aligns with the <strong>CompTIA Security+ (SY0-701)</strong> certification, specifically Objective 1.4: <em>"Explain the importance of using appropriate cryptographic solutions"</em>—covering PKI, encryption, hashing, digital signatures, key stretching, blockchain, and certificates.</p>

    <h3>Learning Objectives</h3>
    <div class="card-grid">
      <div class="info-card">
        <h4>&#128270; Objective 1</h4>
        <p>Explain how to implement cryptography — key strength, block cipher modes, algorithm input values, and crypto service providers.</p>
      </div>
      <div class="info-card">
        <h4>&#128196; Objective 2</h4>
        <p>Define digital certificates — types, formats, lifecycle, and trust relationships.</p>
      </div>
      <div class="info-card">
        <h4>&#128737; Objective 3</h4>
        <p>Describe the components of Public Key Infrastructure (PKI) — CAs, trust models, certificate management, and key handling.</p>
      </div>
      <div class="info-card">
        <h4>&#128274; Objective 4</h4>
        <p>Describe transport encryption protocols — TLS 1.3, IPsec, SSH, S/MIME, SRTP, and post-quantum considerations.</p>
      </div>
    </div>

    <h3>Why This Matters</h3>
    <p>With over 95% of internet traffic now encrypted, proper implementation of cryptographic solutions is essential. Misconfigured encryption or expired certificates are among the most common security failures organizations face. Additionally, the emergence of quantum computing has prompted NIST to finalize post-quantum cryptography (PQC) standards in 2024, making crypto-agility a critical skill for modern security professionals.</p>

    <div class="highlight-card">
      <span class="card-label">Exam Tip</span>
      <p>The SY0-701 exam emphasizes practical application of cryptographic concepts. You need to understand <strong>when and why</strong> to use specific solutions — not just what they are. Expect scenario-based questions about certificate management, key lifecycle, and selecting appropriate encryption protocols.</p>
    </div>

    <div style="text-align:center; margin-top:24px;">
      <button class="btn btn-primary" onclick="goToSection(1)">Begin Lesson &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 1: IMPLEMENTING CRYPTOGRAPHY -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-1" aria-label="Implementing Cryptography">
  <div class="section-header">
    <h2>Implementing Cryptography</h2>
    <span class="obj-tag">Objective 1 &bull; Key Strength &bull; Block Ciphers &bull; Algorithm Inputs</span>
  </div>
  <div class="section-body">
    <p>Improperly applied cryptography can create vulnerabilities that threat actors exploit. Understanding the fundamentals of implementation is critical.</p>

    <h3>Key Strength</h3>
    <p>The resiliency of a cryptographic key against attacks depends on three primary characteristics:</p>
    <div class="card-grid">
      <div class="info-card">
        <h4>Randomness</h4>
        <p>Keys must be generated using a cryptographically secure random number generator (CSPRNG). Predictable keys are easily compromised.</p>
      </div>
      <div class="info-card">
        <h4>Length</h4>
        <p>Longer keys provide greater security. AES-256 (256-bit key) is stronger than AES-128. RSA keys under 2048 bits are considered weak; 4096 bits is strong.</p>
      </div>
      <div class="info-card">
        <h4>Cryptoperiod</h4>
        <p>The time during which a key is authorized for use. Shorter cryptoperiods limit exposure if a key is compromised. NIST SP 800-57 provides guidance.</p>
      </div>
    </div>

    <h3>Block Cipher Modes of Operation</h3>
    <p>A block cipher mode specifies how block ciphers handle blocks of plaintext. Choosing the right mode is essential for security.</p>

    <div class="resp-table-wrap">
      <table class="resp-table" role="table">
        <caption class="sr-only">Block Cipher Modes Comparison</caption>
        <thead>
          <tr><th scope="col">Mode</th><th scope="col">Full Name</th><th scope="col">How It Works</th><th scope="col">Use Case</th><th scope="col">Security</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>ECB</strong></td><td>Electronic Code Book</td><td>Each block encrypted independently</td><td>Simple data</td><td style="color:var(--red-err)">Weak — identical blocks produce identical ciphertext</td></tr>
          <tr><td><strong>CBC</strong></td><td>Cipher Block Chaining</td><td>Each block XORed with previous ciphertext before encryption</td><td>File encryption, TLS (legacy)</td><td style="color:var(--gold)">Moderate — vulnerable to padding oracle attacks</td></tr>
          <tr><td><strong>CTR</strong></td><td>Counter</td><td>Uses incrementing counter as input; enables parallelization</td><td>High-speed encryption</td><td style="color:var(--green-ok)">Strong</td></tr>
          <tr><td><strong>GCM</strong></td><td>Galois/Counter Mode</td><td>Combines CTR with authentication tag (GMAC)</td><td>TLS 1.3, IPsec, SSH</td><td style="color:var(--green-ok)">Strong — provides authenticated encryption</td></tr>
        </tbody>
      </table>
    </div>

    <div class="highlight-card">
      <span class="card-label">SY0-701 Focus</span>
      <p><strong>GCM is the preferred mode</strong> for modern applications because it provides both confidentiality and integrity (authenticated encryption with associated data — AEAD). TLS 1.3 exclusively uses AEAD cipher suites.</p>
    </div>

    <h3>Algorithm Input Values</h3>
    <div class="accordion" id="inputAccordion">
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Salt <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body" role="region">
          <p>A <strong>salt</strong> is a random value added to input before hashing to ensure identical plaintexts produce different digests. Critical for password storage — prevents rainbow table attacks. Each password should use a unique, random salt.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Nonce <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body" role="region">
          <p>A <strong>nonce</strong> ("number used once") is an input value that must be unique within a given scope. Used in challenge-response authentication and encryption protocols to prevent replay attacks. Never reuse a nonce with the same key.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Initialization Vector (IV) <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body" role="region">
          <p>An <strong>IV</strong> is the most widely used algorithm input. It is a type of nonce with an additional requirement: it must be selected in a <em>non-predictable</em> way. Used in CBC mode and other block cipher modes to ensure the first block of plaintext is encrypted differently each time.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Key Stretching <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body" role="region">
          <p><strong>Key stretching</strong> makes weak keys (like passwords) stronger by running them through a computationally intensive function. Common algorithms include <strong>PBKDF2</strong>, <strong>bcrypt</strong>, and <strong>Argon2</strong> (recommended by OWASP). This increases the time needed for brute-force attacks.</p>
        </div>
      </div>
    </div>

    <h3>Crypto Service Providers</h3>
    <p>A crypto service provider (CSP) is a software library or hardware module that implements cryptographic algorithms and enables applications to use encryption without handling low-level math. CSPs implement algorithms, generate keys, provide key storage, and authenticate users by calling various crypto modules.</p>

    <div style="text-align:right; margin-top:24px;">
      <button class="btn btn-primary" onclick="goToSection(2)">Next: Digital Certificates &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 2: DIGITAL CERTIFICATES -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-2" aria-label="Digital Certificates">
  <div class="section-header">
    <h2>Digital Certificates</h2>
    <span class="obj-tag">Objective 2 &bull; X.509 &bull; Certificate Types &bull; Formats</span>
  </div>
  <div class="section-body">
    <p>A <strong>digital certificate</strong> is an electronic document that binds a public key to an identity (person, device, or service). It is digitally signed by a trusted Certificate Authority (CA) to provide assurance of authenticity.</p>

    <h3>X.509 Certificate Standard</h3>
    <p>X.509 is the most widely accepted format for digital certificates. It includes fields such as:</p>
    <div class="resp-table-wrap">
      <table class="resp-table" role="table">
        <caption class="sr-only">X.509 Certificate Fields</caption>
        <thead><tr><th scope="col">Field</th><th scope="col">Description</th></tr></thead>
        <tbody>
          <tr><td>Version</td><td>Version of X.509 standard (usually v3)</td></tr>
          <tr><td>Serial Number</td><td>Unique identifier assigned by the CA</td></tr>
          <tr><td>Signature Algorithm</td><td>Algorithm used by the CA to sign the certificate</td></tr>
          <tr><td>Issuer</td><td>Identity of the CA that issued the certificate</td></tr>
          <tr><td>Validity Period</td><td>Start and end dates for certificate validity</td></tr>
          <tr><td>Subject</td><td>Identity of the certificate holder (CN, O, OU, etc.)</td></tr>
          <tr><td>Public Key</td><td>The subject's public key and its algorithm</td></tr>
          <tr><td>Extensions</td><td>Additional fields — key usage, SAN, CRL distribution points</td></tr>
          <tr><td>Digital Signature</td><td>The CA's signature over all the above fields</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Types of Digital Certificates</h3>
    <div class="sub-tabs" role="tablist" aria-label="Certificate types">
      <button class="sub-tab-btn active" role="tab" aria-selected="true" data-target="certTypeWeb" id="tabCertWeb">Web/Server</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-target="certTypeSpecial" id="tabCertSpecial">Special Purpose</button>
      <button class="sub-tab-btn" role="tab" aria-selected="false" data-target="certTypeFormat" id="tabCertFormat">Formats</button>
    </div>
    <div class="sub-tab-content active" id="certTypeWeb" role="tabpanel" aria-labelledby="tabCertWeb">
      <div class="card-grid">
        <div class="info-card">
          <h4>Domain Validation (DV)</h4>
          <p>Verifies domain ownership only. Quick to issue, low trust level. Shows a padlock but no organization info.</p>
        </div>
        <div class="info-card">
          <h4>Organization Validation (OV)</h4>
          <p>Verifies organization identity and domain ownership. Moderate trust — displays organization name.</p>
        </div>
        <div class="info-card">
          <h4>Extended Validation (EV)</h4>
          <p>Highest level of validation. Requires thorough vetting of the organization. Provides maximum trust for e-commerce and financial sites.</p>
        </div>
        <div class="info-card">
          <h4>Wildcard Certificate</h4>
          <p>Secures a domain and all subdomains (e.g., *.example.com). Cost-effective for organizations with many subdomains.</p>
        </div>
        <div class="info-card">
          <h4>SAN Certificate</h4>
          <p>Subject Alternative Name certificate protects multiple different domains/hostnames with a single certificate. Common with unified communications.</p>
        </div>
        <div class="info-card">
          <h4>Self-Signed Certificate</h4>
          <p>Signed by its own private key, not a trusted CA. Used for internal testing and development. Browsers show trust warnings.</p>
        </div>
      </div>
    </div>
    <div class="sub-tab-content" id="certTypeSpecial" role="tabpanel" aria-labelledby="tabCertSpecial">
      <div class="card-grid">
        <div class="info-card">
          <h4>Code Signing</h4>
          <p>Validates software integrity and publisher identity. Ensures code hasn't been tampered with since distribution.</p>
        </div>
        <div class="info-card">
          <h4>Email (S/MIME)</h4>
          <p>Enables encrypted email and digital signatures. Verifies sender identity and message integrity.</p>
        </div>
        <div class="info-card">
          <h4>Machine/Device</h4>
          <p>Authenticates hardware devices on a network. Used in IoT, 802.1X, and VPN authentication.</p>
        </div>
        <div class="info-card">
          <h4>User Certificate</h4>
          <p>Authenticates individual users. Often stored on smart cards for multi-factor authentication.</p>
        </div>
        <div class="info-card">
          <h4>Root Certificate</h4>
          <p>The foundational certificate of a CA hierarchy. Pre-installed in operating systems and browsers. Its private key must be rigorously protected.</p>
        </div>
      </div>
    </div>
    <div class="sub-tab-content" id="certTypeFormat" role="tabpanel" aria-labelledby="tabCertFormat">
      <div class="resp-table-wrap">
        <table class="resp-table" role="table">
          <caption class="sr-only">Certificate Format Comparison</caption>
          <thead><tr><th scope="col">Format</th><th scope="col">Extension</th><th scope="col">Encoding</th><th scope="col">Notes</th></tr></thead>
          <tbody>
            <tr><td><strong>DER</strong></td><td>.der, .cer</td><td>Binary</td><td>Often used with Java-based systems</td></tr>
            <tr><td><strong>PEM</strong></td><td>.pem, .crt</td><td>Base64 (ASCII)</td><td>Most common; begins with "-----BEGIN CERTIFICATE-----"</td></tr>
            <tr><td><strong>PFX/PKCS#12</strong></td><td>.pfx, .p12</td><td>Binary</td><td>Stores certificate + private key in one file; password-protected</td></tr>
            <tr><td><strong>P7B/PKCS#7</strong></td><td>.p7b</td><td>Base64</td><td>Contains certificates and chain; no private key</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div style="text-align:right; margin-top:24px;">
      <button class="btn btn-outline" onclick="goToSection(1)">&#8592; Previous</button>
      <button class="btn btn-primary" onclick="goToSection(3)" style="margin-left:8px;">Next: PKI Components &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 3: PKI COMPONENTS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-3" aria-label="PKI Components">
  <div class="section-header">
    <h2>Public Key Infrastructure (PKI)</h2>
    <span class="obj-tag">Objective 3 &bull; CAs &bull; Trust Models &bull; Key Management</span>
  </div>
  <div class="section-body">
    <p><strong>Public Key Infrastructure (PKI)</strong> is a comprehensive framework of hardware, software, people, policies, and procedures used to create, manage, distribute, store, and revoke digital certificates. In short, PKI is digital certificate management.</p>

    <h3>Interactive PKI Hierarchy</h3>
    <p>Click any component to learn more about its role.</p>
    <div class="diagram-wrap">
      <h4>&#128737; PKI Trust Hierarchy</h4>
      <div class="pki-hierarchy" id="pkiDiagram">
        <div class="pki-node root" tabindex="0" role="button" aria-label="Root Certificate Authority" onclick="showNodeDetail(this, 'The Root CA is the highest authority in a PKI hierarchy. Its certificate is self-signed and pre-installed in operating systems and browsers. The Root CA private key must be kept offline and physically secured. If compromised, the entire PKI chain is invalidated.')">
          <div class="node-label">Root CA</div>
          <div class="node-desc">Offline &bull; Self-signed</div>
        </div>
        <div class="pki-connector" aria-hidden="true"></div>
        <div class="pki-row">
          <div class="pki-branch">
            <div class="pki-node" tabindex="0" role="button" aria-label="Intermediate CA 1" onclick="showNodeDetail(this, 'Intermediate CAs (also called subordinate CAs) are signed by the Root CA and issue certificates to end entities. Using intermediates protects the Root CA — if an intermediate is compromised, only certificates it issued are affected. This creates a chain of trust.')">
              <div class="node-label">Intermediate CA</div>
              <div class="node-desc">Issues certificates</div>
            </div>
            <div class="pki-connector" aria-hidden="true"></div>
            <div class="pki-row">
              <div class="pki-node" tabindex="0" role="button" onclick="showNodeDetail(this, 'Leaf certificates (end-entity certificates) are issued to servers, users, devices, or applications. They cannot sign other certificates. These are the certificates you see on websites (HTTPS), in email (S/MIME), and in code signing.')">
                <div class="node-label">Server Cert</div>
                <div class="node-desc">Leaf / End-entity</div>
              </div>
              <div class="pki-node" tabindex="0" role="button" onclick="showNodeDetail(this, 'User certificates authenticate individuals. They may be stored on smart cards, USB tokens, or in software keystores. Used for email encryption, VPN access, and multi-factor authentication.')">
                <div class="node-label">User Cert</div>
                <div class="node-desc">Leaf / End-entity</div>
              </div>
            </div>
          </div>
          <div class="pki-branch">
            <div class="pki-node" tabindex="0" role="button" onclick="showNodeDetail(this, 'A Registration Authority (RA) handles the verification of identities before the CA issues a certificate. The RA does not sign certificates — it validates the identity of the requester and forwards approved requests to the CA.')">
              <div class="node-label">Registration Authority</div>
              <div class="node-desc">Identity verification</div>
            </div>
            <div class="pki-connector" aria-hidden="true"></div>
            <div class="pki-node" tabindex="0" role="button" onclick="showNodeDetail(this, 'CRL Distribution Point and OCSP Responder handle revocation checking. The CRL is a list of revoked certificates published by the CA. OCSP provides real-time status checks. OCSP stapling attaches the status to the TLS handshake for efficiency.')">
              <div class="node-label">CRL / OCSP</div>
              <div class="node-desc">Revocation services</div>
            </div>
          </div>
        </div>
      </div>
      <div class="node-detail" id="nodeDetail" role="alert"></div>
    </div>

    <h3>Trust Models</h3>
    <div class="card-grid">
      <div class="info-card">
        <h4>Hierarchical Trust Model</h4>
        <p>A single root CA at the top signs intermediate CAs, which sign end-entity certificates. Most common in enterprise and internet PKI. Clear chain of authority.</p>
      </div>
      <div class="info-card">
        <h4>Distributed Trust Model</h4>
        <p>Multiple CAs operate at the same level with no single root. Each CA signs its own certificates independently. Used when no single authority is trusted by all parties.</p>
      </div>
      <div class="info-card">
        <h4>Bridge Trust Model</h4>
        <p>A bridge CA connects multiple independent PKI hierarchies. Acts as a facilitator — it does not sign end-entity certificates but cross-certifies between CAs.</p>
      </div>
      <div class="info-card">
        <h4>Web of Trust</h4>
        <p>No central CA. Users sign each other's certificates based on direct trust (used by PGP/GPG). Less scalable, but decentralized. Each user decides whom to trust.</p>
      </div>
    </div>

    <h3>Certificate Lifecycle</h3>
    <p>Click each phase to learn more:</p>
    <div class="lifecycle-track" role="group" aria-label="Certificate lifecycle phases">
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(0)" aria-label="Creation phase">1</div>
        <div class="lifecycle-label">Creation</div>
      </div>
      <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(1)">2</div>
        <div class="lifecycle-label">Issuance</div>
      </div>
      <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(2)">3</div>
        <div class="lifecycle-label">Usage</div>
      </div>
      <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(3)">4</div>
        <div class="lifecycle-label">Renewal</div>
      </div>
      <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(4)">5</div>
        <div class="lifecycle-label">Revocation</div>
      </div>
      <div class="lifecycle-arrow" aria-hidden="true">&#8594;</div>
      <div class="lifecycle-step">
        <div class="lifecycle-circle" tabindex="0" role="button" onclick="showLifecycle(5)">6</div>
        <div class="lifecycle-label">Expiration</div>
      </div>
    </div>
    <div class="lifecycle-detail" id="lifecycleDetail"></div>

    <h3>Key Management</h3>
    <div class="accordion">
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Key Storage <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>Public keys are embedded in digital certificates. Private keys can be stored in software (file system) or hardware (HSMs, smart cards, TPMs). Hardware storage is more secure — HSMs (Hardware Security Modules) provide tamper-evident, FIPS 140-2/3 validated storage.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Key Escrow <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>A trusted third party holds copies of encryption keys. Used for regulatory compliance and data recovery. The third party can provide decryption if the original key holder is unavailable.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          M-of-N Control <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>Key recovery requires M people out of N total to participate (e.g., 3-of-5). Prevents any single person from recovering a key alone. Also called split knowledge or secret sharing.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" aria-expanded="false" onclick="toggleAccordion(this)">
          Key Destruction <span class="acc-icon" aria-hidden="true">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>When keys reach end-of-life, they must be securely destroyed. This includes removing all copies from storage media. For hardware keys, physical destruction of the token or HSM partition may be required.</p>
        </div>
      </div>
    </div>

    <div style="text-align:right; margin-top:24px;">
      <button class="btn btn-outline" onclick="goToSection(2)">&#8592; Previous</button>
      <button class="btn btn-primary" onclick="goToSection(4)" style="margin-left:8px;">Next: Transport Encryption &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 4: TRANSPORT ENCRYPTION -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-4" aria-label="Transport Encryption Protocols">
  <div class="section-header">
    <h2>Transport Encryption Protocols</h2>
    <span class="obj-tag">Objective 4 &bull; TLS 1.3 &bull; IPsec &bull; SSH &bull; Post-Quantum</span>
  </div>
  <div class="section-body">
    <p>Cryptographic transport protocols protect <strong>data-in-transit</strong> as it moves across networks. These protocols use a combination of asymmetric cryptography (for key exchange) and symmetric cryptography (for bulk data encryption).</p>

    <h3>Symmetric vs. Asymmetric — Quick Comparison</h3>
    <div class="compare-columns">
      <div class="compare-col sym">
        <h4>&#128273; Symmetric Encryption</h4>
        <p><strong>Same key</strong> for encryption and decryption.</p>
        <p>Fast — suitable for bulk data encryption.</p>
        <p>Key distribution is a challenge (shared secret).</p>
        <p><strong>Examples:</strong> AES-256, ChaCha20</p>
        <p><strong>Used for:</strong> Data encryption after key exchange</p>
      </div>
      <div class="compare-col asym">
        <h4>&#128272; Asymmetric Encryption</h4>
        <p><strong>Key pair</strong> — public key encrypts, private key decrypts.</p>
        <p>Slower — used for key exchange and digital signatures.</p>
        <p>Public key can be freely distributed.</p>
        <p><strong>Examples:</strong> RSA, ECDH, ECDSA, Ed25519</p>
        <p><strong>Used for:</strong> TLS handshake, digital signatures, PKI</p>
      </div>
    </div>

    <h3>Key Transport Protocols</h3>
    <div class="accordion">
      <div class="accordion-item">
        <button class="accordion-header" onclick="toggleAccordion(this)">
          TLS 1.3 (Transport Layer Security) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>TLS 1.3</strong> (RFC 8446, released 2018) is the current standard for securing application-layer communications. Major improvements over TLS 1.2 include:</p>
          <ul>
            <li><strong>Faster handshake:</strong> 1-RTT (one round trip) vs. 2-RTT in TLS 1.2; supports 0-RTT resumption</li>
            <li><strong>Stronger crypto only:</strong> Removes weak algorithms (RC4, 3DES, SHA-1, static RSA). Only AEAD cipher suites (AES-GCM, ChaCha20-Poly1305)</li>
            <li><strong>Perfect Forward Secrecy (PFS):</strong> Required for all connections via ephemeral Diffie-Hellman (ECDHE)</li>
            <li><strong>Simplified cipher suites:</strong> TLS_AES_256_GCM_SHA384, TLS_AES_128_GCM_SHA256, TLS_CHACHA20_POLY1305_SHA256</li>
          </ul>
          <p>A cipher suite in TLS is a named combination of the encryption, authentication, and MAC algorithms used for the session.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" onclick="toggleAccordion(this)">
          IPsec (Internet Protocol Security) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>IPsec operates at the network layer (Layer 3) and is transparent to applications. It provides three areas of protection:</p>
          <ul>
            <li><strong>Authentication Header (AH):</strong> Provides data integrity and origin authentication, but no encryption</li>
            <li><strong>Encapsulating Security Payload (ESP):</strong> Provides confidentiality, integrity, and optional authentication</li>
            <li><strong>Internet Key Exchange (IKE/IKEv2):</strong> Negotiates security associations and manages keys</li>
          </ul>
          <p><strong>Two modes:</strong> Transport mode (encrypts payload only, header unencrypted) and Tunnel mode (encrypts entire original packet — used for VPNs).</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" onclick="toggleAccordion(this)">
          SSH (Secure Shell) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>SSH is an encrypted protocol for remote access and file transfer, replacing insecure Telnet and FTP. SSH uses port 22 and provides strong authentication (password, public key, certificate-based). The SSH suite includes <strong>ssh</strong> (remote login), <strong>scp</strong> (secure copy), and <strong>sftp</strong> (secure file transfer).</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" onclick="toggleAccordion(this)">
          S/MIME &amp; SRTP <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p><strong>S/MIME</strong> (Secure/Multipurpose Internet Mail Extensions) secures email with encryption and digital signatures using PKI certificates.</p>
          <p><strong>SRTP</strong> (Secure Real-time Transport Protocol) protects Voice over IP (VoIP) communications with encryption and message authentication.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-header" onclick="toggleAccordion(this)">
          Post-Quantum Cryptography (PQC) <span class="acc-icon">&#9660;</span>
        </button>
        <div class="accordion-body">
          <p>Quantum computers threaten current asymmetric algorithms (RSA, ECC) via Shor's algorithm. In 2024, NIST published the first PQC standards:</p>
          <ul>
            <li><strong>ML-KEM (FIPS 203)</strong> — Key encapsulation (based on CRYSTALS-Kyber) for key exchange</li>
            <li><strong>ML-DSA (FIPS 204)</strong> — Digital signatures (based on CRYSTALS-Dilithium)</li>
            <li><strong>SLH-DSA (FIPS 205)</strong> — Hash-based signatures (based on SPHINCS+)</li>
          </ul>
          <p>Organizations should adopt a <strong>crypto-agile</strong> approach — using hybrid solutions that combine classical and post-quantum algorithms during the transition period. Symmetric ciphers (AES-256) are already considered quantum-resistant if key sizes are sufficient.</p>
        </div>
      </div>
    </div>

    <div class="highlight-card">
      <span class="card-label">Critical Concept</span>
      <p><strong>Harvest Now, Decrypt Later:</strong> Adversaries may record encrypted traffic today, intending to decrypt it once quantum computers become available. This makes the migration to post-quantum cryptography urgent, especially for data with long-term confidentiality requirements (government, healthcare, financial).</p>
    </div>

    <div style="text-align:right; margin-top:24px;">
      <button class="btn btn-outline" onclick="goToSection(3)">&#8592; Previous</button>
      <button class="btn btn-primary" onclick="goToSection(5)" style="margin-left:8px;">Next: Interactive Lab &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 5: INTERACTIVE LAB -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-5" aria-label="Interactive Lab">
  <div class="section-header">
    <h2>Interactive Lab: Cryptography in Action</h2>
    <span class="obj-tag">Hands-On Practice</span>
  </div>
  <div class="section-body">
    <h3>Lab 1: Hash Generator</h3>
    <p>Enter text below and observe how even a tiny change completely alters the hash output (the avalanche effect). This demonstrates why hashing is used for data integrity verification.</p>
    <div class="demo-box">
      <div class="demo-row">
        <div class="demo-field">
          <label for="hashInput">Input Text:</label>
          <input type="text" id="hashInput" placeholder="Type something..." value="Hello World" oninput="computeHash()">
        </div>
        <div class="demo-field">
          <label for="hashAlgo">Algorithm:</label>
          <select id="hashAlgo" onchange="computeHash()">
            <option value="SHA-256">SHA-256</option>
            <option value="SHA-384">SHA-384</option>
            <option value="SHA-512">SHA-512</option>
          </select>
        </div>
      </div>
      <label style="font-weight:700; font-size:.82rem; color:var(--navy); display:block; margin-bottom:4px;">Hash Output:</label>
      <div class="demo-output" id="hashOutput" aria-live="polite">Computing...</div>
      <p style="font-size:.8rem; color:var(--mid-gray); margin-top:8px;"><em>Try changing a single character and observe how the entire hash changes.</em></p>
    </div>

    <h3>Lab 2: Symmetric Encryption Simulator</h3>
    <p>This demonstrates symmetric encryption — the same key is used for both encryption and decryption.</p>
    <div class="demo-box">
      <div class="demo-row">
        <div class="demo-field">
          <label for="symPlain">Plaintext Message:</label>
          <input type="text" id="symPlain" placeholder="Enter a message..." value="Security+ Exam 2025">
        </div>
        <div class="demo-field">
          <label for="symKey">Encryption Key (password):</label>
          <input type="text" id="symKey" placeholder="Enter a key..." value="MySecretKey123">
        </div>
      </div>
      <div style="display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap;">
        <button class="btn btn-primary" onclick="symEncrypt()" id="symEncBtn">&#128274; Encrypt</button>
        <button class="btn btn-gold" onclick="symDecrypt()" id="symDecBtn">&#128275; Decrypt</button>
      </div>
      <label style="font-weight:700; font-size:.82rem; color:var(--navy); display:block; margin-bottom:4px;">Encrypted Output:</label>
      <div class="demo-output" id="symOutput" aria-live="polite">Click Encrypt to begin...</div>
      <label style="font-weight:700; font-size:.82rem; color:var(--navy); display:block; margin:12px 0 4px;">Decrypted Output:</label>
      <div class="demo-output" id="symDecOutput" aria-live="polite" style="color:#66ccff;">Click Decrypt after encrypting...</div>
    </div>

    <h3>Lab 3: Certificate Chain Validator</h3>
    <p>Explore how browsers validate certificate chains. Click each step to see what happens during HTTPS verification.</p>
    <div class="demo-box">
      <div id="chainSteps">
        <div class="chain-step" style="margin-bottom:12px;">
          <button class="btn btn-navy" onclick="showChainStep(0)" style="width:100%; text-align:left;">
            Step 1: Browser receives server certificate
          </button>
          <div class="chain-detail" id="chainDetail0" style="display:none; padding:12px; background:var(--section-bg); border-radius:var(--radius); margin-top:6px; font-size:.88rem;"></div>
        </div>
        <div class="chain-step" style="margin-bottom:12px;">
          <button class="btn btn-navy" onclick="showChainStep(1)" style="width:100%; text-align:left;">
            Step 2: Verify intermediate CA signature
          </button>
          <div class="chain-detail" id="chainDetail1" style="display:none;padding:12px;background:var(--section-bg);border-radius:var(--radius);margin-top:6px;font-size:.88rem;"></div>
        </div>
        <div class="chain-step" style="margin-bottom:12px;">
          <button class="btn btn-navy" onclick="showChainStep(2)" style="width:100%; text-align:left;">
            Step 3: Verify Root CA trust
          </button>
          <div class="chain-detail" id="chainDetail2" style="display:none;padding:12px;background:var(--section-bg);border-radius:var(--radius);margin-top:6px;font-size:.88rem;"></div>
        </div>
        <div class="chain-step" style="margin-bottom:12px;">
          <button class="btn btn-navy" onclick="showChainStep(3)" style="width:100%; text-align:left;">
            Step 4: Check revocation status (CRL/OCSP)
          </button>
          <div class="chain-detail" id="chainDetail3" style="display:none;padding:12px;background:var(--section-bg);border-radius:var(--radius);margin-top:6px;font-size:.88rem;"></div>
        </div>
        <div class="chain-step" style="margin-bottom:12px;">
          <button class="btn btn-navy" onclick="showChainStep(4)" style="width:100%; text-align:left;">
            Step 5: Establish encrypted session
          </button>
          <div class="chain-detail" id="chainDetail4" style="display:none;padding:12px;background:var(--section-bg);border-radius:var(--radius);margin-top:6px;font-size:.88rem;"></div>
        </div>
      </div>
    </div>

    <div style="text-align:right; margin-top:24px;">
      <button class="btn btn-outline" onclick="goToSection(4)">&#8592; Previous</button>
      <button class="btn btn-primary" onclick="goToSection(6)" style="margin-left:8px;">Next: Flashcards &#8594;</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 6: FLASHCARDS -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-6" aria-label="Flashcards">
  <div class="section-header">
    <h2>Key Term Flashcards</h2>
    <span class="obj-tag">Study Aid &bull; 20 Key Terms</span>
  </div>
  <div class="section-body">
    <p style="text-align:center;">Click the card to reveal the definition. Use the arrows to navigate.</p>
    <div class="flashcard-deck">
      <div class="flashcard" id="flashcard" onclick="flipCard()" role="button" tabindex="0" aria-label="Flashcard - click to flip">
        <div class="flashcard-inner">
          <div class="flashcard-face flashcard-front">
            <div class="fc-label">Term</div>
            <div id="fcTerm">Loading...</div>
          </div>
          <div class="flashcard-face flashcard-back">
            <div id="fcDef">Loading...</div>
          </div>
        </div>
      </div>
      <div class="fc-controls">
        <button class="btn btn-outline" onclick="prevCard()" aria-label="Previous card">&#8592; Prev</button>
        <span class="fc-counter" id="fcCounter" aria-live="polite">1 / 20</span>
        <button class="btn btn-outline" onclick="nextCard()" aria-label="Next card">Next &#8594;</button>
      </div>
      <button class="btn btn-gold" onclick="shuffleCards()" style="margin-top:8px;">&#128256; Shuffle</button>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 7: KNOWLEDGE CHECK -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-7" aria-label="Knowledge Check Quiz">
  <div class="section-header">
    <h2>Knowledge Check</h2>
    <span class="obj-tag">10 Questions &bull; Self-Assessment</span>
  </div>
  <div class="section-body">
    <p>Test your understanding. Select the best answer for each question, then click <strong>Submit Answers</strong> to see your results.</p>
    <div class="quiz-container" id="quizContainer"></div>
    <div style="text-align:center; margin-top:20px;">
      <button class="btn btn-primary" onclick="submitQuiz()" id="submitQuizBtn">Submit Answers</button>
      <button class="btn btn-outline" onclick="resetQuiz()" id="resetQuizBtn" style="margin-left:8px; display:none;">Reset Quiz</button>
    </div>
    <div class="quiz-score" id="quizScore" style="display:none;">
      <div class="score-num" id="scoreNum"></div>
      <div class="score-label" id="scoreLabel"></div>
    </div>
  </div>
</section>

<!-- ============================================================ -->
<!-- SECTION 8: RESOURCES -->
<!-- ============================================================ -->
<section class="lesson-section" id="section-8" aria-label="Additional Resources">
  <div class="section-header">
    <h2>Additional Resources</h2>
    <span class="obj-tag">Videos &bull; Articles &bull; Tools</span>
  </div>
  <div class="section-body">
    <h3>Video Resources</h3>
    <div class="yt-section-label" id="ytModeLabel">
      <span class="yt-icon">&#9654;</span>
      <span id="ytModeText">Detecting playback mode&hellip;</span>
    </div>
    <!-- Tip: shown only when opened from local file -->
    <div id="ytLocalTip" style="display:none; background:#1B2A4A; color:#E8E8E8; border-left:4px solid #CC9900; border-radius:8px; padding:14px 18px; margin-bottom:20px; font-size:.82rem; font-family:var(--sans); line-height:1.6;">
      <strong style="color:#CC9900;">&#9432; Tip &mdash; Enable Inline Playback</strong><br>
      YouTube blocks embedded players when opened directly from a file. To watch videos inside this page, open a terminal in the folder containing this file and run:<br>
      <code style="display:inline-block; margin-top:6px; background:#0D1B2A; padding:6px 12px; border-radius:4px; color:#4DB8A4; font-size:.82rem; letter-spacing:.3px; user-select:all; cursor:text;">python3 -m http.server 8000</code><br>
      Then open <a href="http://localhost:8000" target="_blank" rel="noopener noreferrer" style="color:#4DB8A4; font-weight:700;">http://localhost:8000</a> in your browser and navigate to the file. Videos will play inline.
    </div>
    <div class="yt-embed-grid">
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-xHAMEF7-inQ">
          <button class="yt-facade" role="button" aria-label="Play video: Public Key Infrastructure – Security+ 1.4 by Professor Messer" style="background-image:url('https://img.youtube.com/vi/xHAMEF7-inQ/hqdefault.jpg')" onclick="loadYT(this,'xHAMEF7-inQ')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">9:08</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>Public Key Infrastructure &mdash; Security+ (1.4)</h4>
          <p>Comprehensive PKI overview: symmetric &amp; asymmetric encryption, key pairs, digital certificates, and certificate authorities.</p>
          <span class="yt-channel">Professor Messer &bull; 9:08</span>
        </div>
      </div>
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-0ctat6RBrFo">
          <button class="yt-facade" role="button" aria-label="Play video: Tech Talk – What is Public Key Infrastructure? by IBM Technology" style="background-image:url('https://img.youtube.com/vi/0ctat6RBrFo/hqdefault.jpg')" onclick="loadYT(this,'0ctat6RBrFo')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">9:22</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>Tech Talk: What is PKI?</h4>
          <p>Deep dive into PKI components, asymmetric cryptography, digital signatures, and real-world PKI applications in enterprise environments.</p>
          <span class="yt-channel">IBM Technology &bull; 9:22</span>
        </div>
      </div>
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-AQDCe585Lnc">
          <button class="yt-facade" role="button" aria-label="Play video: Asymmetric Encryption Simply Explained" style="background-image:url('https://img.youtube.com/vi/AQDCe585Lnc/hqdefault.jpg')" onclick="loadYT(this,'AQDCe585Lnc')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">4:40</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>Asymmetric Encryption &mdash; Simply Explained</h4>
          <p>Clear visual breakdown of public/private key cryptography, key exchange, and why asymmetric encryption is the backbone of internet security.</p>
          <span class="yt-channel">Simply Explained &bull; 4:40</span>
        </div>
      </div>
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-86cQJ0MMses">
          <button class="yt-facade" role="button" aria-label="Play video: TLS Handshake Explained by Computerphile" style="background-image:url('https://img.youtube.com/vi/86cQJ0MMses/hqdefault.jpg')" onclick="loadYT(this,'86cQJ0MMses')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">15:09</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>TLS Handshake Explained</h4>
          <p>How TLS establishes secure connections: cipher negotiation, certificate validation, key exchange, and the differences between TLS 1.2 and 1.3.</p>
          <span class="yt-channel">Computerphile &bull; 15:09</span>
        </div>
      </div>
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-jhXCTbFnK8o">
          <button class="yt-facade" role="button" aria-label="Play video: Cryptography – Crash Course Computer Science" style="background-image:url('https://img.youtube.com/vi/jhXCTbFnK8o/hqdefault.jpg')" onclick="loadYT(this,'jhXCTbFnK8o')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">12:32</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>Cryptography &mdash; Crash Course Computer Science</h4>
          <p>Engaging overview of cryptographic history, AES, DES, Diffie-Hellman key exchange, and RSA &mdash; all the crypto fundamentals in one lesson.</p>
          <span class="yt-channel">CrashCourse &bull; 12:32</span>
        </div>
      </div>
      <div class="yt-embed-card">
        <div class="yt-embed-wrap" id="yt-crPe69NeTdk">
          <button class="yt-facade" role="button" aria-label="Play video: NIST Post-Quantum Cryptography Standardization Explained" style="background-image:url('https://img.youtube.com/vi/crPe69NeTdk/hqdefault.jpg')" onclick="loadYT(this,'crPe69NeTdk')">
            <span class="yt-play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></span>
            <span class="yt-duration">8:14</span>
          </button>
        </div>
        <div class="yt-embed-info">
          <h4>Post-Quantum Cryptography &mdash; NIST Standardization</h4>
          <p>Why current encryption is at risk from quantum computing and how NIST&rsquo;s new PQC standards (ML-KEM, ML-DSA, SLH-DSA) will protect us.</p>
          <span class="yt-channel">Cybersecurity Education &bull; PQC</span>
        </div>
      </div>
    </div>

    <h3 style="margin-top:32px;">Search &amp; Additional Resources</h3>
    <div class="yt-search-bar" role="navigation" aria-label="YouTube search links">
      <span>&#x25B6; Search YouTube:</span>
      <a href="https://www.youtube.com/results?search_query=public+key+infrastructure+PKI+explained" target="_blank" rel="noopener noreferrer">PKI Overview</a>
      <a href="https://www.youtube.com/results?search_query=digital+certificates+X.509+certificate+authority+explained" target="_blank" rel="noopener noreferrer">Digital Certificates</a>
      <a href="https://www.youtube.com/results?search_query=TLS+1.3+handshake+explained" target="_blank" rel="noopener noreferrer">TLS 1.3</a>
      <a href="https://www.youtube.com/results?search_query=symmetric+vs+asymmetric+encryption+explained" target="_blank" rel="noopener noreferrer">Encryption Types</a>
      <a href="https://www.youtube.com/results?search_query=post+quantum+cryptography+NIST+2024+ML-KEM" target="_blank" rel="noopener noreferrer">Post-Quantum Crypto</a>
      <a href="https://www.youtube.com/results?search_query=CompTIA+Security%2B+SY0-701+1.4+cryptographic+solutions" target="_blank" rel="noopener noreferrer">Security+ 1.4</a>
    </div>
    <div class="video-grid">
      <a class="video-card" href="https://www.professormesser.com/security-plus/sy0-701/sy0-701-video/public-key-infrastructure-sy0-701/" target="_blank" rel="noopener noreferrer" aria-label="Watch Public Key Infrastructure lesson by Professor Messer (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge">Video Lesson</span>
          <div class="play-icon" aria-hidden="true">&#9654;</div>
          <span class="type-label">professormesser.com</span>
        </div>
        <div class="video-card-body">
          <h4>Public Key Infrastructure &mdash; Security+ (1.4)</h4>
          <p>Professor Messer &mdash; Comprehensive overview of PKI, symmetric &amp; asymmetric encryption, key pair generation, and certificate authorities.</p>
          <span class="video-link">Watch Free Video &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.professormesser.com/security-plus/sy0-701/sy0-701-video/certificates-sy0-701/" target="_blank" rel="noopener noreferrer" aria-label="Watch Certificates lesson by Professor Messer (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge">Video Lesson</span>
          <div class="play-icon" aria-hidden="true">&#9654;</div>
          <span class="type-label">professormesser.com</span>
        </div>
        <div class="video-card-body">
          <h4>Certificates &mdash; Security+ (1.4)</h4>
          <p>Professor Messer &mdash; Digital certificates, CSRs, X.509 format, OCSP stapling, key revocation, and certificate formats.</p>
          <span class="video-link">Watch Free Video &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.professormesser.com/security-plus/sy0-701/sy0-701-video/encrypting-data-sy0-701/" target="_blank" rel="noopener noreferrer" aria-label="Watch Encrypting Data lesson by Professor Messer (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge">Video Lesson</span>
          <div class="play-icon" aria-hidden="true">&#9654;</div>
          <span class="type-label">professormesser.com</span>
        </div>
        <div class="video-card-body">
          <h4>Encrypting Data &mdash; Security+ (1.4)</h4>
          <p>Professor Messer &mdash; Database encryption, transport encryption, cryptographic keys, and data protection methods.</p>
          <span class="video-link">Watch Free Video &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.professormesser.com/security-plus/sy0-701/sy0-701-video/key-exchange-sy0-701/" target="_blank" rel="noopener noreferrer" aria-label="Watch Key Exchange lesson by Professor Messer (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge">Video Lesson</span>
          <div class="play-icon" aria-hidden="true">&#9654;</div>
          <span class="type-label">professormesser.com</span>
        </div>
        <div class="video-card-body">
          <h4>Key Exchange &mdash; Security+ (1.4)</h4>
          <p>Professor Messer &mdash; How symmetric keys can be derived from a public/private key pair using Diffie-Hellman and other key exchange methods.</p>
          <span class="video-link">Watch Free Video &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.infosecinstitute.com/resources/securityplus/security-implementing-a-public-key-infrastructure/" target="_blank" rel="noopener noreferrer" aria-label="Read Infosec Institute PKI implementation article (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge article">Article</span>
          <div class="play-icon" aria-hidden="true">&#128196;</div>
          <span class="type-label">infosecinstitute.com</span>
        </div>
        <div class="video-card-body">
          <h4>Implementing PKI &mdash; Security+ Deep Dive</h4>
          <p>Infosec Institute &mdash; Detailed walkthrough of PKI components, OCSP stapling, certificate pinning, and trust models for the exam.</p>
          <span class="video-link">Read Article &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://csrc.nist.gov/projects/post-quantum-cryptography" target="_blank" rel="noopener noreferrer" aria-label="Visit NIST Post-Quantum Cryptography project page (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge reference">Reference</span>
          <div class="play-icon" aria-hidden="true">&#127891;</div>
          <span class="type-label">csrc.nist.gov</span>
        </div>
        <div class="video-card-body">
          <h4>Post-Quantum Cryptography &mdash; NIST Standards 2024</h4>
          <p>NIST CSRC &mdash; Official PQC Standardization project with ML-KEM (FIPS 203), ML-DSA (FIPS 204), and SLH-DSA (FIPS 205).</p>
          <span class="video-link">Visit NIST &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://tls13.xargs.org/" target="_blank" rel="noopener noreferrer" aria-label="Read The Illustrated TLS 1.3 Connection (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge reference">Interactive</span>
          <div class="play-icon" aria-hidden="true">&#128274;</div>
          <span class="type-label">tls13.xargs.org</span>
        </div>
        <div class="video-card-body">
          <h4>The Illustrated TLS 1.3 Connection</h4>
          <p>Every byte of a TLS 1.3 connection explained and reproduced &mdash; interactive walkthrough of the full handshake process.</p>
          <span class="video-link">Explore Interactive Guide &#8599;</span>
        </div>
      </a>
      <a class="video-card" href="https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/" target="_blank" rel="noopener noreferrer" aria-label="Read Cloudflare TLS handshake article (opens in new tab)">
        <div class="video-thumb">
          <span class="source-badge article">Article</span>
          <div class="play-icon" aria-hidden="true">&#9729;</div>
          <span class="type-label">cloudflare.com/learning</span>
        </div>
        <div class="video-card-body">
          <h4>TLS Handshake Explained</h4>
          <p>Cloudflare Learning Center &mdash; Visual explanation of TLS 1.2 vs 1.3 handshakes, cipher suites, and post-quantum integration.</p>
          <span class="video-link">Read Article &#8599;</span>
        </div>
      </a>
    </div>

    <h3>Study References</h3>
    <div class="card-grid">
      <div class="info-card">
        <h4>CompTIA Security+ SY0-701 Exam Objectives</h4>
        <p>Download the official exam objectives covering all five domains.</p>
        <a href="https://www.comptia.org/certifications/security" target="_blank" rel="noopener noreferrer" style="color:var(--teal); font-weight:700; font-size:.85rem;">CompTIA Official Site &#8599;</a>
      </div>
      <div class="info-card">
        <h4>NIST SP 800-57 — Key Management</h4>
        <p>Best practices for cryptographic key management — key lengths, cryptoperiods, and lifecycle.</p>
        <a href="https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final" target="_blank" rel="noopener noreferrer" style="color:var(--teal); font-weight:700; font-size:.85rem;">NIST Publication &#8599;</a>
      </div>
      <div class="info-card">
        <h4>RFC 8446 — TLS 1.3 Specification</h4>
        <p>The complete technical specification for Transport Layer Security version 1.3.</p>
        <a href="https://www.rfc-editor.org/rfc/rfc8446" target="_blank" rel="noopener noreferrer" style="color:var(--teal); font-weight:700; font-size:.85rem;">Read RFC &#8599;</a>
      </div>
      <div class="info-card">
        <h4>OWASP Cryptographic Best Practices</h4>
        <p>Practical guidance on selecting algorithms, key sizes, and avoiding common cryptographic mistakes.</p>
        <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer" style="color:var(--teal); font-weight:700; font-size:.85rem;">OWASP Cheat Sheet &#8599;</a>
      </div>
    </div>

    <div style="text-align:center; margin-top:32px; padding:24px; background:var(--section-bg); border-radius:var(--radius);">
      <h3 style="border:none; margin-top:0;">Lesson Complete!</h3>
      <p>Review any sections as needed, practice with the flashcards and quiz, and explore the additional resources above.</p>
      <button class="btn btn-primary" onclick="goToSection(0)" style="margin-top:12px;">&#8592; Return to Overview</button>
    </div>
  </div>
</section>

</main>

<!-- ===== FOOTER ===== -->
<footer style="background:var(--navy-dark); color:rgba(255,255,255,.6); text-align:center; padding:20px; font-size:.78rem; margin-top:32px;">
  <p>Interactive Security Lesson &bull; Advanced Cryptography &amp; PKI &bull; Aligned with CompTIA Security+ SY0-701</p>
  <p style="margin-top:4px;">Designed for accessibility (WCAG 2.1 AA) &bull; Use keyboard navigation: Tab, Enter, and arrow keys</p>
</footer>

<!-- ===== JAVASCRIPT ===== -->
<script>
/* ========== YOUTUBE CLICK-TO-PLAY (dual-mode) ========== */
var ytCanEmbed = (window.location.protocol === 'http:' || window.location.protocol === 'https:');

/* On load — set label text and show tip if local file */
(function initYTMode() {
  var label = document.getElementById('ytModeText');
  var tip   = document.getElementById('ytLocalTip');
  if (ytCanEmbed) {
    label.textContent = 'Click any video to play it directly on this page';
  } else {
    label.textContent = 'Click any video to watch it on YouTube (opens new tab)';
    if (tip) tip.style.display = 'block';
    /* add external-link badges to each facade */
    document.querySelectorAll('.yt-facade').forEach(function(btn) {
      var badge = document.createElement('span');
      badge.className = 'yt-ext-badge';
      badge.textContent = 'Opens on YouTube \u2197';
      btn.appendChild(badge);
    });
  }
})();

function loadYT(btn, videoId) {
  if (ytCanEmbed) {
    /* HTTP/HTTPS — load iframe inline */
    var wrap = btn.parentElement;
    var iframe = document.createElement('iframe');
    iframe.setAttribute('src', 'https://www.youtube.com/embed/' + videoId + '?autoplay=1&rel=0');
    iframe.setAttribute('title', btn.getAttribute('aria-label'));
    iframe.setAttribute('frameborder', '0');
    iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
    iframe.setAttribute('allowfullscreen', '');
    iframe.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;border:0;';
    wrap.innerHTML = '';
    wrap.appendChild(iframe);
  } else {
    /* file:// — open on YouTube in new tab */
    window.open('https://www.youtube.com/watch?v=' + videoId, '_blank', 'noopener,noreferrer');
  }
}
/* ========== NAVIGATION & PROGRESS ========== */
const sections = document.querySelectorAll('.lesson-section');
const navBtns = document.querySelectorAll('.nav-btn');
const totalSections = sections.length;
let visitedSections = new Set([0]);

function goToSection(idx) {
  sections.forEach(s => s.classList.remove('active'));
  navBtns.forEach(b => { b.classList.remove('active'); b.removeAttribute('aria-current'); });
  sections[idx].classList.add('active');
  navBtns[idx].classList.add('active');
  navBtns[idx].setAttribute('aria-current', 'true');
  visitedSections.add(idx);
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
  // Mark as completed
  if (idx > 0) navBtns[idx-1] && navBtns[idx-1].classList.add('completed');
}

navBtns.forEach(btn => {
  btn.addEventListener('click', () => goToSection(parseInt(btn.dataset.section)));
});

function updateProgress() {
  const pct = Math.round((visitedSections.size / totalSections) * 100);
  document.getElementById('progressBarInner').style.width = pct + '%';
  document.getElementById('progressPct').textContent = pct + '%';
  const bar = document.querySelector('.progress-bar-outer');
  bar.setAttribute('aria-valuenow', pct);
}

/* ========== ACCORDION ========== */
function toggleAccordion(header) {
  const item = header.parentElement;
  const wasOpen = item.classList.contains('open');
  // Close siblings
  item.parentElement.querySelectorAll('.accordion-item').forEach(i => i.classList.remove('open'));
  if (!wasOpen) item.classList.add('open');
  header.setAttribute('aria-expanded', !wasOpen);
}

/* ========== SUB-TABS ========== */
document.querySelectorAll('.sub-tab-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const parent = this.closest('.section-body');
    parent.querySelectorAll('.sub-tab-btn').forEach(b => { b.classList.remove('active'); b.setAttribute('aria-selected', 'false'); });
    parent.querySelectorAll('.sub-tab-content').forEach(c => c.classList.remove('active'));
    this.classList.add('active');
    this.setAttribute('aria-selected', 'true');
    document.getElementById(this.dataset.target).classList.add('active');
  });
});

/* ========== PKI NODE DETAIL ========== */
function showNodeDetail(node, text) {
  const detail = document.getElementById('nodeDetail');
  detail.textContent = text;
  detail.classList.add('visible');
  // Remove highlighting from all nodes
  document.querySelectorAll('.pki-node').forEach(n => n.style.boxShadow = '');
  node.style.boxShadow = '0 0 20px rgba(204,153,0,.6)';
}

/* ========== LIFECYCLE ========== */
const lifecycleData = [
  { title: 'Creation', desc: 'A Certificate Signing Request (CSR) is generated by the entity. The CSR contains the public key and identity information. A key pair (public/private) is generated using a cryptographically secure algorithm.' },
  { title: 'Issuance', desc: 'The CA verifies the identity of the requester (via the RA), validates the CSR, and issues a signed digital certificate. The certificate is digitally signed with the CA\'s private key.' },
  { title: 'Usage', desc: 'The certificate is deployed to servers, applications, or users. It is used for encryption, authentication, and digital signatures. Clients validate the certificate by checking the chain of trust, validity dates, and revocation status.' },
  { title: 'Renewal', desc: 'Before a certificate expires, it must be renewed. This may involve generating a new CSR or simply extending the validity period. Automated Certificate Management Environment (ACME) protocols (like Let\'s Encrypt) can automate this process.' },
  { title: 'Revocation', desc: 'If a private key is compromised, or the certificate is no longer needed, it must be revoked. The CA adds the certificate serial number to a Certificate Revocation List (CRL). Real-time checking is available via OCSP (Online Certificate Status Protocol). OCSP stapling embeds the status in the TLS handshake for efficiency.' },
  { title: 'Expiration', desc: 'All certificates have a validity period. Once expired, they are no longer trusted. Modern best practice is shorter lifetimes (90 days for web certificates, as promoted by Let\'s Encrypt and Google\'s push toward 90-day certificates). This limits exposure from compromised keys.' }
];

function showLifecycle(idx) {
  const circles = document.querySelectorAll('.lifecycle-circle');
  circles.forEach(c => c.classList.remove('active'));
  circles[idx].classList.add('active');
  const detail = document.getElementById('lifecycleDetail');
  detail.innerHTML = '<strong>' + lifecycleData[idx].title + ':</strong> ' + lifecycleData[idx].desc;
  detail.classList.add('visible');
}

/* ========== HASH GENERATOR ========== */
async function computeHash() {
  const input = document.getElementById('hashInput').value;
  const algo = document.getElementById('hashAlgo').value;
  if (!input) { document.getElementById('hashOutput').textContent = 'Enter text above...'; return; }
  try {
    const encoder = new TextEncoder();
    const data = encoder.encode(input);
    const hashBuffer = await crypto.subtle.digest(algo, data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    document.getElementById('hashOutput').textContent = hashHex;
  } catch(e) {
    document.getElementById('hashOutput').textContent = 'Error: ' + e.message;
  }
}
// Init hash on load
setTimeout(computeHash, 200);

/* ========== SYMMETRIC ENCRYPTION SIMULATOR ========== */
let encryptedData = null;
let encIV = null;

async function getKeyFromPassword(password) {
  const enc = new TextEncoder();
  const keyMaterial = await crypto.subtle.importKey('raw', enc.encode(password), 'PBKDF2', false, ['deriveKey']);
  return crypto.subtle.deriveKey(
    { name: 'PBKDF2', salt: enc.encode('SecurityPlusSalt'), iterations: 100000, hash: 'SHA-256' },
    keyMaterial, { name: 'AES-GCM', length: 256 }, false, ['encrypt', 'decrypt']
  );
}

async function symEncrypt() {
  const plain = document.getElementById('symPlain').value;
  const key = document.getElementById('symKey').value;
  if (!plain || !key) { document.getElementById('symOutput').textContent = 'Please enter both plaintext and key.'; return; }
  try {
    const cryptoKey = await getKeyFromPassword(key);
    encIV = crypto.getRandomValues(new Uint8Array(12));
    const enc = new TextEncoder();
    encryptedData = await crypto.subtle.encrypt({ name: 'AES-GCM', iv: encIV }, cryptoKey, enc.encode(plain));
    const arr = Array.from(new Uint8Array(encryptedData));
    document.getElementById('symOutput').textContent = btoa(String.fromCharCode(...arr));
    document.getElementById('symDecOutput').textContent = 'Click Decrypt to reveal original message...';
  } catch(e) {
    document.getElementById('symOutput').textContent = 'Error: ' + e.message;
  }
}

async function symDecrypt() {
  if (!encryptedData) { document.getElementById('symDecOutput').textContent = 'Encrypt a message first!'; return; }
  const key = document.getElementById('symKey').value;
  try {
    const cryptoKey = await getKeyFromPassword(key);
    const dec = await crypto.subtle.decrypt({ name: 'AES-GCM', iv: encIV }, cryptoKey, encryptedData);
    const text = new TextDecoder().decode(dec);
    document.getElementById('symDecOutput').textContent = '✓ Decrypted: ' + text;
    document.getElementById('symDecOutput').style.color = '#66ff66';
  } catch(e) {
    document.getElementById('symDecOutput').textContent = '✗ Decryption failed — wrong key or corrupted data';
    document.getElementById('symDecOutput').style.color = '#ff6666';
  }
}

/* ========== CHAIN VALIDATOR ========== */
const chainData = [
  'The browser connects to the web server via HTTPS. The server sends its digital certificate containing: the server\'s public key, the server\'s domain name (CN/SAN), the issuer (Intermediate CA), a serial number, validity dates, and the CA\'s digital signature.',
  'The browser checks the server certificate\'s signature using the Intermediate CA\'s public key (found in the intermediate certificate also sent by the server). If the signature is valid, the browser knows the certificate was issued by that Intermediate CA and has not been tampered with.',
  'The browser follows the chain upward — it checks the Intermediate CA\'s certificate against the Root CA\'s public key. The Root CA certificate is pre-installed in the browser\'s or operating system\'s trust store. If the chain validates all the way to a trusted root, the chain of trust is established.',
  'The browser checks if the certificate has been revoked by querying the CRL Distribution Point URL or using OCSP. With OCSP stapling, the server provides a time-stamped, CA-signed OCSP response during the TLS handshake — faster and more private. If revoked, the connection is rejected.',
  'With the certificate validated, the TLS 1.3 handshake completes: ephemeral keys are exchanged via ECDHE, a shared session key is derived, and all subsequent communication is encrypted with AES-GCM or ChaCha20-Poly1305. Perfect Forward Secrecy ensures past sessions cannot be decrypted even if the server\'s private key is later compromised.'
];

function showChainStep(idx) {
  const el = document.getElementById('chainDetail' + idx);
  if (el.style.display === 'block') { el.style.display = 'none'; return; }
  el.textContent = chainData[idx];
  el.style.display = 'block';
}

/* ========== FLASHCARDS ========== */
let flashcards = [
  { term: 'Public Key Infrastructure (PKI)', def: 'A framework of hardware, software, people, policies, and procedures used to create, manage, distribute, store, and revoke digital certificates.' },
  { term: 'Certificate Authority (CA)', def: 'A trusted third-party organization that issues, signs, and manages digital certificates to verify identities on a network.' },
  { term: 'Certificate Revocation List (CRL)', def: 'A list of digital certificates that have been revoked by the CA before their scheduled expiration date.' },
  { term: 'OCSP Stapling', def: 'A method where the server obtains a time-stamped OCSP response from the CA and includes it in the TLS handshake, eliminating the need for the client to query the CA directly.' },
  { term: 'X.509', def: 'The international standard defining the format of public key certificates used in PKI, including fields for subject, issuer, validity, public key, and extensions.' },
  { term: 'Certificate Signing Request (CSR)', def: 'A message sent from an applicant to a CA to apply for a digital certificate. Contains the applicant\'s public key and identity information.' },
  { term: 'TLS 1.3', def: 'The latest version of Transport Layer Security (RFC 8446). Features 1-RTT handshake, mandatory Perfect Forward Secrecy, and AEAD-only cipher suites.' },
  { term: 'Perfect Forward Secrecy (PFS)', def: 'A property ensuring that session keys cannot be compromised even if the server\'s long-term private key is compromised. Achieved through ephemeral Diffie-Hellman key exchange.' },
  { term: 'AES-GCM', def: 'Advanced Encryption Standard in Galois/Counter Mode — an authenticated encryption algorithm that provides both confidentiality and integrity. The preferred cipher for TLS 1.3.' },
  { term: 'Initialization Vector (IV)', def: 'A random or non-predictable input value used to ensure that the same plaintext encrypts to different ciphertext each time. A type of nonce.' },
  { term: 'Salt', def: 'A random value added to input before hashing to prevent identical plaintexts from producing the same hash. Critical for password storage to prevent rainbow table attacks.' },
  { term: 'Key Stretching', def: 'A technique that makes weak keys stronger by running them through a computationally intensive function (e.g., PBKDF2, bcrypt, Argon2) to slow brute-force attacks.' },
  { term: 'IPsec', def: 'A suite of protocols providing authentication, integrity, and encryption at the network layer. Supports Transport mode (payload only) and Tunnel mode (entire packet). Used for VPNs.' },
  { term: 'Asymmetric Encryption', def: 'A cryptographic system using a key pair (public and private). The public key encrypts; only the corresponding private key can decrypt. Used for key exchange and digital signatures.' },
  { term: 'Digital Signature', def: 'A cryptographic hash of a message encrypted with the sender\'s private key. Provides authentication, integrity, and non-repudiation.' },
  { term: 'Wildcard Certificate', def: 'A digital certificate that secures a domain and all its subdomains (e.g., *.example.com) with a single certificate.' },
  { term: 'Post-Quantum Cryptography (PQC)', def: 'Cryptographic algorithms designed to be secure against attacks by quantum computers. NIST published standards ML-KEM, ML-DSA, and SLH-DSA in 2024.' },
  { term: 'Key Escrow', def: 'A practice where a copy of a cryptographic key is held by a trusted third party for recovery purposes. Raises concerns about potential misuse or compromise.' },
  { term: 'M-of-N Control', def: 'A key recovery method requiring M of N total key holders to participate in order to recover or use a key. Prevents any single person from accessing the key alone.' },
  { term: 'Cipher Suite', def: 'A named combination of encryption, authentication, key exchange, and MAC algorithms used in TLS/SSL. Example: TLS_AES_256_GCM_SHA384.' }
];

let fcIndex = 0;

function renderCard() {
  document.getElementById('fcTerm').textContent = flashcards[fcIndex].term;
  document.getElementById('fcDef').textContent = flashcards[fcIndex].def;
  document.getElementById('fcCounter').textContent = (fcIndex + 1) + ' / ' + flashcards.length;
  document.getElementById('flashcard').classList.remove('flipped');
}

function flipCard() { document.getElementById('flashcard').classList.toggle('flipped'); }
function nextCard() { fcIndex = (fcIndex + 1) % flashcards.length; renderCard(); }
function prevCard() { fcIndex = (fcIndex - 1 + flashcards.length) % flashcards.length; renderCard(); }
function shuffleCards() {
  for (let i = flashcards.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
  }
  fcIndex = 0; renderCard();
}

// Keyboard support for flashcard
document.addEventListener('DOMContentLoaded', () => {
  renderCard();
  document.getElementById('flashcard').addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); flipCard(); }
  });
});

/* ========== QUIZ ========== */
const quizData = [
  { q: 'Which block cipher mode provides authenticated encryption and is exclusively used by TLS 1.3?', opts: ['ECB (Electronic Code Book)', 'CBC (Cipher Block Chaining)', 'GCM (Galois/Counter Mode)', 'CTR (Counter Mode)'], ans: 2, exp: 'GCM provides both confidentiality and integrity (AEAD). TLS 1.3 only uses AEAD cipher suites like AES-GCM and ChaCha20-Poly1305.' },
  { q: 'What is the primary purpose of a salt in cryptography?', opts: ['To encrypt data at rest', 'To ensure identical plaintexts produce different hashes', 'To authenticate the sender of a message', 'To establish a secure tunnel between two endpoints'], ans: 1, exp: 'A salt is a random value added before hashing to prevent identical inputs from producing the same digest, defeating rainbow table attacks.' },
  { q: 'Which PKI trust model uses a single master CA at the top that signs all subordinate CAs?', opts: ['Web of Trust', 'Distributed Trust Model', 'Hierarchical Trust Model', 'Bridge Trust Model'], ans: 2, exp: 'The hierarchical model has one root CA at the top that signs intermediate CAs, which then sign end-entity certificates, creating a clear chain of trust.' },
  { q: 'What feature of TLS 1.3 ensures that past encrypted sessions cannot be decrypted even if the server private key is compromised?', opts: ['Certificate Pinning', 'OCSP Stapling', 'Perfect Forward Secrecy (PFS)', 'Key Escrow'], ans: 2, exp: 'PFS uses ephemeral Diffie-Hellman (ECDHE) to generate unique session keys. Even if the long-term key is compromised, past sessions remain secure.' },
  { q: 'Which certificate format stores both the certificate and the private key in a single password-protected binary file?', opts: ['PEM (.pem)', 'DER (.der)', 'P7B/PKCS#7 (.p7b)', 'PFX/PKCS#12 (.pfx)'], ans: 3, exp: 'PFX (PKCS#12) stores the certificate, private key, and chain in one password-protected binary file, commonly used for importing/exporting certificates.' },
  { q: 'What does OCSP stapling accomplish?', opts: ['It pins a certificate to a specific server', 'It attaches the certificate revocation status to the TLS handshake', 'It encrypts the certificate before transmission', 'It signs the certificate with a timestamp authority'], ans: 1, exp: 'OCSP stapling embeds a CA-signed revocation status response into the TLS handshake, so clients do not need to contact the CA separately for revocation checks.' },
  { q: 'Which IPsec mode encrypts the entire original IP packet, including the header, and is commonly used for VPN tunnels?', opts: ['Transport mode', 'Tunnel mode', 'Authentication mode', 'Encapsulation mode'], ans: 1, exp: 'Tunnel mode encrypts both the header and payload of the original packet, wrapping it in a new IP header. This is the standard mode for site-to-site VPNs.' },
  { q: 'Which NIST post-quantum standard provides key encapsulation for key exchange?', opts: ['ML-DSA (FIPS 204)', 'SLH-DSA (FIPS 205)', 'ML-KEM (FIPS 203)', 'AES-256-GCM'], ans: 2, exp: 'ML-KEM (Module Lattice-based Key Encapsulation Mechanism, FIPS 203) is based on CRYSTALS-Kyber and provides quantum-resistant key exchange.' },
  { q: 'An attacker records encrypted traffic now, planning to decrypt it once quantum computers are available. What is this attack called?', opts: ['Birthday attack', 'Harvest Now, Decrypt Later', 'Replay attack', 'Side-channel attack'], ans: 1, exp: '"Harvest Now, Decrypt Later" describes the threat of adversaries storing encrypted data now to decrypt once quantum computers can break current asymmetric algorithms.' },
  { q: 'In M-of-N control for key recovery, what does the requirement that 3-of-5 key holders must participate ensure?', opts: ['Keys are backed up to five locations', 'Any single person can recover the key quickly', 'No single individual can access the key alone', 'The key is split into three separate keys'], ans: 2, exp: 'M-of-N control (split knowledge) requires multiple participants to recover a key, preventing any single person from having sole access and reducing insider threat risk.' }
];

function buildQuiz() {
  const container = document.getElementById('quizContainer');
  container.innerHTML = '';
  quizData.forEach((item, i) => {
    let optionsHtml = '';
    item.opts.forEach((opt, j) => {
      optionsHtml += `<label class="quiz-option" id="qopt-${i}-${j}">
        <input type="radio" name="q${i}" value="${j}" aria-label="${opt}"> ${opt}
      </label>`;
    });
    container.innerHTML += `<div class="quiz-question" id="qq-${i}">
      <div class="q-text"><span class="q-number">${i+1}</span>${item.q}</div>
      ${optionsHtml}
      <div class="quiz-feedback" id="qfb-${i}"></div>
    </div>`;
  });
  // Add click handlers for option selection visual feedback
  container.querySelectorAll('.quiz-option').forEach(opt => {
    opt.addEventListener('click', function() {
      const name = this.querySelector('input').name;
      container.querySelectorAll(`[name="${name}"]`).forEach(r => r.closest('.quiz-option').classList.remove('selected'));
      this.classList.add('selected');
      this.querySelector('input').checked = true;
    });
  });
}

function submitQuiz() {
  let score = 0;
  quizData.forEach((item, i) => {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    const question = document.getElementById('qq-' + i);
    const feedback = document.getElementById('qfb-' + i);
    if (selected) {
      const val = parseInt(selected.value);
      if (val === item.ans) {
        score++;
        question.classList.add('correct');
        document.getElementById(`qopt-${i}-${val}`).classList.add('right');
        feedback.className = 'quiz-feedback show correct-fb';
        feedback.textContent = '✓ Correct! ' + item.exp;
      } else {
        question.classList.add('incorrect');
        document.getElementById(`qopt-${i}-${val}`).classList.add('wrong');
        document.getElementById(`qopt-${i}-${item.ans}`).classList.add('right');
        feedback.className = 'quiz-feedback show incorrect-fb';
        feedback.textContent = '✗ Incorrect. ' + item.exp;
      }
    } else {
      question.classList.add('incorrect');
      document.getElementById(`qopt-${i}-${item.ans}`).classList.add('right');
      feedback.className = 'quiz-feedback show incorrect-fb';
      feedback.textContent = '✗ Not answered. ' + item.exp;
    }
  });
  // Disable inputs
  document.querySelectorAll('.quiz-option input').forEach(i => i.disabled = true);
  document.getElementById('submitQuizBtn').style.display = 'none';
  document.getElementById('resetQuizBtn').style.display = 'inline-flex';

  const scoreEl = document.getElementById('quizScore');
  scoreEl.style.display = 'block';
  document.getElementById('scoreNum').textContent = score + ' / ' + quizData.length;
  const pct = Math.round((score / quizData.length) * 100);
  let msg = pct >= 80 ? 'Excellent work! You have a strong grasp of cryptography and PKI concepts.' :
            pct >= 60 ? 'Good effort! Review the sections where you missed questions.' :
            'Keep studying! Focus on the areas covered by the questions you missed.';
  document.getElementById('scoreLabel').textContent = pct + '% — ' + msg;
  scoreEl.scrollIntoView({ behavior: 'smooth' });
}

function resetQuiz() {
  document.querySelectorAll('.quiz-question').forEach(q => { q.classList.remove('correct', 'incorrect'); });
  document.querySelectorAll('.quiz-option').forEach(o => { o.classList.remove('selected', 'right', 'wrong'); });
  document.querySelectorAll('.quiz-option input').forEach(i => { i.disabled = false; i.checked = false; });
  document.querySelectorAll('.quiz-feedback').forEach(f => { f.className = 'quiz-feedback'; f.textContent = ''; });
  document.getElementById('quizScore').style.display = 'none';
  document.getElementById('submitQuizBtn').style.display = 'inline-flex';
  document.getElementById('resetQuizBtn').style.display = 'none';
}

// Build quiz on load
document.addEventListener('DOMContentLoaded', buildQuiz);

/* ========== SCREEN READER ONLY TEXT ========== */
// Add sr-only class
const style = document.createElement('style');
style.textContent = '.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}';
document.head.appendChild(style);
</script>
</body>
</html>
