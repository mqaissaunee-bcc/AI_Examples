<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Interactive Trigonometry Learning Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .keyboard-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.9em;
            cursor: pointer;
        }

        .keyboard-hint:hover {
            background: rgba(255,255,255,0.3);
        }

        .tab-navigation {
            display: flex;
            flex-wrap: wrap;
            background: #f7fafc;
            border-bottom: 3px solid #e2e8f0;
            padding: 10px;
            gap: 10px;
            justify-content: center;
        }

        .tab-btn {
            padding: 15px 25px;
            background: white;
            border: 2px solid #cbd5e0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #4a5568;
        }

        .tab-btn:hover {
            background: #edf2f7;
            border-color: #5a67d8;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            color: white;
            border-color: #5a67d8;
        }

        .content-area {
            padding: 30px;
            min-height: 500px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .formula-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border: 2px solid #cbd5e0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .formula-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: #5a67d8;
        }

        .formula-card h3 {
            color: #5a67d8;
            font-size: 1.5em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #cbd5e0;
        }

        .formula {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-size: 1.2em;
            text-align: center;
            border-left: 4px solid #5a67d8;
            font-family: 'Courier New', monospace;
        }

        .explanation {
            background: #fff5e6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #f6ad55;
            font-size: 1em;
            line-height: 1.6;
        }

        .unit-circle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        #unitCircle {
            border: 2px solid #cbd5e0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            background: white;
        }

        .angle-selector {
            margin: 20px 0;
            width: 100%;
            max-width: 600px;
        }

        .angle-selector input {
            width: 100%;
            height: 50px;
            cursor: pointer;
        }

        .angle-display {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3em;
            border: 2px solid #cbd5e0;
        }

        .practice-section {
            background: #f7fafc;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .question {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #cbd5e0;
        }

        .question h4 {
            color: #5a67d8;
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .option-btn {
            padding: 15px;
            background: white;
            border: 2px solid #cbd5e0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            background: #edf2f7;
            border-color: #5a67d8;
            transform: scale(1.05);
        }

        .option-btn.correct {
            background: #c6f6d5;
            border-color: #48bb78;
        }

        .option-btn.incorrect {
            background: #fed7d7;
            border-color: #f56565;
        }

        .feedback {
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            text-align: center;
        }

        .feedback.correct {
            background: #c6f6d5;
            color: #22543d;
        }

        .feedback.incorrect {
            background: #fed7d7;
            color: #742a2a;
        }

        .next-btn {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 20px auto;
            display: block;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(90, 103, 216, 0.4);
        }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #cbd5e0;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .search-box:focus {
            outline: none;
            border-color: #5a67d8;
            box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.1);
        }

        .visualization {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #cbd5e0;
        }

        .interactive-demo {
            text-align: center;
            padding: 20px;
        }

        #demoCanvas {
            border: 2px solid #cbd5e0;
            border-radius: 10px;
            background: white;
            margin: 20px auto;
            display: block;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #4a5568;
        }

        .slider {
            width: 200px;
            height: 40px;
        }

        .score-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 2px solid #5a67d8;
            z-index: 1000;
        }

        .score-display h3 {
            color: #5a67d8;
            margin-bottom: 10px;
        }

        /* Interactive Explorer Styles */
        .explorer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .input-panel {
            background: #f7fafc;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #cbd5e0;
        }

        .input-panel h3 {
            color: #5a67d8;
            margin-bottom: 15px;
        }

        .input-field {
            margin: 15px 0;
        }

        .input-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4a5568;
        }

        .input-field input {
            width: 100%;
            padding: 10px;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .input-field input:focus {
            outline: none;
            border-color: #5a67d8;
        }

        .result-panel {
            background: white;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #5a67d8;
        }

        .result-panel h3 {
            color: #5a67d8;
            margin-bottom: 15px;
        }

        .result-item {
            background: #f7fafc;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-label {
            font-weight: 600;
            color: #4a5568;
        }

        .result-value {
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
            color: #5a67d8;
        }

        /* Problem Solver Styles */
        .problem-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .problem-btn {
            padding: 12px 20px;
            background: white;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .problem-btn.active {
            background: #5a67d8;
            color: white;
            border-color: #5a67d8;
        }

        .problem-btn:hover {
            border-color: #5a67d8;
            transform: translateY(-2px);
        }

        .problem-workspace {
            background: #f7fafc;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .step-container {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 4px solid #5a67d8;
        }

        .step-title {
            font-weight: 700;
            color: #5a67d8;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .calculator-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #cbd5e0;
            margin: 20px 0;
        }

        /* Common Mistakes Styles */
        .mistake-card {
            background: #fff5f5;
            border: 2px solid #fc8181;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .mistake-card h4 {
            color: #c53030;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .wrong-answer {
            background: #fed7d7;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
        }

        .correct-answer {
            background: #c6f6d5;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
        }

        .why-wrong {
            background: #fff5e6;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #f6ad55;
        }

        .tip-box {
            background: #e6f7ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .tip-box strong {
            color: #0066cc;
        }

        .highlight-term {
            background: #fef5e7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            color: #d68910;
        }

        .greek {
            font-family: 'Times New Roman', 'Georgia', 'Cambria Math', 'DejaVu Serif', serif;
            font-style: italic;
            font-weight: normal;
        }

        /* Animation styles */
        .derivation-step {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 2px solid #cbd5e0;
            opacity: 0;
            animation: slideIn 0.5s ease forwards;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-side {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #cbd5e0;
        }

        .comparison-side h4 {
            color: #5a67d8;
            margin-bottom: 15px;
            text-align: center;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .tab-btn {
                padding: 10px 15px;
                font-size: 1em;
            }

            .formula-grid, .explorer-grid, .comparison-container {
                grid-template-columns: 1fr;
            }

            .content-area {
                padding: 15px;
            }

            .score-display {
                position: static;
                margin: 20px auto;
                max-width: 300px;
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
            }
            
            .tab-navigation, .score-display, button, .keyboard-hint {
                display: none !important;
            }
            
            .tab-content {
                display: block !important;
            }
            
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>📐 Enhanced Interactive Trigonometry Learning Center</h1>
            <p>Master trigonometry with interactive lessons, practice, and visual learning</p>
            <div class="keyboard-hint" onclick="showKeyboardShortcuts()">⌨️ Keyboard Shortcuts</div>
        </header>

        <div class="tab-navigation">
            <button class="tab-btn active" onclick="showTab('formulas')" data-key="1">📚 Formulas</button>
            <button class="tab-btn" onclick="showTab('explorer')" data-key="2">🔍 Formula Explorer</button>
            <button class="tab-btn" onclick="showTab('circle')" data-key="3">⭕ Unit Circle</button>
            <button class="tab-btn" onclick="showTab('practice')" data-key="4">✏️ Practice</button>
            <button class="tab-btn" onclick="showTab('solver')" data-key="5">🧮 Problem Solver</button>
            <button class="tab-btn" onclick="showTab('visual')" data-key="6">👁️ Visualize</button>
            <button class="tab-btn" onclick="showTab('mistakes')" data-key="7">⚠️ Common Mistakes</button>
            <button class="tab-btn" onclick="showTab('applications')" data-key="8">🌍 Real World</button>
            <button class="tab-btn" onclick="showTab('reference')" data-key="9">📖 Reference</button>
        </div>

        <div class="content-area">
            <!-- FORMULAS TAB -->
            <div id="formulas" class="tab-content active">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Trigonometry Formulas</h2>
                <input type="text" class="search-box" id="formulaSearch" placeholder="🔍 Search formulas... (e.g., 'pythagorean', 'sine', 'double angle')" onkeyup="filterFormulas()">
                
                <div class="formula-grid" id="formulaGrid">
                    <!-- Fundamental Identities -->
                    <div class="formula-card" data-keywords="reciprocal basic fundamental">
                        <h3>🔄 Reciprocal Identities</h3>
                        <div class="explanation">These show how trig functions relate to their reciprocals.</div>
                        <div class="formula">sin θ = 1/csc θ</div>
                        <div class="formula">cos θ = 1/sec θ</div>
                        <div class="formula">tan θ = 1/cot θ</div>
                        <div class="formula">csc θ = 1/sin θ</div>
                        <div class="formula">sec θ = 1/cos θ</div>
                        <div class="formula">cot θ = 1/tan θ</div>
                        <div class="tip-box">
                            <strong>Memory Tip:</strong> Think "co-" means reciprocal. Secant is "co-sine", cosecant is "co-cosine"
                        </div>
                    </div>

                    <!-- Quotient Identities -->
                    <div class="formula-card" data-keywords="quotient tangent cotangent ratio">
                        <h3>➗ Quotient Identities</h3>
                        <div class="explanation">Express tangent and cotangent in terms of sine and cosine.</div>
                        <div class="formula">tan θ = sin θ / cos θ</div>
                        <div class="formula">cot θ = cos θ / sin θ</div>
                        <div class="tip-box">
                            <strong>Remember:</strong> Tangent = "sin over cos" (alphabetical order!)
                        </div>
                    </div>

                    <!-- Pythagorean Identities -->
                    <div class="formula-card" data-keywords="pythagorean pythagoras fundamental">
                        <h3>🔺 Pythagorean Identities</h3>
                        <div class="explanation">Derived from the Pythagorean theorem on the unit circle.</div>
                        <div class="formula">sin² θ + cos² θ = 1</div>
                        <div class="formula">tan² θ + 1 = sec² θ</div>
                        <div class="formula">1 + cot² θ = csc² θ</div>
                        <div class="tip-box">
                            <strong>Key Insight:</strong> The first identity is the most fundamental. The others follow by dividing by cos² θ or sin² θ.
                        </div>
                    </div>

                    <!-- Even-Odd Identities -->
                    <div class="formula-card" data-keywords="even odd negative angle opposite">
                        <h3>🔀 Even-Odd (Negative Angle) Identities</h3>
                        <div class="explanation">How functions behave with negative angles.</div>
                        <div class="formula">sin(-θ) = -sin θ (odd)</div>
                        <div class="formula">cos(-θ) = cos θ (even)</div>
                        <div class="formula">tan(-θ) = -tan θ (odd)</div>
                        <div class="formula">csc(-θ) = -csc θ (odd)</div>
                        <div class="formula">sec(-θ) = sec θ (even)</div>
                        <div class="formula">cot(-θ) = -cot θ (odd)</div>
                        <div class="tip-box">
                            <strong>Pattern:</strong> Only cosine and secant are even functions (symmetric about y-axis)
                        </div>
                    </div>

                    <!-- Cofunction Identities -->
                    <div class="formula-card" data-keywords="cofunction complementary">
                        <h3>🤝 Cofunction Identities</h3>
                        <div class="explanation">Functions of complementary angles (angles that add to 90°).</div>
                        <div class="formula">sin(<span class="greek">π</span>/2 - θ) = cos θ</div>
                        <div class="formula">cos(<span class="greek">π</span>/2 - θ) = sin θ</div>
                        <div class="formula">tan(<span class="greek">π</span>/2 - θ) = cot θ</div>
                        <div class="formula">cot(<span class="greek">π</span>/2 - θ) = tan θ</div>
                        <div class="formula">sec(<span class="greek">π</span>/2 - θ) = csc θ</div>
                        <div class="formula">csc(<span class="greek">π</span>/2 - θ) = sec θ</div>
                        <div class="tip-box">
                            <strong>Degrees Version:</strong> sin(90° - θ) = cos θ, etc.
                        </div>
                    </div>

                    <!-- Sum & Difference - Sine -->
                    <div class="formula-card" data-keywords="sum difference addition subtraction sine">
                        <h3>➕ Sum & Difference Formulas (Sine)</h3>
                        <div class="explanation">Find sine of angle sums and differences.</div>
                        <div class="formula">sin(A + B) = sin A cos B + cos A sin B</div>
                        <div class="formula">sin(A - B) = sin A cos B - cos A sin B</div>
                        <div class="tip-box">
                            <strong>Pattern:</strong> Always "sine cosine plus cosine sine" (for addition)
                        </div>
                    </div>

                    <!-- Sum & Difference - Cosine -->
                    <div class="formula-card" data-keywords="sum difference addition subtraction cosine">
                        <h3>➕ Sum & Difference Formulas (Cosine)</h3>
                        <div class="explanation">Find cosine of angle sums and differences.</div>
                        <div class="formula">cos(A + B) = cos A cos B - sin A sin B</div>
                        <div class="formula">cos(A - B) = cos A cos B + sin A sin B</div>
                        <div class="tip-box">
                            <strong>Note the Sign:</strong> Addition gets MINUS, subtraction gets PLUS (opposite of sine!)
                        </div>
                    </div>

                    <!-- Sum & Difference - Tangent -->
                    <div class="formula-card" data-keywords="sum difference addition subtraction tangent">
                        <h3>➕ Sum & Difference Formulas (Tangent)</h3>
                        <div class="explanation">Find tangent of angle sums and differences.</div>
                        <div class="formula">tan(A + B) = (tan A + tan B) / (1 - tan A tan B)</div>
                        <div class="formula">tan(A - B) = (tan A - tan B) / (1 + tan A tan B)</div>
                        <div class="tip-box">
                            <strong>Watch the Signs:</strong> The denominator sign is opposite of the numerator
                        </div>
                    </div>

                    <!-- Double Angle Formulas -->
                    <div class="formula-card" data-keywords="double angle 2theta">
                        <h3>✖️2 Double Angle Formulas</h3>
                        <div class="explanation">Express trigonometric functions of 2θ.</div>
                        <div class="formula">sin 2θ = 2 sin θ cos θ</div>
                        <div class="formula">cos 2θ = cos² θ - sin² θ</div>
                        <div class="formula">cos 2θ = 2cos² θ - 1</div>
                        <div class="formula">cos 2θ = 1 - 2sin² θ</div>
                        <div class="formula">tan 2θ = (2 tan θ) / (1 - tan² θ)</div>
                        <div class="tip-box">
                            <strong>Three Forms for Cosine:</strong> All three are equivalent! Choose based on what you have.
                        </div>
                    </div>

                    <!-- Half Angle Formulas -->
                    <div class="formula-card" data-keywords="half angle reduction">
                        <h3>➗2 Half Angle Formulas</h3>
                        <div class="explanation">Express functions of θ/2 in terms of θ.</div>
                        <div class="formula">sin(θ/2) = ± √[(1 - cos θ) / 2]</div>
                        <div class="formula">cos(θ/2) = ± √[(1 + cos θ) / 2]</div>
                        <div class="formula">tan(θ/2) = ± √[(1 - cos θ) / (1 + cos θ)]</div>
                        <div class="formula">tan(θ/2) = (1 - cos θ) / sin θ</div>
                        <div class="formula">tan(θ/2) = sin θ / (1 + cos θ)</div>
                        <div class="tip-box">
                            <strong>Sign Choice:</strong> The ± depends on which quadrant θ/2 is in
                        </div>
                    </div>

                    <!-- Power Reducing Formulas -->
                    <div class="formula-card" data-keywords="power reducing squared">
                        <h3>📉 Power Reducing Formulas</h3>
                        <div class="explanation">Reduce powers of trig functions (useful in integration).</div>
                        <div class="formula">sin² θ = (1 - cos 2θ) / 2</div>
                        <div class="formula">cos² θ = (1 + cos 2θ) / 2</div>
                        <div class="formula">tan² θ = (1 - cos 2θ) / (1 + cos 2θ)</div>
                        <div class="tip-box">
                            <strong>Derived From:</strong> Rearranging the double angle formula for cosine
                        </div>
                    </div>

                    <!-- Laws of Triangles -->
                    <div class="formula-card" data-keywords="law sines triangle">
                        <h3>📐 Law of Sines</h3>
                        <div class="explanation">Relates sides and angles in any triangle.</div>
                        <div class="formula">a/sin A = b/sin B = c/sin C</div>
                        <div class="formula">Alternative: sin A/a = sin B/b = sin C/c</div>
                        <div class="tip-box">
                            <strong>When to Use:</strong> When you know two angles and one side (AAS or ASA), or two sides and a non-included angle (SSA)
                        </div>
                    </div>

                    <div class="formula-card" data-keywords="law cosines triangle">
                        <h3>📐 Law of Cosines</h3>
                        <div class="explanation">Generalizes the Pythagorean theorem to all triangles.</div>
                        <div class="formula">a² = b² + c² - 2bc cos A</div>
                        <div class="formula">b² = a² + c² - 2ac cos B</div>
                        <div class="formula">c² = a² + b² - 2ab cos C</div>
                        <div class="tip-box">
                            <strong>When to Use:</strong> When you know three sides (SSS), or two sides and the included angle (SAS)
                        </div>
                    </div>
                </div>
            </div>

            <!-- FORMULA EXPLORER TAB -->
            <div id="explorer" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">🔍 Interactive Formula Explorer</h2>
                <p style="font-size: 1.1em; margin-bottom: 20px;">Enter angle values and see all trigonometric functions calculated in real-time!</p>
                
                <div class="explorer-grid">
                    <div class="input-panel">
                        <h3>Input Angle</h3>
                        <div class="input-field">
                            <label>Angle in Degrees:</label>
                            <input type="number" id="exploreDegrees" value="45" oninput="updateExplorer()">
                        </div>
                        <div class="input-field">
                            <label>Angle in Radians:</label>
                            <input type="number" id="exploreRadians" value="0.7854" step="0.0001" oninput="updateExplorerFromRadians()">
                        </div>
                        <div class="tip-box" style="margin-top: 20px;">
                            <strong>Quick Angles:</strong>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                                <button class="option-btn" style="margin: 0;" onclick="setExploreAngle(0)">0°</button>
                                <button class="option-btn" style="margin: 0;" onclick="setExploreAngle(30)">30°</button>
                                <button class="option-btn" style="margin: 0;" onclick="setExploreAngle(45)">45°</button>
                                <button class="option-btn" style="margin: 0;" onclick="setExploreAngle(60)">60°</button>
                                <button class="option-btn" style="margin: 0;" onclick="setExploreAngle(90)">90°</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>All Trigonometric Values</h3>
                        <div class="result-item">
                            <span class="result-label">sin θ =</span>
                            <span class="result-value" id="expSin">0.7071</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">cos θ =</span>
                            <span class="result-value" id="expCos">0.7071</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">tan θ =</span>
                            <span class="result-value" id="expTan">1.0000</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">csc θ =</span>
                            <span class="result-value" id="expCsc">1.4142</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">sec θ =</span>
                            <span class="result-value" id="expSec">1.4142</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">cot θ =</span>
                            <span class="result-value" id="expCot">1.0000</span>
                        </div>
                    </div>
                </div>

                <div class="visualization">
                    <h3>Identity Verification Tool</h3>
                    <p>Check if two expressions are equal for your chosen angle!</p>
                    <div class="explorer-grid" style="margin-top: 20px;">
                        <div class="input-field">
                            <label>Left Side (use: sin, cos, tan, Math.PI):</label>
                            <input type="text" id="leftSide" placeholder="sin(x)*sin(x) + cos(x)*cos(x)" value="Math.sin(x)*Math.sin(x) + Math.cos(x)*Math.cos(x)">
                        </div>
                        <div class="input-field">
                            <label>Right Side:</label>
                            <input type="text" id="rightSide" placeholder="1" value="1">
                        </div>
                    </div>
                    <button class="next-btn" onclick="verifyIdentity()">Verify Identity</button>
                    <div id="verifyResult" style="margin-top: 20px;"></div>
                </div>

                <div class="visualization">
                    <h3>📊 Formula Derivation: Double Angle</h3>
                    <p>Watch how sin(2θ) = 2sin(θ)cos(θ) is derived from sum formulas:</p>
                    <div id="derivationSteps"></div>
                    <button class="next-btn" onclick="showDerivation()">Show Derivation</button>
                </div>
            </div>

            <!-- UNIT CIRCLE TAB -->
            <div id="circle" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Interactive Unit Circle</h2>
                <div class="unit-circle-container">
                    <canvas id="unitCircle" width="600" height="600"></canvas>
                    <div class="angle-selector">
                        <label for="angleSlider" style="font-size: 1.2em; font-weight: 600; display: block; margin-bottom: 10px;">
                            Select Angle: <span id="angleValue">0°</span> (<span id="angleRadians">0</span> radians)
                        </label>
                        <input type="range" id="angleSlider" class="slider" min="0" max="360" value="0" oninput="updateUnitCircle(this.value)">
                    </div>
                    <div class="angle-display">
                        <div><strong>sin θ = </strong><span id="sinValue">0.000</span></div>
                        <div><strong>cos θ = </strong><span id="cosValue">1.000</span></div>
                        <div><strong>tan θ = </strong><span id="tanValue">0.000</span></div>
                    </div>
                    <div class="angle-display">
                        <div style="margin-bottom: 10px;"><strong>Common Angles Quick Reference:</strong></div>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(0)">0° / 0</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(30)">30° / <span class="greek">π</span>/6</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(45)">45° / <span class="greek">π</span>/4</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(60)">60° / <span class="greek">π</span>/3</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(90)">90° / <span class="greek">π</span>/2</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(120)">120° / 2<span class="greek">π</span>/3</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(135)">135° / 3<span class="greek">π</span>/4</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(150)">150° / 5<span class="greek">π</span>/6</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(180)">180° / <span class="greek">π</span></button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(210)">210° / 7<span class="greek">π</span>/6</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(225)">225° / 5<span class="greek">π</span>/4</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(240)">240° / 4<span class="greek">π</span>/3</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(270)">270° / 3<span class="greek">π</span>/2</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(300)">300° / 5<span class="greek">π</span>/3</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(315)">315° / 7<span class="greek">π</span>/4</button>
                        <button class="option-btn" style="margin: 5px;" onclick="setAngle(330)">330° / 11<span class="greek">π</span>/6</button>
                    </div>
                </div>
            </div>

            <!-- PRACTICE TAB -->
            <div id="practice" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Practice Problems</h2>
                <div class="tip-box" style="margin-bottom: 20px;">
                    <strong>📝 Progress Saved!</strong> Your progress is automatically saved. Each practice set contains 10 random questions. Use keyboard: Space for next, R for reset.
                </div>
                <div class="practice-section" id="practiceArea">
                    <div class="question" id="currentQuestion">
                        <!-- Questions will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- PROBLEM SOLVER TAB -->
            <div id="solver" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">🧮 Real-World Problem Solver</h2>
                <p style="font-size: 1.1em; margin-bottom: 20px;">Solve practical problems step-by-step with interactive calculators!</p>
                
                <div class="problem-selector">
                    <button class="problem-btn active" onclick="loadProblem('ladder')">🪜 Ladder Problem</button>
                    <button class="problem-btn" onclick="loadProblem('roof')">🏠 Roof Pitch</button>
                    <button class="problem-btn" onclick="loadProblem('projectile')">⚽ Projectile Motion</button>
                    <button class="problem-btn" onclick="loadProblem('surveying')">📏 Land Surveying</button>
                    <button class="problem-btn" onclick="loadProblem('navigation')">🧭 Navigation</button>
                </div>

                <div id="problemWorkspace" class="problem-workspace">
                    <!-- Problem content loaded here -->
                </div>
            </div>

            <!-- VISUALIZATION TAB -->
            <div id="visual" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Visual Learning</h2>
                
                <div class="visualization">
                    <h3 style="color: #5a67d8; margin-bottom: 20px;">Interactive Sine and Cosine Waves</h3>
                    <div class="interactive-demo">
                        <canvas id="demoCanvas" width="800" height="400"></canvas>
                        <div class="controls">
                            <div class="control-group">
                                <label>Amplitude</label>
                                <input type="range" class="slider" id="amplitude" min="0.1" max="3" step="0.1" value="1" oninput="updateWave()">
                                <span id="ampValue">1.0</span>
                            </div>
                            <div class="control-group">
                                <label>Frequency</label>
                                <input type="range" class="slider" id="frequency" min="0.1" max="3" step="0.1" value="1" oninput="updateWave()">
                                <span id="freqValue">1.0</span>
                            </div>
                            <div class="control-group">
                                <label>Phase Shift</label>
                                <input type="range" class="slider" id="phase" min="0" max="6.28" step="0.1" value="0" oninput="updateWave()">
                                <span id="phaseValue">0.0</span>
                            </div>
                        </div>
                        <div style="margin: 20px 0;">
                            <button class="option-btn" onclick="toggleWaveType('sin')">Show Sine</button>
                            <button class="option-btn" onclick="toggleWaveType('cos')">Show Cosine</button>
                            <button class="option-btn" onclick="toggleWaveType('both')">Show Both</button>
                        </div>
                        <div class="formula" style="margin: 20px; background: #f7fafc;">
                            <span style="color: #e53e3e; font-weight: bold;">Red: </span>
                            y = <span id="sineEquation">sin(x)</span>
                            <br>
                            <span style="color: #3182ce; font-weight: bold;">Blue: </span>
                            y = <span id="cosineEquation">cos(x)</span>
                        </div>
                    </div>
                </div>

                <div class="visualization" style="margin-top: 30px;">
                    <h3 style="color: #5a67d8; margin-bottom: 20px;">Function Comparison Tool</h3>
                    <div class="comparison-container">
                        <div class="comparison-side">
                            <h4>Sine vs Cosine</h4>
                            <canvas id="sinCosCompare" width="350" height="300"></canvas>
                            <p style="margin-top: 10px; text-align: center;">Cosine is sine shifted by π/2</p>
                        </div>
                        <div class="comparison-side">
                            <h4>Tangent vs Cotangent</h4>
                            <canvas id="tanCotCompare" width="350" height="300"></canvas>
                            <p style="margin-top: 10px; text-align: center;">Cotangent is the reciprocal of tangent</p>
                        </div>
                    </div>
                </div>

                <div class="visualization" style="margin-top: 30px;">
                    <h3 style="color: #5a67d8; margin-bottom: 20px;">Pythagorean Identity Visual Proof</h3>
                    <div class="explanation">
                        On the unit circle, any point (x, y) satisfies x² + y² = 1. 
                        Since x = cos θ and y = sin θ, we get: <strong>sin² θ + cos² θ = 1</strong>
                    </div>
                    <div style="text-align: center; margin: 20px 0;">
                        <canvas id="pythagoreanCanvas" width="400" height="400"></canvas>
                    </div>
                </div>
            </div>

            <!-- COMMON MISTAKES TAB -->
            <div id="mistakes" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">⚠️ Common Mistakes to Avoid</h2>
                <p style="font-size: 1.1em; margin-bottom: 30px;">Learn from these frequent errors that trip up students!</p>

                <div class="mistake-card">
                    <h4>❌ Mistake #1: Not Squaring Both Terms</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> sin²θ + cosθ = 1
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> sin²θ + cos²θ = 1
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> The Pythagorean identity requires BOTH sine and cosine to be squared. Without squaring both, the identity doesn't hold for most angles.
                    </div>
                    <div class="tip-box">
                        <strong>How to avoid:</strong> Always remember "squared plus squared equals one" - both terms must have exponent 2.
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #2: Sign Errors in Sum Formulas</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> cos(A + B) = cos A cos B + sin A sin B
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> cos(A + B) = cos A cos B - sin A sin B
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> The cosine addition formula has a MINUS sign, not a plus. This is opposite from sine!
                    </div>
                    <div class="tip-box">
                        <strong>Memory trick:</strong> "Sine is so positive, cosine is negative" - sin(A+B) has +, cos(A+B) has -
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #3: Degree vs Radian Mode</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> sin(90) = 0.8940 (calculator in radian mode)
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> sin(90°) = 1 OR sin(π/2 radians) = 1
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> When you put "90" in a calculator set to radian mode, it calculates sin(90 radians), not sin(90 degrees).
                    </div>
                    <div class="tip-box">
                        <strong>How to avoid:</strong> ALWAYS check your calculator mode before computing. Convert 90° to radians (π/2) if in radian mode.
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #4: Order of Operations with Tangent</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> tan(θ) = sin(θ) / cos(θ) ≠ sin(θ/cos(θ))
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> tan(θ) = sin(θ) / cos(θ) means [sin(θ)] / [cos(θ)]
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> The division applies to the VALUES of sin and cos, not the angles themselves.
                    </div>
                    <div class="tip-box">
                        <strong>Remember:</strong> Calculate sin(θ) and cos(θ) separately, THEN divide the results.
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #5: Thinking sin(2θ) = 2sin(θ)</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> sin(2θ) = 2sin(θ)
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> sin(2θ) = 2sin(θ)cos(θ)
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> Trig functions are not linear! You can't just "distribute" the 2 outside the function.
                    </div>
                    <div class="tip-box">
                        <strong>Test it:</strong> Try θ = 30°. sin(60°) = √3/2 ≈ 0.866, but 2sin(30°) = 2(0.5) = 1. Not equal!
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #6: Forgetting Domain Restrictions</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> tan(90°) = 1.6×10¹⁶ (calculator gives huge number)
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> tan(90°) is undefined (division by zero)
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> Since tan(θ) = sin(θ)/cos(θ) and cos(90°) = 0, we're dividing by zero.
                    </div>
                    <div class="tip-box">
                        <strong>Remember:</strong> tan and sec are undefined at 90° and 270°; csc and cot are undefined at 0° and 180°
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #7: Incorrect Reciprocal Identities</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> csc(θ) = 1/cos(θ)
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> csc(θ) = 1/sin(θ), sec(θ) = 1/cos(θ)
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> Cosecant is the reciprocal of SINE, not cosine. Secant is the reciprocal of cosine.
                    </div>
                    <div class="tip-box">
                        <strong>Memory aid:</strong> Co-secant goes with sine (no "co"), Secant goes with cosine (the "co" one)
                    </div>
                </div>

                <div class="mistake-card">
                    <h4>❌ Mistake #8: Using Wrong Triangle in Word Problems</h4>
                    <div class="wrong-answer">
                        <strong>WRONG:</strong> In "find the height of a building", using adjacent/hypotenuse when you meant opposite/adjacent
                    </div>
                    <div class="correct-answer">
                        <strong>CORRECT:</strong> Draw a diagram! Identify what's opposite, adjacent, and hypotenuse relative to YOUR angle
                    </div>
                    <div class="why-wrong">
                        <strong>Why it's wrong:</strong> "Opposite" and "adjacent" are relative to the angle you're working with.
                    </div>
                    <div class="tip-box">
                        <strong>Pro tip:</strong> ALWAYS draw and label a diagram. Mark your angle, then identify opposite and adjacent sides relative to THAT angle.
                    </div>
                </div>

                <div class="visualization" style="margin-top: 30px;">
                    <h3>🎯 Practice Avoiding These Mistakes!</h3>
                    <p>Test yourself with problems designed to catch common errors:</p>
                    <button class="next-btn" onclick="loadMistakeQuiz()">Start Mistake-Focused Quiz</button>
                    <div id="mistakeQuiz"></div>
                </div>
            </div>

            <!-- APPLICATIONS TAB -->
            <div id="applications" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Real-World Applications of Trigonometry</h2>
                <p style="font-size: 1.2em; margin-bottom: 30px;">Trigonometry isn't just abstract math—it's the mathematical language that makes our modern world work! From the phone in your hand to the buildings you walk through, trig is everywhere.</p>

                <div class="formula-grid">
                    <!-- Architecture & Construction -->
                    <div class="formula-card">
                        <h3>🏗️ Architecture & Construction</h3>
                        <div class="explanation">
                            <strong>Building Design:</strong> Architects use trigonometry to calculate roof slopes, support beam angles, and structural load distributions. The pitch of a roof is expressed as a ratio that relates directly to tangent.
                        </div>
                        <div class="tip-box">
                            <strong>Real Example:</strong> If a roof rises 6 feet over a horizontal distance of 12 feet, the angle is arctan(6/12) = 26.57°. This determines material needs and drainage efficiency.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Bridge Engineering:</strong> Suspension bridges use parabolic curves (analyzed with trig) to distribute weight. The Golden Gate Bridge's main cables are calculated using trigonometric equations to ensure each support cable bears the correct load. Engineers calculate the angle of every support cable at various points using sine and cosine.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Structural Analysis:</strong> When designing earthquake-resistant buildings, engineers use trigonometry to calculate force vectors and moments at different angles. A force of 1000N at 45° is broken into components: horizontal = 1000cos(45°) = 707N, vertical = 1000sin(45°) = 707N.
                        </div>
                        <div class="formula">tan(angle) = rise/run for roof pitch</div>
                    </div>

                    <!-- Navigation & GPS -->
                    <div class="formula-card">
                        <h3>🧭 Navigation & GPS Systems</h3>
                        <div class="explanation">
                            <strong>GPS Technology:</strong> Your phone's GPS uses trilateration with trigonometric calculations to determine your exact position from satellite signals. The system measures the time delay of signals from at least four satellites, converts these to distances using the speed of light, and then uses the Law of Cosines to calculate your position.
                        </div>
                        <div class="tip-box">
                            <strong>How it works:</strong> Each satellite defines a sphere (you're somewhere on that sphere's surface). Three spheres intersect at two points; the fourth satellite determines which of the two points is correct. The math uses 3D trigonometry extensively.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Aviation Navigation:</strong> Pilots use trigonometry constantly. When landing, they follow a 3° glide slope (calculated using tangent). For crosswind corrections, they calculate heading adjustments: if wind is 20 knots at 90° to runway and aircraft speed is 120 knots, correction angle = arcsin(20/120) ≈ 9.6°.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Marine Navigation:</strong> Ships use celestial navigation, measuring angles to stars with a sextant. If you measure the angle from the horizon to Polaris (North Star) as 35°, your latitude is 35°N. This is pure trigonometry dating back centuries!
                        </div>
                        <div class="formula">Distance = √[(x₂-x₁)² + (y₂-y₁)² + (z₂-z₁)²]</div>
                    </div>

                    <!-- Sound & Music -->
                    <div class="formula-card">
                        <h3>🎵 Sound Engineering & Music</h3>
                        <div class="explanation">
                            <strong>Sound Waves:</strong> Every sound you hear is a combination of sine waves at different frequencies. A pure tone at 440 Hz (the musical note A) can be expressed as y = A sin(2π × 440t), where A is amplitude and t is time. When you play a chord, you're combining multiple sine waves!
                        </div>
                        <div class="tip-box">
                            <strong>Example:</strong> An A major chord combines:
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>A note: sin(2π × 440t)</li>
                                <li>C# note: sin(2π × 554t)</li>
                                <li>E note: sin(2π × 659t)</li>
                            </ul>
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Audio Engineering:</strong> When you adjust an equalizer, you're applying filters that use sine and cosine transforms to boost or reduce specific frequency ranges. Auto-Tune works by analyzing the fundamental frequency using Fast Fourier Transform (FFT), which breaks audio into sine wave components, then shifts these components to the nearest correct pitch.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Concert Hall Acoustics:</strong> Acoustic engineers use trigonometry to design concert halls. Sound reflects off walls at angles following the law of reflection (angle of incidence = angle of reflection). By calculating these angles, they position walls and ceilings to direct sound optimally, ensuring no "dead spots" in the audience.
                        </div>
                    </div>

                    <!-- Video Games & Graphics -->
                    <div class="formula-card">
                        <h3>🎮 Video Games & Computer Graphics</h3>
                        <div class="explanation">
                            <strong>3D Rendering:</strong> Every 3D game uses rotation matrices filled with sines and cosines. When a character rotates 30° around the y-axis, the game engine multiplies every vertex by:
                        </div>
                        <div class="formula">
                            [cos(30°)  0  sin(30°)]<br>
                            [0         1  0      ]<br>
                            [-sin(30°) 0  cos(30°)]
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Camera Systems:</strong> First-person shooters calculate what you see using field-of-view angles. A 90° FOV means the camera "sees" objects within a 90° cone. To determine if an enemy is visible, the game checks: angle = arccos(dot product of vectors). If angle < FOV/2, the enemy is visible.
                        </div>
                        <div class="tip-box">
                            <strong>Projectile Physics:</strong> When you throw a grenade at angle θ with velocity v:
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>Horizontal velocity: v × cos(θ)</li>
                                <li>Vertical velocity: v × sin(θ)</li>
                                <li>Range: v² × sin(2θ) / g</li>
                            </ul>
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Animation:</strong> Character movements use sine waves for natural motion. A breathing animation might be: chest_position = base + 0.5sin(2πt), creating smooth expansion and contraction. Walking cycles use combinations of sine and cosine to animate limbs naturally.
                        </div>
                    </div>

                    <!-- Medical Imaging -->
                    <div class="formula-card">
                        <h3>🏥 Medical Imaging & Healthcare</h3>
                        <div class="explanation">
                            <strong>CT Scans (Computed Tomography):</strong> A CT scanner rotates an X-ray source around your body, taking images at many angles (typically 360-720 different angles). Each angle provides a 1D projection. The Radon Transform uses trigonometry to reconstruct the 3D image from these 2D projections. Mathematically, this involves integrating over all angles using sine and cosine.
                        </div>
                        <div class="formula">f(x,y) = ∫∫ g(r,θ) δ(x·cos(θ) + y·sin(θ) - r) dr dθ</div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>MRI (Magnetic Resonance Imaging):</strong> MRI uses Fourier transforms—essentially breaking down complex signals into combinations of sine and cosine waves at different frequencies. Each pixel's brightness is calculated by summing hundreds of sine waves with different phases and amplitudes.
                        </div>
                        <div class="tip-box">
                            <strong>Ultrasound:</strong> When an ultrasound probe is angled at θ to the skin, the echo return time tells distance: depth = (speed of sound × time) / 2. The angle affects what structures are visible. Doppler ultrasound uses trigonometry to measure blood flow velocity based on angle of the probe relative to blood vessel.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Biomechanics:</strong> Physical therapists measure joint angles to assess range of motion. For knee rehabilitation, they might measure: flexion angle = arccos[(thigh² + shin² - distance²)/(2 × thigh × shin)]. This tracks recovery progress numerically.
                        </div>
                    </div>

                    <!-- Astronomy & Space -->
                    <div class="formula-card">
                        <h3>🚀 Astronomy & Space Exploration</h3>
                        <div class="explanation">
                            <strong>Orbital Mechanics:</strong> Every satellite orbit is an ellipse, described by equations filled with trigonometry. The position of a satellite at time t is calculated using: x = a·cos(ωt), y = b·sin(ωt), where a and b are the semi-major and semi-minor axes. NASA uses these equations to plan every mission.
                        </div>
                        <div class="tip-box">
                            <strong>Mars Mission Example:</strong> To send a spacecraft to Mars, you need to calculate the Hohmann transfer orbit. This requires:
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>Orbital velocities using v = √(GM/r)</li>
                                <li>Transfer angle: θ = π - arcsin(r₁/r₂)</li>
                                <li>Launch window timing (requires solving Kepler's equations with trig functions)</li>
                            </ul>
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Parallax Distance Measurement:</strong> To measure the distance to nearby stars, astronomers measure the angle of parallax as Earth orbits the Sun. If the parallax angle is p (in arcseconds), the distance in parsecs is: d = 1/p. For Proxima Centauri with p = 0.772", the distance is 1.30 parsecs or 4.24 light-years.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Telescope Pointing:</strong> To point the Hubble Space Telescope at a specific star, engineers convert sky coordinates (right ascension and declination) to spacecraft orientation angles using spherical trigonometry. They must account for Earth's rotation, orbital motion, and precession.
                        </div>
                    </div>

                    <!-- Electricity & Electronics -->
                    <div class="formula-card">
                        <h3>⚡ Electrical Engineering</h3>
                        <div class="explanation">
                            <strong>AC Current:</strong> The electricity in your home is alternating current, which flows as a sine wave. In North America, it's V(t) = 170·sin(2π·60t), oscillating 60 times per second. The "120V" you see on outlets is the RMS (root mean square) value: V_RMS = V_peak/√2 ≈ 120V.
                        </div>
                        <div class="tip-box">
                            <strong>Three-Phase Power:</strong> Industrial electricity uses three voltage waves separated by 120°:
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>Phase A: V·sin(ωt)</li>
                                <li>Phase B: V·sin(ωt - 120°)</li>
                                <li>Phase C: V·sin(ωt - 240°)</li>
                            </ul>
                            This provides smoother, more efficient power delivery for large motors and industrial equipment.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Impedance & Power Factor:</strong> When AC flows through inductors and capacitors, voltage and current become out of phase. If current lags voltage by angle φ, the power factor is cos(φ). A motor with PF = 0.8 means φ = arccos(0.8) ≈ 36.87° phase lag. This affects efficiency and electricity bills!
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Signal Processing:</strong> WiFi, Bluetooth, 5G—all wireless signals use quadrature amplitude modulation (QAM), encoding data in both the amplitude and phase of sine waves. A signal might be: s(t) = A·cos(ωt + φ), where both A and φ carry information. Your phone decodes this using trigonometric transformations.
                        </div>
                    </div>

                    <!-- Surveying & Mapping -->
                    <div class="formula-card">
                        <h3>🗺️ Surveying & Cartography</h3>
                        <div class="explanation">
                            <strong>Triangulation:</strong> Surveyors create accurate maps using trigonometric triangulation. To measure the width of a river without crossing it: stand at point A, measure the angle to point C across the river (say 45°), walk along your side to point B (say 100m), measure the angle from B to C (say 60°). Then use Law of Sines to find the width.
                        </div>
                        <div class="formula">
                            width/sin(75°) = 100/sin(60°)<br>
                            width = 100·sin(75°)/sin(60°) ≈ 111.8m
                        </div>
                        <div class="tip-box">
                            <strong>Real Application:</strong> The entire U.S. National Geodetic Survey is built on triangulation networks. Surveyors measured angles between mountaintop markers and used trigonometry to calculate distances across the continent before GPS existed!
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Map Projections:</strong> Converting Earth's spherical surface to flat maps requires trigonometric transformations. The Mercator projection uses: x = λ, y = ln(tan(φ/2 + π/4)), where λ is longitude and φ is latitude. This preserves angles but distorts sizes (Greenland looks huge!).
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Elevation Mapping:</strong> Topographic maps show elevation using contour lines. Surveyors calculate height differences using: Δh = d·tan(α), where d is horizontal distance and α is the angle of elevation measured with a theodolite.
                        </div>
                    </div>

                    <!-- Weather & Climate -->
                    <div class="formula-card">
                        <h3>🌦️ Meteorology & Climate Science</h3>
                        <div class="explanation">
                            <strong>Seasonal Temperature Modeling:</strong> Average temperature varies sinusoidally through the year. For a location with average temp 15°C, amplitude 10°C, the model is: T(d) = 15 + 10·sin(2πd/365 - π/2), where d is day of year. This predicts temperature patterns for agriculture and energy planning.
                        </div>
                        <div class="tip-box">
                            <strong>Weather Radar:</strong> Doppler weather radar measures wind velocity by detecting frequency shifts. If radar wavelength is λ and frequency shift is Δf, wind velocity is: v = (λ·Δf·c)/(2·f₀·cos(θ)), where θ is the angle between wind direction and radar beam. This calculates wind speed in storms!
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Solar Energy Optimization:</strong> To maximize solar panel output, calculate optimal angle based on latitude. At latitude L, the optimal tilt angle is approximately L°. During summer, adjust to (L - 15°), during winter to (L + 15°). This uses: incident power = P₀·cos(θ), where θ is angle between sunlight and panel normal.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Hurricane Tracking:</strong> Hurricane wind speeds decrease with distance from eye. Models use: v(r) = v_max·(r_max/r)^α, where α involves trigonometric coefficients based on latitude. This helps predict damage zones and plan evacuations.
                        </div>
                    </div>

                    <!-- Photography & Film -->
                    <div class="formula-card">
                        <h3>📷 Photography & Cinematography</h3>
                        <div class="explanation">
                            <strong>Lens Field of View:</strong> For a camera with sensor width w and focal length f, the horizontal field of view is: FOV = 2·arctan(w/2f). For example, a 50mm lens on a 36mm wide sensor gives: FOV = 2·arctan(36/100) ≈ 39.6°. This determines what fits in your frame!
                        </div>
                        <div class="tip-box">
                            <strong>Practical Example:</strong> To photograph a building 30m wide from 50m away, you need FOV = 2·arctan(15/50) ≈ 33.4°. You'd need approximately a 55mm lens on full-frame.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Panoramic Stitching:</strong> Creating panoramas requires calculating rotation angles between shots. For a 360° panorama with 40% overlap using 60° FOV, you need: number of shots = 360/(60 × 0.6) = 10 shots. Software uses trigonometric transforms to align and blend images seamlessly.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Lighting Calculations:</strong> Light intensity follows inverse square law with angular falloff. If a light source has intensity I₀ at angle θ from perpendicular, intensity on surface is: I = (I₀·cos(θ))/r². Cinematographers use this to calculate lighting positions for even illumination.
                        </div>
                    </div>

                    <!-- Sports & Athletics -->
                    <div class="formula-card">
                        <h3>⚽ Sports Science & Athletics</h3>
                        <div class="explanation">
                            <strong>Projectile Motion in Sports:</strong> Optimal angle for maximum range on level ground is 45°, but biomechanical constraints change this. Long jump takeoff is ~20° (not 45°) because humans can't maintain velocity at steeper angles. Shot put optimal angle is ~40° due to release height above landing.
                        </div>
                        <div class="formula">
                            Range = (v²·sin(2θ))/g + (v·cos(θ)/g)·√[v²·sin²(θ) + 2gh]
                        </div>
                        <div class="tip-box">
                            <strong>Basketball Free Throw:</strong> For a 3m shot at 3m height, optimal entry angle is 45-52°. Launch angle of 49° with 7.2 m/s gives perfect arc. Too flat (<43°) increases chance of hitting front rim; too steep (>53°) makes it harder to control distance.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Biomechanical Analysis:</strong> Motion capture systems track joint angles during movement. For a tennis serve, shoulder rotation might be: θ(t) = 90 + 180·sin(ωt - φ). Coaches analyze these functions to optimize technique and prevent injury.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Swimming Stroke Analysis:</strong> Arm recovery in freestyle follows approximately: height = L·sin(πt/T), where L is arm length and T is stroke period. This creates the characteristic sinusoidal pattern seen from the side.
                        </div>
                    </div>

                    <!-- Robotics & Automation -->
                    <div class="formula-card">
                        <h3>🤖 Robotics & Automation</h3>
                        <div class="explanation">
                            <strong>Inverse Kinematics:</strong> For a robot arm to grab an object at position (x, y), calculate required joint angles. For a two-joint arm with lengths L₁ and L₂:
                        </div>
                        <div class="formula">
                            θ₂ = ±arccos[(x² + y² - L₁² - L₂²)/(2L₁L₂)]<br>
                            θ₁ = arctan(y/x) - arctan[(L₂·sin(θ₂))/(L₁ + L₂·cos(θ₂))]
                        </div>
                        <div class="tip-box">
                            <strong>Example:</strong> To reach point (30, 40) cm with L₁ = 25cm, L₂ = 25cm:
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>θ₂ = arccos[(900+1600-625-625)/1250] ≈ 78.5°</li>
                                <li>θ₁ = arctan(40/30) - arctan[(24.5)/(25+4.8)] ≈ 13.5°</li>
                            </ul>
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Self-Driving Cars:</strong> Autonomous vehicles constantly calculate angles to obstacles. If LIDAR detects an object at distance r and angle θ, convert to (x,y): x = r·cos(θ), y = r·sin(θ). The car's path planner uses these coordinates to navigate safely around obstacles.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Drone Stabilization:</strong> Quadcopters use gyroscope data (roll, pitch, yaw angles) with PID controllers. To correct a 5° tilt: calculate required motor speed difference using thrust vectors: F = mg/(cos(θ)·4), where θ is tilt angle. This keeps the drone level using continuous trigonometric calculations.
                        </div>
                    </div>

                    <!-- Seismology -->
                    <div class="formula-card">
                        <h3>🌍 Seismology & Earthquake Science</h3>
                        <div class="explanation">
                            <strong>Locating Earthquakes:</strong> Seismologists use triangulation from three stations. If earthquake waves arrive at station A at t₁, station B at t₂, station C at t₃, solve the system using wave velocity v and distances:
                        </div>
                        <div class="formula">
                            (x-xₐ)² + (y-yₐ)² = [v(t₂-t₁)]²<br>
                            (x-xᵦ)² + (y-yᵦ)² = [v(t₃-t₁)]²
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Wave Analysis:</strong> P-waves and S-waves travel at different speeds. The time difference helps determine distance: d = (tₛ - tₚ) × vₚ × vₛ/(vₛ - vₚ). This uses principles of wave motion described by trigonometric functions.
                        </div>
                        <div class="tip-box">
                            <strong>Building Design:</strong> Earthquake-resistant buildings use base isolation that allows controlled oscillation. The natural frequency is: f = (1/2π)√(k/m). Engineers ensure this differs from seismic frequencies to avoid resonance using phase relationships between waves.
                        </div>
                    </div>

                    <!-- Economics & Finance -->
                    <div class="formula-card">
                        <h3>💰 Economics & Financial Markets</h3>
                        <div class="explanation">
                            <strong>Cyclical Economic Models:</strong> Economic indicators often follow cycles modeled with trig functions. Housing starts might follow: S(t) = S₀ + A·sin(2πt/T + φ), where T is the business cycle period (~7-10 years). This helps predict market trends.
                        </div>
                        <div class="explanation" style="margin-top: 10px;">
                            <strong>Options Pricing:</strong> The Black-Scholes model for options uses the cumulative normal distribution, which is calculated using: Φ(x) = (1/√2π)∫exp(-t²/2)dt. This integral involves trigonometric substitutions and is fundamental to derivative pricing.
                        </div>
                        <div class="tip-box">
                            <strong>Technical Analysis:</strong> Traders use indicators like RSI (Relative Strength Index) and stochastic oscillators that oscillate like sine waves between 0-100, identifying overbought/oversold conditions based on cyclical patterns.
                        </div>
                    </div>
                </div>

                <div class="formula-card" style="margin-top: 30px;">
                    <h3>💡 Why Understanding These Applications Matters</h3>
                    <div class="explanation">
                        <p style="margin: 15px 0; font-size: 1.1em;">
                            <strong>Career Opportunities:</strong> Trigonometry is essential in engineering (aerospace, civil, electrical, mechanical), computer science, data science, physics, architecture, medicine, surveying, navigation, animation, game development, and countless other high-paying fields. Mastering trig opens doors to exciting careers shaping our future.
                        </p>
                        <p style="margin: 15px 0; font-size: 1.1em;">
                            <strong>Problem-Solving Skills:</strong> Learning trigonometry develops logical thinking, spatial reasoning, and analytical skills that apply far beyond mathematics. These cognitive tools help you break down complex problems in any field—from debugging code to planning projects to making data-driven decisions.
                        </p>
                        <p style="margin: 15px 0; font-size: 1.1em;">
                            <strong>Understanding Technology:</strong> Every technology you use daily—smartphones, GPS, streaming video, music, medical imaging, video games, weather forecasts—relies on trigonometry. Understanding the math helps you understand and shape the world, whether you're choosing a career, evaluating claims, or making informed decisions.
                        </p>
                        <p style="margin: 15px 0; font-size: 1.1em;">
                            <strong>Innovation & Creation:</strong> The next generation of inventors, engineers, and scientists will use trigonometry to solve problems we haven't even imagined yet—designing Mars habitats, creating new medical treatments, building quantum computers, developing sustainable energy systems. Your trigonometry knowledge could be the foundation for revolutionary innovations.
                        </p>
                    </div>
                </div>

                <div class="visualization" style="margin-top: 30px;">
                    <h3 style="color: #5a67d8; margin-bottom: 20px;">🎯 Try It Yourself: Application Calculator</h3>
                    <p>Select an application and input values to see real calculations!</p>
                    
                    <div class="problem-selector" style="margin: 20px 0;">
                        <button class="problem-btn active" onclick="loadApplicationDemo('solar')">☀️ Solar Panel Angle</button>
                        <button class="problem-btn" onclick="loadApplicationDemo('basketball')">🏀 Basketball Shot</button>
                        <button class="problem-btn" onclick="loadApplicationDemo('bridge')">🌉 Bridge Cable</button>
                        <button class="problem-btn" onclick="loadApplicationDemo('radio')">📻 Radio Wave</button>
                    </div>
                    
                    <div id="applicationDemo" style="background: white; padding: 25px; border-radius: 10px; margin-top: 20px;"></div>
                </div>
            </div>

            <!-- REFERENCE TAB -->
            <div id="reference" class="tab-content">
                <h2 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">Quick Reference Guide</h2>
                
                <div class="formula-card">
                    <h3>🎯 Common Angle Values</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <tr style="background: #5a67d8; color: white;">
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">Angle</th>
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">Degrees</th>
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">Radians</th>
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">sin</th>
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">cos</th>
                            <th style="padding: 12px; border: 1px solid #cbd5e0;">tan</th>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0°</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0</td>
                        </tr>
                        <tr style="background: #f7fafc;">
                            <td style="padding: 10px; border: 1px solid #cbd5e0;"><span class="greek">π</span>/6</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">30°</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0.524</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√3/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√3/3</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;"><span class="greek">π</span>/4</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">45°</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0.785</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√2/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√2/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1</td>
                        </tr>
                        <tr style="background: #f7fafc;">
                            <td style="padding: 10px; border: 1px solid #cbd5e0;"><span class="greek">π</span>/3</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">60°</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1.047</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√3/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">√3</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;"><span class="greek">π</span>/2</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">90°</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1.571</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">1</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">0</td>
                            <td style="padding: 10px; border: 1px solid #cbd5e0;">undefined</td>
                        </tr>
                    </table>
                </div>

                <div class="formula-card" style="margin-top: 20px;">
                    <h3>🧮 Conversion Formulas</h3>
                    <div class="formula">Degrees to Radians: radians = degrees × (<span class="greek">π</span>/180)</div>
                    <div class="formula">Radians to Degrees: degrees = radians × (180/<span class="greek">π</span>)</div>
                </div>

                <div class="formula-card" style="margin-top: 20px;">
                    <h3>🎓 SOH-CAH-TOA</h3>
                    <div class="explanation">
                        <p style="margin: 10px 0;"><strong>SOH:</strong> <span class="highlight-term">S</span>ine = <span class="highlight-term">O</span>pposite / <span class="highlight-term">H</span>ypotenuse</p>
                        <p style="margin: 10px 0;"><strong>CAH:</strong> <span class="highlight-term">C</span>osine = <span class="highlight-term">A</span>djacent / <span class="highlight-term">H</span>ypotenuse</p>
                        <p style="margin: 10px 0;"><strong>TOA:</strong> <span class="highlight-term">T</span>angent = <span class="highlight-term">O</span>pposite / <span class="highlight-term">A</span>djacent</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="score-display" id="scoreDisplay" style="display: none;">
        <h3>📊 Your Progress</h3>
        <div>Correct: <strong id="correctCount">0</strong></div>
        <div>Total: <strong id="totalCount">0</strong></div>
        <div>Score: <strong id="percentage">0%</strong></div>
        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">Auto-saved ✓</div>
    </div>

    <script>
        // Global variables
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let totalQuestions = 0;
        let waveType = 'both';
        let questions = [];
        let usedQuestions = [];

        // Practice Questions Bank
        const allQuestions = [
            {
                question: "If sin² θ + cos² θ = 1, and sin θ = 3/5, what is cos θ? (Assume θ is in the first quadrant)",
                options: ["3/5", "4/5", "5/3", "5/4"],
                correct: 1,
                explanation: "Using the Pythagorean identity: cos² θ = 1 - sin² θ = 1 - (3/5)² = 1 - 9/25 = 16/25, so cos θ = 4/5"
            },
            {
                question: "What is sin(90° - θ) equal to?",
                options: ["sin θ", "cos θ", "-sin θ", "-cos θ"],
                correct: 1,
                explanation: "This is the cofunction identity. sin(90° - θ) = cos θ"
            },
            {
                question: "Simplify: tan θ × cos θ",
                options: ["sin θ", "cos θ", "1", "tan θ"],
                correct: 0,
                explanation: "tan θ = sin θ / cos θ, so tan θ × cos θ = (sin θ / cos θ) × cos θ = sin θ"
            },
            {
                question: "What is sin(-θ)?",
                options: ["sin θ", "-sin θ", "cos θ", "-cos θ"],
                correct: 1,
                explanation: "Sine is an odd function, so sin(-θ) = -sin θ"
            },
            {
                question: "If tan θ = 1, what is θ in degrees (0° ≤ θ ≤ 360°)?",
                options: ["30° and 210°", "45° and 225°", "60° and 240°", "90° and 270°"],
                correct: 1,
                explanation: "tan θ = 1 when θ = 45° (first quadrant) and θ = 225° (third quadrant)"
            },
            {
                question: "What is sin 2θ equal to?",
                options: ["2 sin θ", "sin² θ", "2 sin θ cos θ", "sin θ + cos θ"],
                correct: 2,
                explanation: "The double angle formula for sine is: sin 2θ = 2 sin θ cos θ"
            },
            {
                question: "What is 1/sec θ equal to?",
                options: ["sin θ", "cos θ", "tan θ", "csc θ"],
                correct: 1,
                explanation: "sec θ = 1/cos θ, so 1/sec θ = cos θ"
            },
            {
                question: "In a right triangle, if the opposite side is 3 and the hypotenuse is 5, what is sin θ?",
                options: ["3/5", "4/5", "3/4", "5/3"],
                correct: 0,
                explanation: "SOH: Sine = Opposite / Hypotenuse = 3/5"
            },
            {
                question: "What is cos(A + B) equal to?",
                options: ["cos A + cos B", "cos A cos B + sin A sin B", "cos A cos B - sin A sin B", "sin A cos B + cos A sin B"],
                correct: 2,
                explanation: "The sum formula for cosine is: cos(A + B) = cos A cos B - sin A sin B"
            },
            {
                question: "If cos θ = 0, what could θ be in degrees?",
                options: ["0° or 180°", "45° or 225°", "90° or 270°", "30° or 330°"],
                correct: 2,
                explanation: "Cosine equals zero at 90° and 270° (the points on the unit circle where x = 0)"
            }
        ];

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('trigProgress');
            if (saved) {
                const data = JSON.parse(saved);
                correctAnswers = data.correctAnswers || 0;
                totalQuestions = data.totalQuestions || 0;
                updateScore();
            }
        }

        // Save progress
        function saveProgress() {
            localStorage.setItem('trigProgress', JSON.stringify({
                correctAnswers,
                totalQuestions,
                lastVisited: new Date().toISOString()
            }));
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Only respond if not typing in input
            if (e.target.tagName === 'INPUT') return;
            
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    const nextBtn = document.querySelector('.next-btn');
                    if (nextBtn) nextBtn.click();
                    break;
                case 'r':
                case 'R':
                    if (document.getElementById('practice').classList.contains('active')) {
                        selectRandomQuestions();
                        loadQuestion();
                    }
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                case '5':
                case '6':
                case '7':
                case '8':
                case '9':
                    const tabIndex = parseInt(e.key) - 1;
                    const tabs = ['formulas', 'explorer', 'circle', 'practice', 'solver', 'visual', 'mistakes', 'applications', 'reference'];
                    if (tabs[tabIndex]) showTab(tabs[tabIndex]);
                    break;
            }
        });

        function showKeyboardShortcuts() {
            alert('⌨️ Keyboard Shortcuts:\n\n' +
                  '1-9: Switch between tabs\n' +
                  'Space: Next question/step\n' +
                  'R: Reset practice\n\n' +
                  'Works when not typing in input fields!');
        }

        // Tab navigation
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`[onclick*="${tabName}"]`).classList.add('active');

            // Initialize specific tab content
            if (tabName === 'circle') {
                drawUnitCircle(0);
            } else if (tabName === 'practice') {
                if (currentQuestionIndex === 0 && questions.length === 0) {
                    selectRandomQuestions();
                    loadQuestion();
                    document.getElementById('scoreDisplay').style.display = 'block';
                }
            } else if (tabName === 'visual') {
                updateWave();
                drawPythagoreanProof();
                drawComparison();
            } else if (tabName === 'explorer') {
                updateExplorer();
            } else if (tabName === 'solver') {
                loadProblem('ladder');
            } else if (tabName === 'applications') {
                loadApplicationDemo('solar');
            }
        }

        // Formula search/filter
        function filterFormulas() {
            const searchTerm = document.getElementById('formulaSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.formula-card');
            
            cards.forEach(card => {
                const keywords = card.getAttribute('data-keywords') || '';
                const text = card.textContent.toLowerCase();
                
                if (text.includes(searchTerm) || keywords.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Unit Circle Drawing
        function drawUnitCircle(angleDeg) {
            const canvas = document.getElementById('unitCircle');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 200;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw axes
            ctx.strokeStyle = '#cbd5e0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, canvas.height);
            ctx.stroke();
            
            // Draw unit circle
            ctx.strokeStyle = '#5a67d8';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();
            
            // Convert angle to radians
            const angleRad = angleDeg * Math.PI / 180;
            const x = Math.cos(angleRad);
            const y = Math.sin(angleRad);
            
            // Draw angle line
            ctx.strokeStyle = '#e53e3e';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(centerX + x * radius, centerY - y * radius);
            ctx.stroke();
            
            // Draw point on circle
            ctx.fillStyle = '#e53e3e';
            ctx.beginPath();
            ctx.arc(centerX + x * radius, centerY - y * radius, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw projections
            ctx.strokeStyle = '#3182ce';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(centerX + x * radius, centerY - y * radius);
            ctx.lineTo(centerX + x * radius, centerY);
            ctx.stroke();
            
            ctx.strokeStyle = '#38a169';
            ctx.beginPath();
            ctx.moveTo(centerX + x * radius, centerY - y * radius);
            ctx.lineTo(centerX, centerY - y * radius);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Labels
            ctx.fillStyle = '#2d3748';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('cos θ', centerX + x * radius / 2 - 30, centerY + 20);
            ctx.fillText('sin θ', centerX + 10, centerY - y * radius / 2);
        }

        function updateUnitCircle(angle) {
            drawUnitCircle(angle);
            
            const angleRad = angle * Math.PI / 180;
            const sinVal = Math.sin(angleRad);
            const cosVal = Math.cos(angleRad);
            const tanVal = Math.tan(angleRad);
            
            document.getElementById('angleValue').textContent = angle + '°';
            document.getElementById('angleRadians').textContent = (angleRad).toFixed(3);
            document.getElementById('sinValue').textContent = sinVal.toFixed(3);
            document.getElementById('cosValue').textContent = cosVal.toFixed(3);
            document.getElementById('tanValue').textContent = Math.abs(tanVal) > 100 ? 'undefined' : tanVal.toFixed(3);
        }

        function setAngle(angle) {
            document.getElementById('angleSlider').value = angle;
            updateUnitCircle(angle);
        }

        // Formula Explorer
        function updateExplorer() {
            const degrees = parseFloat(document.getElementById('exploreDegrees').value);
            const radians = degrees * Math.PI / 180;
            
            document.getElementById('exploreRadians').value = radians.toFixed(4);
            
            const sin = Math.sin(radians);
            const cos = Math.cos(radians);
            const tan = Math.tan(radians);
            
            document.getElementById('expSin').textContent = sin.toFixed(4);
            document.getElementById('expCos').textContent = cos.toFixed(4);
            document.getElementById('expTan').textContent = Math.abs(tan) > 100 ? 'undefined' : tan.toFixed(4);
            document.getElementById('expCsc').textContent = Math.abs(sin) < 0.001 ? 'undefined' : (1/sin).toFixed(4);
            document.getElementById('expSec').textContent = Math.abs(cos) < 0.001 ? 'undefined' : (1/cos).toFixed(4);
            document.getElementById('expCot').textContent = Math.abs(tan) > 100 ? '0.0000' : (1/tan).toFixed(4);
        }

        function updateExplorerFromRadians() {
            const radians = parseFloat(document.getElementById('exploreRadians').value);
            const degrees = radians * 180 / Math.PI;
            
            document.getElementById('exploreDegrees').value = degrees.toFixed(2);
            updateExplorer();
        }

        function setExploreAngle(degrees) {
            document.getElementById('exploreDegrees').value = degrees;
            updateExplorer();
        }

        function verifyIdentity() {
            try {
                const leftExpr = document.getElementById('leftSide').value;
                const rightExpr = document.getElementById('rightSide').value;
                const angle = parseFloat(document.getElementById('exploreDegrees').value) * Math.PI / 180;
                
                const x = angle;
                const leftResult = eval(leftExpr);
                const rightResult = eval(rightExpr);
                
                const diff = Math.abs(leftResult - rightResult);
                const resultDiv = document.getElementById('verifyResult');
                
                if (diff < 0.0001) {
                    resultDiv.innerHTML = `
                        <div class="feedback correct">
                            ✅ Identity VERIFIED!<br>
                            Left side = ${leftResult.toFixed(6)}<br>
                            Right side = ${rightResult.toFixed(6)}<br>
                            Difference = ${diff.toExponential(2)}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="feedback incorrect">
                            ❌ Not equal at this angle<br>
                            Left side = ${leftResult.toFixed(6)}<br>
                            Right side = ${rightResult.toFixed(6)}<br>
                            Difference = ${diff.toFixed(6)}
                        </div>
                    `;
                }
            } catch(e) {
                document.getElementById('verifyResult').innerHTML = `
                    <div class="feedback incorrect">
                        ❌ Error: ${e.message}<br>
                        Use Math.sin(x), Math.cos(x), Math.tan(x)
                    </div>
                `;
            }
        }

        function showDerivation() {
            const container = document.getElementById('derivationSteps');
            const steps = [
                {
                    title: "Step 1: Start with sum formula",
                    content: "sin(A + B) = sin A cos B + cos A sin B"
                },
                {
                    title: "Step 2: Let A = B = θ",
                    content: "sin(θ + θ) = sin θ cos θ + cos θ sin θ"
                },
                {
                    title: "Step 3: Simplify left side",
                    content: "sin(2θ) = sin θ cos θ + cos θ sin θ"
                },
                {
                    title: "Step 4: Combine like terms",
                    content: "sin(2θ) = 2 sin θ cos θ"
                },
                {
                    title: "✓ Result",
                    content: "We've derived the double angle formula!"
                }
            ];
            
            container.innerHTML = '';
            steps.forEach((step, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = 'derivation-step';
                    div.style.animationDelay = `${index * 0.2}s`;
                    div.innerHTML = `
                        <div class="step-title">${step.title}</div>
                        <div class="formula">${step.content}</div>
                    `;
                    container.appendChild(div);
                }, index * 500);
            });
        }

        // Practice Questions
        function selectRandomQuestions() {
            const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
            questions = shuffled.slice(0, 10);
            usedQuestions = [];
            currentQuestionIndex = 0;
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                selectRandomQuestions();
            }
            
            const q = questions[currentQuestionIndex];
            const questionHTML = `
                <h4>Question ${currentQuestionIndex + 1} of ${questions.length}</h4>
                <p style="font-size: 1.2em; margin: 20px 0;">${q.question}</p>
                <div class="options">
                    ${q.options.map((opt, i) => `
                        <button class="option-btn" onclick="checkAnswer(${i})">${opt}</button>
                    `).join('')}
                </div>
                <div id="feedback"></div>
            `;
            
            document.getElementById('currentQuestion').innerHTML = questionHTML;
        }

        function checkAnswer(selected) {
            const q = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.option-btn');
            const feedback = document.getElementById('feedback');
            
            totalQuestions++;
            
            options.forEach((btn, i) => {
                btn.disabled = true;
                if (i === q.correct) {
                    btn.classList.add('correct');
                } else if (i === selected) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (selected === q.correct) {
                correctAnswers++;
                feedback.innerHTML = `
                    <div class="feedback correct">
                        ✅ Correct! ${q.explanation}
                    </div>
                    <button class="next-btn" onclick="nextQuestion()">Next Question →</button>
                `;
            } else {
                feedback.innerHTML = `
                    <div class="feedback incorrect">
                        ❌ Not quite. ${q.explanation}
                    </div>
                    <button class="next-btn" onclick="nextQuestion()">Next Question →</button>
                `;
            }
            
            updateScore();
            saveProgress();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex >= questions.length) {
                const percentage = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;
                document.getElementById('currentQuestion').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h3 style="color: #5a67d8; font-size: 2em; margin-bottom: 20px;">🎉 Set Complete!</h3>
                        <p style="font-size: 1.3em; margin: 20px 0;">You've completed this set of 10 questions!</p>
                        <div class="angle-display" style="max-width: 400px; margin: 30px auto;">
                            <div style="font-size: 1.5em; margin: 10px 0;">Your Score: <strong>${percentage}%</strong></div>
                            <div style="font-size: 1.2em; margin: 10px 0;">Correct: ${correctAnswers} / ${totalQuestions}</div>
                        </div>
                        <button class="next-btn" onclick="startNewSet()" style="font-size: 1.3em; padding: 20px 50px; margin-top: 20px;">
                            🔄 Start New Question Set
                        </button>
                    </div>
                `;
            } else {
                loadQuestion();
            }
        }

        function startNewSet() {
            selectRandomQuestions();
            loadQuestion();
        }

        function updateScore() {
            document.getElementById('correctCount').textContent = correctAnswers;
            document.getElementById('totalCount').textContent = totalQuestions;
            const percentage = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;
            document.getElementById('percentage').textContent = percentage + '%';
        }

        // Problem Solver
        function loadProblem(type) {
            document.querySelectorAll('.problem-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const workspace = document.getElementById('problemWorkspace');
            
            const problems = {
                ladder: `
                    <h3>🪜 Ladder Problem</h3>
                    <p>A 20-foot ladder leans against a wall. You want to find the height it reaches if the base is 5 feet from the wall.</p>
                    
                    <div class="calculator-section">
                        <h4>Given Information</h4>
                        <div class="input-field">
                            <label>Ladder Length (hypotenuse):</label>
                            <input type="number" id="ladderLength" value="20" oninput="solveLadder()">
                        </div>
                        <div class="input-field">
                            <label>Distance from Wall (adjacent):</label>
                            <input type="number" id="wallDist" value="5" oninput="solveLadder()">
                        </div>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-title">Step 1: Identify What We Have</div>
                        <p>We have a right triangle where:</p>
                        <ul style="margin-left: 20px;">
                            <li>Hypotenuse (ladder) = <span id="hypValue">20</span> ft</li>
                            <li>Adjacent (ground distance) = <span id="adjValue">5</span> ft</li>
                            <li>Opposite (height) = ? ft</li>
                        </ul>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-title">Step 2: Choose Formula</div>
                        <p>Using Pythagorean theorem: a² + b² = c²</p>
                        <p>Or: height² + distance² = ladder²</p>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-title">Step 3: Solve</div>
                        <div class="formula">height² = ladder² - distance²</div>
                        <div class="formula">height² = <span id="calc1">400 - 25</span></div>
                        <div class="formula">height² = <span id="calc2">375</span></div>
                        <div class="formula">height = <span id="result1">19.36</span> ft</div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>🎯 Answer</h3>
                        <div class="result-item">
                            <span class="result-label">Height reached:</span>
                            <span class="result-value"><span id="finalHeight">19.36</span> feet</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Angle with ground:</span>
                            <span class="result-value"><span id="angle">75.5</span>°</span>
                        </div>
                    </div>
                `,
                roof: `
                    <h3>🏠 Roof Pitch Calculator</h3>
                    <p>Calculate the angle and measurements for a roof.</p>
                    
                    <div class="calculator-section">
                        <h4>Roof Dimensions</h4>
                        <div class="input-field">
                            <label>Rise (vertical height in feet):</label>
                            <input type="number" id="roofRise" value="6" oninput="solveRoof()">
                        </div>
                        <div class="input-field">
                            <label>Run (horizontal distance in feet):</label>
                            <input type="number" id="roofRun" value="12" oninput="solveRoof()">
                        </div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>📐 Results</h3>
                        <div class="result-item">
                            <span class="result-label">Roof Angle:</span>
                            <span class="result-value"><span id="roofAngle">26.57</span>°</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Rafter Length:</span>
                            <span class="result-value"><span id="rafterLength">13.42</span> ft</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Pitch Ratio:</span>
                            <span class="result-value"><span id="pitchRatio">6:12</span></span>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>Formula Used:</strong> tan(angle) = rise/run, then angle = arctan(rise/run)
                    </div>
                `,
                projectile: `
                    <h3>⚽ Projectile Motion Calculator</h3>
                    <p>Calculate the trajectory of a ball or projectile.</p>
                    
                    <div class="calculator-section">
                        <h4>Launch Parameters</h4>
                        <div class="input-field">
                            <label>Initial Velocity (m/s):</label>
                            <input type="number" id="velocity" value="20" oninput="solveProjectile()">
                        </div>
                        <div class="input-field">
                            <label>Launch Angle (degrees):</label>
                            <input type="number" id="launchAngle" value="45" oninput="solveProjectile()">
                        </div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>🎯 Results</h3>
                        <div class="result-item">
                            <span class="result-label">Maximum Height:</span>
                            <span class="result-value"><span id="maxHeight">10.19</span> m</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Range (Distance):</span>
                            <span class="result-value"><span id="range">40.77</span> m</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Flight Time:</span>
                            <span class="result-value"><span id="flightTime">2.89</span> s</span>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>Physics + Trig:</strong> Horizontal component = v·cos(θ), Vertical component = v·sin(θ)
                    </div>
                `,
                surveying: `
                    <h3>📏 Distance Across River</h3>
                    <p>Measure an inaccessible distance using angles and one measured distance.</p>
                    
                    <div class="calculator-section">
                        <h4>Surveying Data</h4>
                        <div class="input-field">
                            <label>Baseline (measured distance in meters):</label>
                            <input type="number" id="baseline" value="100" oninput="solveSurvey()">
                        </div>
                        <div class="input-field">
                            <label>Angle A (degrees):</label>
                            <input type="number" id="angleA" value="45" oninput="solveSurvey()">
                        </div>
                        <div class="input-field">
                            <label>Angle B (degrees):</label>
                            <input type="number" id="angleB" value="60" oninput="solveSurvey()">
                        </div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>📐 Results</h3>
                        <div class="result-item">
                            <span class="result-label">Distance Across:</span>
                            <span class="result-value"><span id="distAcross">113.40</span> m</span>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>Using Law of Sines:</strong> a/sin(A) = b/sin(B) = c/sin(C)
                    </div>
                `,
                navigation: `
                    <h3>🧭 Navigation Bearing Problem</h3>
                    <p>A ship travels 50 km north, then 30 km east. Find the direct distance and bearing back to start.</p>
                    
                    <div class="calculator-section">
                        <h4>Travel Data</h4>
                        <div class="input-field">
                            <label>Distance North (km):</label>
                            <input type="number" id="northDist" value="50" oninput="solveNav()">
                        </div>
                        <div class="input-field">
                            <label>Distance East (km):</label>
                            <input type="number" id="eastDist" value="30" oninput="solveNav()">
                        </div>
                    </div>
                    
                    <div class="result-panel">
                        <h3>🧭 Results</h3>
                        <div class="result-item">
                            <span class="result-label">Direct Distance:</span>
                            <span class="result-value"><span id="directDist">58.31</span> km</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Bearing to Origin:</span>
                            <span class="result-value"><span id="bearing">210.96</span>°</span>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>Using:</strong> Pythagorean theorem for distance, arctan for angle
                    </div>
                `
            };
            
            workspace.innerHTML = problems[type] || problems.ladder;
            
            // Call the appropriate solver
            setTimeout(() => {
                switch(type) {
                    case 'ladder': solveLadder(); break;
                    case 'roof': solveRoof(); break;
                    case 'projectile': solveProjectile(); break;
                    case 'surveying': solveSurvey(); break;
                    case 'navigation': solveNav(); break;
                }
            }, 100);
        }

        function solveLadder() {
            const length = parseFloat(document.getElementById('ladderLength').value);
            const dist = parseFloat(document.getElementById('wallDist').value);
            
            document.getElementById('hypValue').textContent = length;
            document.getElementById('adjValue').textContent = dist;
            
            const heightSq = length * length - dist * dist;
            const height = Math.sqrt(heightSq);
            
            document.getElementById('calc1').textContent = `${length*length} - ${dist*dist}`;
            document.getElementById('calc2').textContent = heightSq.toFixed(2);
            document.getElementById('result1').textContent = height.toFixed(2);
            document.getElementById('finalHeight').textContent = height.toFixed(2);
            
            const angle = Math.atan(height/dist) * 180 / Math.PI;
            document.getElementById('angle').textContent = angle.toFixed(1);
        }

        function solveRoof() {
            const rise = parseFloat(document.getElementById('roofRise').value);
            const run = parseFloat(document.getElementById('roofRun').value);
            
            const angle = Math.atan(rise/run) * 180 / Math.PI;
            const rafter = Math.sqrt(rise*rise + run*run);
            
            document.getElementById('roofAngle').textContent = angle.toFixed(2);
            document.getElementById('rafterLength').textContent = rafter.toFixed(2);
            document.getElementById('pitchRatio').textContent = `${rise}:${run}`;
        }

        function solveProjectile() {
            const v = parseFloat(document.getElementById('velocity').value);
            const angleDeg = parseFloat(document.getElementById('launchAngle').value);
            const angleRad = angleDeg * Math.PI / 180;
            const g = 9.81;
            
            const maxHeight = (v * Math.sin(angleRad))**2 / (2 * g);
            const range = v**2 * Math.sin(2 * angleRad) / g;
            const time = 2 * v * Math.sin(angleRad) / g;
            
            document.getElementById('maxHeight').textContent = maxHeight.toFixed(2);
            document.getElementById('range').textContent = range.toFixed(2);
            document.getElementById('flightTime').textContent = time.toFixed(2);
        }

        function solveSurvey() {
            const baseline = parseFloat(document.getElementById('baseline').value);
            const angleA = parseFloat(document.getElementById('angleA').value) * Math.PI / 180;
            const angleB = parseFloat(document.getElementById('angleB').value) * Math.PI / 180;
            
            const angleC = Math.PI - angleA - angleB;
            const dist = baseline * Math.sin(angleA) / Math.sin(angleC);
            
            document.getElementById('distAcross').textContent = dist.toFixed(2);
        }

        function solveNav() {
            const north = parseFloat(document.getElementById('northDist').value);
            const east = parseFloat(document.getElementById('eastDist').value);
            
            const dist = Math.sqrt(north*north + east*east);
            const angle = Math.atan2(east, north) * 180 / Math.PI;
            const bearing = (270 - angle + 360) % 360;
            
            document.getElementById('directDist').textContent = dist.toFixed(2);
            document.getElementById('bearing').textContent = bearing.toFixed(2);
        }

        // Wave Visualization
        function updateWave() {
            const canvas = document.getElementById('demoCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const amplitude = parseFloat(document.getElementById('amplitude').value);
            const frequency = parseFloat(document.getElementById('frequency').value);
            const phase = parseFloat(document.getElementById('phase').value);
            
            document.getElementById('ampValue').textContent = amplitude.toFixed(1);
            document.getElementById('freqValue').textContent = frequency.toFixed(1);
            document.getElementById('phaseValue').textContent = phase.toFixed(1);
            
            const ampStr = amplitude !== 1 ? amplitude.toFixed(1) : '';
            const freqStr = frequency !== 1 ? frequency.toFixed(1) : '';
            const phaseStr = phase !== 0 ? ` + ${phase.toFixed(1)}` : '';
            
            document.getElementById('sineEquation').textContent = 
                `${ampStr}sin(${freqStr}x${phaseStr})`;
            document.getElementById('cosineEquation').textContent = 
                `${ampStr}cos(${freqStr}x${phaseStr})`;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw axes
            ctx.strokeStyle = '#cbd5e0';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, canvas.height / 2);
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
            
            // Draw gridlines
            ctx.strokeStyle = '#e2e8f0';
            for (let i = 0; i < canvas.width; i += 50) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            // Draw sine wave
            if (waveType === 'sin' || waveType === 'both') {
                ctx.strokeStyle = '#e53e3e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let x = 0; x < canvas.width; x++) {
                    const angle = (x / 50) * frequency + phase;
                    const y = canvas.height / 2 - amplitude * Math.sin(angle) * (canvas.height / 8);
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
            
            // Draw cosine wave
            if (waveType === 'cos' || waveType === 'both') {
                ctx.strokeStyle = '#3182ce';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let x = 0; x < canvas.width; x++) {
                    const angle = (x / 50) * frequency + phase;
                    const y = canvas.height / 2 - amplitude * Math.cos(angle) * (canvas.height / 8);
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
        }

        function toggleWaveType(type) {
            waveType = type;
            updateWave();
        }

        function drawPythagoreanProof() {
            const canvas = document.getElementById('pythagoreanCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 150;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw axes
            ctx.strokeStyle = '#cbd5e0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, canvas.height);
            ctx.stroke();
            
            // Draw unit circle
            ctx.strokeStyle = '#5a67d8';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();
            
            // Draw right triangle for angle 40°
            const angle = 40 * Math.PI / 180;
            const x = Math.cos(angle) * radius;
            const y = Math.sin(angle) * radius;
            
            ctx.strokeStyle = '#e53e3e';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(centerX + x, centerY - y);
            ctx.lineTo(centerX + x, centerY);
            ctx.closePath();
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#2d3748';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('cos θ', centerX + x/2 - 20, centerY + 20);
            ctx.fillText('sin θ', centerX + x + 10, centerY - y/2);
            ctx.fillText('1', centerX + x/2 - 10, centerY - y/2 - 10);
        }

        function drawComparison() {
            // Sin vs Cos
            const canvas1 = document.getElementById('sinCosCompare');
            if (canvas1) {
                const ctx = canvas1.getContext('2d');
                ctx.clearRect(0, 0, canvas1.width, canvas1.height);
                
                // Axes
                ctx.strokeStyle = '#cbd5e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(0, canvas1.height/2);
                ctx.lineTo(canvas1.width, canvas1.height/2);
                ctx.stroke();
                
                // Sine
                ctx.strokeStyle = '#e53e3e';
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let x = 0; x < canvas1.width; x++) {
                    const angle = (x / canvas1.width) * 4 * Math.PI;
                    const y = canvas1.height/2 - Math.sin(angle) * (canvas1.height/3);
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
                
                // Cosine
                ctx.strokeStyle = '#3182ce';
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let x = 0; x < canvas1.width; x++) {
                    const angle = (x / canvas1.width) * 4 * Math.PI;
                    const y = canvas1.height/2 - Math.cos(angle) * (canvas1.height/3);
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
            
            // Tan vs Cot
            const canvas2 = document.getElementById('tanCotCompare');
            if (canvas2) {
                const ctx = canvas2.getContext('2d');
                ctx.clearRect(0, 0, canvas2.width, canvas2.height);
                
                // Axes
                ctx.strokeStyle = '#cbd5e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(0, canvas2.height/2);
                ctx.lineTo(canvas2.width, canvas2.height/2);
                ctx.stroke();
                
                // Tangent
                ctx.strokeStyle = '#e53e3e';
                ctx.lineWidth = 2;
                for (let segment = 0; segment < 4; segment++) {
                    ctx.beginPath();
                    const start = segment * canvas2.width / 4;
                    const end = (segment + 1) * canvas2.width / 4;
                    for (let x = start; x < end; x++) {
                        const angle = ((x - start) / (canvas2.width/4)) * Math.PI * 0.9;
                        const tan = Math.tan(angle);
                        if (Math.abs(tan) < 3) {
                            const y = canvas2.height/2 - tan * (canvas2.height/8);
                            if (x === start) ctx.moveTo(x, y);
                            else ctx.lineTo(x, y);
                        }
                    }
                    ctx.stroke();
                }
            }
        }

        // Mistake-focused quiz
        const mistakeQuestions = [
            {
                question: "Which of these is the CORRECT Pythagorean identity?",
                options: [
                    "sin²θ + cosθ = 1",
                    "sinθ + cos²θ = 1",
                    "sin²θ + cos²θ = 1",
                    "sinθ + cosθ = 1"
                ],
                correct: 2,
                explanation: "Both sine AND cosine must be squared. The identity is sin²θ + cos²θ = 1.",
                mistake: "Forgetting to square both terms"
            },
            {
                question: "What is cos(A + B)?",
                options: [
                    "cos A + cos B",
                    "cos A cos B + sin A sin B",
                    "cos A cos B - sin A sin B",
                    "sin A cos B + cos A sin B"
                ],
                correct: 2,
                explanation: "The cosine sum formula has a MINUS sign: cos(A + B) = cos A cos B - sin A sin B",
                mistake: "Sign error in sum formulas"
            },
            {
                question: "If your calculator is in RADIAN mode and you type sin(90), what do you actually calculate?",
                options: [
                    "sin(90°) = 1",
                    "sin(90 radians) ≈ 0.894",
                    "sin(π/2) = 1",
                    "The calculator will show an error"
                ],
                correct: 1,
                explanation: "In radian mode, sin(90) calculates sin(90 radians), NOT sin(90 degrees). You get approximately 0.894, not 1!",
                mistake: "Degree vs radian mode confusion"
            },
            {
                question: "Which statement is TRUE?",
                options: [
                    "sin(2θ) = 2sin(θ)",
                    "cos(2θ) = 2cos(θ)",
                    "sin(2θ) = 2sin(θ)cos(θ)",
                    "tan(2θ) = 2tan(θ)"
                ],
                correct: 2,
                explanation: "You can't distribute the 2! The correct double angle formula is sin(2θ) = 2sin(θ)cos(θ).",
                mistake: "Treating trig functions as linear"
            },
            {
                question: "What is tan(90°)?",
                options: [
                    "1",
                    "0",
                    "∞ (infinity)",
                    "undefined"
                ],
                correct: 3,
                explanation: "tan(90°) = sin(90°)/cos(90°) = 1/0 which is undefined. Division by zero is not allowed!",
                mistake: "Ignoring domain restrictions"
            },
            {
                question: "What is csc(θ)?",
                options: [
                    "1/cos(θ)",
                    "1/sin(θ)",
                    "cos(θ)/sin(θ)",
                    "sin(θ)/cos(θ)"
                ],
                correct: 1,
                explanation: "Cosecant is the reciprocal of SINE: csc(θ) = 1/sin(θ). Don't confuse it with secant!",
                mistake: "Wrong reciprocal identity"
            },
            {
                question: "In tan(θ) = sin(θ)/cos(θ), what does this fraction mean?",
                options: [
                    "sin(θ/cos(θ))",
                    "Divide the angle θ by cos(θ)",
                    "Calculate sin(θ) and cos(θ) separately, then divide the results",
                    "Take the sine of θ divided by the cosine of θ"
                ],
                correct: 2,
                explanation: "Calculate sin(θ) and cos(θ) SEPARATELY first, then divide those two numbers. Don't put cos(θ) inside the sine function!",
                mistake: "Order of operations error"
            },
            {
                question: "If sin(30°) = 0.5, what is sin(60°)?",
                options: [
                    "1.0 (double of 30°)",
                    "2 × 0.5 = 1.0",
                    "≈ 0.866 (must calculate separately)",
                    "0.25 (half of 30°)"
                ],
                correct: 2,
                explanation: "Doubling the angle does NOT double the sine value! sin(60°) ≈ 0.866, not 1.0.",
                mistake: "Thinking trig functions are linear"
            },
            {
                question: "Using SOH-CAH-TOA, if you're finding the height of a building and the angle is measured from the ground up, which ratio do you use?",
                options: [
                    "Opposite/Hypotenuse (sine) - always",
                    "Adjacent/Hypotenuse (cosine) - always",
                    "Depends on what you know and what's opposite/adjacent to YOUR angle",
                    "Opposite/Adjacent (tangent) - always"
                ],
                correct: 2,
                explanation: "It DEPENDS on your setup! 'Opposite' and 'adjacent' are relative to the angle YOU'RE working with. Always draw a diagram!",
                mistake: "Not identifying sides relative to the specific angle"
            },
            {
                question: "Which identity is WRONG?",
                options: [
                    "sin²θ + cos²θ = 1",
                    "tan²θ + 1 = sec²θ",
                    "1 + cot²θ = csc²θ",
                    "sin²θ - cos²θ = 1"
                ],
                correct: 3,
                explanation: "The last one is wrong! It should be sin²θ + cos²θ = 1 (addition, not subtraction).",
                mistake: "Sign errors in identities"
            }
        ];

        let mistakeQuizIndex = 0;
        let mistakeCorrect = 0;
        let mistakeTotal = 0;

        function loadMistakeQuiz() {
            mistakeQuizIndex = 0;
            mistakeCorrect = 0;
            mistakeTotal = 0;
            
            document.getElementById('mistakeQuiz').innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 15px; margin-top: 20px; border: 2px solid #5a67d8;">
                    <h3 style="color: #5a67d8; margin-bottom: 20px;">⚠️ Common Mistakes Quiz</h3>
                    <div id="mistakeQuestion"></div>
                    <div style="margin-top: 20px; text-align: center;">
                        <strong>Score: <span id="mistakeScore">0/0</span></strong>
                    </div>
                </div>
            `;
            
            loadMistakeQuestion();
        }

        function loadMistakeQuestion() {
            if (mistakeQuizIndex >= mistakeQuestions.length) {
                const percentage = mistakeTotal > 0 ? Math.round((mistakeCorrect / mistakeTotal) * 100) : 0;
                document.getElementById('mistakeQuestion').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h3 style="color: #5a67d8; font-size: 2em;">🎉 Quiz Complete!</h3>
                        <div class="angle-display" style="margin: 30px auto; max-width: 400px;">
                            <div style="font-size: 1.5em; margin: 10px 0;">Final Score: <strong>${percentage}%</strong></div>
                            <div style="font-size: 1.2em; margin: 10px 0;">Correct: ${mistakeCorrect} / ${mistakeTotal}</div>
                        </div>
                        <button class="next-btn" onclick="loadMistakeQuiz()">Take Quiz Again</button>
                        <p style="margin-top: 20px; color: #666;">Review the mistakes above to improve your score!</p>
                    </div>
                `;
                return;
            }

            const q = mistakeQuestions[mistakeQuizIndex];
            document.getElementById('mistakeQuestion').innerHTML = `
                <div class="mistake-card" style="background: white; border: 2px solid #cbd5e0;">
                    <h4 style="color: #5a67d8;">Question ${mistakeQuizIndex + 1} of ${mistakeQuestions.length}</h4>
                    <p style="font-size: 1.2em; margin: 20px 0;">${q.question}</p>
                    <div class="options">
                        ${q.options.map((opt, i) => `
                            <button class="option-btn" onclick="checkMistakeAnswer(${i})">${opt}</button>
                        `).join('')}
                    </div>
                    <div id="mistakeFeedback"></div>
                </div>
            `;
        }

        function checkMistakeAnswer(selected) {
            const q = mistakeQuestions[mistakeQuizIndex];
            const options = document.querySelectorAll('#mistakeQuestion .option-btn');
            const feedback = document.getElementById('mistakeFeedback');
            
            mistakeTotal++;
            
            options.forEach((btn, i) => {
                btn.disabled = true;
                if (i === q.correct) {
                    btn.classList.add('correct');
                } else if (i === selected) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (selected === q.correct) {
                mistakeCorrect++;
                feedback.innerHTML = `
                    <div class="feedback correct">
                        ✅ Correct! ${q.explanation}
                        <div style="margin-top: 10px; padding: 10px; background: #e6f7ff; border-radius: 5px;">
                            <strong>Common Mistake:</strong> ${q.mistake}
                        </div>
                    </div>
                    <button class="next-btn" onclick="nextMistakeQuestion()">Next Question →</button>
                `;
            } else {
                feedback.innerHTML = `
                    <div class="feedback incorrect">
                        ❌ Not quite! ${q.explanation}
                        <div style="margin-top: 10px; padding: 10px; background: #fff5e6; border-radius: 5px;">
                            <strong>This is a common mistake:</strong> ${q.mistake}
                        </div>
                    </div>
                    <button class="next-btn" onclick="nextMistakeQuestion()">Next Question →</button>
                `;
            }
            
            document.getElementById('mistakeScore').textContent = `${mistakeCorrect}/${mistakeTotal}`;
        }

        function nextMistakeQuestion() {
            mistakeQuizIndex++;
            loadMistakeQuestion();
        }

        // Application Demos
        function loadApplicationDemo(type) {
            document.querySelectorAll('.problem-selector .problem-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const demos = {
                solar: `
                    <h4>☀️ Solar Panel Optimal Angle Calculator</h4>
                    <p>Calculate the best angle for solar panels based on your latitude.</p>
                    <div class="input-field">
                        <label>Your Latitude (degrees):</label>
                        <input type="number" id="latitude" value="40" min="-90" max="90" oninput="calculateSolar()">
                    </div>
                    <div class="input-field">
                        <label>Season:</label>
                        <select id="season" onchange="calculateSolar()">
                            <option value="year">Year-Round</option>
                            <option value="summer">Summer</option>
                            <option value="winter">Winter</option>
                        </select>
                    </div>
                    <div class="result-panel" style="margin-top: 20px;">
                        <h4>Optimal Tilt Angle</h4>
                        <div class="result-item">
                            <span class="result-label">Recommended Angle:</span>
                            <span class="result-value"><span id="solarAngle">40</span>°</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Incident Power:</span>
                            <span class="result-value"><span id="solarPower">100</span>%</span>
                        </div>
                    </div>
                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>Formula:</strong> Optimal angle ≈ Latitude + seasonal adjustment<br>
                        Summer: Latitude - 15°, Winter: Latitude + 15°
                    </div>
                `,
                basketball: `
                    <h4>🏀 Basketball Shot Calculator</h4>
                    <p>Calculate the optimal angle and velocity for a free throw.</p>
                    <div class="input-field">
                        <label>Distance to Hoop (meters):</label>
                        <input type="number" id="bbDistance" value="4.6" step="0.1" oninput="calculateBasketball()">
                    </div>
                    <div class="input-field">
                        <label>Launch Velocity (m/s):</label>
                        <input type="number" id="bbVelocity" value="7.2" step="0.1" oninput="calculateBasketball()">
                    </div>
                    <div class="input-field">
                        <label>Release Height (meters):</label>
                        <input type="number" id="bbHeight" value="2.1" step="0.1" oninput="calculateBasketball()">
                    </div>
                    <div class="result-panel" style="margin-top: 20px;">
                        <h4>Shot Analysis</h4>
                        <div class="result-item">
                            <span class="result-label">Launch Angle:</span>
                            <span class="result-value"><span id="bbAngle">49.0</span>°</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Peak Height:</span>
                            <span class="result-value"><span id="bbPeak">3.5</span> m</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Entry Angle:</span>
                            <span class="result-value"><span id="bbEntry">45</span>°</span>
                        </div>
                    </div>
                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>Physics:</strong> Using projectile motion equations with gravity g = 9.81 m/s²<br>
                        Optimal entry angle is 45-52° for highest success rate
                    </div>
                `,
                bridge: `
                    <h4>🌉 Suspension Bridge Cable Tension</h4>
                    <p>Calculate the tension in bridge support cables.</p>
                    <div class="input-field">
                        <label>Cable Length (meters):</label>
                        <input type="number" id="cableLength" value="50" oninput="calculateBridge()">
                    </div>
                    <div class="input-field">
                        <label>Vertical Drop (meters):</label>
                        <input type="number" id="cableDrop" value="5" oninput="calculateBridge()">
                    </div>
                    <div class="input-field">
                        <label>Load per meter (kN):</label>
                        <input type="number" id="cableLoad" value="10" oninput="calculateBridge()">
                    </div>
                    <div class="result-panel" style="margin-top: 20px;">
                        <h4>Cable Analysis</h4>
                        <div class="result-item">
                            <span class="result-label">Cable Angle:</span>
                            <span class="result-value"><span id="bridgeAngle">11.5</span>°</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Horizontal Tension:</span>
                            <span class="result-value"><span id="bridgeTensionH">490</span> kN</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Total Tension:</span>
                            <span class="result-value"><span id="bridgeTensionT">500</span> kN</span>
                        </div>
                    </div>
                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>Engineering:</strong> Uses θ = arctan(drop/length) and T = Load/sin(θ)<br>
                        Critical for structural safety calculations
                    </div>
                `,
                radio: `
                    <h4>📻 Radio Wave Frequency & Wavelength</h4>
                    <p>Calculate wavelength and properties of radio waves.</p>
                    <div class="input-field">
                        <label>Frequency (MHz):</label>
                        <input type="number" id="radioFreq" value="100" step="0.1" oninput="calculateRadio()">
                    </div>
                    <div class="result-panel" style="margin-top: 20px;">
                        <h4>Wave Properties</h4>
                        <div class="result-item">
                            <span class="result-label">Wavelength:</span>
                            <span class="result-value"><span id="radioWave">3.00</span> m</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Period:</span>
                            <span class="result-value"><span id="radioPeriod">10.0</span> ns</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Band:</span>
                            <span class="result-value" id="radioBand">FM Radio</span>
                        </div>
                    </div>
                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>Physics:</strong> λ = c/f where c = 3×10⁸ m/s (speed of light)<br>
                        Radio waves are sine waves: E(x,t) = E₀·sin(2πx/λ - 2πft)
                    </div>
                `
            };
            
            document.getElementById('applicationDemo').innerHTML = demos[type] || demos.solar;
            
            // Calculate initial values
            setTimeout(() => {
                switch(type) {
                    case 'solar': calculateSolar(); break;
                    case 'basketball': calculateBasketball(); break;
                    case 'bridge': calculateBridge(); break;
                    case 'radio': calculateRadio(); break;
                }
            }, 100);
        }

        function calculateSolar() {
            const lat = parseFloat(document.getElementById('latitude').value);
            const season = document.getElementById('season').value;
            
            let angle = lat;
            if (season === 'summer') angle = lat - 15;
            if (season === 'winter') angle = lat + 15;
            
            // Clamp to reasonable range
            angle = Math.max(-15, Math.min(75, angle));
            
            // Calculate relative power (simplified)
            const optimalAngle = lat;
            const deviation = Math.abs(angle - optimalAngle);
            const power = 100 * Math.cos(deviation * Math.PI / 180);
            
            document.getElementById('solarAngle').textContent = angle.toFixed(1);
            document.getElementById('solarPower').textContent = power.toFixed(1);
        }

        function calculateBasketball() {
            const distance = parseFloat(document.getElementById('bbDistance').value);
            const velocity = parseFloat(document.getElementById('bbVelocity').value);
            const releaseHeight = parseFloat(document.getElementById('bbHeight').value);
            const g = 9.81;
            const hoopHeight = 3.05; // NBA hoop height
            
            // Calculate launch angle (simplified)
            const heightDiff = hoopHeight - releaseHeight;
            const angle = Math.atan2(heightDiff + (g * distance * distance)/(2 * velocity * velocity), distance);
            const angleDeg = angle * 180 / Math.PI;
            
            // Calculate peak height
            const vy = velocity * Math.sin(angle);
            const peakHeight = releaseHeight + (vy * vy) / (2 * g);
            
            // Calculate entry angle (approximate)
            const timeToHoop = distance / (velocity * Math.cos(angle));
            const vyAtHoop = vy - g * timeToHoop;
            const entryAngle = Math.abs(Math.atan2(vyAtHoop, velocity * Math.cos(angle)) * 180 / Math.PI);
            
            document.getElementById('bbAngle').textContent = angleDeg.toFixed(1);
            document.getElementById('bbPeak').textContent = peakHeight.toFixed(1);
            document.getElementById('bbEntry').textContent = entryAngle.toFixed(0);
        }

        function calculateBridge() {
            const length = parseFloat(document.getElementById('cableLength').value);
            const drop = parseFloat(document.getElementById('cableDrop').value);
            const load = parseFloat(document.getElementById('cableLoad').value);
            
            // Calculate angle
            const angle = Math.atan2(drop, length);
            const angleDeg = angle * 180 / Math.PI;
            
            // Calculate tensions (simplified)
            const totalLoad = load * length;
            const tensionH = totalLoad * Math.cos(angle);
            const tensionT = totalLoad / Math.sin(Math.max(angle, 0.1));
            
            document.getElementById('bridgeAngle').textContent = angleDeg.toFixed(1);
            document.getElementById('bridgeTensionH').textContent = tensionH.toFixed(0);
            document.getElementById('bridgeTensionT').textContent = Math.min(tensionT, 9999).toFixed(0);
        }

        function calculateRadio() {
            const freqMHz = parseFloat(document.getElementById('radioFreq').value);
            const freqHz = freqMHz * 1e6;
            const c = 3e8; // speed of light
            
            const wavelength = c / freqHz;
            const period = 1 / freqHz * 1e9; // in nanoseconds
            
            // Determine band
            let band = '';
            if (freqMHz < 0.535) band = 'Long Wave';
            else if (freqMHz < 1.705) band = 'AM Radio';
            else if (freqMHz < 30) band = 'Shortwave';
            else if (freqMHz < 88) band = 'VHF';
            else if (freqMHz < 108) band = 'FM Radio';
            else if (freqMHz < 300) band = 'VHF TV';
            else if (freqMHz < 3000) band = 'UHF';
            else band = 'Microwave';
            
            document.getElementById('radioWave').textContent = wavelength.toFixed(2);
            document.getElementById('radioPeriod').textContent = period.toFixed(1);
            document.getElementById('radioBand').textContent = band;
        }

        // Initialize on load
        window.onload = function() {
            loadProgress();
            drawUnitCircle(0);
            updateWave();
            drawPythagoreanProof();
            updateExplorer();
        };
    </script>
</body>
</html>