<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Management - Interactive Security Learning Module</title>
    <style>
        :root {
            /* WCAG AA Compliant Color Palette */
            --primary: #1a365d;
            --primary-light: #2c5282;
            --secondary: #2d3748;
            --accent: #2b6cb0;
            --accent-hover: #1e4e8c;
            --success: #276749;
            --success-bg: #c6f6d5;
            --warning: #c05621;
            --warning-bg: #feebc8;
            --danger: #c53030;
            --danger-bg: #fed7d7;
            --bg-light: #f7fafc;
            --bg-white: #ffffff;
            --text-dark: #1a202c;
            --text-muted: #4a5568;
            --border: #cbd5e0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --radius: 8px;
            --transition: all 0.3s ease;
            --focus-ring: 0 0 0 3px rgba(43, 108, 176, 0.5);
            --focus-ring-inset: inset 0 0 0 3px rgba(43, 108, 176, 0.5);
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.7;
            font-size: 16px;
        }

        /* Skip Link */
        .skip-link {
            position: absolute;
            top: -50px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 0.75rem 1.5rem;
            z-index: 10000;
            text-decoration: none;
            font-weight: 600;
            border-radius: 0 0 var(--radius) 0;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        /* Global Focus Styles */
        *:focus {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        *:focus:not(:focus-visible) {
            outline: none;
        }

        *:focus-visible {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        /* Keyboard Navigation Help */
        .keyboard-help {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .keyboard-help-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 0.9rem;
            box-shadow: var(--shadow-lg);
        }

        .keyboard-help-btn:hover {
            background: var(--primary-light);
        }

        .keyboard-help-panel {
            display: none;
            position: absolute;
            bottom: 50px;
            right: 0;
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.25rem;
            width: 320px;
            box-shadow: var(--shadow-lg);
        }

        .keyboard-help-panel.show {
            display: block;
        }

        .keyboard-help-panel h3 {
            margin-bottom: 0.75rem;
            color: var(--primary);
            font-size: 1rem;
        }

        .keyboard-help-panel dl {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .keyboard-help-panel dt {
            font-weight: 600;
        }

        .keyboard-help-panel kbd {
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 0.1rem 0.4rem;
            font-family: monospace;
            font-size: 0.85rem;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .header p {
            font-size: 1rem;
        }

        .cert-badge {
            display: inline-block;
            background: rgba(255,255,255,0.25);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-white);
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .progress-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }

        .progress-bar {
            background: var(--border);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #276749 0%, #2b6cb0 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        /* Navigation */
        .nav-container {
            background: var(--bg-white);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .nav-tabs {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
            list-style: none;
            min-width: max-content;
        }

        .nav-tab {
            padding: 1rem 1.25rem;
            border: none;
            background: transparent;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            white-space: nowrap;
            font-size: 0.9rem;
            font-family: inherit;
            color: var(--text-muted);
        }

        .nav-tab:hover {
            background: var(--bg-light);
            color: var(--accent);
        }

        .nav-tab:focus {
            outline: none;
            box-shadow: var(--focus-ring-inset);
            background: var(--bg-light);
        }

        .nav-tab[aria-selected="true"] {
            border-bottom-color: var(--accent);
            color: var(--accent);
            font-weight: 600;
        }

        .nav-tab .completed-icon {
            color: var(--success);
            margin-left: 0.25rem;
        }

        /* Screen Reader Only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section:focus {
            outline: none;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--bg-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .card-header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 1.25rem 1.5rem;
        }

        .card-header h2 {
            font-size: 1.25rem;
            margin: 0;
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Tooltip System */
        .tooltip-term {
            color: var(--accent);
            border: none;
            border-bottom: 2px dotted var(--accent);
            cursor: help;
            position: relative;
            font-weight: 600;
            background: none;
            padding: 0;
            font-size: inherit;
            font-family: inherit;
        }

        .tooltip-term:focus {
            outline: none;
            box-shadow: var(--focus-ring);
            border-radius: 2px;
        }

        .tooltip-popup {
            display: none;
            position: fixed;
            background: var(--secondary);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            font-size: 0.9rem;
            width: 300px;
            max-width: calc(100vw - 32px);
            z-index: 10001;
            box-shadow: var(--shadow-lg);
            line-height: 1.5;
            font-weight: 400;
            pointer-events: none;
        }

        .tooltip-popup.visible {
            display: block;
        }

        .tooltip-popup::after {
            content: '';
            position: absolute;
            border: 8px solid transparent;
            border-top-color: var(--secondary);
            top: 100%;
            left: var(--arrow-left, 50%);
            transform: translateX(-50%);
        }

        /* Concepts Grid */
        .concepts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.25rem;
            margin: 1.5rem 0;
        }

        .concept-card {
            background: var(--bg-light);
            border-radius: var(--radius);
            padding: 1.25rem;
            border-left: 4px solid var(--accent);
            transition: var(--transition);
        }

        .concept-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .concept-card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .concept-card p {
            font-size: 0.95rem;
            color: var(--text-dark);
        }

        /* Accordion */
        .accordion {
            margin: 1rem 0;
        }

        .accordion-item {
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .accordion-header {
            width: 100%;
            background: var(--bg-light);
            padding: 1rem 1.25rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            font-weight: 500;
            border: none;
            font-size: 1rem;
            font-family: inherit;
            color: var(--text-dark);
            text-align: left;
        }

        .accordion-header:hover {
            background: var(--border);
        }

        .accordion-header:focus {
            outline: none;
            box-shadow: var(--focus-ring-inset);
        }

        .accordion-header[aria-expanded="true"] {
            background: var(--accent);
            color: white;
        }

        .accordion-icon {
            transition: transform 0.3s ease;
            font-size: 0.8rem;
        }

        .accordion-header[aria-expanded="true"] .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            padding: 1.25rem;
            background: var(--bg-white);
            border-top: 1px solid var(--border);
        }

        /* Tables - High Contrast Design */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 1rem 0;
            border-radius: var(--radius);
            border: 2px solid var(--primary);
        }

        .table-wrapper:focus {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 500px;
            font-size: 0.95rem;
            background: #ffffff;
        }

        .comparison-table caption {
            font-weight: 600;
            text-align: left;
            padding: 0.75rem 1rem;
            color: var(--primary);
            background: #ffffff;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 0.875rem 1rem;
            text-align: left;
            border: 1px solid #cbd5e0;
            color: #1a202c;
        }

        .comparison-table th {
            background: #1a365d;
            color: #ffffff;
            font-weight: 600;
            border-color: #1a365d;
        }

        .comparison-table tbody tr {
            background: #ffffff;
        }

        .comparison-table tbody tr:nth-child(odd) {
            background: #ffffff;
        }

        .comparison-table tbody tr:nth-child(even) {
            background: #f0f4f8;
        }

        .comparison-table tbody td {
            background: inherit;
            color: #1a202c;
        }

        .comparison-table tbody tr:hover {
            background: #e2e8f0;
        }

        .comparison-table tbody tr:hover td {
            background: inherit;
        }

        /* Info Boxes */
        .info-box {
            padding: 1rem 1.25rem;
            border-radius: var(--radius);
            margin: 1rem 0;
            display: flex;
            gap: 0.75rem;
            align-items: flex-start;
        }

        .info-box.tip {
            background: #dbeafe;
            border-left: 4px solid var(--accent);
        }

        .info-box.warning {
            background: var(--warning-bg);
            border-left: 4px solid var(--warning);
        }

        .info-box.important {
            background: var(--danger-bg);
            border-left: 4px solid var(--danger);
        }

        .info-box.success {
            background: var(--success-bg);
            border-left: 4px solid var(--success);
        }

        .info-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        /* Diagram Box */
        .diagram-box {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
        }

        .flow-diagram {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }

        .flow-step {
            background: var(--accent);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .flow-arrow {
            color: var(--text-dark);
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Scenario Box */
        .scenario-box {
            background: linear-gradient(135deg, #2d3748 0%, #1a365d 100%);
            color: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .scenario-box h4 {
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
            color: #ffffff;
        }

        .scenario-box .scenario-content {
            background: rgba(255,255,255,0.95);
            color: #1a202c;
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 0.75rem;
        }

        .scenario-box .scenario-question {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .scenario-box ul.styled-list {
            margin: 0.5rem 0;
            padding-left: 1.25rem;
            color: #1a202c;
        }

        .scenario-box ul.styled-list li {
            color: #1a202c;
        }

        /* Tables inside scenario boxes - high contrast */
        .scenario-box table {
            background: #ffffff;
            margin: 1rem 0;
            border-radius: var(--radius);
            overflow: hidden;
            width: 100%;
            border-collapse: collapse;
        }

        .scenario-box th,
        .scenario-box td {
            padding: 0.625rem 0.875rem;
            border: 1px solid #cbd5e0;
            color: #1a202c;
            background: #ffffff;
        }

        .scenario-box thead th {
            background: #1a365d;
            color: #ffffff;
            border-color: #1a365d;
            font-weight: 600;
        }

        .scenario-box tbody tr:nth-child(even) td {
            background: #f0f4f8;
        }

        .scenario-box tbody tr:hover td {
            background: #e2e8f0;
        }

        /* Accordion content headings */
        .accordion-content h5 {
            font-size: 1.1rem;
            color: var(--primary);
            margin: 1.5rem 0 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .accordion-content h6 {
            font-size: 1rem;
            color: var(--primary-light);
            margin: 0 0 0.5rem;
        }

        /* Example text in concept cards */
        .example-text {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px dashed var(--border);
        }

        /* Model Cards */
        .model-card {
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        .model-card:hover,
        .model-card:focus-within {
            border-color: var(--accent);
            box-shadow: var(--shadow);
        }

        .model-card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .model-tag {
            font-size: 0.75rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
        }

        .model-tag.restrictive {
            background: var(--danger-bg);
            color: var(--danger);
        }

        .model-tag.flexible {
            background: var(--success-bg);
            color: var(--success);
        }

        .model-tag.moderate {
            background: var(--warning-bg);
            color: var(--warning);
        }

        /* Exam Tips */
        .exam-tip {
            background: linear-gradient(135deg, #2b6cb0 0%, #2c5282 100%);
            color: white;
            padding: 1.25rem;
            border-radius: var(--radius);
            margin: 1rem 0;
        }

        .exam-tip h4 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Quiz Styles */
        .quiz-container {
            background: var(--bg-light);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .quiz-question {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
            border: none;
        }

        .quiz-question:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .quiz-question legend h4 {
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quiz-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .quiz-option:hover {
            border-color: var(--accent);
            background: #dbeafe;
        }

        .quiz-option:focus-within {
            box-shadow: var(--focus-ring);
            border-color: var(--accent);
        }

        .quiz-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: var(--success-bg);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: var(--danger-bg);
        }

        .quiz-feedback {
            margin-top: 0.75rem;
            padding: 0.75rem;
            border-radius: var(--radius);
            font-size: 0.95rem;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: var(--success-bg);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .quiz-feedback.incorrect {
            background: var(--danger-bg);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.95rem;
            font-family: inherit;
        }

        .btn:focus {
            outline: none;
            box-shadow: var(--focus-ring);
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: var(--text-dark);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }

        /* Lists */
        ul.styled-list {
            list-style: none;
            padding: 0;
        }

        ul.styled-list li {
            padding: 0.5rem 0 0.5rem 1.5rem;
            position: relative;
        }

        ul.styled-list li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: var(--accent);
            font-weight: bold;
        }

        /* Live Region */
        .live-region {
            position: absolute;
            left: -10000px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        /* Footer */
        .footer {
            background: var(--primary);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
        }

        .footer p {
            font-size: 0.9rem;
        }

        /* High Contrast Mode */
        @media (prefers-contrast: high) {
            :root {
                --border: #000000;
                --text-muted: #000000;
            }
            .card, .concept-card, .accordion-item, .quiz-option {
                border-width: 2px;
            }
            .comparison-table,
            .comparison-table th,
            .comparison-table td {
                border: 2px solid #000000;
            }
            .comparison-table th {
                background: #000000;
                color: #ffffff;
            }
            .comparison-table tbody tr:nth-child(even) {
                background: #e2e2e2;
            }
            .scenario-box {
                background: #000000;
            }
            .scenario-box table,
            .scenario-box th,
            .scenario-box td {
                border: 2px solid #000000;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }
            .nav-tab {
                padding: 0.75rem 1rem;
                font-size: 0.85rem;
            }
            .comparison-table {
                font-size: 0.85rem;
            }
            .comparison-table th,
            .comparison-table td {
                padding: 0.5rem;
            }
            .tooltip-popup {
                width: 250px;
                left: 0;
                transform: none;
            }
            .flow-diagram {
                flex-direction: column;
            }
            .flow-arrow {
                transform: rotate(90deg);
            }
            .keyboard-help {
                bottom: 10px;
                right: 10px;
            }
            .keyboard-help-panel {
                width: 280px;
                right: -10px;
            }
        }

        /* Print */
        @media print {
            .header, .nav-container, .progress-container, .skip-link, .keyboard-help {
                position: static;
            }
            .section {
                display: block !important;
                page-break-after: always;
            }
            .tooltip-popup, .btn-group {
                display: none !important;
            }
            /* Ensure tables are readable when printed */
            .comparison-table,
            .scenario-box table {
                border: 2px solid #000000;
            }
            .comparison-table th,
            .comparison-table td,
            .scenario-box th,
            .scenario-box td {
                border: 1px solid #000000;
                color: #000000;
                background: #ffffff !important;
                -webkit-print-color-adjust: exact;
            }
            .comparison-table th,
            .scenario-box th {
                background: #e2e8f0 !important;
                font-weight: 700;
            }
            .comparison-table tbody tr:nth-child(even) td {
                background: #f5f5f5 !important;
            }
            .scenario-box {
                background: #ffffff !important;
                border: 2px solid #1a365d;
                color: #000000;
            }
            .scenario-box h4 {
                color: #1a365d;
            }
        }
    </style>
</head>
<body>
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Live Region -->
    <div id="liveRegion" class="live-region" aria-live="polite" aria-atomic="true"></div>

    <!-- Keyboard Help -->
    <div class="keyboard-help">
        <button class="keyboard-help-btn" onclick="toggleKeyboardHelp()" aria-expanded="false" aria-controls="keyboardPanel">
            <span aria-hidden="true">‚å®Ô∏è</span> Keyboard Help
        </button>
        <div class="keyboard-help-panel" id="keyboardPanel" role="dialog" aria-label="Keyboard shortcuts">
            <h3>Keyboard Navigation</h3>
            <dl>
                <dt><kbd>Tab</kbd></dt>
                <dd>Move to next element</dd>
                <dt><kbd>Shift+Tab</kbd></dt>
                <dd>Move to previous element</dd>
                <dt><kbd>‚Üê</kbd> <kbd>‚Üí</kbd></dt>
                <dd>Navigate between tabs</dd>
                <dt><kbd>Enter</kbd></dt>
                <dd>Activate button/link</dd>
                <dt><kbd>Space</kbd></dt>
                <dd>Toggle accordion/select option</dd>
                <dt><kbd>Esc</kbd></dt>
                <dd>Close tooltip/dialog</dd>
                <dt><kbd>Home</kbd></dt>
                <dd>Go to first tab</dd>
                <dt><kbd>End</kbd></dt>
                <dd>Go to last tab</dd>
            </dl>
        </div>
    </div>

    <header class="header" role="banner">
        <h1><span aria-hidden="true">üîê</span> Access Management</h1>
        <p>Interactive Security Learning Module</p>
        <span class="cert-badge"><span aria-hidden="true">üìú</span> CompTIA Security+ Aligned</span>
    </header>

    <div class="progress-container">
        <div class="progress-wrapper">
            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Course progress" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <p class="progress-text"><span id="progressText">0</span>% Complete</p>
        </div>
    </div>

    <nav class="nav-container" aria-label="Module sections">
        <div role="tablist" class="nav-tabs" id="navTabs" aria-label="Module navigation">
            <button role="tab" class="nav-tab" data-section="intro" aria-selected="true" aria-controls="intro" id="tab-intro" tabindex="0" onclick="navigateTo('intro')" onkeydown="handleTabKey(event, 0)">Introduction</button>
            <button role="tab" class="nav-tab" data-section="models" aria-selected="false" aria-controls="models" id="tab-models" tabindex="-1" onclick="navigateTo('models')" onkeydown="handleTabKey(event, 1)">Access Models</button>
            <button role="tab" class="nav-tab" data-section="account" aria-selected="false" aria-controls="account" id="tab-account" tabindex="-1" onclick="navigateTo('account')" onkeydown="handleTabKey(event, 2)">Account Management</button>
            <button role="tab" class="nav-tab" data-section="bestpractices" aria-selected="false" aria-controls="bestpractices" id="tab-bestpractices" tabindex="-1" onclick="navigateTo('bestpractices')" onkeydown="handleTabKey(event, 3)">Best Practices</button>
            <button role="tab" class="nav-tab" data-section="implementation" aria-selected="false" aria-controls="implementation" id="tab-implementation" tabindex="-1" onclick="navigateTo('implementation')" onkeydown="handleTabKey(event, 4)">Implementation</button>
            <button role="tab" class="nav-tab" data-section="services" aria-selected="false" aria-controls="services" id="tab-services" tabindex="-1" onclick="navigateTo('services')" onkeydown="handleTabKey(event, 5)">IAM Services</button>
            <button role="tab" class="nav-tab" data-section="federation" aria-selected="false" aria-controls="federation" id="tab-federation" tabindex="-1" onclick="navigateTo('federation')" onkeydown="handleTabKey(event, 6)">Federation &amp; SSO</button>
            <button role="tab" class="nav-tab" data-section="zerotrust" aria-selected="false" aria-controls="zerotrust" id="tab-zerotrust" tabindex="-1" onclick="navigateTo('zerotrust')" onkeydown="handleTabKey(event, 7)">Zero Trust</button>
            <button role="tab" class="nav-tab" data-section="quiz" aria-selected="false" aria-controls="quiz" id="tab-quiz" tabindex="-1" onclick="navigateTo('quiz')" onkeydown="handleTabKey(event, 8)">Assessment</button>
        </div>
    </nav>

    <main class="main-content" id="main-content" tabindex="-1">
        
        <!-- ==================== SECTION 1: INTRODUCTION ==================== -->
        <section class="section active" id="intro" role="tabpanel" aria-labelledby="tab-intro">
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üéØ</span> Learning Objectives</h2>
                </div>
                <div class="card-body">
                    <p>After completing this module, you will be able to:</p>
                    <ul class="styled-list">
                        <li>Define access management and explain its role in information security</li>
                        <li>Compare and contrast the five major access control models</li>
                        <li>Describe account management lifecycle including provisioning and deprovisioning</li>
                        <li>Apply best practices for implementing access control in enterprise environments</li>
                        <li>Explain identity and access services including RADIUS, Kerberos, LDAP, and SAML</li>
                        <li>Understand federation, Single Sign-On (SSO), and OAuth/OpenID Connect</li>
                        <li>Describe Zero Trust Architecture principles and implementation</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìö</span> What is Access Control?</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Access Control
                            <span class="tooltip-popup" role="tooltip">The process of granting or denying approval to use specific resources. It ensures that only authorized users can access protected systems and data.</span>
                        </button>
                        is the fundamental security mechanism that grants or denies approval to use specific resources. It forms the cornerstone of information security by ensuring that only authorized entities can interact with protected assets.
                    </p>

                    <div class="concepts-grid">
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üö™</span> Physical Access Control</h4>
                            <p>Tangible barriers and mechanisms that limit physical contact with systems and facilities, including fencing, hardware locks, badge readers, and 
                                <button class="tooltip-term" type="button">
                                    mantraps
                                    <span class="tooltip-popup" role="tooltip">A physical security access control system comprising a small space with two sets of interlocking doors. Only one door can be open at a time, preventing tailgating.</span>
                                </button>.
                            </p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üíª</span> Technical Access Control</h4>
                            <p>Technology-based restrictions that limit users from accessing data on computer systems, including authentication mechanisms, encryption, and access control lists.</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üìã</span> Administrative Access Control</h4>
                            <p>Policies, procedures, and guidelines that govern access decisions, including security policies, background checks, and security awareness training.</p>
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üè¢</span> Real-World Scenario: Hospital Data Center</h4>
                        <p>Memorial Hospital needs to protect patient records in their data center. They implement all three control types:</p>
                        <div class="scenario-content">
                            <p><strong>Physical:</strong> Biometric door locks, security cameras, mantrap entrance</p>
                            <p><strong>Technical:</strong> Encrypted databases, role-based access to EMR system, audit logging</p>
                            <p><strong>Administrative:</strong> HIPAA compliance training, background checks, acceptable use policy</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîë</span> The IAAA Framework</h2>
                </div>
                <div class="card-body">
                    <p>Access control relies on four fundamental processes:</p>

                    <div class="diagram-box" role="figure" aria-label="IAAA Process Flow">
                        <div class="flow-diagram">
                            <div class="flow-step">1. Identification</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">2. Authentication</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">3. Authorization</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">4. Accounting</div>
                        </div>
                    </div>

                    <div class="accordion" id="iaaaAccordion">
                        <div class="accordion-item">
                            <button class="accordion-header" aria-expanded="false" aria-controls="acc-id" id="btn-acc-id" type="button">
                                <span><span aria-hidden="true">ü™™</span> Identification - "Who are you?"</span>
                                <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                            </button>
                            <div class="accordion-content" id="acc-id" hidden>
                                <p><strong>Identification</strong> is the process of presenting credentials to claim an identity.</p>
                                <p><strong>Examples:</strong> Username, employee badge, email address</p>
                                <p><strong>Key Point:</strong> Identification alone does NOT prove identity‚Äîit simply makes a claim that must be verified.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-header" aria-expanded="false" aria-controls="acc-authn" id="btn-acc-authn" type="button">
                                <span><span aria-hidden="true">‚úÖ</span> Authentication - "Prove it!"</span>
                                <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                            </button>
                            <div class="accordion-content" id="acc-authn" hidden>
                                <p><strong>Authentication</strong> validates that credentials are genuine.</p>
                                <p><strong>Authentication Factors:</strong></p>
                                <ul class="styled-list">
                                    <li><strong>Something you know</strong> - Passwords, PINs, security questions</li>
                                    <li><strong>Something you have</strong> - Smart cards, tokens, mobile devices</li>
                                    <li><strong>Something you are</strong> - Fingerprints, facial recognition, iris scan</li>
                                    <li><strong>Somewhere you are</strong> - GPS location, IP address</li>
                                    <li><strong>Something you do</strong> - Typing patterns, gait analysis</li>
                                </ul>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-header" aria-expanded="false" aria-controls="acc-authz" id="btn-acc-authz" type="button">
                                <span><span aria-hidden="true">üîì</span> Authorization - "What can you do?"</span>
                                <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                            </button>
                            <div class="accordion-content" id="acc-authz" hidden>
                                <p><strong>Authorization</strong> grants permission to perform specific actions or access resources after successful authentication.</p>
                                <p><strong>Key Distinction:</strong> You can be authenticated (proven who you are) but NOT authorized to access certain resources.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-header" aria-expanded="false" aria-controls="acc-acct" id="btn-acc-acct" type="button">
                                <span><span aria-hidden="true">üìä</span> Accounting - "What did you do?"</span>
                                <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                            </button>
                            <div class="accordion-content" id="acc-acct" hidden>
                                <p><strong>Accounting</strong> (Auditing) creates a record of user activities.</p>
                                <p><strong>Purposes:</strong></p>
                                <ul class="styled-list">
                                    <li>Security incident investigation and forensics</li>
                                    <li>Compliance and regulatory requirements</li>
                                    <li>Billing and resource usage tracking</li>
                                    <li>Detecting anomalous behavior patterns</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üí≥</span> Real-World Scenario: ATM Transaction</h4>
                        <div class="scenario-content">
                            <p><strong>Identification:</strong> Insert debit card (card number identifies account)</p>
                            <p><strong>Authentication:</strong> Enter PIN (proves you possess secret knowledge)</p>
                            <p><strong>Authorization:</strong> System checks if you can withdraw $200 (sufficient funds, daily limit)</p>
                            <p><strong>Accounting:</strong> Transaction logged with timestamp, amount, location</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üë•</span> Key Access Control Roles</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption class="sr-only">Access Control Roles and Responsibilities</caption>
                        <thead>
                            <tr>
                                <th scope="col">Role</th>
                                <th scope="col">Description</th>
                                <th scope="col">Responsibilities</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Subject</th>
                                <td>Active entity requesting access</td>
                                <td>Initiates access requests and operations</td>
                            </tr>
                            <tr>
                                <th scope="row">Object</th>
                                <td>Passive resource being accessed</td>
                                <td>Contains data or provides services</td>
                            </tr>
                            <tr>
                                <th scope="row">Owner</th>
                                <td>Person responsible for information</td>
                                <td>Determines security classification</td>
                            </tr>
                            <tr>
                                <th scope="row">Custodian</th>
                                <td>Delegated security manager</td>
                                <td>Implements and maintains controls</td>
                            </tr>
                            <tr>
                                <th scope="row">Privacy Officer</th>
                                <td>Oversees data privacy</td>
                                <td>Ensures compliance with privacy laws</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="markComplete('intro'); navigateTo('models')">
                    Continue to Access Models <span aria-hidden="true">‚Üí</span>
                </button>
            </div>
        </section>

        <!-- ==================== SECTION 2: ACCESS MODELS ==================== -->
        <section class="section" id="models" role="tabpanel" aria-labelledby="tab-models" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üèóÔ∏è</span> Access Control Models Overview</h2>
                </div>
                <div class="card-body">
                    <p>Access control models are standardized frameworks that define how permissions are granted and managed. Understanding these models is essential for implementing appropriate security controls.</p>
                    
                    <div class="exam-tip">
                        <h4><span aria-hidden="true">üìù</span> Security+ Exam Focus</h4>
                        <p>Be able to compare all five models, understand use cases, and identify which model fits given scenarios. Know key differences between DAC, MAC, and RBAC.</p>
                    </div>
                </div>
            </div>

            <!-- DAC -->
            <div class="model-card">
                <h4><span aria-hidden="true">üìÇ</span> Discretionary Access Control (DAC) <span class="model-tag flexible">Least Restrictive</span></h4>
                <p>
                    <button class="tooltip-term" type="button">
                        DAC
                        <span class="tooltip-popup" role="tooltip">An access control model where the owner of a resource has complete control over who can access it. Used in Windows, macOS, and Linux.</span>
                    </button>
                    gives resource owners complete control over access permissions.
                </p>
                
                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" aria-expanded="false" aria-controls="dac-details" type="button">
                            <span>View DAC Details</span>
                            <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                        </button>
                        <div class="accordion-content" id="dac-details" hidden>
                            <p><strong>Key Characteristics:</strong></p>
                            <ul class="styled-list">
                                <li>Every object has an owner who controls access</li>
                                <li>Owners can grant permissions to other subjects</li>
                                <li>Used in Windows, macOS, Linux, and most consumer OS</li>
                            </ul>
                            
                            <p><strong>Weaknesses:</strong></p>
                            <ul class="styled-list">
                                <li>Relies on users to set proper security (user error risk)</li>
                                <li>Programs inherit user's permissions (malware risk)</li>
                            </ul>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üìÅ</span> Real-World Scenario: Shared Drive Mistake</h4>
                                <p>Sarah, an HR manager, creates a spreadsheet with salary data. Using DAC in Windows, she accidentally shares the folder with "Everyone" instead of "HR Team." Now any employee can view confidential salary information until the mistake is discovered.</p>
                                <div class="scenario-content">
                                    <p class="scenario-question">How could this be prevented?</p>
                                    <p>Use group-based permissions, regular access audits, or a more restrictive model like RBAC.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MAC -->
            <div class="model-card">
                <h4><span aria-hidden="true">üîí</span> Mandatory Access Control (MAC) <span class="model-tag restrictive">Most Restrictive</span></h4>
                <p>
                    <button class="tooltip-term" type="button">
                        MAC
                        <span class="tooltip-popup" role="tooltip">A strict model where access decisions are made by a central authority based on security labels and clearances. Users cannot override these controls.</span>
                    </button>
                    enforces access through system-wide policies based on security labels.
                </p>
                
                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" aria-expanded="false" aria-controls="mac-details" type="button">
                            <span>View MAC Details</span>
                            <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                        </button>
                        <div class="accordion-content" id="mac-details" hidden>
                            <p><strong>Key Elements:</strong></p>
                            <ul class="styled-list">
                                <li><strong>Labels:</strong> Objects get classification labels (Top Secret, Secret, Confidential, Unclassified)</li>
                                <li><strong>Clearances:</strong> Subjects get privilege labels matching clearance level</li>
                                <li><strong>Levels:</strong> Hierarchical structure determines access eligibility</li>
                                <li><strong>Central Authority:</strong> Security administrators set all policies; users cannot change them</li>
                            </ul>

                            <div class="info-box tip">
                                <span aria-hidden="true">üí°</span>
                                <p><strong>Security+ Exam Tip:</strong> MAC is the <em>most restrictive</em> model because users have NO control over access decisions. The system enforces all policies automatically.</p>
                            </div>

                            <h5><span aria-hidden="true">üîê</span> Bell-LaPadula Model (Confidentiality)</h5>
                            <p>Developed for the U.S. Department of Defense to protect <strong>classified information</strong>. Focuses entirely on <strong>confidentiality</strong>‚Äîpreventing unauthorized disclosure.</p>
                            
                            <div class="concepts-grid">
                                <div class="concept-card">
                                    <h6>Simple Security Property</h6>
                                    <p><strong>"No Read Up"</strong></p>
                                    <p>A subject cannot read data at a higher classification level than their clearance.</p>
                                    <p class="example-text"><em>Example: A Secret-cleared analyst cannot read Top Secret documents.</em></p>
                                </div>
                                <div class="concept-card">
                                    <h6>Star Property (*-Property)</h6>
                                    <p><strong>"No Write Down"</strong></p>
                                    <p>A subject cannot write data to a lower classification level.</p>
                                    <p class="example-text"><em>Example: A Top Secret user cannot save classified data to an Unclassified folder.</em></p>
                                </div>
                            </div>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üèõÔ∏è</span> Real-World Scenario: Intelligence Agency</h4>
                                <p><strong>Situation:</strong> CIA analyst Sarah has Secret clearance. She needs information for a briefing.</p>
                                <div class="scenario-content">
                                    <p><strong>What she CAN do:</strong></p>
                                    <ul class="styled-list">
                                        <li>Read Unclassified documents ‚úì</li>
                                        <li>Read Confidential documents ‚úì</li>
                                        <li>Read Secret documents ‚úì</li>
                                        <li>Write to Secret or Top Secret systems ‚úì</li>
                                    </ul>
                                    <p><strong>What she CANNOT do:</strong></p>
                                    <ul class="styled-list">
                                        <li>Read Top Secret briefings ‚úó (no read up)</li>
                                        <li>Copy Secret data to Unclassified USB ‚úó (no write down)</li>
                                        <li>Email classified info to unclassified account ‚úó</li>
                                    </ul>
                                    <p class="scenario-question">Why "No Write Down"?</p>
                                    <p>Prevents data leakage. Even if Sarah accidentally (or intentionally) tries to declassify information, the system blocks it. This stops insider threats and Trojan horse attacks that try to exfiltrate data to lower security levels.</p>
                                </div>
                            </div>

                            <h5><span aria-hidden="true">üõ°Ô∏è</span> Biba Model (Integrity)</h5>
                            <p>The <strong>mathematical opposite</strong> of Bell-LaPadula. Focuses entirely on <strong>integrity</strong>‚Äîpreventing unauthorized modification of data.</p>
                            
                            <div class="concepts-grid">
                                <div class="concept-card">
                                    <h6>Simple Integrity Property</h6>
                                    <p><strong>"No Read Down"</strong></p>
                                    <p>A subject cannot read data at a lower integrity level (prevents contamination).</p>
                                    <p class="example-text"><em>Example: Critical system processes shouldn't read user-uploaded files.</em></p>
                                </div>
                                <div class="concept-card">
                                    <h6>Star Integrity Property</h6>
                                    <p><strong>"No Write Up"</strong></p>
                                    <p>A subject cannot write data to a higher integrity level.</p>
                                    <p class="example-text"><em>Example: Untrusted code cannot modify critical system files.</em></p>
                                </div>
                            </div>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üè¶</span> Real-World Scenario: Banking System</h4>
                                <p><strong>Situation:</strong> A bank uses Biba model to protect financial transaction integrity.</p>
                                <div class="scenario-content">
                                    <p><strong>Integrity Levels (High to Low):</strong></p>
                                    <ul class="styled-list">
                                        <li><strong>Critical:</strong> Core banking ledger, wire transfer system</li>
                                        <li><strong>Important:</strong> Customer account balances, transaction logs</li>
                                        <li><strong>Normal:</strong> Employee workstations, email</li>
                                        <li><strong>Untrusted:</strong> Customer-facing web inputs, uploaded documents</li>
                                    </ul>
                                    <p><strong>Protection in Action:</strong></p>
                                    <p>A web form (Untrusted level) collects a wire transfer request. The data cannot directly modify the core ledger (Critical level). Instead, it must pass through validation middleware that "elevates" verified transactions. This prevents SQL injection or malformed inputs from corrupting critical financial data.</p>
                                </div>
                            </div>

                            <div class="info-box warning">
                                <span aria-hidden="true">‚ö†Ô∏è</span>
                                <p><strong>Bell-LaPadula vs Biba:</strong> They're opposites! Bell-LaPadula protects secrets from leaking OUT (confidentiality). Biba protects trusted data from being corrupted by untrusted sources (integrity). You typically can't fully implement both simultaneously.</p>
                            </div>

                            <h5><span aria-hidden="true">üìä</span> Lattice-Based Access Control</h5>
                            <p>A mathematical framework where subjects and objects are assigned positions on a <strong>lattice structure</strong> with defined upper and lower bounds.</p>
                            
                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üè•</span> Real-World Scenario: Hospital Data Access</h4>
                                <p><strong>Situation:</strong> A hospital implements lattice-based access for patient records.</p>
                                <div class="scenario-content">
                                    <p><strong>Lattice Structure:</strong></p>
                                    <table class="comparison-table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Level</th>
                                                <th scope="col">Access Rights</th>
                                                <th scope="col">Example Roles</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Top (All Data)</td>
                                                <td>Full patient records + billing + research</td>
                                                <td>Hospital Administrator, Compliance Officer</td>
                                            </tr>
                                            <tr>
                                                <td>Medical + Billing</td>
                                                <td>Treatment records + insurance claims</td>
                                                <td>Department Head</td>
                                            </tr>
                                            <tr>
                                                <td>Medical Only</td>
                                                <td>Diagnosis, treatment, medications</td>
                                                <td>Attending Physician, Specialist</td>
                                            </tr>
                                            <tr>
                                                <td>Billing Only</td>
                                                <td>Charges, insurance, payments</td>
                                                <td>Billing Clerk</td>
                                            </tr>
                                            <tr>
                                                <td>Limited Medical</td>
                                                <td>Vital signs, basic status</td>
                                                <td>Nurse, Medical Assistant</td>
                                            </tr>
                                            <tr>
                                                <td>Bottom (Minimal)</td>
                                                <td>Name, room number only</td>
                                                <td>Receptionist, Visitor Desk</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <p><strong>How it works:</strong> The billing clerk (Billing Only) and nurse (Limited Medical) are on <em>different branches</em> of the lattice‚Äîneither can access the other's data. Only someone at a higher node that encompasses both (Department Head) can see both views. The lattice defines the <strong>least upper bound</strong> (who can access combined data) and <strong>greatest lower bound</strong> (minimum shared access).</p>
                                </div>
                            </div>

                            <h5><span aria-hidden="true">üìã</span> MAC Models Comparison</h5>
                            <table class="comparison-table">
                                <thead>
                                    <tr>
                                        <th scope="col">Model</th>
                                        <th scope="col">Protects</th>
                                        <th scope="col">Rules</th>
                                        <th scope="col">Best For</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">Bell-LaPadula</th>
                                        <td>Confidentiality</td>
                                        <td>No read up, no write down</td>
                                        <td>Military, intelligence, classified data</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Biba</th>
                                        <td>Integrity</td>
                                        <td>No read down, no write up</td>
                                        <td>Financial systems, software dev, critical infrastructure</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Lattice</th>
                                        <td>Both (flexible)</td>
                                        <td>Upper/lower bounds on lattice</td>
                                        <td>Healthcare, complex organizations, multi-department access</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Clark-Wilson</th>
                                        <td>Integrity</td>
                                        <td>Well-formed transactions, separation of duties</td>
                                        <td>Commercial/business applications, accounting systems</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h5><span aria-hidden="true">üè¢</span> Clark-Wilson Model (Commercial Integrity)</h5>
                            <p>Unlike Biba which focuses on <em>data levels</em>, Clark-Wilson ensures integrity through <strong>controlled transactions</strong> and <strong>separation of duties</strong>. It was designed specifically for commercial business environments.</p>
                            
                            <div class="concepts-grid">
                                <div class="concept-card">
                                    <h6><span aria-hidden="true">üì¶</span> Constrained Data Items (CDIs)</h6>
                                    <p>Data that must maintain integrity (e.g., account balances, inventory counts, financial records)</p>
                                    <p class="example-text"><em>Example:</em> A bank account balance is a CDI‚Äîit must always be accurate.</p>
                                </div>
                                <div class="concept-card">
                                    <h6><span aria-hidden="true">üìÑ</span> Unconstrained Data Items (UDIs)</h6>
                                    <p>Input data that hasn't been validated yet (e.g., user input, imported files)</p>
                                    <p class="example-text"><em>Example:</em> A deposit slip amount entered by a teller is a UDI until verified.</p>
                                </div>
                                <div class="concept-card">
                                    <h6><span aria-hidden="true">‚öôÔ∏è</span> Transformation Procedures (TPs)</h6>
                                    <p>The ONLY approved programs that can modify CDIs. They ensure "well-formed transactions."</p>
                                    <p class="example-text"><em>Example:</em> Only the "Process Deposit" program can add money to an account‚Äînot direct database edits.</p>
                                </div>
                                <div class="concept-card">
                                    <h6><span aria-hidden="true">‚úÖ</span> Integrity Verification Procedures (IVPs)</h6>
                                    <p>Programs that verify CDIs are in a valid state (auditing functions)</p>
                                    <p class="example-text"><em>Example:</em> End-of-day reconciliation that confirms all debits equal all credits.</p>
                                </div>
                            </div>

                            <div class="info-box tip">
                                <span aria-hidden="true">üîë</span>
                                <div>
                                    <p><strong>Clark-Wilson's Two Key Principles:</strong></p>
                                    <ol class="styled-list">
                                        <li><strong>Well-Formed Transactions:</strong> Users can't directly modify data‚Äîthey must use approved programs (TPs) that enforce business rules</li>
                                        <li><strong>Separation of Duties:</strong> The person who initiates a transaction shouldn't be the same person who authorizes it</li>
                                    </ol>
                                </div>
                            </div>

                            <div class="info-box warning">
                                <span aria-hidden="true">‚ö†Ô∏è</span>
                                <p><strong>Clark-Wilson vs Biba:</strong> Biba controls WHO can access data at different integrity levels. Clark-Wilson controls HOW data can be modified (only through approved programs). Clark-Wilson is more practical for real business applications.</p>
                            </div>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üè¶</span> Real-World Scenario: Bank Transaction Processing</h4>
                                <p><strong>Situation:</strong> First National Bank implements Clark-Wilson for their core banking system.</p>
                                <div class="scenario-content">
                                    <p><strong>How Clark-Wilson Protects Integrity:</strong></p>
                                    <table class="comparison-table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Component</th>
                                                <th scope="col">Bank Example</th>
                                                <th scope="col">Protection</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>CDI</strong></td>
                                                <td>Account balances, loan records</td>
                                                <td>Can only be changed by TPs</td>
                                            </tr>
                                            <tr>
                                                <td><strong>UDI</strong></td>
                                                <td>Customer deposit slip, check image</td>
                                                <td>Must be validated before affecting CDIs</td>
                                            </tr>
                                            <tr>
                                                <td><strong>TP</strong></td>
                                                <td>"Process Deposit" program</td>
                                                <td>Ensures both accounts update correctly</td>
                                            </tr>
                                            <tr>
                                                <td><strong>IVP</strong></td>
                                                <td>Daily reconciliation audit</td>
                                                <td>Verifies all transactions balanced</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <p><strong>Separation of Duties Example:</strong></p>
                                    <ul class="styled-list">
                                        <li><strong>Teller (Role A):</strong> Can initiate deposits up to $10,000</li>
                                        <li><strong>Supervisor (Role B):</strong> Must approve deposits over $10,000</li>
                                        <li><strong>Auditor (Role C):</strong> Reviews all transactions but cannot initiate or approve</li>
                                    </ul>
                                    <p><em>No single person can deposit $50,000 into their own account without another person's involvement!</em></p>
                                </div>
                            </div>

                            <div class="info-box tip">
                                <span aria-hidden="true">üìù</span>
                                <div>
                                    <p><strong>üß† Memory Tricks for MAC Models:</strong></p>
                                    <ul class="styled-list">
                                        <li><strong>Bell-LaPadula = "BLP Blocks Leaks to Public"</strong> ‚Äî Confidentiality, no read up/write down (keeps secrets from leaking down)</li>
                                        <li><strong>Biba = "Biba Blocks Bad Input"</strong> ‚Äî Integrity, no read down/write up (keeps garbage from flowing up)</li>
                                        <li><strong>Lattice = "Ladder with Branches"</strong> ‚Äî Picture a ladder where some rungs connect to side branches; you can only reach data on your rung or connected branches below</li>
                                        <li><strong>Clark-Wilson = "CW = Certified Workflow"</strong> ‚Äî Everything must go through certified programs (TPs); think of it as a formal workflow where you can't skip steps</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="exam-tip">
                                <h4><span aria-hidden="true">üéØ</span> Security+ Exam Tip: Clark-Wilson</h4>
                                <p>Remember these keywords for Clark-Wilson:</p>
                                <ul class="styled-list">
                                    <li><strong>"Well-formed transactions"</strong> ‚Äî data changes only through approved programs</li>
                                    <li><strong>"Separation of duties"</strong> ‚Äî no single person controls entire process</li>
                                    <li><strong>"Commercial integrity"</strong> ‚Äî designed for business, not military</li>
                                    <li><strong>"CDI/UDI/TP/IVP"</strong> ‚Äî the four components (Constrained Data, Unconstrained Data, Transformation Procedures, Integrity Verification Procedures)</li>
                                </ul>
                            </div>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üéñÔ∏è</span> Real-World Scenario: Military Intelligence</h4>
                                <p>Captain Martinez has "Secret" clearance. She can read Secret and Confidential documents, but cannot access Top Secret briefings even if she "needs" them for a project. The system enforces this automatically‚Äîshe has no option to override.</p>
                                <div class="scenario-content">
                                    <p class="scenario-question">Why is this important?</p>
                                    <p>If Captain Martinez's account were compromised, the attacker couldn't escalate to Top Secret materials regardless of what they try.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RBAC -->
            <div class="model-card">
                <h4><span aria-hidden="true">üëî</span> Role-Based Access Control (RBAC) <span class="model-tag moderate">Real-World Approach</span></h4>
                <p>
                    <button class="tooltip-term" type="button">
                        RBAC
                        <span class="tooltip-popup" role="tooltip">An access control model where permissions are assigned to roles (job functions) rather than individuals. Users are assigned to roles.</span>
                    </button>
                    (Non-Discretionary Access Control) assigns permissions based on job functions.
                </p>
                
                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" aria-expanded="false" aria-controls="rbac-details" type="button">
                            <span>View RBAC Details</span>
                            <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                        </button>
                        <div class="accordion-content" id="rbac-details" hidden>
                            <div class="diagram-box" role="figure" aria-label="RBAC Structure">
                                <div class="flow-diagram">
                                    <div class="flow-step">Permissions</div>
                                    <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                                    <div class="flow-step">Roles</div>
                                    <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                                    <div class="flow-step">Users</div>
                                </div>
                            </div>

                            <p><strong>Advantages:</strong></p>
                            <ul class="styled-list">
                                <li>Simplifies administration - manage roles, not individual permissions</li>
                                <li>Easy onboarding/offboarding - just add/remove role assignments</li>
                                <li>Supports principle of least privilege</li>
                                <li>Aligns with organizational structure</li>
                            </ul>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üè•</span> Real-World Scenario: Hospital RBAC</h4>
                                <p>Memorial Hospital implements RBAC with these roles:</p>
                                <div class="scenario-content">
                                    <p><strong>Nurse:</strong> View patient vitals, administer medications, update charts</p>
                                    <p><strong>Doctor:</strong> All nurse permissions + order tests, prescribe medications, view full history</p>
                                    <p><strong>Billing:</strong> View patient demographics and insurance, process payments (NO medical access)</p>
                                    <p><strong>Administrator:</strong> Manage user accounts, run reports, configure system settings</p>
                                </div>
                                <p style="margin-top: 0.75rem;">When Dr. Chen joins, IT simply assigns the "Doctor" role‚Äîinstant appropriate access!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rule-Based -->
            <div class="model-card">
                <h4><span aria-hidden="true">üìú</span> Rule-Based Access Control <span class="model-tag moderate">Dynamic</span></h4>
                <p>Rule-Based Access Control dynamically assigns access based on predefined rules set by administrators.</p>
                
                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" aria-expanded="false" aria-controls="rule-details" type="button">
                            <span>View Rule-Based Details</span>
                            <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                        </button>
                        <div class="accordion-content" id="rule-details" hidden>
                            <p><strong>Common Use Cases:</strong></p>
                            <ul class="styled-list">
                                <li>Firewall rules (allow/deny based on IP, port, protocol)</li>
                                <li>Router access control lists</li>
                                <li>Time-based access restrictions</li>
                                <li>Conditional access policies</li>
                            </ul>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">üïê</span> Real-World Scenario: After-Hours Access</h4>
                                <p>A financial services firm creates these rules:</p>
                                <div class="scenario-content">
                                    <p><strong>Rule 1:</strong> Trading systems accessible only 6 AM - 8 PM EST, Monday-Friday</p>
                                    <p><strong>Rule 2:</strong> After-hours access requires manager approval AND MFA</p>
                                    <p><strong>Rule 3:</strong> Weekend access triggers automatic security alert</p>
                                </div>
                                <p style="margin-top: 0.75rem;">When a trader tries to access at 11 PM, the system automatically requires additional verification.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ABAC -->
            <div class="model-card">
                <h4><span aria-hidden="true">üéõÔ∏è</span> Attribute-Based Access Control (ABAC) <span class="model-tag flexible">Most Flexible</span></h4>
                <p>
                    <button class="tooltip-term" type="button">
                        ABAC
                        <span class="tooltip-popup" role="tooltip">A highly flexible model that evaluates multiple attributes (user, resource, action, environment) to make fine-grained access decisions.</span>
                    </button>
                    uses multiple attributes combined in policies for fine-grained decisions.
                </p>
                
                <div class="accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" aria-expanded="false" aria-controls="abac-details" type="button">
                            <span>View ABAC Details</span>
                            <span class="accordion-icon" aria-hidden="true">‚ñº</span>
                        </button>
                        <div class="accordion-content" id="abac-details" hidden>
                            <table class="comparison-table">
                                <caption>ABAC Attribute Categories</caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Category</th>
                                        <th scope="col">Examples</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">Subject</th>
                                        <td>User ID, role, department, clearance, job title</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Object</th>
                                        <td>Resource type, owner, sensitivity level, file type</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Action</th>
                                        <td>Read/write/delete, request time, request IP</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Environment</th>
                                        <td>Time of day, network conditions, device type</td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="info-box success">
                                <span class="info-icon" aria-hidden="true">üìã</span>
                                <div>
                                    <strong>Policy Example:</strong><br>
                                    <code>IF user.department = "Finance" AND user.clearance >= "Confidential" AND environment.time BETWEEN 9:00-17:00 AND device.compliant = true THEN ALLOW access to financial_reports</code>
                                </div>
                            </div>

                            <div class="scenario-box">
                                <h4><span aria-hidden="true">‚òÅÔ∏è</span> Real-World Scenario: Cloud Access</h4>
                                <p>A multinational company uses ABAC for cloud resources:</p>
                                <div class="scenario-content">
                                    <p><strong>Scenario:</strong> Employee in Germany tries to access US customer data</p>
                                    <p><strong>Attributes Evaluated:</strong> User location (Germany), Data location (US), Data type (PII), Time (business hours), Device (corporate laptop, compliant)</p>
                                    <p><strong>Decision:</strong> DENY - GDPR restricts EU employee access to US PII without explicit consent</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparison Table -->
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìä</span> Model Comparison Summary</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption class="sr-only">Access Control Models Comparison</caption>
                        <thead>
                            <tr>
                                <th scope="col">Model</th>
                                <th scope="col">Control</th>
                                <th scope="col">Flexibility</th>
                                <th scope="col">Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">DAC</th>
                                <td>Owner</td>
                                <td>High</td>
                                <td>Personal systems, small orgs</td>
                            </tr>
                            <tr>
                                <th scope="row">MAC</th>
                                <td>System</td>
                                <td>Low</td>
                                <td>Military, government</td>
                            </tr>
                            <tr>
                                <th scope="row">RBAC</th>
                                <td>Admin (roles)</td>
                                <td>Moderate</td>
                                <td>Enterprises</td>
                            </tr>
                            <tr>
                                <th scope="row">Rule-Based</th>
                                <td>Admin (rules)</td>
                                <td>Moderate</td>
                                <td>Network devices</td>
                            </tr>
                            <tr>
                                <th scope="row">ABAC</th>
                                <td>Policy engine</td>
                                <td>Highest</td>
                                <td>Cloud, Zero Trust</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('intro')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('models'); navigateTo('account')">Continue to Account Management <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 3: ACCOUNT MANAGEMENT ==================== -->
        <section class="section" id="account" role="tabpanel" aria-labelledby="tab-account" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üë§</span> Account Management Lifecycle</h2>
                </div>
                <div class="card-body">
                    <p>Proper account management is essential for security throughout an employee's lifecycle with an organization.</p>

                    <div class="diagram-box" role="figure" aria-label="Account Lifecycle">
                        <div class="flow-diagram">
                            <div class="flow-step">Onboarding</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">Active Use</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">Role Changes</div>
                            <span class="flow-arrow" aria-hidden="true">‚Üí</span>
                            <div class="flow-step">Offboarding</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üöÄ</span> Employee Onboarding</h2>
                </div>
                <div class="card-body">
                    <div class="concepts-grid">
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üíª</span> System Provisioning</h4>
                            <p>Configure computer, install software, apply security baselines</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üìß</span> Account Creation</h4>
                            <p>Create email, Active Directory accounts, application accounts</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üë•</span> Group Membership</h4>
                            <p>Add user to security groups based on role and department</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üîê</span> Security Setup</h4>
                            <p>Enable MFA, configure security policies, set permissions</p>
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üÜï</span> Real-World Scenario: New Marketing Hire</h4>
                        <p>Jessica starts Monday as Marketing Coordinator. IT receives the onboarding ticket Friday:</p>
                        <div class="scenario-content">
                            <p><strong>1. Account:</strong> Create jsmith@company.com following naming convention</p>
                            <p><strong>2. Groups:</strong> Add to "Marketing-Team," "All-Employees," "Building-A-Access"</p>
                            <p><strong>3. Applications:</strong> Provision access to CRM, social media tools, design software</p>
                            <p><strong>4. Hardware:</strong> Configure laptop with endpoint protection, disk encryption</p>
                            <p><strong>5. Training:</strong> Assign security awareness training in LMS</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üö™</span> Employee Offboarding</h2>
                </div>
                <div class="card-body">
                    <p>Critical security process when employees leave:</p>
                    <ul class="styled-list">
                        <li>Disable accounts IMMEDIATELY upon departure notification</li>
                        <li>Back up employee files from local computer and servers</li>
                        <li>Archive and forward email to manager</li>
                        <li>Revoke VPN, remote access, and cloud service access</li>
                        <li>Recover physical badges and security tokens</li>
                        <li>Change shared passwords the employee knew</li>
                    </ul>

                    <div class="info-box warning">
                        <span class="info-icon" aria-hidden="true">‚ö†Ô∏è</span>
                        <div>
                            <strong>Security Risk:</strong> 
                            <button class="tooltip-term" type="button">
                                Orphaned accounts
                                <span class="tooltip-popup" role="tooltip">User accounts that remain active after an employee has left. These create backdoors for unauthorized access.</span>
                            </button>
                            are accounts that remain active after an employee leaves‚Äîa major security vulnerability!
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üò†</span> Real-World Scenario: Disgruntled Employee</h4>
                        <p>Tom, a system administrator, is fired for performance issues on Friday afternoon. However, HR forgets to notify IT:</p>
                        <div class="scenario-content">
                            <p><strong>Problem:</strong> Tom's accounts remain active over the weekend</p>
                            <p><strong>Result:</strong> Tom logs in remotely Saturday, downloads customer database, deletes backup files</p>
                            <p><strong>Lesson:</strong> Terminations require IMMEDIATE account disabling‚Äîideally before the employee is notified</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìç</span> Location-Based Policies &amp; Time Restrictions</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Geofencing
                            <span class="tooltip-popup" role="tooltip">A location-based technology that creates virtual geographic boundaries. Access can be automatically controlled when devices enter or exit these boundaries.</span>
                        </button>
                        establishes geographical boundaries for access:
                    </p>
                    <ul class="styled-list">
                        <li>Restrict access based on GPS or IP location</li>
                        <li>Useful for compliance with data sovereignty requirements</li>
                        <li>Can trigger additional authentication from unusual locations</li>
                    </ul>

                    <p style="margin-top: 1rem;"><strong>Time-of-Day Restrictions:</strong></p>
                    <ul class="styled-list">
                        <li>Limit login times to business hours</li>
                        <li>Prevent unauthorized after-hours access</li>
                        <li>Configure different restrictions for different days</li>
                    </ul>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üåç</span> Real-World Scenario: Impossible Travel</h4>
                        <p>Azure AD detects: User logged in from New York at 2:00 PM, then from Moscow at 2:15 PM.</p>
                        <div class="scenario-content">
                            <p><strong>System Response:</strong> Block access, require MFA, alert security team</p>
                            <p><strong>Investigation:</strong> Account credentials were stolen in phishing attack</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">‚öñÔ∏è</span> Principle of Least Privilege</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Least Privilege
                            <span class="tooltip-popup" role="tooltip">Security principle stating that users and processes should only be granted the minimum permissions necessary to perform their required functions.</span>
                        </button>
                        means granting only the minimum access necessary.
                    </p>

                    <div class="info-box success">
                        <span class="info-icon" aria-hidden="true">‚úÖ</span>
                        <div>
                            <strong>Security Benefit:</strong> Reduces attack surface by eliminating unnecessary access paths that attackers could exploit if an account is compromised.
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üíº</span> Real-World Scenario: Developer Access</h4>
                        <p>A developer requests production database admin rights "just in case" they need to fix something:</p>
                        <div class="scenario-content">
                            <p><strong>Wrong Approach:</strong> Grant permanent admin access</p>
                            <p><strong>Right Approach:</strong> Provide read-only access normally; require approval and time-limited elevation for admin tasks (Just-In-Time access)</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('models')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('account'); navigateTo('bestpractices')">Continue to Best Practices <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 4: BEST PRACTICES ==================== -->
        <section class="section" id="bestpractices" role="tabpanel" aria-labelledby="tab-bestpractices" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üèÜ</span> Best Practices for Access Control</h2>
                </div>
                <div class="card-body">
                    <p>Implementing these practices helps prevent insider threats, fraud, and security breaches through operational controls.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">‚öñÔ∏è</span> Separation of Duties (SoD)</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Separation of Duties
                            <span class="tooltip-popup" role="tooltip">A security principle requiring that critical tasks be divided among multiple people, preventing any single individual from having complete control over high-risk processes.</span>
                        </button>
                        divides critical tasks among multiple people.
                    </p>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üí∞</span> Real-World Scenario: Accounts Payable Fraud</h4>
                        <p>Without SoD: Linda in accounting can create vendors, approve invoices, AND process payments.</p>
                        <div class="scenario-content">
                            <p><strong>Fraud Method:</strong> Linda creates fake vendor "LM Consulting," submits invoices, approves them, and processes payments to her personal account.</p>
                            <p><strong>With SoD:</strong> Different people handle vendor creation, invoice approval, and payment processing‚ÄîLinda can't commit fraud alone.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîÑ</span> Job Rotation</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Job Rotation
                            <span class="tooltip-popup" role="tooltip">A practice where employees periodically move between different job responsibilities, limiting manipulation opportunities and exposing potential fraud when others take over.</span>
                        </button>
                        periodically moves individuals between job responsibilities.
                    </p>
                    
                    <p><strong>Benefits:</strong></p>
                    <ul class="styled-list">
                        <li>Limits time window for unauthorized activities</li>
                        <li>New employees may discover hidden irregularities</li>
                        <li>Creates backup personnel for critical functions</li>
                        <li>Reduces employee burnout</li>
                    </ul>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üîç</span> Real-World Scenario: Hidden Embezzlement</h4>
                        <p>Bank implements job rotation policy. When Michael takes over from Susan in wire transfers:</p>
                        <div class="scenario-content">
                            <p><strong>Discovery:</strong> Michael notices unusual recurring transfers to an offshore account</p>
                            <p><strong>Investigation:</strong> Reveals Susan had been siphoning funds for 3 years</p>
                            <p><strong>Lesson:</strong> Without rotation, fraud could have continued indefinitely</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üèñÔ∏è</span> Mandatory Vacations</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Mandatory Vacations
                            <span class="tooltip-popup" role="tooltip">A security policy requiring employees in sensitive positions to take consecutive days off, during which others perform their duties and may detect fraudulent activities.</span>
                        </button>
                        require employees to take extended time off.
                    </p>

                    <div class="info-box tip">
                        <span class="info-icon" aria-hidden="true">üí°</span>
                        <div>
                            <strong>Why It Works:</strong> Many frauds require the perpetrator's daily presence to conceal. When someone else performs the duties, discrepancies often surface.
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üè¶</span> Real-World Scenario: The Workaholic</h4>
                        <p>James in treasury hasn't taken vacation in 5 years, always claiming he's "too essential."</p>
                        <div class="scenario-content">
                            <p><strong>Red Flag:</strong> Employee who refuses vacation may be hiding something</p>
                            <p><strong>Policy Applied:</strong> Company mandates 2-week consecutive vacation</p>
                            <p><strong>Result:</strong> Replacement discovers James had been manipulating reconciliation reports to hide a $2M shortage</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üßπ</span> Clean Desk Policy</h2>
                </div>
                <div class="card-body">
                    <p>Ensures confidential materials are secured when not in use:</p>
                    
                    <div class="concepts-grid">
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üíª</span> Workstation</h4>
                            <p>Lock computer when away; power off at end of day</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üìÑ</span> Documents</h4>
                            <p>Lock sensitive papers in drawer when unattended</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üóÑÔ∏è</span> Storage</h4>
                            <p>Keep file cabinets locked; never leave keys out</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üíæ</span> Devices</h4>
                            <p>Secure laptops with cable lock or locked drawer</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('account')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('bestpractices'); navigateTo('implementation')">Continue to Implementation <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 5: IMPLEMENTATION ==================== -->
        <section class="section" id="implementation" role="tabpanel" aria-labelledby="tab-implementation" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîß</span> Implementing Access Control</h2>
                </div>
                <div class="card-body">
                    <p>Technical mechanisms that enforce permission policies on systems and networks.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìã</span> Access Control Lists (ACLs)</h2>
                </div>
                <div class="card-body">
                    <p>An 
                        <button class="tooltip-term" type="button">
                            ACL
                            <span class="tooltip-popup" role="tooltip">Access Control List - A set of rules attached to an object specifying which subjects may access it and what operations they can perform.</span>
                        </button>
                        is a set of permissions attached to an object.
                    </p>

                    <p><strong>How ACLs Work:</strong></p>
                    <ol class="styled-list" style="list-style: decimal; padding-left: 1.5rem;">
                        <li>Subject requests operation on object</li>
                        <li>System checks object's ACL for matching entry</li>
                        <li>If approved entry exists, access granted</li>
                        <li>If no match or denied, access rejected</li>
                    </ol>

                    <div class="info-box tip">
                        <span class="info-icon" aria-hidden="true">üí°</span>
                        <div>
                            <strong>Access Control Entry (ACE):</strong> Each individual rule in an ACL. In Windows, contains: Security Identifier (SID), Access Mask, ACE Type (allow/deny), and Inheritance Flags.
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üìÅ</span> Real-World Scenario: File Server Permissions</h4>
                        <p>Company shared drive "Projects" folder ACL:</p>
                        <div class="scenario-content">
                            <p><strong>ACE 1:</strong> Domain Admins - Full Control</p>
                            <p><strong>ACE 2:</strong> Project-Managers - Modify</p>
                            <p><strong>ACE 3:</strong> All-Employees - Read &amp; Execute</p>
                            <p><strong>ACE 4:</strong> Contractors - DENY All (explicit block)</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üë•</span> Group-Based Access Control</h2>
                </div>
                <div class="card-body">
                    <p>Simplifies management by assigning permissions to groups rather than individuals.</p>

                    <p><strong>
                        <button class="tooltip-term" type="button">
                            Group Policy
                            <span class="tooltip-popup" role="tooltip">A Microsoft Windows feature providing centralized management of computers and users through Active Directory using Group Policy Objects (GPOs).</span>
                        </button>
                        (Windows):</strong>
                    </p>
                    <ul class="styled-list">
                        <li>Centralized management via Active Directory</li>
                        <li>Settings stored in Group Policy Objects (GPOs)</li>
                        <li>Applied at domain, site, or OU level</li>
                    </ul>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üè¢</span> Real-World Scenario: Department GPOs</h4>
                        <p>IT configures GPOs for different departments:</p>
                        <div class="scenario-content">
                            <p><strong>Finance GPO:</strong> Require 15-minute screen lock, block USB storage, enable audit logging</p>
                            <p><strong>Development GPO:</strong> Allow admin rights, permit USB, enable developer tools</p>
                            <p><strong>Kiosk GPO:</strong> Single application mode, no Start menu, auto-logoff after 5 minutes</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîê</span> Privileged Access Management (PAM)</h2>
                </div>
                <div class="card-body">
                    <p>Special controls for high-privilege accounts:</p>

                    <div class="concepts-grid">
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üîë</span> Credential Vaulting</h4>
                            <p>Store privileged credentials in encrypted vaults with strict access controls</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">‚è±Ô∏è</span> Just-In-Time Access</h4>
                            <p>Grant elevated privileges only when needed, auto-revoke after use</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üìπ</span> Session Recording</h4>
                            <p>Record all privileged sessions for forensic review</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üîÑ</span> Password Rotation</h4>
                            <p>Automatically rotate privileged passwords on schedule</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('bestpractices')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('implementation'); navigateTo('services')">Continue to IAM Services <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 6: IAM SERVICES ==================== -->
        <section class="section" id="services" role="tabpanel" aria-labelledby="tab-services" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üåê</span> Identity and Access Services</h2>
                </div>
                <div class="card-body">
                    <p>Various protocols and services provide centralized identity and access management for enterprise networks.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üì°</span> RADIUS</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            RADIUS
                            <span class="tooltip-popup" role="tooltip">Remote Authentication Dial-In User Service - A networking protocol providing centralized authentication, authorization, and accounting (AAA) for network access.</span>
                        </button>
                        (Remote Authentication Dial-In User Service) provides centralized AAA:
                    </p>

                    <ul class="styled-list">
                        <li>Industry standard since 1992</li>
                        <li>Used for WiFi, VPN, and network device authentication</li>
                        <li>RADIUS client = network device (AP, switch)</li>
                        <li>Uses UDP (ports 1812/1813)</li>
                        <li>Only encrypts password, not entire packet</li>
                    </ul>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üì∂</span> Real-World Scenario: Corporate WiFi</h4>
                        <p>Employee connects to "CorpSecure" WiFi network:</p>
                        <div class="scenario-content">
                            <p><strong>1.</strong> Laptop sends credentials to wireless access point</p>
                            <p><strong>2.</strong> AP (RADIUS client) forwards to RADIUS server</p>
                            <p><strong>3.</strong> RADIUS server checks against Active Directory</p>
                            <p><strong>4.</strong> Server returns Access-Accept with VLAN assignment</p>
                            <p><strong>5.</strong> AP grants access to appropriate network segment</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üé´</span> Kerberos</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Kerberos
                            <span class="tooltip-popup" role="tooltip">A ticket-based authentication system using symmetric key cryptography. Developed at MIT and used by Active Directory.</span>
                        </button>
                        is a ticket-based authentication system:
                    </p>

                    <p><strong>Key Components:</strong></p>
                    <ul class="styled-list">
                        <li><strong>KDC (Key Distribution Center):</strong> Central authentication authority</li>
                        <li><strong>TGT (Ticket Granting Ticket):</strong> Initial ticket proving identity</li>
                        <li><strong>Service Tickets:</strong> Access tickets for specific services</li>
                    </ul>

                    <p><strong>Ticket Characteristics:</strong></p>
                    <ul class="styled-list">
                        <li>Cryptographically protected (difficult to forge)</li>
                        <li>Contains user identity information</li>
                        <li>Time-limited (typically 8-10 hours)</li>
                    </ul>

                    <div class="exam-tip">
                        <h4><span aria-hidden="true">üìù</span> Security+ Exam Focus</h4>
                        <p>Kerberos is the primary authentication protocol for Windows Active Directory. Know: uses tickets, has single point of failure (KDC), all communication encrypted.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîê</span> TACACS+ vs RADIUS</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption>TACACS+ and RADIUS Comparison</caption>
                        <thead>
                            <tr>
                                <th scope="col">Feature</th>
                                <th scope="col">RADIUS</th>
                                <th scope="col">TACACS+</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Transport</th>
                                <td>UDP</td>
                                <td>TCP</td>
                            </tr>
                            <tr>
                                <th scope="row">AAA Separation</th>
                                <td>Combined AuthN/AuthZ</td>
                                <td>Separate (more granular)</td>
                            </tr>
                            <tr>
                                <th scope="row">Encryption</th>
                                <td>Password only</td>
                                <td>Entire packet</td>
                            </tr>
                            <tr>
                                <th scope="row">Primary Use</th>
                                <td>Network access (WiFi, VPN)</td>
                                <td>Device administration</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìñ</span> LDAP</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            LDAP
                            <span class="tooltip-popup" role="tooltip">Lightweight Directory Access Protocol - A protocol for accessing and managing directory services containing user, group, and resource information.</span>
                        </button>
                        (Lightweight Directory Access Protocol) provides access to directory services:
                    </p>

                    <ul class="styled-list">
                        <li>Stores information about users, groups, computers</li>
                        <li>Hierarchical structure (directory information tree)</li>
                        <li>Standard LDAP transmits in cleartext</li>
                        <li>LDAPS (LDAP over SSL/TLS) encrypts traffic</li>
                        <li>Vulnerable to LDAP injection attacks</li>
                    </ul>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üîç</span> Real-World Scenario: Application Authentication</h4>
                        <p>HR application needs to authenticate users:</p>
                        <div class="scenario-content">
                            <p><strong>1.</strong> User enters username/password in HR app</p>
                            <p><strong>2.</strong> App performs LDAP bind to Active Directory</p>
                            <p><strong>3.</strong> AD validates credentials</p>
                            <p><strong>4.</strong> App queries LDAP for user's group memberships</p>
                            <p><strong>5.</strong> App grants access based on groups (HR-Users, HR-Managers)</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìú</span> SAML</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            SAML
                            <span class="tooltip-popup" role="tooltip">Security Assertion Markup Language - An XML-based standard for exchanging authentication and authorization data between identity providers and service providers.</span>
                        </button>
                        (Security Assertion Markup Language) enables web-based SSO:
                    </p>

                    <p><strong>Components:</strong></p>
                    <ul class="styled-list">
                        <li><strong>Identity Provider (IdP):</strong> Authenticates users, issues assertions</li>
                        <li><strong>Service Provider (SP):</strong> Relies on IdP for authentication</li>
                        <li><strong>SAML Assertion:</strong> XML document with identity information</li>
                    </ul>

                    <div class="info-box warning">
                        <span class="info-icon" aria-hidden="true">‚ö†Ô∏è</span>
                        <div>
                            <strong>Limitation:</strong> SAML was designed before mobile devices‚Äînot well-suited for mobile apps. Modern alternatives like OAuth 2.0 and OIDC are preferred.
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('implementation')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('services'); navigateTo('federation')">Continue to Federation &amp; SSO <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 7: FEDERATION & SSO ==================== -->
        <section class="section" id="federation" role="tabpanel" aria-labelledby="tab-federation" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîó</span> Federation and Single Sign-On</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Federation
                            <span class="tooltip-popup" role="tooltip">A trust relationship between organizations allowing users authenticated by one organization to access resources in another without separate credentials.</span>
                        </button>
                        enables identity sharing across boundaries, while 
                        <button class="tooltip-term" type="button">
                            SSO
                            <span class="tooltip-popup" role="tooltip">Single Sign-On - An authentication scheme allowing users to log in once and access multiple applications without re-authenticating.</span>
                        </button>
                        allows users to authenticate once and access multiple systems.
                    </p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîì</span> OAuth 2.0</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            OAuth 2.0
                            <span class="tooltip-popup" role="tooltip">An authorization framework enabling applications to obtain limited access to user resources without exposing credentials. Handles authorization, NOT authentication.</span>
                        </button>
                        is an <strong>authorization</strong> framework (NOT authentication!):
                    </p>

                    <div class="info-box important">
                        <span class="info-icon" aria-hidden="true">‚ö†Ô∏è</span>
                        <div>
                            <strong>Critical Distinction:</strong> OAuth 2.0 handles <em>authorization</em> (what can you access?), not authentication (who are you?). When you click "Sign in with Google," OAuth grants app permission to access your data‚ÄîOpenID Connect handles identity.
                        </div>
                    </div>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üì±</span> Real-World Scenario: Photo Printing App</h4>
                        <p>You want to print photos from Google Photos using PrintShop app:</p>
                        <div class="scenario-content">
                            <p><strong>1.</strong> PrintShop redirects you to Google</p>
                            <p><strong>2.</strong> Google asks: "PrintShop wants to access your photos. Allow?"</p>
                            <p><strong>3.</strong> You click Allow</p>
                            <p><strong>4.</strong> Google gives PrintShop a limited access token</p>
                            <p><strong>5.</strong> PrintShop can read photos but NOT your email, contacts, etc.</p>
                        </div>
                        <p style="margin-top: 0.75rem;"><strong>Key Point:</strong> PrintShop never sees your Google password!</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üÜî</span> OpenID Connect (OIDC)</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            OpenID Connect
                            <span class="tooltip-popup" role="tooltip">An authentication layer built on OAuth 2.0 that verifies user identity and provides profile information. Combines OAuth's authorization with authentication.</span>
                        </button>
                        adds an identity layer on top of OAuth 2.0:
                    </p>

                    <table class="comparison-table">
                        <caption>OAuth 2.0 vs OpenID Connect</caption>
                        <thead>
                            <tr>
                                <th scope="col">Aspect</th>
                                <th scope="col">OAuth 2.0</th>
                                <th scope="col">OIDC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Purpose</th>
                                <td>Authorization</td>
                                <td>Authentication + Authorization</td>
                            </tr>
                            <tr>
                                <th scope="row">Token Type</th>
                                <td>Access Token</td>
                                <td>ID Token (JWT) + Access Token</td>
                            </tr>
                            <tr>
                                <th scope="row">User Info</th>
                                <td>Not standardized</td>
                                <td>Standardized claims</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìä</span> Protocol Comparison</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption>Identity Protocol Comparison</caption>
                        <thead>
                            <tr>
                                <th scope="col">Protocol</th>
                                <th scope="col">Function</th>
                                <th scope="col">Format</th>
                                <th scope="col">Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">SAML 2.0</th>
                                <td>AuthN + AuthZ</td>
                                <td>XML</td>
                                <td>Enterprise SSO</td>
                            </tr>
                            <tr>
                                <th scope="row">OAuth 2.0</th>
                                <td>Authorization</td>
                                <td>JSON</td>
                                <td>API delegation</td>
                            </tr>
                            <tr>
                                <th scope="row">OIDC</th>
                                <td>Authentication</td>
                                <td>JSON/JWT</td>
                                <td>Modern web/mobile</td>
                            </tr>
                            <tr>
                                <th scope="row">Kerberos</th>
                                <td>Authentication</td>
                                <td>Binary</td>
                                <td>Internal/AD</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exam-tip">
                        <h4><span aria-hidden="true">üìù</span> Security+ Exam Focus</h4>
                        <p>SAML = XML, enterprise SSO. OAuth 2.0 = authorization only. OIDC = authentication on top of OAuth. SAML not designed for mobile; OIDC is modern choice.</p>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('services')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('federation'); navigateTo('zerotrust')">Continue to Zero Trust <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 8: ZERO TRUST ==================== -->
        <section class="section" id="zerotrust" role="tabpanel" aria-labelledby="tab-zerotrust" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üõ°Ô∏è</span> Zero Trust Architecture</h2>
                </div>
                <div class="card-body">
                    <p>
                        <button class="tooltip-term" type="button">
                            Zero Trust
                            <span class="tooltip-popup" role="tooltip">A security model based on "never trust, always verify." Assumes no implicit trust regardless of network location and requires continuous verification.</span>
                        </button>
                        is based on the principle: <strong>"Never trust, always verify."</strong>
                    </p>

                    <div class="info-box important">
                        <span class="info-icon" aria-hidden="true">‚ö†Ô∏è</span>
                        <div>
                            <strong>Key Shift:</strong> Traditional security assumed everything inside the network perimeter was trusted. Zero Trust assumes the network is already compromised and verifies every request.
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìê</span> Zero Trust Core Principles</h2>
                </div>
                <div class="card-body">
                    <div class="concepts-grid">
                        <div class="concept-card">
                            <h4><span aria-hidden="true">‚úÖ</span> Verify Explicitly</h4>
                            <p>Always authenticate and authorize based on all data points: identity, location, device health, data classification</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">‚öñÔ∏è</span> Least Privilege</h4>
                            <p>Limit access with Just-In-Time and Just-Enough-Access; risk-based adaptive policies</p>
                        </div>
                        <div class="concept-card">
                            <h4><span aria-hidden="true">üí•</span> Assume Breach</h4>
                            <p>Minimize blast radius through segmentation; verify end-to-end encryption; use analytics for threat detection</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üèóÔ∏è</span> Zero Trust Pillars</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption>Five Pillars of Zero Trust</caption>
                        <thead>
                            <tr>
                                <th scope="col">Pillar</th>
                                <th scope="col">Zero Trust Approach</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Identity</th>
                                <td>Strong authentication, MFA, risk-based conditional access</td>
                            </tr>
                            <tr>
                                <th scope="row">Devices</th>
                                <td>Endpoint detection, device compliance, health attestation</td>
                            </tr>
                            <tr>
                                <th scope="row">Network</th>
                                <td>Microsegmentation, encrypted traffic, real-time protection</td>
                            </tr>
                            <tr>
                                <th scope="row">Applications</th>
                                <td>In-app permissions, shadow IT discovery, secure access</td>
                            </tr>
                            <tr>
                                <th scope="row">Data</th>
                                <td>Classification, encryption, DLP, sensitivity-based access</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üîÑ</span> ZTNA vs Traditional VPN</h2>
                </div>
                <div class="card-body">
                    <table class="comparison-table">
                        <caption>Zero Trust Network Access vs VPN</caption>
                        <thead>
                            <tr>
                                <th scope="col">Traditional VPN</th>
                                <th scope="col">ZTNA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Grants access to entire network</td>
                                <td>Grants access to specific apps only</td>
                            </tr>
                            <tr>
                                <td>Once connected, trusted implicitly</td>
                                <td>Continuous verification</td>
                            </tr>
                            <tr>
                                <td>Lateral movement possible</td>
                                <td>Microsegmentation prevents spread</td>
                            </tr>
                            <tr>
                                <td>Apps visible on network</td>
                                <td>Apps hidden until authorized</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="scenario-box">
                        <h4><span aria-hidden="true">üè†</span> Real-World Scenario: Remote Work Security</h4>
                        <p>Company migrates from VPN to Zero Trust:</p>
                        <div class="scenario-content">
                            <p><strong>Before (VPN):</strong> Employee connects VPN ‚Üí has access to entire corporate network ‚Üí if compromised, attacker can reach everything</p>
                            <p><strong>After (ZTNA):</strong> Employee authenticates ‚Üí device health checked ‚Üí granted access ONLY to authorized apps (HR portal, email) ‚Üí attacker can't reach database servers or other systems</p>
                        </div>
                    </div>

                    <div class="exam-tip">
                        <h4><span aria-hidden="true">üìù</span> Security+ Exam Focus</h4>
                        <p>Know: "Never trust, always verify"; assume breach; least privilege. ZTNA replaces VPN. NIST SP 800-207 defines Zero Trust standards.</p>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="navigateTo('federation')"><span aria-hidden="true">‚Üê</span> Previous</button>
                <button class="btn btn-primary" onclick="markComplete('zerotrust'); navigateTo('quiz')">Continue to Assessment <span aria-hidden="true">‚Üí</span></button>
            </div>
        </section>

        <!-- ==================== SECTION 9: QUIZ ==================== -->
        <section class="section" id="quiz" role="tabpanel" aria-labelledby="tab-quiz" hidden>
            <div class="card">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìù</span> Knowledge Assessment</h2>
                </div>
                <div class="card-body">
                    <p>Test your understanding of Access Management concepts. Use <kbd>Tab</kbd> to navigate options, <kbd>Space</kbd> to select.</p>
                </div>
            </div>

            <form class="quiz-container" id="quizForm" aria-label="Knowledge assessment quiz">
                <!-- Quiz questions inserted by JavaScript -->
            </form>

            <div class="btn-group">
                <button type="button" class="btn btn-primary" onclick="submitQuiz()">Submit Assessment</button>
                <button type="button" class="btn btn-secondary" onclick="resetQuiz()">Reset Quiz</button>
            </div>

            <div id="quizResults" class="card" style="display: none; margin-top: 1.5rem;" role="region" aria-live="polite">
                <div class="card-header">
                    <h2><span aria-hidden="true">üìä</span> Assessment Results</h2>
                </div>
                <div class="card-body">
                    <div id="resultsContent"></div>
                </div>
            </div>
        </section>

    </main>

    <footer class="footer" role="contentinfo">
        <p>Access Management Interactive Learning Module</p>
        <p>Aligned with CompTIA Security+ Certification Objectives</p>
        <p style="margin-top: 0.5rem; font-size: 0.8rem;">¬© Educational Use Only | Accessible Design</p>
    </footer>

    <script>
        // ==================== QUIZ DATA ====================
        const quizQuestions = [
            {
                question: "Which access control model is considered the MOST restrictive?",
                options: ["Discretionary Access Control (DAC)", "Role-Based Access Control (RBAC)", "Mandatory Access Control (MAC)", "Attribute-Based Access Control (ABAC)"],
                correct: 2,
                explanation: "MAC is the most restrictive‚Äîusers cannot override system-enforced policies based on security labels."
            },
            {
                question: "What is the PRIMARY difference between authentication and authorization?",
                options: ["Authentication grants permissions; authorization verifies identity", "Authentication verifies identity; authorization determines permitted actions", "Authentication tracks actions; authorization grants access", "They are the same process"],
                correct: 1,
                explanation: "Authentication verifies WHO you are; authorization determines WHAT you can do."
            },
            {
                question: "Which protocol provides AUTHORIZATION but NOT authentication?",
                options: ["Kerberos", "SAML", "OAuth 2.0", "OpenID Connect"],
                correct: 2,
                explanation: "OAuth 2.0 is an authorization framework‚Äîit grants access but doesn't verify identity."
            },
            {
                question: "User accounts that remain active after an employee leaves are called:",
                options: ["Dormant accounts", "Orphaned accounts", "Service accounts", "Privileged accounts"],
                correct: 1,
                explanation: "Orphaned accounts remain active after departure‚Äîa major security vulnerability."
            },
            {
                question: "Which model assigns permissions based on job functions?",
                options: ["DAC", "MAC", "RBAC", "Rule-Based"],
                correct: 2,
                explanation: "RBAC assigns permissions to roles (job functions), then users are assigned to roles."
            },
            {
                question: "Separation of Duties requires that:",
                options: ["Users change passwords regularly", "Critical tasks are divided among multiple people", "All data is encrypted", "Backups are performed daily"],
                correct: 1,
                explanation: "SoD divides critical tasks so no single person has complete control over high-risk processes."
            },
            {
                question: "What is the KEY difference between RADIUS and TACACS+?",
                options: ["RADIUS uses TCP; TACACS+ uses UDP", "TACACS+ encrypts entire packet; RADIUS only encrypts password", "RADIUS separates AAA; TACACS+ combines them", "TACACS+ is open standard; RADIUS is proprietary"],
                correct: 1,
                explanation: "TACACS+ encrypts everything and uses TCP; RADIUS only encrypts password and uses UDP."
            },
            {
                question: "Which Zero Trust principle states 'access should be continuously verified'?",
                options: ["Verify Explicitly", "Assume Breach", "Least Privilege", "Defense in Depth"],
                correct: 0,
                explanation: "Verify Explicitly means always authenticate and authorize based on all data points for every request."
            },
            {
                question: "What does Kerberos issue after initial authentication?",
                options: ["Access Token", "Security Identifier (SID)", "Ticket Granting Ticket (TGT)", "SAML Assertion"],
                correct: 2,
                explanation: "After authentication, Kerberos KDC issues a TGT used to request service tickets."
            },
            {
                question: "SAML was NOT designed for which type of application?",
                options: ["Enterprise web applications", "B2B systems", "Mobile applications", "Cloud SaaS applications"],
                correct: 2,
                explanation: "SAML predates mobile devices‚ÄîOIDC is preferred for mobile apps."
            },
            {
                question: "Which access control model uses If-Then-Else policy statements?",
                options: ["RBAC", "DAC", "ABAC", "MAC"],
                correct: 2,
                explanation: "ABAC uses policies combining multiple attributes in If-Then-Else logic."
            },
            {
                question: "Mandatory vacations help detect fraud because:",
                options: ["Employees return refreshed", "Others perform duties and may find irregularities", "It reduces burnout", "It's required by law"],
                correct: 1,
                explanation: "Many frauds require perpetrator's daily presence‚Äîwhen absent, discrepancies surface."
            },
            {
                question: "LDAPS provides what that standard LDAP does not?",
                options: ["User authentication", "Directory services", "Encrypted communication", "Group membership"],
                correct: 2,
                explanation: "LDAPS (LDAP over SSL/TLS) encrypts communication; standard LDAP is cleartext."
            },
            {
                question: "In ZTNA, what happens BEFORE accessing an application?",
                options: ["VPN tunnel established to entire network", "User identity and device posture verified", "Firewall rules disabled", "Network perimeter extended"],
                correct: 1,
                explanation: "ZTNA verifies identity and device health before granting application-specific access."
            },
            {
                question: "Windows Mandatory Integrity Control uses:",
                options: ["Certificates", "Tokens", "Security Identifiers (SIDs)", "Biometrics"],
                correct: 2,
                explanation: "Windows MIC assigns integrity levels using SIDs, enforced via UAC."
            }
        ];

        // ==================== STATE ====================
        let completedSections = new Set();
        let userAnswers = {};

        // ==================== QUIZ FUNCTIONS ====================
        function initQuiz() {
            const container = document.getElementById('quizForm');
            let html = '';
            
            quizQuestions.forEach((q, index) => {
                html += `
                    <fieldset class="quiz-question" id="question${index}">
                        <legend><h4>${index + 1}. ${q.question}</h4></legend>
                        <div class="quiz-options" role="radiogroup">
                            ${q.options.map((opt, optIndex) => `
                                <label class="quiz-option" id="q${index}opt${optIndex}">
                                    <input type="radio" name="question${index}" value="${optIndex}" 
                                           onchange="selectAnswer(${index}, ${optIndex})"
                                           aria-describedby="feedback${index}">
                                    <span>${String.fromCharCode(65 + optIndex)}. ${opt}</span>
                                </label>
                            `).join('')}
                        </div>
                        <div class="quiz-feedback" id="feedback${index}" role="alert" aria-live="polite"></div>
                    </fieldset>
                `;
            });
            
            container.innerHTML = html;
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;
        }

        function submitQuiz() {
            let correct = 0;
            
            quizQuestions.forEach((q, index) => {
                const feedback = document.getElementById(`feedback${index}`);
                const selectedOption = userAnswers[index];
                
                for (let i = 0; i < q.options.length; i++) {
                    document.getElementById(`q${index}opt${i}`).classList.remove('correct', 'incorrect');
                }
                
                if (selectedOption === undefined) {
                    feedback.innerHTML = `<strong>Not answered.</strong> ${q.explanation}`;
                    feedback.className = 'quiz-feedback show incorrect';
                    document.getElementById(`q${index}opt${q.correct}`).classList.add('correct');
                } else if (selectedOption === q.correct) {
                    correct++;
                    feedback.innerHTML = `<strong>Correct!</strong> ${q.explanation}`;
                    feedback.className = 'quiz-feedback show correct';
                    document.getElementById(`q${index}opt${selectedOption}`).classList.add('correct');
                } else {
                    feedback.innerHTML = `<strong>Incorrect.</strong> ${q.explanation}`;
                    feedback.className = 'quiz-feedback show incorrect';
                    document.getElementById(`q${index}opt${selectedOption}`).classList.add('incorrect');
                    document.getElementById(`q${index}opt${q.correct}`).classList.add('correct');
                }
            });
            
            const percentage = Math.round((correct / quizQuestions.length) * 100);
            const resultsDiv = document.getElementById('quizResults');
            const resultsContent = document.getElementById('resultsContent');
            
            let message = '';
            if (percentage >= 80) {
                message = `<div class="info-box success"><span class="info-icon" aria-hidden="true">üéâ</span><div><strong>Excellent!</strong> You've demonstrated strong understanding of Access Management.</div></div>`;
            } else if (percentage >= 60) {
                message = `<div class="info-box warning"><span class="info-icon" aria-hidden="true">üìö</span><div><strong>Good progress!</strong> Review missed sections before the exam.</div></div>`;
            } else {
                message = `<div class="info-box important"><span class="info-icon" aria-hidden="true">üìñ</span><div><strong>More study needed.</strong> Review all sections and retake the assessment.</div></div>`;
            }
            
            resultsContent.innerHTML = `<h3>Score: ${correct}/${quizQuestions.length} (${percentage}%)</h3>${message}`;
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
            
            announce(`Quiz submitted. Score: ${correct} out of ${quizQuestions.length}, ${percentage} percent.`);
            
            if (percentage >= 70) markComplete('quiz');
        }

        function resetQuiz() {
            userAnswers = {};
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('quizForm').reset();
            
            quizQuestions.forEach((q, index) => {
                for (let i = 0; i < q.options.length; i++) {
                    document.getElementById(`q${index}opt${i}`).classList.remove('correct', 'incorrect');
                }
                const feedback = document.getElementById(`feedback${index}`);
                feedback.className = 'quiz-feedback';
                feedback.innerHTML = '';
            });
            
            announce('Quiz has been reset.');
        }

        // ==================== NAVIGATION ====================
        const tabIds = ['intro', 'models', 'account', 'bestpractices', 'implementation', 'services', 'federation', 'zerotrust', 'quiz'];
        
        function handleTabKey(event, currentIndex) {
            let targetIndex = null;
            
            switch(event.key) {
                case 'ArrowRight':
                case 'ArrowDown':
                    targetIndex = (currentIndex + 1) % 9;
                    break;
                case 'ArrowLeft':
                case 'ArrowUp':
                    targetIndex = (currentIndex - 1 + 9) % 9;
                    break;
                case 'Home':
                    targetIndex = 0;
                    break;
                case 'End':
                    targetIndex = 8;
                    break;
                case 'Enter':
                case ' ':
                    event.preventDefault();
                    navigateTo(tabIds[currentIndex]);
                    return;
                default:
                    return;
            }
            
            if (targetIndex !== null) {
                event.preventDefault();
                // Automatically activate the tab (not just focus)
                navigateTo(tabIds[targetIndex]);
                // Focus the new tab after navigation
                const targetTab = document.getElementById('tab-' + tabIds[targetIndex]);
                if (targetTab) {
                    targetTab.focus();
                }
            }
        }
        
        function navigateTo(sectionId) {
            const tabs = document.querySelectorAll('.nav-tab');
            const sections = document.querySelectorAll('.section');
            
            tabs.forEach(tab => {
                const isSelected = tab.dataset.section === sectionId;
                tab.setAttribute('aria-selected', isSelected);
                tab.setAttribute('tabindex', isSelected ? '0' : '-1');
            });
            
            sections.forEach(section => {
                const isActive = section.id === sectionId;
                section.classList.toggle('active', isActive);
                section.hidden = !isActive;
            });
            
            const targetSection = document.getElementById(sectionId);
            targetSection.setAttribute('tabindex', '-1');
            targetSection.focus();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            announce(`Now viewing ${sectionId.replace(/([A-Z])/g, ' $1').trim()} section.`);
            updateProgress();
        }

        function markComplete(sectionId) {
            completedSections.add(sectionId);
            const tab = document.querySelector(`[data-section="${sectionId}"]`);
            if (!tab.querySelector('.completed-icon')) {
                const icon = document.createElement('span');
                icon.className = 'completed-icon';
                icon.setAttribute('aria-label', 'completed');
                icon.textContent = '‚úì';
                tab.appendChild(icon);
            }
            updateProgress();
        }

        function updateProgress() {
            const total = 9;
            const completed = completedSections.size;
            const percentage = Math.round((completed / total) * 100);
            
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressBar').setAttribute('aria-valuenow', percentage);
            document.getElementById('progressText').textContent = percentage;
        }

        // ==================== ACCORDION ====================
        function initAccordions() {
            document.querySelectorAll('.accordion-header').forEach(btn => {
                btn.addEventListener('click', () => toggleAccordion(btn));
                btn.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleAccordion(btn);
                    }
                });
            });
        }

        function toggleAccordion(btn) {
            const expanded = btn.getAttribute('aria-expanded') === 'true';
            btn.setAttribute('aria-expanded', !expanded);
            const content = document.getElementById(btn.getAttribute('aria-controls'));
            content.hidden = expanded;
        }

        // ==================== TAB KEYBOARD NAVIGATION ====================
        // Keyboard navigation is handled by inline onkeydown handlers
        // This function is kept for any additional initialization if needed
        function initTabNavigation() {
            // Inline handlers (onkeydown, onclick) on tab buttons handle all interaction
            // No additional setup required
        }

        // ==================== KEYBOARD HELP ====================
        function toggleKeyboardHelp() {
            const panel = document.getElementById('keyboardPanel');
            const btn = panel.previousElementSibling;
            const isShown = panel.classList.contains('show');
            
            panel.classList.toggle('show');
            btn.setAttribute('aria-expanded', !isShown);
            
            if (!isShown) {
                panel.focus();
            }
        }

        // Close keyboard help on Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const panel = document.getElementById('keyboardPanel');
                if (panel.classList.contains('show')) {
                    toggleKeyboardHelp();
                }
            }
        });

        // ==================== TOOLTIP POSITIONING ====================
        function initTooltips() {
            const tooltips = document.querySelectorAll('.tooltip-term');
            
            tooltips.forEach(term => {
                const popup = term.querySelector('.tooltip-popup');
                if (!popup) return;
                
                function showTooltip() {
                    // Get term position
                    const rect = term.getBoundingClientRect();
                    const popupWidth = 300;
                    const padding = 16;
                    
                    // Calculate horizontal position
                    let left = rect.left + (rect.width / 2) - (popupWidth / 2);
                    
                    // Clamp to viewport bounds
                    if (left < padding) {
                        left = padding;
                    } else if (left + popupWidth > window.innerWidth - padding) {
                        left = window.innerWidth - popupWidth - padding;
                    }
                    
                    // Calculate arrow position relative to popup
                    const termCenter = rect.left + (rect.width / 2);
                    const arrowLeft = Math.max(20, Math.min(popupWidth - 20, termCenter - left));
                    
                    // Position above the term
                    const top = rect.top - 8;
                    
                    // Apply positioning
                    popup.style.left = left + 'px';
                    popup.style.bottom = (window.innerHeight - top) + 'px';
                    popup.style.top = 'auto';
                    popup.style.setProperty('--arrow-left', arrowLeft + 'px');
                    
                    popup.classList.add('visible');
                }
                
                function hideTooltip() {
                    popup.classList.remove('visible');
                }
                
                // Mouse events
                term.addEventListener('mouseenter', showTooltip);
                term.addEventListener('mouseleave', hideTooltip);
                
                // Keyboard events
                term.addEventListener('focus', showTooltip);
                term.addEventListener('blur', hideTooltip);
                
                // Escape to close
                term.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        hideTooltip();
                        term.blur();
                    }
                });
            });
        }

        // ==================== ANNOUNCEMENTS ====================
        function announce(message) {
            const region = document.getElementById('liveRegion');
            region.textContent = '';
            setTimeout(() => { region.textContent = message; }, 100);
        }

        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Wrap tables in scrollable containers for small screens
            document.querySelectorAll('.comparison-table').forEach(table => {
                const wrapper = document.createElement('div');
                wrapper.className = 'table-wrapper';
                wrapper.setAttribute('tabindex', '0');
                wrapper.setAttribute('role', 'region');
                wrapper.setAttribute('aria-label', 'Scrollable table');
                table.parentNode.insertBefore(wrapper, table);
                wrapper.appendChild(table);
            });
            
            initQuiz();
            initAccordions();
            initTabNavigation();
            initTooltips();
            updateProgress();
        });
    </script>
</body>
</html>
