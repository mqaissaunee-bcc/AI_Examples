<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Wireshark Training Course - 6 Hour Program</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #1976d2;
            --secondary-color: #0d47a1;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f5f5f5;
            --dark-text: #333;
            --border-color: #ddd;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background: var(--light-bg);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background: var(--secondary-color);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar h1 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.3);
        }

        .course-info {
            font-size: 0.9rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            opacity: 0.7;
        }

        .nav-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .nav-item .duration {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .progress-indicator {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-color);
            transition: width 0.3s;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 40px;
            background: white;
        }

        .module {
            display: none;
        }

        .module.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .module-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .module-meta {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .content-section {
            margin-bottom: 40px;
        }

        .content-section h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .content-section h4 {
            color: var(--secondary-color);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        .info-box {
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
            background: #e3f2fd;
        }

        .warning-box {
            border-left-color: var(--warning-color);
            background: #fff3e0;
        }

        .tip-box {
            border-left-color: var(--success-color);
            background: #e8f5e9;
        }

        .code-block {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .command {
            background: #37474f;
            color: #ffeb3b;
            padding: 5px 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
        }

        tr:nth-child(even) {
            background: var(--light-bg);
        }

        /* Knowledge Check */
        .knowledge-check {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
            border: 2px solid var(--primary-color);
        }

        .question {
            margin-bottom: 25px;
        }

        .question-text {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }

        .options {
            margin-left: 20px;
        }

        .option {
            padding: 10px;
            margin: 8px 0;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .option.correct {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .option.incorrect {
            background: var(--danger-color);
            color: white;
            border-color: var(--danger-color);
        }

        .feedback {
            margin-top: 10px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Hands-on Exercise */
        .exercise {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .exercise h4 {
            color: white;
            font-size: 1.4rem;
            margin-bottom: 15px;
        }

        .exercise-steps {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .exercise-steps ol {
            margin-left: 20px;
        }

        .exercise-steps li {
            margin: 10px 0;
        }

        /* Buttons */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-secondary {
            background: #757575;
            color: white;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        /* Resources Section */
        .resource-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .resource-card:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transform: translateY(-3px);
        }

        .resource-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .resource-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
        }

        .resource-link:hover {
            text-decoration: underline;
        }

        /* Installation Guide */
        .os-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .os-tab {
            padding: 10px 20px;
            background: var(--light-bg);
            border: 2px solid var(--border-color);
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .os-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .os-content {
            display: none;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 0 5px 5px 5px;
        }

        .os-content.active {
            display: block;
        }

        /* Capstone Project */
        .capstone {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .scenario-box {
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .requirements-list {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .container {
                flex-direction: column;
            }
        }

        /* Wireshark Interface Simulator Styles */
        .wireshark-simulator {
            margin: 30px 0;
            padding: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            border: 2px solid #ccc;
        }

        .ws-interface {
            background: white;
            border: 2px solid #333;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .clickable-area {
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .clickable-area:hover {
            background: rgba(25, 118, 210, 0.1) !important;
            transform: scale(1.01);
            z-index: 10;
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.5);
        }

        .ws-menu-bar {
            background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
            padding: 8px;
            border-bottom: 1px solid #aaa;
            display: flex;
            gap: 15px;
        }

        .ws-menu-item {
            padding: 4px 8px;
            cursor: pointer;
            font-size: 13px;
            color: #333;
        }

        .ws-menu-item:hover {
            background: #d0d0d0;
        }

        .ws-main-toolbar {
            background: linear-gradient(to bottom, #e8e8e8, #d8d8d8);
            padding: 8px;
            border-bottom: 1px solid #aaa;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .ws-toolbar-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #999;
            background: linear-gradient(to bottom, #f8f8f8, #e8e8e8);
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ws-toolbar-btn:hover {
            background: linear-gradient(to bottom, #fff, #f0f0f0);
            border-color: #666;
        }

        .ws-filter-toolbar {
            background: #f5f5f5;
            padding: 8px;
            border-bottom: 1px solid #aaa;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ws-filter-label {
            font-weight: bold;
            color: #333;
        }

        .ws-filter-input {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid #999;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: #e8f4fd;
        }

        .ws-filter-btn {
            width: 28px;
            height: 28px;
            border: 1px solid #999;
            background: linear-gradient(to bottom, #f8f8f8, #e8e8e8);
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
        }

        .ws-packet-list {
            background: white;
            padding: 0;
            min-height: 180px;
            max-height: 180px;
            overflow-y: auto;
            border-bottom: 2px solid #666;
        }

        .ws-packet-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .ws-packet-table thead {
            background: #e0e0e0;
            position: sticky;
            top: 0;
        }

        .ws-packet-table th {
            padding: 6px 8px;
            text-align: left;
            border-right: 1px solid #ccc;
            border-bottom: 1px solid #999;
            font-weight: bold;
            color: #000;
            background: #d0d0d0;
        }

        .ws-packet-table td {
            padding: 4px 8px;
            border-right: 1px solid #e0e0e0;
            border-bottom: 1px solid #f0f0f0;
        }

        .ws-tcp-packet {
            background: #e5e5ff;
        }

        .ws-http-packet {
            background: #c0ffc0;
        }

        .ws-dns-packet {
            background: #ffffc0;
        }

        .ws-selected {
            background: #0078d7 !important;
            color: white;
        }

        .ws-packet-details {
            background: white;
            padding: 10px;
            min-height: 150px;
            max-height: 150px;
            overflow-y: auto;
            border-bottom: 2px solid #666;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }

        .ws-detail-header {
            font-weight: bold;
            margin-bottom: 4px;
            color: #000;
        }

        .ws-detail-item {
            margin-left: 20px;
            margin-bottom: 3px;
            color: #333;
        }

        .ws-detail-expanded {
            color: #0066cc;
            font-weight: bold;
        }

        .ws-detail-subitem {
            margin-left: 40px;
            color: #666;
            font-size: 10px;
        }

        .ws-packet-bytes {
            background: white;
            padding: 10px;
            min-height: 120px;
            max-height: 120px;
            overflow-y: auto;
            border-bottom: 2px solid #666;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }

        .ws-bytes-row {
            display: flex;
            gap: 15px;
            margin-bottom: 3px;
        }

        .ws-bytes-offset {
            color: #0066cc;
            font-weight: bold;
            width: 50px;
        }

        .ws-bytes-hex {
            flex: 1;
            color: #000;
            letter-spacing: 1px;
        }

        .ws-bytes-ascii {
            width: 150px;
            color: #666;
        }

        .highlight-http {
            background: #ffff99;
            font-weight: bold;
        }

        .ws-status-bar {
            background: linear-gradient(to bottom, #e8e8e8, #d0d0d0);
            padding: 6px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            border-top: 1px solid #aaa;
        }

        .ws-status-left, .ws-status-center, .ws-status-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ws-expert-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4caf50;
            display: inline-block;
        }

        .ws-file-info {
            color: #0066cc;
        }

        /* Modal Styles */
        .component-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            animation: fadeIn 0.3s;
        }

        .component-modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            width: 80%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .component-modal-close {
            color: #aaa;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            line-height: 20px;
        }

        .component-modal-close:hover,
        .component-modal-close:focus {
            color: #000;
        }

        #modalTitle {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 20px;
        }

        #modalBody {
            font-size: 1rem;
            line-height: 1.8;
        }

        #modalBody ul {
            margin-left: 20px;
        }

        #modalBody strong {
            color: var(--secondary-color);
        }

        /* Print Styles */
        @media print {
            .sidebar, .navigation-buttons {
                display: none;
            }

            .main-content {
                margin-left: 0;
            }

            .component-modal {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <h1>Wireshark Mastery</h1>
            <div class="course-info">
                <p><strong>Duration:</strong> 6 Hours</p>
                <p><strong>Level:</strong> Beginner to Intermediate</p>
            </div>

            <div class="nav-section">
                <h3>Course Modules</h3>
                <div class="nav-item active" data-module="0">
                    <span>Introduction & Setup</span>
                    <span class="duration">30m</span>
                </div>
                <div class="nav-item" data-module="1">
                    <span>Interface & Basics</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="2">
                    <span>Capture & Display Filters</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="3">
                    <span>Protocol Analysis</span>
                    <span class="duration">60m</span>
                </div>
                <div class="nav-item" data-module="4">
                    <span>Network Troubleshooting</span>
                    <span class="duration">60m</span>
                </div>
                <div class="nav-item" data-module="5">
                    <span>Security Analysis</span>
                    <span class="duration">60m</span>
                </div>
                <div class="nav-item" data-module="6">
                    <span>Advanced Features</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="7">
                    <span>Capstone Project</span>
                    <span class="duration">45m</span>
                </div>
            </div>

            <div class="progress-indicator">
                <strong>Course Progress</strong>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                </div>
                <p id="progressText">0% Complete</p>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Module 0: Introduction & Setup -->
            <div class="module active" data-module-id="0">
                <div class="module-header">
                    <h2>Module 1: Introduction & Setup</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 30 minutes</span>
                        <span>📚 Topics: 5</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Welcome to Wireshark Mastery</h3>
                    <p>Welcome to this comprehensive 6-hour training course on Wireshark, the world's most popular network protocol analyzer. Whether you're studying network administration or cybersecurity, Wireshark is an essential tool that will serve you throughout your career.</p>
                    
                    <div class="info-box">
                        <strong>What You'll Learn:</strong>
                        <ul>
                            <li>Capture and analyze network traffic in real-time</li>
                            <li>Troubleshoot network performance issues</li>
                            <li>Detect security threats and suspicious activity</li>
                            <li>Master protocol analysis for TCP/IP, HTTP, DNS, and more</li>
                            <li>Apply Wireshark skills to real-world scenarios</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>What is Wireshark?</h3>
                    <p>Wireshark is a free, open-source packet analyzer that captures network traffic and displays it in a human-readable format. It's used by network administrators, security professionals, developers, and educators worldwide.</p>
                    
                    <h4>Key Features</h4>
                    <ul>
                        <li><strong>Deep Inspection:</strong> Examine hundreds of protocols at the packet level</li>
                        <li><strong>Live Capture:</strong> Capture packets in real-time from various network interfaces</li>
                        <li><strong>Powerful Filtering:</strong> Filter packets using display and capture filters</li>
                        <li><strong>Rich VoIP Analysis:</strong> Analyze VoIP calls and play back audio streams</li>
                        <li><strong>Cross-Platform:</strong> Runs on Windows, macOS, Linux, and Unix</li>
                        <li><strong>Export Options:</strong> Save captures in multiple formats for analysis</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Did You Know?</strong> Wireshark was originally called Ethereal but was renamed in 2006. It now has over 20 million downloads annually and supports over 3,000 network protocols!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Installation Guide</h3>
                    <p>Follow these instructions to install Wireshark on your operating system:</p>

                    <div class="os-tabs">
                        <div class="os-tab active" data-os="windows">Windows</div>
                        <div class="os-tab" data-os="macos">macOS</div>
                        <div class="os-tab" data-os="linux">Linux</div>
                    </div>

                    <div class="os-content active" data-os-content="windows">
                        <h4>Installing Wireshark on Windows</h4>
                        <ol>
                            <li><strong>Download:</strong> Visit <a href="https://www.wireshark.org/download.html" class="resource-link" target="_blank">wireshark.org/download.html</a></li>
                            <li>Choose the <strong>Windows x64 Installer</strong> (latest stable version: 4.6.0)</li>
                            <li>Run the downloaded <span class="command">.exe</span> file as Administrator</li>
                            <li>During installation:
                                <ul>
                                    <li>✅ Install Npcap (packet capture driver) - <strong>Required</strong></li>
                                    <li>✅ Install USBPcap if you need to capture USB traffic</li>
                                    <li>Accept all default options for standard installation</li>
                                </ul>
                            </li>
                            <li>Complete the installation and restart if prompted</li>
                            <li>Launch Wireshark from the Start Menu or Desktop shortcut</li>
                        </ol>

                        <div class="warning-box">
                            <strong>⚠️ Important:</strong> You must install Npcap (the packet capture driver) for Wireshark to function. Without it, you won't be able to capture live traffic.
                        </div>

                        <div class="code-block">
# Verify Installation (PowerShell)
Get-Command wireshark
# Should show path to Wireshark executable

# Check Npcap is installed
Get-Service npcap
# Should show service running
                        </div>
                    </div>

                    <div class="os-content" data-os-content="macos">
                        <h4>Installing Wireshark on macOS</h4>
                        <ol>
                            <li><strong>Download:</strong> Visit <a href="https://www.wireshark.org/download.html" class="resource-link" target="_blank">wireshark.org/download.html</a></li>
                            <li>Choose the <strong>macOS Intel/ARM Installer</strong> (.dmg file)</li>
                            <li>Open the downloaded .dmg file</li>
                            <li>Drag Wireshark to your Applications folder</li>
                            <li>Launch Wireshark from Applications</li>
                            <li>Grant necessary permissions when prompted:
                                <ul>
                                    <li>System Preferences → Security & Privacy → Allow Wireshark</li>
                                    <li>May need to approve "System Extension"</li>
                                </ul>
                            </li>
                        </ol>

                        <div class="tip-box">
                            <strong>💡 Alternative:</strong> Install via Homebrew:
                            <div class="code-block">brew install --cask wireshark</div>
                        </div>

                        <div class="code-block">
# Verify Installation (Terminal)
which wireshark
# Should show: /Applications/Wireshark.app/Contents/MacOS/Wireshark

# Grant capture permissions (if needed)
sudo chmod +x /Library/Application\ Support/Wireshark/ChmodBPF/ChmodBPF
                        </div>

                        <div class="warning-box">
                            <strong>⚠️ macOS Security:</strong> You may need to go to System Preferences → Security & Privacy and click "Allow" after the first launch.
                        </div>
                    </div>

                    <div class="os-content" data-os-content="linux">
                        <h4>Installing Wireshark on Linux</h4>
                        
                        <strong>Ubuntu/Debian:</strong>
                        <div class="code-block">
# Update package list
sudo apt update

# Install Wireshark
sudo apt install wireshark

# During installation, select YES to allow non-root users to capture packets
# Add your user to the wireshark group
sudo usermod -a -G wireshark $USER

# Log out and back in for changes to take effect
# Or run: newgrp wireshark

# Launch Wireshark
wireshark
                        </div>

                        <strong>Fedora/Red Hat/CentOS:</strong>
                        <div class="code-block">
# Install Wireshark
sudo dnf install wireshark wireshark-qt

# Add user to wireshark group
sudo usermod -a -G wireshark $USER

# Launch Wireshark
wireshark
                        </div>

                        <strong>Arch Linux:</strong>
                        <div class="code-block">
# Install Wireshark
sudo pacman -S wireshark-qt

# Add user to wireshark group
sudo usermod -a -G wireshark $USER

# Launch Wireshark
wireshark
                        </div>

                        <div class="warning-box">
                            <strong>⚠️ Permissions:</strong> To capture packets as a non-root user, you must:
                            <ol>
                                <li>Add your user to the <span class="command">wireshark</span> group</li>
                                <li>Log out and log back in (or use <span class="command">newgrp wireshark</span>)</li>
                                <li>Alternatively, run with sudo: <span class="command">sudo wireshark</span> (not recommended for security reasons)</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Sample Capture Files (PCAP Resources)</h3>
                    <p>To practice without generating your own traffic, you can download sample PCAP files from these trusted sources:</p>

                    <div class="resource-card">
                        <h4>🔷 Wireshark Official Sample Captures</h4>
                        <p>The official Wireshark wiki contains hundreds of sample captures covering various protocols and scenarios.</p>
                        <a href="https://wiki.wireshark.org/SampleCaptures" class="resource-link" target="_blank">wiki.wireshark.org/SampleCaptures</a>
                    </div>

                    <div class="resource-card">
                        <h4>🔷 NETRESEC's PCAP Files</h4>
                        <p>Comprehensive list of PCAP repositories from various sources, including malware analysis samples.</p>
                        <a href="https://www.netresec.com/?page=PcapFiles" class="resource-link" target="_blank">netresec.com/?page=PcapFiles</a>
                    </div>

                    <div class="resource-card">
                        <h4>🔷 Malware Traffic Analysis</h4>
                        <p>Real-world malware traffic captures for security analysis practice (use in isolated environment).</p>
                        <a href="https://www.malware-traffic-analysis.net/" class="resource-link" target="_blank">malware-traffic-analysis.net</a>
                    </div>

                    <div class="resource-card">
                        <h4>🔷 The Ultimate PCAP</h4>
                        <p>A single PCAP file containing 80+ different protocols by Johannes Weber.</p>
                        <a href="https://weberblog.net/the-ultimate-pcap/" class="resource-link" target="_blank">weberblog.net/the-ultimate-pcap</a>
                    </div>

                    <div class="tip-box">
                        <strong>💡 For This Course:</strong> We'll reference specific captures from these sources throughout the modules. Bookmark these sites for future practice!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Sandbox Environment Setup</h3>
                    <p>Since you'll be working in a virtualized sandbox environment, here are some tips:</p>

                    <div class="info-box">
                        <strong>Working in Restricted Environments:</strong>
                        <ul>
                            <li><strong>Pre-captured Files:</strong> Use PCAP files instead of live capture when you can't access interfaces</li>
                            <li><strong>Loopback Interface:</strong> You can always capture on loopback (127.0.0.1/localhost)</li>
                            <li><strong>Generate Traffic:</strong> Create your own traffic by visiting websites, pinging servers, or using tools like curl</li>
                            <li><strong>Export Settings:</strong> Save your display filters and profiles for reuse</li>
                        </ul>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 1</h3>
                    <p><em>Test your understanding of this module. Click on your answer to check if you're correct.</em></p>

                    <div class="question">
                        <div class="question-text">1. What is the primary purpose of Wireshark?</div>
                        <div class="options">
                            <div class="option" data-correct="true">To capture and analyze network traffic at the packet level</div>
                            <div class="option" data-correct="false">To block malicious network traffic automatically</div>
                            <div class="option" data-correct="false">To speed up network connections</div>
                            <div class="option" data-correct="false">To replace network routers and switches</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which component is REQUIRED for Wireshark to capture packets on Windows?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Java Runtime Environment</div>
                            <div class="option" data-correct="true">Npcap (packet capture driver)</div>
                            <div class="option" data-correct="false">Python interpreter</div>
                            <div class="option" data-correct="false">Microsoft Office</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. On Linux, what must you do to capture packets as a non-root user?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Install a special kernel module</div>
                            <div class="option" data-correct="true">Add your user to the wireshark group</div>
                            <div class="option" data-correct="false">Use a VPN connection</div>
                            <div class="option" data-correct="false">Run Wireshark only at night</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What file extension is used for Wireshark capture files?</div>
                        <div class="options">
                            <div class="option" data-correct="false">.wsk or .wire</div>
                            <div class="option" data-correct="true">.pcap or .pcapng</div>
                            <div class="option" data-correct="false">.net or .cap</div>
                            <div class="option" data-correct="false">.pkt or .shark</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Approximately how many network protocols does Wireshark support?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Around 100</div>
                            <div class="option" data-correct="false">Around 500</div>
                            <div class="option" data-correct="true">Over 3,000</div>
                            <div class="option" data-correct="false">Exactly 256</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" disabled>← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Interface & Basics →</button>
                </div>
            </div>

            <!-- Module 1: Interface & Basics -->
            <div class="module" data-module-id="1">
                <div class="module-header">
                    <h2>Module 2: Interface & Basics</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding the Wireshark Interface</h3>
                    <p>When you first launch Wireshark, you'll see a clean interface divided into several key areas. Let's explore each component:</p>

                    <div class="info-box">
                        <strong>🖱️ Interactive Demo Below:</strong> Click on any colored area in the interface diagram to learn what that component does!
                    </div>

                    <!-- Interactive Wireshark Interface Simulator -->
                    <div class="wireshark-simulator">
                        <h4 style="text-align: center; margin-bottom: 15px;">Interactive Wireshark Interface</h4>
                        
                        <!-- The simulated interface -->
                        <div class="ws-interface">
                            <!-- Menu Bar -->
                            <div class="ws-menu-bar clickable-area" data-component="menu-bar">
                                <span class="ws-menu-item">File</span>
                                <span class="ws-menu-item">Edit</span>
                                <span class="ws-menu-item">View</span>
                                <span class="ws-menu-item">Go</span>
                                <span class="ws-menu-item">Capture</span>
                                <span class="ws-menu-item">Analyze</span>
                                <span class="ws-menu-item">Statistics</span>
                                <span class="ws-menu-item">Telephony</span>
                                <span class="ws-menu-item">Wireless</span>
                                <span class="ws-menu-item">Tools</span>
                                <span class="ws-menu-item">Help</span>
                            </div>

                            <!-- Main Toolbar -->
                            <div class="ws-main-toolbar clickable-area" data-component="main-toolbar">
                                <button class="ws-toolbar-btn" title="Start Capture">▶</button>
                                <button class="ws-toolbar-btn" title="Stop Capture">■</button>
                                <button class="ws-toolbar-btn" title="Restart Capture">↻</button>
                                <button class="ws-toolbar-btn" title="Open File">📁</button>
                                <button class="ws-toolbar-btn" title="Save">💾</button>
                                <button class="ws-toolbar-btn" title="Close">✖</button>
                                <button class="ws-toolbar-btn" title="Reload">⟳</button>
                                <button class="ws-toolbar-btn" title="Find Packet">🔍</button>
                                <button class="ws-toolbar-btn" title="Go Back">◀</button>
                                <button class="ws-toolbar-btn" title="Go Forward">▶</button>
                                <button class="ws-toolbar-btn" title="Go to Packet">→</button>
                                <button class="ws-toolbar-btn" title="Auto Scroll">↓</button>
                                <button class="ws-toolbar-btn" title="Colorize">🎨</button>
                                <button class="ws-toolbar-btn" title="Zoom In">+</button>
                                <button class="ws-toolbar-btn" title="Zoom Out">-</button>
                                <button class="ws-toolbar-btn" title="Resize">⇔</button>
                            </div>

                            <!-- Filter Toolbar -->
                            <div class="ws-filter-toolbar clickable-area" data-component="filter-toolbar">
                                <span class="ws-filter-label">Filter:</span>
                                <input type="text" class="ws-filter-input" placeholder="Apply a display filter..." value="http.request.method == &quot;GET&quot;">
                                <button class="ws-filter-btn">📌</button>
                                <button class="ws-filter-btn">⭐</button>
                                <button class="ws-filter-btn">↻</button>
                                <button class="ws-filter-btn">▶</button>
                                <button class="ws-filter-btn">✖</button>
                            </div>

                            <!-- Packet List Pane -->
                            <div class="ws-packet-list clickable-area" data-component="packet-list">
                                <table class="ws-packet-table">
                                    <thead>
                                        <tr>
                                            <th>No.</th>
                                            <th>Time</th>
                                            <th>Source</th>
                                            <th>Destination</th>
                                            <th>Protocol</th>
                                            <th>Length</th>
                                            <th>Info</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="ws-tcp-packet">
                                            <td>1</td>
                                            <td>0.000000</td>
                                            <td>192.168.1.100</td>
                                            <td>93.184.216.34</td>
                                            <td>TCP</td>
                                            <td>66</td>
                                            <td>52841 → 80 [SYN]</td>
                                        </tr>
                                        <tr class="ws-tcp-packet">
                                            <td>2</td>
                                            <td>0.023456</td>
                                            <td>93.184.216.34</td>
                                            <td>192.168.1.100</td>
                                            <td>TCP</td>
                                            <td>66</td>
                                            <td>80 → 52841 [SYN, ACK]</td>
                                        </tr>
                                        <tr class="ws-tcp-packet">
                                            <td>3</td>
                                            <td>0.023567</td>
                                            <td>192.168.1.100</td>
                                            <td>93.184.216.34</td>
                                            <td>TCP</td>
                                            <td>54</td>
                                            <td>52841 → 80 [ACK]</td>
                                        </tr>
                                        <tr class="ws-http-packet ws-selected">
                                            <td>4</td>
                                            <td>0.023678</td>
                                            <td>192.168.1.100</td>
                                            <td>93.184.216.34</td>
                                            <td>HTTP</td>
                                            <td>485</td>
                                            <td>GET /index.html HTTP/1.1</td>
                                        </tr>
                                        <tr class="ws-http-packet">
                                            <td>5</td>
                                            <td>0.156789</td>
                                            <td>93.184.216.34</td>
                                            <td>192.168.1.100</td>
                                            <td>HTTP</td>
                                            <td>1514</td>
                                            <td>HTTP/1.1 200 OK</td>
                                        </tr>
                                        <tr class="ws-dns-packet">
                                            <td>6</td>
                                            <td>0.234567</td>
                                            <td>192.168.1.100</td>
                                            <td>8.8.8.8</td>
                                            <td>DNS</td>
                                            <td>74</td>
                                            <td>Standard query A example.com</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Packet Details Pane -->
                            <div class="ws-packet-details clickable-area" data-component="packet-details">
                                <div class="ws-detail-header">▼ Frame 4: 485 bytes on wire</div>
                                <div class="ws-detail-item">  ▼ Ethernet II, Src: Apple_12:34:56, Dst: Cisco_ab:cd:ef</div>
                                <div class="ws-detail-item">  ▼ Internet Protocol Version 4, Src: 192.168.1.100, Dst: 93.184.216.34</div>
                                <div class="ws-detail-item">  ▼ Transmission Control Protocol, Src Port: 52841, Dst Port: 80</div>
                                <div class="ws-detail-item ws-detail-expanded">  ▼ Hypertext Transfer Protocol</div>
                                <div class="ws-detail-subitem">      GET /index.html HTTP/1.1\r\n</div>
                                <div class="ws-detail-subitem">      Host: example.com\r\n</div>
                                <div class="ws-detail-subitem">      User-Agent: Mozilla/5.0\r\n</div>
                                <div class="ws-detail-subitem">      Accept: */*\r\n</div>
                            </div>

                            <!-- Packet Bytes Pane -->
                            <div class="ws-packet-bytes clickable-area" data-component="packet-bytes">
                                <div class="ws-bytes-row">
                                    <span class="ws-bytes-offset">0000</span>
                                    <span class="ws-bytes-hex">00 1a a0 ab cd ef a4 83 e7 12 34 56 08 00 45 00</span>
                                    <span class="ws-bytes-ascii">..........4V..E.</span>
                                </div>
                                <div class="ws-bytes-row">
                                    <span class="ws-bytes-offset">0010</span>
                                    <span class="ws-bytes-hex">01 d7 8f 3c 40 00 40 06 4d 5e c0 a8 01 64 5d b8</span>
                                    <span class="ws-bytes-ascii">...&lt;@.@.M^...d].</span>
                                </div>
                                <div class="ws-bytes-row">
                                    <span class="ws-bytes-offset">0020</span>
                                    <span class="ws-bytes-hex">d8 22 ce 89 00 50 3f 8a 47 12 00 00 00 00 a0 02</span>
                                    <span class="ws-bytes-ascii">."...P?.G.......</span>
                                </div>
                                <div class="ws-bytes-row">
                                    <span class="ws-bytes-offset">0030</span>
                                    <span class="ws-bytes-hex highlight-http">47 45 54 20 2f 69 6e 64 65 78 2e 68 74 6d 6c 20</span>
                                    <span class="ws-bytes-ascii highlight-http">GET /index.html </span>
                                </div>
                            </div>

                            <!-- Status Bar -->
                            <div class="ws-status-bar clickable-area" data-component="status-bar">
                                <span class="ws-status-left">
                                    <span class="ws-expert-indicator">●</span>
                                    <span class="ws-file-info">📄 capture.pcapng</span>
                                </span>
                                <span class="ws-status-center">Packets: 6 • Displayed: 6 • Marked: 0</span>
                                <span class="ws-status-right">Profile: Default</span>
                            </div>
                        </div>
                    </div>

                    <!-- Modal for component information -->
                    <div id="componentModal" class="component-modal">
                        <div class="component-modal-content">
                            <span class="component-modal-close">&times;</span>
                            <h3 id="modalTitle"></h3>
                            <div id="modalBody"></div>
                        </div>
                    </div>

                    <h4>Main Interface Components</h4>
                    <table>
                        <tr>
                            <th>Component</th>
                            <th>Description</th>
                            <th>Purpose</th>
                        </tr>
                        <tr>
                            <td><strong>Menu Bar</strong></td>
                            <td>Top menu (File, Edit, View, etc.)</td>
                            <td>Access all Wireshark features and settings</td>
                        </tr>
                        <tr>
                            <td><strong>Main Toolbar</strong></td>
                            <td>Quick access buttons below menu</td>
                            <td>Start/stop captures, open files, filters</td>
                        </tr>
                        <tr>
                            <td><strong>Filter Toolbar</strong></td>
                            <td>Display filter input field</td>
                            <td>Filter packets in current capture</td>
                        </tr>
                        <tr>
                            <td><strong>Packet List Pane</strong></td>
                            <td>Top pane showing all packets</td>
                            <td>Browse captured packets chronologically</td>
                        </tr>
                        <tr>
                            <td><strong>Packet Details Pane</strong></td>
                            <td>Middle pane with protocol tree</td>
                            <td>Examine packet structure in detail</td>
                        </tr>
                        <tr>
                            <td><strong>Packet Bytes Pane</strong></td>
                            <td>Bottom pane showing raw data</td>
                            <td>View hexadecimal and ASCII data</td>
                        </tr>
                        <tr>
                            <td><strong>Status Bar</strong></td>
                            <td>Bottom bar with statistics</td>
                            <td>Display packet count, time, profile info</td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Starting Your First Capture</h3>
                    
                    <h4>Step 1: Select an Interface</h4>
                    <p>When Wireshark starts, you'll see a list of available network interfaces. Each interface shows real-time activity with a mini sparkline graph.</p>
                    
                    <div class="info-box">
                        <strong>Common Interface Types:</strong>
                        <ul>
                            <li><strong>Ethernet (eth0, en0):</strong> Wired network connection</li>
                            <li><strong>Wi-Fi (wlan0, en1):</strong> Wireless network connection</li>
                            <li><strong>Loopback (lo0, 127.0.0.1):</strong> Local machine traffic only</li>
                            <li><strong>USB, Bluetooth:</strong> Specialized capture interfaces</li>
                        </ul>
                    </div>

                    <h4>Step 2: Start Capturing</h4>
                    <ol>
                        <li>Double-click an active interface, OR</li>
                        <li>Select an interface and click the blue shark fin icon, OR</li>
                        <li>Use menu: <strong>Capture → Start</strong> (Ctrl+E)</li>
                    </ol>

                    <h4>Step 3: Stop Capturing</h4>
                    <ul>
                        <li>Click the red square icon, OR</li>
                        <li>Use menu: <strong>Capture → Stop</strong> (Ctrl+E), OR</li>
                        <li>Set capture filters to automatically stop after N packets/seconds</li>
                    </ul>

                    <div class="warning-box">
                        <strong>⚠️ Caution:</strong> Capturing on busy networks generates massive amounts of data quickly. Always use capture filters or time limits to avoid overwhelming your system!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding Packet Information</h3>
                    
                    <h4>Packet List Pane Columns</h4>
                    <table>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td><strong>No.</strong></td>
                            <td>Packet number in capture</td>
                            <td>1, 2, 3...</td>
                        </tr>
                        <tr>
                            <td><strong>Time</strong></td>
                            <td>Timestamp (relative to capture start)</td>
                            <td>0.000000, 0.523451</td>
                        </tr>
                        <tr>
                            <td><strong>Source</strong></td>
                            <td>Source IP/MAC address</td>
                            <td>192.168.1.100</td>
                        </tr>
                        <tr>
                            <td><strong>Destination</strong></td>
                            <td>Destination IP/MAC address</td>
                            <td>10.0.0.5</td>
                        </tr>
                        <tr>
                            <td><strong>Protocol</strong></td>
                            <td>Highest-level protocol detected</td>
                            <td>TCP, HTTP, DNS</td>
                        </tr>
                        <tr>
                            <td><strong>Length</strong></td>
                            <td>Total packet size in bytes</td>
                            <td>66, 1514</td>
                        </tr>
                        <tr>
                            <td><strong>Info</strong></td>
                            <td>Protocol-specific information</td>
                            <td>GET /index.html</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 Customizing Columns:</strong> Right-click column headers → Column Preferences to add, remove, or reorder columns. You can add custom columns for specific protocol fields!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Color Coding</h3>
                    <p>Wireshark uses colors to help you quickly identify different packet types:</p>

                    <table>
                        <tr>
                            <th>Color</th>
                            <th>Protocol/Type</th>
                            <th>Meaning</th>
                        </tr>
                        <tr>
                            <td style="background: #a0d0ff;">Light Blue</td>
                            <td>UDP</td>
                            <td>User Datagram Protocol traffic</td>
                        </tr>
                        <tr>
                            <td style="background: #e5e5ff;">Light Purple</td>
                            <td>TCP</td>
                            <td>Transmission Control Protocol traffic</td>
                        </tr>
                        <tr>
                            <td style="background: #000000; color: white;">Black</td>
                            <td>TCP Errors</td>
                            <td>Retransmissions, bad checksums</td>
                        </tr>
                        <tr>
                            <td style="background: #ffc0c0;">Light Red</td>
                            <td>TCP Problems</td>
                            <td>Previous segment not captured</td>
                        </tr>
                        <tr>
                            <td style="background: #c0ffc0;">Light Green</td>
                            <td>HTTP</td>
                            <td>HTTP protocol traffic</td>
                        </tr>
                        <tr>
                            <td style="background: #ffffc0;">Light Yellow</td>
                            <td>Routing</td>
                            <td>ICMP, routing protocols</td>
                        </tr>
                        <tr>
                            <td style="background: #e0e0e0;">Gray</td>
                            <td>Malformed</td>
                            <td>Malformed packets</td>
                        </tr>
                    </table>

                    <div class="info-box">
                        <strong>Customizing Colors:</strong> View → Coloring Rules allows you to create custom color schemes based on display filters.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Working with Files</h3>
                    
                    <h4>Opening Capture Files</h4>
                    <p>Wireshark supports multiple capture file formats:</p>
                    <ul>
                        <li><strong>.pcap</strong> - Standard libpcap format</li>
                        <li><strong>.pcapng</strong> - Next generation format (recommended, more features)</li>
                        <li><strong>.cap</strong> - Multiple formats use this extension</li>
                        <li>Many others (snoop, NetMon, etc.)</li>
                    </ul>

                    <div class="code-block">
# Open via menu
File → Open → Select file

# Open via command line (useful for automation)
wireshark -r capture.pcap

# Merge multiple captures
wireshark -r capture1.pcap -r capture2.pcap
                    </div>

                    <h4>Saving Captures</h4>
                    <div class="code-block">
# Save current capture
File → Save As... (Ctrl+Shift+S)

# Save only displayed packets (after applying filter)
File → Export Specified Packets → Displayed packets

# Save only selected packets
Select packets → File → Export Selected Packets
                    </div>

                    <div class="tip-box">
                        <strong>💡 Best Practice:</strong> Always save in <strong>.pcapng</strong> format - it supports multiple interfaces, packet comments, name resolution, and other enhanced features.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Basic Statistics</h3>
                    <p>Wireshark provides powerful built-in statistics to understand your traffic at a glance:</p>

                    <h4>Key Statistics Tools</h4>
                    <table>
                        <tr>
                            <th>Tool</th>
                            <th>Menu Path</th>
                            <th>Use Case</th>
                        </tr>
                        <tr>
                            <td><strong>Capture File Properties</strong></td>
                            <td>Statistics → Capture File Properties</td>
                            <td>See capture duration, size, interface info</td>
                        </tr>
                        <tr>
                            <td><strong>Protocol Hierarchy</strong></td>
                            <td>Statistics → Protocol Hierarchy</td>
                            <td>See percentage of each protocol</td>
                        </tr>
                        <tr>
                            <td><strong>Conversations</strong></td>
                            <td>Statistics → Conversations</td>
                            <td>See all connections by protocol</td>
                        </tr>
                        <tr>
                            <td><strong>Endpoints</strong></td>
                            <td>Statistics → Endpoints</td>
                            <td>See all communicating devices</td>
                        </tr>
                        <tr>
                            <td><strong>I/O Graphs</strong></td>
                            <td>Statistics → I/O Graphs</td>
                            <td>Visualize traffic over time</td>
                        </tr>
                    </table>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Your First Capture</h4>
                    <p>Let's practice capturing and examining network traffic:</p>

                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Start a capture</strong> on your active network interface (Wi-Fi or Ethernet)</li>
                            <li>Open a web browser and visit <strong>http://example.com</strong> (not HTTPS for now)</li>
                            <li>Wait 10 seconds, then <strong>stop the capture</strong></li>
                            <li><strong>Find HTTP traffic:</strong> Type <span class="command">http</span> in the display filter bar and press Enter</li>
                            <li><strong>Examine a packet:</strong> Click on an HTTP GET request
                                <ul>
                                    <li>Look at the Packet Details pane - expand the HTTP section</li>
                                    <li>Find the "Host:" header</li>
                                    <li>Look at the Packet Bytes pane - can you read the HTTP request?</li>
                                </ul>
                            </li>
                            <li><strong>View statistics:</strong> Go to Statistics → Protocol Hierarchy
                                <ul>
                                    <li>What percentage is HTTP?</li>
                                    <li>What percentage is TCP?</li>
                                </ul>
                            </li>
                            <li><strong>Save your capture:</strong> File → Save As → "my_first_capture.pcapng"</li>
                        </ol>
                    </div>

                    <div class="tip-box">
                        <strong>💡 Challenge:</strong> Can you find the DNS query that resolved example.com? (Filter: <span class="command">dns</span>)
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 2</h3>

                    <div class="question">
                        <div class="question-text">1. Which pane shows the hexadecimal and ASCII representation of packet data?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Packet List Pane</div>
                            <div class="option" data-correct="false">Packet Details Pane</div>
                            <div class="option" data-correct="true">Packet Bytes Pane</div>
                            <div class="option" data-correct="false">Statistics Pane</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What color typically indicates TCP traffic in Wireshark's default coloring scheme?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Light Blue</div>
                            <div class="option" data-correct="true">Light Purple</div>
                            <div class="option" data-correct="false">Light Green</div>
                            <div class="option" data-correct="false">Light Yellow</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. Which file format is recommended for saving Wireshark captures?</div>
                        <div class="options">
                            <div class="option" data-correct="false">.pcap (older format)</div>
                            <div class="option" data-correct="true">.pcapng (newer format with more features)</div>
                            <div class="option" data-correct="false">.txt (text format)</div>
                            <div class="option" data-correct="false">.xml (extensible markup)</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. Which statistics tool shows the percentage breakdown of protocols in your capture?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Conversations</div>
                            <div class="option" data-correct="false">Endpoints</div>
                            <div class="option" data-correct="true">Protocol Hierarchy</div>
                            <div class="option" data-correct="false">I/O Graphs</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What does the loopback interface (127.0.0.1) capture?</div>
                        <div class="options">
                            <div class="option" data-correct="false">All network traffic on the subnet</div>
                            <div class="option" data-correct="true">Only traffic between applications on the local machine</div>
                            <div class="option" data-correct="false">Internet traffic only</div>
                            <div class="option" data-correct="false">Wireless traffic only</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Filters →</button>
                </div>
            </div>

            <!-- Module 2: Capture & Display Filters -->
            <div class="module" data-module-id="2">
                <div class="module-header">
                    <h2>Module 3: Capture & Display Filters</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 4</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding Filters: The Key to Efficient Analysis</h3>
                    <p>Filters are the most powerful feature in Wireshark. They allow you to focus on exactly what you need to see, ignoring everything else. There are two types of filters:</p>

                    <table>
                        <tr>
                            <th>Filter Type</th>
                            <th>When Applied</th>
                            <th>Purpose</th>
                            <th>Syntax</th>
                        </tr>
                        <tr>
                            <td><strong>Capture Filters</strong></td>
                            <td>BEFORE capturing</td>
                            <td>Limit what packets are captured to disk</td>
                            <td>BPF (Berkeley Packet Filter)</td>
                        </tr>
                        <tr>
                            <td><strong>Display Filters</strong></td>
                            <td>AFTER capturing</td>
                            <td>Hide/show packets already captured</td>
                            <td>Wireshark Display Filter</td>
                        </tr>
                    </table>

                    <div class="warning-box">
                        <strong>⚠️ Critical Difference:</strong> Capture filters PREVENT packets from being saved (permanent), while display filters only HIDE packets temporarily (they're still in the file).
                    </div>
                </div>

                <div class="content-section">
                    <h3>Display Filters: Your Primary Tool</h3>
                    <p>Display filters are more flexible and powerful. You'll use them 90% of the time.</p>

                    <h4>Basic Display Filter Syntax</h4>
                    <div class="code-block">
# Filter by protocol
http
tcp
dns
udp
icmp

# Filter by IP address
ip.addr == 192.168.1.100        # Either source or destination
ip.src == 192.168.1.100         # Source only
ip.dst == 10.0.0.1              # Destination only

# Filter by port
tcp.port == 80                   # Either source or destination port
tcp.srcport == 443              # Source port only
tcp.dstport == 22               # Destination port only

# Filter by protocol and port
http and tcp.port == 80
                    </div>

                    <h4>Logical Operators</h4>
                    <table>
                        <tr>
                            <th>Operator</th>
                            <th>Syntax</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td>AND</td>
                            <td><span class="command">and</span> or <span class="command">&&</span></td>
                            <td><span class="command">ip.addr == 192.168.1.1 and tcp.port == 80</span></td>
                        </tr>
                        <tr>
                            <td>OR</td>
                            <td><span class="command">or</span> or <span class="command">||</span></td>
                            <td><span class="command">tcp.port == 80 or tcp.port == 443</span></td>
                        </tr>
                        <tr>
                            <td>NOT</td>
                            <td><span class="command">not</span> or <span class="command">!</span></td>
                            <td><span class="command">not arp</span></td>
                        </tr>
                    </table>

                    <h4>Comparison Operators</h4>
                    <table>
                        <tr>
                            <th>Operator</th>
                            <th>Meaning</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td><span class="command">==</span></td>
                            <td>Equal</td>
                            <td><span class="command">ip.addr == 192.168.1.1</span></td>
                        </tr>
                        <tr>
                            <td><span class="command">!=</span></td>
                            <td>Not equal</td>
                            <td><span class="command">tcp.port != 443</span></td>
                        </tr>
                        <tr>
                            <td><span class="command">&gt;</span></td>
                            <td>Greater than</td>
                            <td><span class="command">frame.len &gt; 1000</span></td>
                        </tr>
                        <tr>
                            <td><span class="command">&lt;</span></td>
                            <td>Less than</td>
                            <td><span class="command">tcp.window_size &lt; 1000</span></td>
                        </tr>
                        <tr>
                            <td><span class="command">contains</span></td>
                            <td>Contains string</td>
                            <td><span class="command">http.host contains "google"</span></td>
                        </tr>
                        <tr>
                            <td><span class="command">matches</span></td>
                            <td>Regex match</td>
                            <td><span class="command">http.request.uri matches "\.php$"</span></td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Essential Display Filters Cheat Sheet</h3>

                    <h4>Protocol Filters</h4>
                    <div class="code-block">
# Web traffic
http
http2
https
ssl
tls

# DNS queries and responses
dns
dns.qry.name == "example.com"
dns.flags.response == 1          # DNS responses only

# Email protocols
smtp
pop
imap

# File transfer
ftp
ftp-data
smb
smb2

# Remote access
ssh
telnet
rdp

# Network management
icmp
arp
dhcp
                    </div>

                    <h4>Common Practical Filters</h4>
                    <div class="code-block">
# Show only traffic to/from specific host
ip.addr == 192.168.1.100

# Show traffic between two hosts
ip.addr == 192.168.1.100 and ip.addr == 10.0.0.5

# Exclude broadcast and multicast
!(eth.dst == ff:ff:ff:ff:ff:ff) and !(ip.dst == 224.0.0.0/4)

# Show packets larger than 1000 bytes
frame.len > 1000

# Show HTTP GET requests only
http.request.method == "GET"

# Show HTTP errors (4xx, 5xx)
http.response.code >= 400

# Show TCP retransmissions (network problems!)
tcp.analysis.retransmission

# Show TCP connection resets
tcp.flags.reset == 1

# Show SYN packets (connection attempts)
tcp.flags.syn == 1 and tcp.flags.ack == 0

# Exclude common "noise" protocols
!(arp or dns or icmp or ssdp or mdns)
                    </div>

                    <h4>Advanced Filters</h4>
                    <div class="code-block">
# Follow TCP stream number 5
tcp.stream == 5

# Show packets with specific string in payload
frame contains "password"
tcp.payload contains "malware"

# Show packets from specific subnet
ip.src == 192.168.1.0/24

# Show slow HTTP responses (> 1 second)
http.time > 1

# Show packets with TCP flags
tcp.flags.push == 1              # PSH flag
tcp.flags.urgent == 1            # URG flag

# Show duplicate ACKs (performance issue indicator)
tcp.analysis.duplicate_ack

# Show zero window (receiving buffer full)
tcp.analysis.zero_window
                    </div>

                    <div class="tip-box">
                        <strong>💡 Pro Tip:</strong> Right-click on any field in the Packet Details pane → Apply as Filter → Selected to automatically create a filter for that field!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Capture Filters: When to Use Them</h3>
                    <p>Capture filters use Berkeley Packet Filter (BPF) syntax. Use them when:</p>
                    <ul>
                        <li>You're on a very busy network and want to reduce capture file size</li>
                        <li>You know exactly what you're looking for before starting</li>
                        <li>You have limited disk space</li>
                        <li>You want to improve performance during capture</li>
                    </ul>

                    <div class="warning-box">
                        <strong>⚠️ Warning:</strong> Capture filters are permanent! Once packets are not captured, you can't get them back. Use display filters unless you have a specific reason to use capture filters.
                    </div>

                    <h4>Setting Capture Filters</h4>
                    <p>Before starting capture: Capture → Capture Filters or click gear icon on interface</p>

                    <h4>Common Capture Filter Examples</h4>
                    <div class="code-block">
# Capture only traffic to/from specific host
host 192.168.1.100

# Capture only HTTP traffic
port 80

# Capture HTTP and HTTPS
port 80 or port 443

# Capture traffic on subnet
net 192.168.1.0/24

# Capture only TCP traffic
tcp

# Capture only UDP traffic
udp

# Exclude specific host
not host 192.168.1.100

# Capture between two hosts
host 192.168.1.100 and host 10.0.0.5

# Capture traffic to/from port range
portrange 80-443

# More complex: HTTP from specific IP
tcp port 80 and host 192.168.1.100
                    </div>

                    <h4>Key Differences: Display vs Capture Filter Syntax</h4>
                    <table>
                        <tr>
                            <th>Purpose</th>
                            <th>Display Filter</th>
                            <th>Capture Filter</th>
                        </tr>
                        <tr>
                            <td>Filter by IP</td>
                            <td><span class="command">ip.addr == 192.168.1.1</span></td>
                            <td><span class="command">host 192.168.1.1</span></td>
                        </tr>
                        <tr>
                            <td>Filter by port</td>
                            <td><span class="command">tcp.port == 80</span></td>
                            <td><span class="command">port 80</span></td>
                        </tr>
                        <tr>
                            <td>Filter by protocol</td>
                            <td><span class="command">tcp</span></td>
                            <td><span class="command">tcp</span></td>
                        </tr>
                        <tr>
                            <td>Exclude traffic</td>
                            <td><span class="command">!(arp)</span></td>
                            <td><span class="command">not arp</span></td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Filter Expression Builder</h3>
                    <p>Wireshark includes a graphical filter builder if you prefer not to memorize syntax:</p>
                    <ol>
                        <li>Click the bookmark icon next to the display filter bar</li>
                        <li>Or go to: Analyze → Display Filter Expression</li>
                        <li>Browse available fields and build filters visually</li>
                    </ol>

                    <div class="info-box">
                        <strong>Filter Autocomplete:</strong> As you type in the display filter bar, Wireshark shows suggestions. Press Tab to autocomplete!
                    </div>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Master Filters</h4>
                    <p>Download a sample capture and practice filtering:</p>

                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Download:</strong> Get a sample capture from <a href="https://wiki.wireshark.org/SampleCaptures" style="color: white; text-decoration: underline;" target="_blank">Wireshark Sample Captures</a>
                                <ul>
                                    <li>Try "http.cap" or "dns.cap" for beginners</li>
                                </ul>
                            </li>
                            <li><strong>Open the file</strong> in Wireshark</li>
                            <li><strong>Practice these display filters:</strong>
                                <ul>
                                    <li><span class="command">http</span> - Show only HTTP traffic</li>
                                    <li><span class="command">http.request.method == "GET"</span> - Show HTTP GET requests</li>
                                    <li><span class="command">ip.src == [pick an IP from capture]</span> - Traffic from specific source</li>
                                    <li><span class="command">http and ip.dst == [pick an IP]</span> - HTTP to specific destination</li>
                                </ul>
                            </li>
                            <li><strong>Use right-click filtering:</strong>
                                <ul>
                                    <li>Click a packet</li>
                                    <li>Right-click on "Source" or "Destination" in Packet Details</li>
                                    <li>Choose "Apply as Filter" → "Selected"</li>
                                </ul>
                            </li>
                            <li><strong>Combine filters:</strong>
                                <ul>
                                    <li>Try: <span class="command">http and (ip.src == X or ip.dst == X)</span></li>
                                    <li>Try: <span class="command">tcp.port == 80 and frame.len > 500</span></li>
                                </ul>
                            </li>
                            <li><strong>Save your favorite filter:</strong>
                                <ul>
                                    <li>Type a useful filter</li>
                                    <li>Click the "+" button next to filter bar</li>
                                    <li>Give it a name like "My HTTP Filter"</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 3</h3>

                    <div class="question">
                        <div class="question-text">1. What's the main difference between capture and display filters?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Capture filters are faster than display filters</div>
                            <div class="option" data-correct="true">Capture filters prevent packets from being saved; display filters only hide packets</div>
                            <div class="option" data-correct="false">Display filters use different protocols than capture filters</div>
                            <div class="option" data-correct="false">There is no difference; they're the same thing</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which display filter shows only HTTP GET requests?</div>
                        <div class="options">
                            <div class="option" data-correct="false">http.get == true</div>
                            <div class="option" data-correct="true">http.request.method == "GET"</div>
                            <div class="option" data-correct="false">tcp.port == 80 and method == GET</div>
                            <div class="option" data-correct="false">protocol == http.get</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. Which operator means "OR" in display filters?</div>
                        <div class="options">
                            <div class="option" data-correct="false">&amp; or AND</div>
                            <div class="option" data-correct="true">|| or or</div>
                            <div class="option" data-correct="false">+ or plus</div>
                            <div class="option" data-correct="false">/ or divide</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What does the filter "tcp.analysis.retransmission" show?</div>
                        <div class="options">
                            <div class="option" data-correct="false">All TCP packets</div>
                            <div class="option" data-correct="false">TCP packets with errors in the header</div>
                            <div class="option" data-correct="true">TCP packets that were retransmitted (potential network issue)</div>
                            <div class="option" data-correct="false">TCP packets larger than normal</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Which is the correct capture filter syntax to capture only HTTP traffic?</div>
                        <div class="options">
                            <div class="option" data-correct="false">tcp.port == 80</div>
                            <div class="option" data-correct="true">port 80</div>
                            <div class="option" data-correct="false">http</div>
                            <div class="option" data-correct="false">protocol == http</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Protocol Analysis →</button>
                </div>
            </div>

            <!-- Module 3: Protocol Analysis -->
            <div class="module" data-module-id="3">
                <div class="module-header">
                    <h2>Module 4: Protocol Analysis</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 60 minutes</span>
                        <span>📚 Topics: 8</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding Network Protocols</h3>
                    <p>Network communication relies on a stack of protocols working together. Wireshark excels at dissecting these protocols layer by layer, following the OSI and TCP/IP models.</p>

                    <h4>The OSI Model vs TCP/IP Model</h4>
                    <table>
                        <tr>
                            <th>OSI Layer</th>
                            <th>TCP/IP Layer</th>
                            <th>Protocols</th>
                            <th>What Wireshark Shows</th>
                        </tr>
                        <tr>
                            <td>7. Application</td>
                            <td rowspan="3">Application</td>
                            <td>HTTP, DNS, FTP, SMTP</td>
                            <td>Request/response data, commands</td>
                        </tr>
                        <tr>
                            <td>6. Presentation</td>
                            <td>TLS/SSL, MIME</td>
                            <td>Encryption, encoding</td>
                        </tr>
                        <tr>
                            <td>5. Session</td>
                            <td>NetBIOS, RPC</td>
                            <td>Session management</td>
                        </tr>
                        <tr>
                            <td>4. Transport</td>
                            <td>Transport</td>
                            <td>TCP, UDP</td>
                            <td>Ports, sequence numbers, flags</td>
                        </tr>
                        <tr>
                            <td>3. Network</td>
                            <td>Internet</td>
                            <td>IP, ICMP, ARP</td>
                            <td>IP addresses, routing, fragmentation</td>
                        </tr>
                        <tr>
                            <td>2. Data Link</td>
                            <td rowspan="2">Network Access</td>
                            <td>Ethernet, Wi-Fi</td>
                            <td>MAC addresses, frame structure</td>
                        </tr>
                        <tr>
                            <td>1. Physical</td>
                            <td>Physical media</td>
                            <td>Raw bits (not shown in Wireshark)</td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Ethernet & Data Link Layer</h3>
                    <p>Every packet in Wireshark starts with a frame header. Let's understand what you're seeing:</p>

                    <h4>Ethernet Frame Structure</h4>
                    <div class="code-block">
Frame 42: 74 bytes on wire (592 bits), 74 bytes captured
    Arrival Time: Oct 29, 2025 10:15:23.456789000 EDT
    Epoch Time: 1730211323.456789000 seconds
    [Time delta from previous: 0.000123000 seconds]
    Frame Number: 42
    Frame Length: 74 bytes (592 bits)
    Capture Length: 74 bytes (592 bits)

Ethernet II, Src: Apple_12:34:56, Dst: Cisco_ab:cd:ef
    Destination: Cisco_ab:cd:ef (00:1a:a0:ab:cd:ef)
    Source: Apple_12:34:56 (a4:83:e7:12:34:56)
    Type: IPv4 (0x0800)
                    </div>

                    <div class="info-box">
                        <strong>MAC Address Format:</strong>
                        <ul>
                            <li><strong>First 3 bytes (OUI):</strong> Manufacturer identifier (e.g., Apple, Cisco, Dell)</li>
                            <li><strong>Last 3 bytes:</strong> Device-specific identifier</li>
                            <li><strong>Broadcast address:</strong> ff:ff:ff:ff:ff:ff (sent to all devices on LAN)</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>IP (Internet Protocol)</h3>
                    <p>IP is responsible for routing packets across networks. Key fields to understand:</p>

                    <h4>IPv4 Header Fields</h4>
                    <table>
                        <tr>
                            <th>Field</th>
                            <th>Description</th>
                            <th>What to Look For</th>
                        </tr>
                        <tr>
                            <td><strong>Version</strong></td>
                            <td>IP version (4 or 6)</td>
                            <td>Should be 4 for IPv4</td>
                        </tr>
                        <tr>
                            <td><strong>Header Length</strong></td>
                            <td>Length of IP header</td>
                            <td>Typically 20 bytes (no options)</td>
                        </tr>
                        <tr>
                            <td><strong>Total Length</strong></td>
                            <td>Total packet size</td>
                            <td>Header + Data; max 65,535 bytes</td>
                        </tr>
                        <tr>
                            <td><strong>Time to Live (TTL)</strong></td>
                            <td>Hop limit</td>
                            <td>Decreases by 1 each hop; 0 = discard</td>
                        </tr>
                        <tr>
                            <td><strong>Protocol</strong></td>
                            <td>Next layer protocol</td>
                            <td>6=TCP, 17=UDP, 1=ICMP</td>
                        </tr>
                        <tr>
                            <td><strong>Source Address</strong></td>
                            <td>Sender's IP</td>
                            <td>Where packet came from</td>
                        </tr>
                        <tr>
                            <td><strong>Destination Address</strong></td>
                            <td>Receiver's IP</td>
                            <td>Where packet is going</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 TTL Insights:</strong>
                        <ul>
                            <li><strong>High TTL (64, 128, 255):</strong> Packet originated nearby</li>
                            <li><strong>Low TTL (1-10):</strong> Packet traveled through many routers</li>
                            <li><strong>Different OS defaults:</strong> Linux=64, Windows=128, Cisco=255</li>
                        </ul>
                    </div>

                    <h4>IP Fragmentation</h4>
                    <p>Large packets may be fragmented to fit network MTU (Maximum Transmission Unit, typically 1500 bytes for Ethernet):</p>
                    
                    <div class="code-block">
# Display filter for fragmented packets
ip.flags.mf == 1 or ip.frag_offset > 0

# Display filter for unfragmented packets only
ip.flags.df == 1
                    </div>
                </div>

                <div class="content-section">
                    <h3>TCP (Transmission Control Protocol)</h3>
                    <p>TCP provides reliable, ordered delivery of data. It's connection-oriented and uses a three-way handshake.</p>

                    <h4>TCP Three-Way Handshake</h4>
                    <table>
                        <tr>
                            <th>Step</th>
                            <th>Flags</th>
                            <th>Description</th>
                            <th>Filter</th>
                        </tr>
                        <tr>
                            <td>1. SYN</td>
                            <td>SYN=1</td>
                            <td>Client initiates connection</td>
                            <td><span class="command">tcp.flags.syn==1 && tcp.flags.ack==0</span></td>
                        </tr>
                        <tr>
                            <td>2. SYN-ACK</td>
                            <td>SYN=1, ACK=1</td>
                            <td>Server acknowledges and agrees</td>
                            <td><span class="command">tcp.flags.syn==1 && tcp.flags.ack==1</span></td>
                        </tr>
                        <tr>
                            <td>3. ACK</td>
                            <td>ACK=1</td>
                            <td>Client acknowledges, connection established</td>
                            <td><span class="command">tcp.flags.syn==0 && tcp.flags.ack==1</span></td>
                        </tr>
                    </table>

                    <h4>TCP Flags</h4>
                    <table>
                        <tr>
                            <th>Flag</th>
                            <th>Name</th>
                            <th>Purpose</th>
                        </tr>
                        <tr>
                            <td><strong>SYN</strong></td>
                            <td>Synchronize</td>
                            <td>Establish connection</td>
                        </tr>
                        <tr>
                            <td><strong>ACK</strong></td>
                            <td>Acknowledgment</td>
                            <td>Acknowledge received data</td>
                        </tr>
                        <tr>
                            <td><strong>FIN</strong></td>
                            <td>Finish</td>
                            <td>Close connection gracefully</td>
                        </tr>
                        <tr>
                            <td><strong>RST</strong></td>
                            <td>Reset</td>
                            <td>Abort connection (error/refused)</td>
                        </tr>
                        <tr>
                            <td><strong>PSH</strong></td>
                            <td>Push</td>
                            <td>Send data immediately (don't buffer)</td>
                        </tr>
                        <tr>
                            <td><strong>URG</strong></td>
                            <td>Urgent</td>
                            <td>Priority data (rarely used)</td>
                        </tr>
                    </table>

                    <h4>Key TCP Fields</h4>
                    <div class="code-block">
Internet Protocol Version 4, Src: 192.168.1.100, Dst: 10.0.0.5
Transmission Control Protocol, Src Port: 52841, Dst Port: 80
    Source Port: 52841
    Destination Port: 80 (http)
    Sequence Number: 1543
    Acknowledgment Number: 8947
    Header Length: 20 bytes
    Flags: 0x018 (PSH, ACK)
        .... ...0 = FIN: Not set
        .... ..0. = SYN: Not set
        .... .0.. = RST: Not set
        .... 1... = PSH: Set
        ...1 .... = ACK: Set
    Window Size: 64240
    [Checksum: 0x1a3f [correct]]
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ TCP Issues to Watch For:</strong>
                        <ul>
                            <li><strong>Retransmissions:</strong> <span class="command">tcp.analysis.retransmission</span> - Packet loss</li>
                            <li><strong>Duplicate ACKs:</strong> <span class="command">tcp.analysis.duplicate_ack</span> - Missing packets</li>
                            <li><strong>Zero Window:</strong> <span class="command">tcp.analysis.zero_window</span> - Receiver overwhelmed</li>
                            <li><strong>RST flags:</strong> <span class="command">tcp.flags.reset==1</span> - Connection problems</li>
                        </ul>
                    </div>

                    <h4>Following TCP Streams</h4>
                    <p>One of Wireshark's most powerful features - reconstructing entire conversations:</p>
                    <ol>
                        <li>Right-click any TCP packet</li>
                        <li>Choose "Follow" → "TCP Stream"</li>
                        <li>See the entire conversation in a readable format</li>
                        <li>Red = client→server, Blue = server→client</li>
                    </ol>

                    <div class="tip-box">
                        <strong>💡 Use Case:</strong> Following HTTP streams lets you see complete web requests and responses, including headers and content!
                    </div>
                </div>

                <div class="content-section">
                    <h3>UDP (User Datagram Protocol)</h3>
                    <p>UDP is connectionless and provides fast, unreliable delivery. Used for real-time applications where speed matters more than reliability.</p>

                    <h4>UDP vs TCP</h4>
                    <table>
                        <tr>
                            <th>Feature</th>
                            <th>TCP</th>
                            <th>UDP</th>
                        </tr>
                        <tr>
                            <td>Connection</td>
                            <td>Connection-oriented</td>
                            <td>Connectionless</td>
                        </tr>
                        <tr>
                            <td>Reliability</td>
                            <td>Guaranteed delivery</td>
                            <td>Best-effort (may lose packets)</td>
                        </tr>
                        <tr>
                            <td>Order</td>
                            <td>In-order delivery</td>
                            <td>No ordering guarantee</td>
                        </tr>
                        <tr>
                            <td>Speed</td>
                            <td>Slower (overhead)</td>
                            <td>Faster (minimal overhead)</td>
                        </tr>
                        <tr>
                            <td>Header Size</td>
                            <td>20+ bytes</td>
                            <td>8 bytes</td>
                        </tr>
                        <tr>
                            <td>Use Cases</td>
                            <td>Web, email, file transfer</td>
                            <td>DNS, streaming, gaming, VoIP</td>
                        </tr>
                    </table>

                    <h4>Common UDP Protocols</h4>
                    <div class="code-block">
# DNS queries (port 53)
udp.port == 53
dns

# DHCP (ports 67-68)
udp.port == 67 or udp.port == 68
bootp

# NTP (Network Time Protocol, port 123)
udp.port == 123
ntp

# SNMP (port 161)
udp.port == 161
snmp

# VoIP (SIP typically uses 5060)
udp.port == 5060
sip
                    </div>
                </div>

                <div class="content-section">
                    <h3>DNS (Domain Name System)</h3>
                    <p>DNS translates domain names to IP addresses. It typically uses UDP port 53.</p>

                    <h4>DNS Query/Response</h4>
                    <div class="code-block">
# Show DNS queries only
dns.flags.response == 0

# Show DNS responses only
dns.flags.response == 1

# Show queries for specific domain
dns.qry.name == "example.com"

# Show DNS A records (IPv4 addresses)
dns.qry.type == 1

# Show DNS AAAA records (IPv6 addresses)
dns.qry.type == 28

# Show DNS errors (NXDOMAIN, etc.)
dns.flags.rcode != 0
                    </div>

                    <h4>DNS Record Types</h4>
                    <table>
                        <tr>
                            <th>Type</th>
                            <th>Code</th>
                            <th>Purpose</th>
                        </tr>
                        <tr>
                            <td><strong>A</strong></td>
                            <td>1</td>
                            <td>IPv4 address</td>
                        </tr>
                        <tr>
                            <td><strong>AAAA</strong></td>
                            <td>28</td>
                            <td>IPv6 address</td>
                        </tr>
                        <tr>
                            <td><strong>CNAME</strong></td>
                            <td>5</td>
                            <td>Canonical name (alias)</td>
                        </tr>
                        <tr>
                            <td><strong>MX</strong></td>
                            <td>15</td>
                            <td>Mail server</td>
                        </tr>
                        <tr>
                            <td><strong>NS</strong></td>
                            <td>2</td>
                            <td>Name server</td>
                        </tr>
                        <tr>
                            <td><strong>PTR</strong></td>
                            <td>12</td>
                            <td>Reverse lookup (IP to name)</td>
                        </tr>
                        <tr>
                            <td><strong>TXT</strong></td>
                            <td>16</td>
                            <td>Text records (SPF, verification)</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 Security Insight:</strong> DNS tunneling attacks abuse DNS queries to exfiltrate data. Look for unusually large TXT records or excessive DNS queries to random subdomains.
                    </div>
                </div>

                <div class="content-section">
                    <h3>HTTP/HTTPS</h3>
                    <p>HTTP is the foundation of web communication. HTTPS is HTTP over TLS/SSL for security.</p>

                    <h4>HTTP Request Methods</h4>
                    <table>
                        <tr>
                            <th>Method</th>
                            <th>Purpose</th>
                            <th>Filter</th>
                        </tr>
                        <tr>
                            <td><strong>GET</strong></td>
                            <td>Retrieve resource</td>
                            <td><span class="command">http.request.method == "GET"</span></td>
                        </tr>
                        <tr>
                            <td><strong>POST</strong></td>
                            <td>Submit data</td>
                            <td><span class="command">http.request.method == "POST"</span></td>
                        </tr>
                        <tr>
                            <td><strong>PUT</strong></td>
                            <td>Upload/replace resource</td>
                            <td><span class="command">http.request.method == "PUT"</span></td>
                        </tr>
                        <tr>
                            <td><strong>DELETE</strong></td>
                            <td>Remove resource</td>
                            <td><span class="command">http.request.method == "DELETE"</span></td>
                        </tr>
                        <tr>
                            <td><strong>HEAD</strong></td>
                            <td>Get headers only</td>
                            <td><span class="command">http.request.method == "HEAD"</span></td>
                        </tr>
                    </table>

                    <h4>HTTP Status Codes</h4>
                    <div class="code-block">
# 2xx Success
http.response.code >= 200 and http.response.code < 300

# 3xx Redirects
http.response.code >= 300 and http.response.code < 400

# 4xx Client Errors
http.response.code >= 400 and http.response.code < 500

# 5xx Server Errors
http.response.code >= 500

# Specific codes
http.response.code == 200    # OK
http.response.code == 301    # Moved Permanently
http.response.code == 404    # Not Found
http.response.code == 500    # Internal Server Error
                    </div>

                    <h4>Analyzing HTTPS/TLS</h4>
                    <p>HTTPS traffic is encrypted, but you can still see:</p>
                    <ul>
                        <li>TLS handshake and cipher negotiation</li>
                        <li>Server certificates</li>
                        <li>SNI (Server Name Indication) - domain name in plaintext</li>
                        <li>Packet sizes and timing</li>
                    </ul>

                    <div class="code-block">
# TLS handshake packets
tls.handshake.type

# Show SNI (domain names in HTTPS)
tls.handshake.extensions_server_name

# Show certificate details
tls.handshake.certificate
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Privacy Note:</strong> To decrypt HTTPS traffic, you need the server's private key or configure browsers to log session keys (SSLKEYLOGFILE). This is only ethical in controlled lab environments you own!
                    </div>
                </div>

                <div class="content-section">
                    <h3>ICMP (Internet Control Message Protocol)</h3>
                    <p>ICMP is used for network diagnostics and error reporting.</p>

                    <h4>Common ICMP Types</h4>
                    <table>
                        <tr>
                            <th>Type</th>
                            <th>Code</th>
                            <th>Description</th>
                            <th>Example Use</th>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td>0</td>
                            <td>Echo Reply</td>
                            <td>Ping response</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>0-15</td>
                            <td>Destination Unreachable</td>
                            <td>Host/port unreachable</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>0</td>
                            <td>Echo Request</td>
                            <td>Ping request</td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td>0-1</td>
                            <td>Time Exceeded</td>
                            <td>TTL expired (traceroute)</td>
                        </tr>
                    </table>

                    <div class="code-block">
# Ping requests/replies
icmp.type == 8 or icmp.type == 0

# Destination unreachable
icmp.type == 3

# Time exceeded (traceroute)
icmp.type == 11
                    </div>
                </div>

                <div class="content-section">
                    <h3>ARP (Address Resolution Protocol)</h3>
                    <p>ARP maps IP addresses to MAC addresses on a local network.</p>

                    <div class="code-block">
# All ARP traffic
arp

# ARP requests (who has IP?)
arp.opcode == 1

# ARP replies (I have IP!)
arp.opcode == 2

# Look for specific IP
arp.dst.proto_ipv4 == 192.168.1.100
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Security Alert:</strong> ARP spoofing/poisoning attacks can redirect traffic. Look for:
                        <ul>
                            <li>Multiple ARP replies for the same IP with different MAC addresses</li>
                            <li>Gratuitous ARP packets (unsolicited replies)</li>
                        </ul>
                    </div>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Protocol Deep Dive</h4>
                    
                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Download sample captures:</strong>
                                <ul>
                                    <li>http.cap (HTTP traffic)</li>
                                    <li>dns.pcap (DNS queries)</li>
                                    <li>tcp-ethereal-trace-1.pcap (TCP handshake)</li>
                                </ul>
                                From: <a href="https://wiki.wireshark.org/SampleCaptures" style="color: white; text-decoration: underline;" target="_blank">wiki.wireshark.org/SampleCaptures</a>
                            </li>
                            <li><strong>TCP Analysis:</strong>
                                <ul>
                                    <li>Open tcp capture</li>
                                    <li>Find a TCP handshake (filter: <span class="command">tcp.flags.syn==1</span>)</li>
                                    <li>Look at the three-way handshake packets</li>
                                    <li>Note the sequence and acknowledgment numbers</li>
                                </ul>
                            </li>
                            <li><strong>HTTP Analysis:</strong>
                                <ul>
                                    <li>Open HTTP capture</li>
                                    <li>Filter: <span class="command">http.request</span></li>
                                    <li>Right-click a GET request → Follow → HTTP Stream</li>
                                    <li>Can you see the full HTTP headers and HTML content?</li>
                                </ul>
                            </li>
                            <li><strong>DNS Analysis:</strong>
                                <ul>
                                    <li>Open DNS capture</li>
                                    <li>Filter: <span class="command">dns.flags.response == 0</span> (queries)</li>
                                    <li>Find a query, then find its response</li>
                                    <li>What IP address was returned?</li>
                                </ul>
                            </li>
                            <li><strong>Protocol Statistics:</strong>
                                <ul>
                                    <li>Go to Statistics → Protocol Hierarchy</li>
                                    <li>What's the most common application protocol?</li>
                                    <li>Go to Statistics → Conversations</li>
                                    <li>Switch between Ethernet, IPv4, TCP, UDP tabs</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 4</h3>

                    <div class="question">
                        <div class="question-text">1. What are the three steps of the TCP three-way handshake?</div>
                        <div class="options">
                            <div class="option" data-correct="true">SYN, SYN-ACK, ACK</div>
                            <div class="option" data-correct="false">CONNECT, ACCEPT, ACKNOWLEDGE</div>
                            <div class="option" data-correct="false">REQUEST, RESPONSE, CONFIRM</div>
                            <div class="option" data-correct="false">HELLO, WELCOME, READY</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which protocol is connectionless and provides unreliable delivery?</div>
                        <div class="options">
                            <div class="option" data-correct="false">TCP</div>
                            <div class="option" data-correct="true">UDP</div>
                            <div class="option" data-correct="false">HTTP</div>
                            <div class="option" data-correct="false">FTP</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What does a TCP RST flag indicate?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Connection successful</div>
                            <div class="option" data-correct="false">Data transfer complete</div>
                            <div class="option" data-correct="true">Connection aborted or refused</div>
                            <div class="option" data-correct="false">Requesting more bandwidth</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What is the standard port for DNS?</div>
                        <div class="options">
                            <div class="option" data-correct="true">53</div>
                            <div class="option" data-correct="false">80</div>
                            <div class="option" data-correct="false">443</div>
                            <div class="option" data-correct="false">25</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What protocol maps IP addresses to MAC addresses?</div>
                        <div class="options">
                            <div class="option" data-correct="false">DNS</div>
                            <div class="option" data-correct="true">ARP</div>
                            <div class="option" data-correct="false">DHCP</div>
                            <div class="option" data-correct="false">ICMP</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Network Troubleshooting →</button>
                </div>
            </div>

            <!-- Module 4: Network Troubleshooting -->
            <div class="module" data-module-id="4">
                <div class="module-header">
                    <h2>Module 5: Network Troubleshooting</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 60 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Introduction to Network Troubleshooting</h3>
                    <p>Wireshark is an invaluable tool for diagnosing network problems. This module teaches you how to identify and resolve common network issues using packet analysis.</p>

                    <div class="info-box">
                        <strong>The Troubleshooting Mindset:</strong>
                        <ul>
                            <li>Start with the <strong>symptom</strong> (slow, not connecting, timeouts)</li>
                            <li>Form a <strong>hypothesis</strong> (congestion? DNS? firewall?)</li>
                            <li>Gather <strong>evidence</strong> with Wireshark</li>
                            <li><strong>Analyze</strong> the data systematically</li>
                            <li><strong>Verify</strong> your conclusion and test fixes</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 1: Connection Failures</h3>
                    <p>When a client can't connect to a server, packet analysis quickly reveals why.</p>

                    <h4>Symptoms</h4>
                    <ul>
                        <li>Connection timeout</li>
                        <li>"Cannot connect to server"</li>
                        <li>Application hangs</li>
                    </ul>

                    <h4>What to Look For in Wireshark</h4>
                    <div class="code-block">
# 1. Look for SYN packets without responses
tcp.flags.syn == 1 and tcp.flags.ack == 0

# 2. Look for RST (reset) responses
tcp.flags.reset == 1

# 3. Look for ICMP unreachable messages
icmp.type == 3
                    </div>

                    <h4>Common Causes & Solutions</h4>
                    <table>
                        <tr>
                            <th>What You See</th>
                            <th>Diagnosis</th>
                            <th>Solution</th>
                        </tr>
                        <tr>
                            <td>SYN sent, no response</td>
                            <td>Server down, wrong IP, or firewall blocking</td>
                            <td>Check server status, verify IP, check firewall</td>
                        </tr>
                        <tr>
                            <td>SYN → RST</td>
                            <td>Server rejects connection (port closed)</td>
                            <td>Check if service is running on that port</td>
                        </tr>
                        <tr>
                            <td>SYN → ICMP Unreachable</td>
                            <td>Network/host unreachable</td>
                            <td>Check routing, gateway configuration</td>
                        </tr>
                        <tr>
                            <td>Multiple SYN retransmissions</td>
                            <td>Packet loss or severe network congestion</td>
                            <td>Investigate network path, check for congestion</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 Quick Test:</strong> If you see SYN packets leaving your machine but no response, the problem is likely external (network or remote server). If you don't see SYN packets at all, check the application or local firewall.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 2: Slow Performance</h3>
                    <p>Slow network performance has many possible causes. Wireshark helps identify which layer is the bottleneck.</p>

                    <h4>TCP Performance Indicators</h4>
                    <div class="code-block">
# Show retransmissions (packet loss indicator)
tcp.analysis.retransmission

# Show duplicate ACKs (packet loss detected)
tcp.analysis.duplicate_ack

# Show out-of-order packets
tcp.analysis.out_of_order

# Show zero window (receiver can't keep up)
tcp.analysis.zero_window

# Show long delays between request and response
http.time > 2
                    </div>

                    <h4>Analyzing TCP Window Size</h4>
                    <p>TCP window size determines how much data can be in flight without acknowledgment. Small windows = slow transfer.</p>

                    <table>
                        <tr>
                            <th>Observation</th>
                            <th>Meaning</th>
                            <th>Impact</th>
                        </tr>
                        <tr>
                            <td>Consistently small window (&lt;10KB)</td>
                            <td>Receiver limiting throughput</td>
                            <td>Slow data transfer</td>
                        </tr>
                        <tr>
                            <td>Window = 0</td>
                            <td>Receiver buffer full</td>
                            <td>Transfer paused until buffer emptied</td>
                        </tr>
                        <tr>
                            <td>Large window (64KB+)</td>
                            <td>Good throughput potential</td>
                            <td>Fast transfer if no packet loss</td>
                        </tr>
                    </table>

                    <div class="code-block">
# Graph TCP window size over time
Statistics → TCP Stream Graphs → Window Scaling

# Show small window sizes
tcp.window_size_value < 10000
                    </div>

                    <h4>Round Trip Time (RTT) Analysis</h4>
                    <p>High RTT increases latency and reduces effective throughput.</p>

                    <div class="code-block">
# Wireshark calculates RTT automatically
# Look in TCP section of packet details for "Time since request"

# Graph I/O over time to see delays
Statistics → I/O Graphs
                    </div>

                    <div class="info-box">
                        <strong>RTT Benchmarks:</strong>
                        <ul>
                            <li><strong>&lt;50ms:</strong> Excellent</li>
                            <li><strong>50-100ms:</strong> Good</li>
                            <li><strong>100-200ms:</strong> Noticeable lag</li>
                            <li><strong>&gt;200ms:</strong> Poor performance</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 3: DNS Issues</h3>
                    <p>DNS problems cause connection delays or failures. Symptoms include slow page loads or "server not found" errors.</p>

                    <h4>DNS Troubleshooting Filters</h4>
                    <div class="code-block">
# Show all DNS traffic
dns

# Show DNS queries with no response
dns.flags.response == 0 and !dns.response_in

# Show DNS errors
dns.flags.rcode != 0

# Show specific error: NXDOMAIN (domain doesn't exist)
dns.flags.rcode == 3

# Show long DNS response times
dns.time > 0.5

# Compare query and response for same transaction
dns.id == [transaction_id]
                    </div>

                    <h4>Common DNS Problems</h4>
                    <table>
                        <tr>
                            <th>Issue</th>
                            <th>What You'll See</th>
                            <th>Fix</th>
                        </tr>
                        <tr>
                            <td>DNS server not responding</td>
                            <td>Queries sent, no responses</td>
                            <td>Check DNS server IP, connectivity, firewall</td>
                        </tr>
                        <tr>
                            <td>Slow DNS lookups</td>
                            <td>Long time between query and response</td>
                            <td>Use faster DNS server, check network path</td>
                        </tr>
                        <tr>
                            <td>NXDOMAIN errors</td>
                            <td>Response code = 3</td>
                            <td>Check domain spelling, verify domain exists</td>
                        </tr>
                        <tr>
                            <td>DNS poisoning/spoofing</td>
                            <td>Multiple responses, unexpected IPs</td>
                            <td>Security issue - investigate further</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 DNS Best Practice:</strong> Most DNS queries should complete in under 100ms. Anything over 500ms indicates a problem.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 4: Packet Loss</h3>
                    <p>Packet loss degrades performance and causes retransmissions, timeouts, and application errors.</p>

                    <h4>Identifying Packet Loss</h4>
                    <div class="code-block">
# TCP retransmissions indicate packet loss
tcp.analysis.retransmission

# Duplicate ACKs (receiver detected missing packet)
tcp.analysis.duplicate_ack

# Fast retransmission (after 3 duplicate ACKs)
tcp.analysis.fast_retransmission

# Show all TCP analysis flags at once
tcp.analysis.flags
                    </div>

                    <h4>Calculating Packet Loss Percentage</h4>
                    <ol>
                        <li>Statistics → Capture File Properties</li>
                        <li>Note total packets</li>
                        <li>Count retransmissions: <span class="command">tcp.analysis.retransmission</span></li>
                        <li>Loss % = (retransmissions / total) × 100</li>
                    </ol>

                    <div class="info-box">
                        <strong>Acceptable Loss Rates:</strong>
                        <ul>
                            <li><strong>0-0.5%:</strong> Excellent</li>
                            <li><strong>0.5-1%:</strong> Acceptable</li>
                            <li><strong>1-2%:</strong> Noticeable degradation</li>
                            <li><strong>&gt;2%:</strong> Significant problems</li>
                        </ul>
                    </div>

                    <h4>Locating the Source of Packet Loss</h4>
                    <p>Use traceroute with packet capture to identify where packets are being dropped:</p>
                    <div class="code-block">
# Run traceroute while capturing
tracert example.com (Windows)
traceroute example.com (Linux/Mac)

# In Wireshark, look for:
# 1. ICMP Time Exceeded messages (normal for traceroute)
# 2. Missing hops or * * * in traceroute output
# 3. High RTT at specific hops
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 5: Routing Issues</h3>
                    <p>Incorrect routing causes packets to take wrong paths or not arrive at all.</p>

                    <h4>Analyzing Routing</h4>
                    <div class="code-block">
# Look at TTL values
# Decreasing TTL shows packet progression

# Very low TTL suggests many hops
ip.ttl < 10

# TTL exceeded (routing loop or too many hops)
icmp.type == 11

# Look for asymmetric routing
# Outbound and return paths use different routes
# Compare TTL values in both directions
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Routing Loops:</strong> If you see packets with very low TTL values repeatedly, or ICMP "Time Exceeded" messages, you may have a routing loop where packets circulate endlessly.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Problem 6: Application Layer Issues</h3>
                    <p>Sometimes the network is fine, but the application protocol has problems.</p>

                    <h4>HTTP/HTTPS Issues</h4>
                    <div class="code-block">
# Show HTTP errors
http.response.code >= 400

# Show slow HTTP responses
http.time > 3

# Show incomplete HTTP transfers
http.content_length_header != http.content_length

# Show HTTP redirects (may cause loops)
http.response.code >= 300 and http.response.code < 400
                    </div>

                    <h4>Database/Application Protocols</h4>
                    <ul>
                        <li>Look for errors in application-specific fields</li>
                        <li>Check request/response timing</li>
                        <li>Verify protocol version compatibility</li>
                        <li>Look for authentication failures</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Using Statistics for Troubleshooting</h3>
                    
                    <h4>Expert Information</h4>
                    <p>Wireshark's Expert Information is your first stop for troubleshooting:</p>
                    <ul>
                        <li><strong>Analyze → Expert Information</strong> (or click the colored circle in status bar)</li>
                        <li>Shows errors, warnings, notes, and chats</li>
                        <li>Sorted by severity</li>
                    </ul>

                    <h4>TCP Stream Graphs</h4>
                    <p>Visualize TCP behavior:</p>
                    <ul>
                        <li><strong>Statistics → TCP Stream Graphs → Time-Sequence (Stevens)</strong> - Shows sequence numbers over time</li>
                        <li><strong>Statistics → TCP Stream Graphs → Throughput</strong> - Shows data rate over time</li>
                        <li><strong>Statistics → TCP Stream Graphs → Round Trip Time</strong> - Shows latency trends</li>
                        <li><strong>Statistics → TCP Stream Graphs → Window Scaling</strong> - Shows receive window changes</li>
                    </ul>

                    <h4>I/O Graphs for Pattern Analysis</h4>
                    <p>Statistics → I/O Graphs shows traffic patterns that reveal problems:</p>
                    <ul>
                        <li>Sudden drops = outage or packet loss</li>
                        <li>Spikes = bursts of traffic, possible DDoS</li>
                        <li>Periodic patterns = scheduled tasks, backups</li>
                    </ul>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Diagnose Network Problems</h4>
                    
                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Scenario 1: Connection Timeout</strong>
                                <ul>
                                    <li>Generate or download a capture with connection attempts</li>
                                    <li>Filter for SYN packets: <span class="command">tcp.flags.syn==1 && tcp.flags.ack==0</span></li>
                                    <li>Do you see responses? SYN-ACK or RST?</li>
                                    <li>If no response, check for ICMP unreachable</li>
                                </ul>
                            </li>
                            <li><strong>Scenario 2: Performance Analysis</strong>
                                <ul>
                                    <li>Open any TCP capture</li>
                                    <li>Check Expert Information (bottom left indicator)</li>
                                    <li>Filter: <span class="command">tcp.analysis.retransmission</span></li>
                                    <li>How many retransmissions? Calculate loss rate</li>
                                    <li>Go to Statistics → TCP Stream Graphs → Round Trip Time</li>
                                    <li>What's the average RTT?</li>
                                </ul>
                            </li>
                            <li><strong>Scenario 3: DNS Troubleshooting</strong>
                                <ul>
                                    <li>Capture while browsing websites</li>
                                    <li>Filter: <span class="command">dns</span></li>
                                    <li>Find a DNS query, note the query time</li>
                                    <li>Find its response, check the response time</li>
                                    <li>Calculate DNS resolution time</li>
                                </ul>
                            </li>
                            <li><strong>Scenario 4: Create an I/O Graph</strong>
                                <ul>
                                    <li>Open a capture with varied traffic</li>
                                    <li>Statistics → I/O Graphs</li>
                                    <li>Add filter for HTTP: <span class="command">http</span></li>
                                    <li>Add filter for TCP errors: <span class="command">tcp.analysis.flags</span></li>
                                    <li>Can you see patterns or spikes?</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 5</h3>

                    <div class="question">
                        <div class="question-text">1. If you see SYN packets but no SYN-ACK response, what's the likely cause?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Client application error</div>
                            <div class="option" data-correct="true">Server is down, unreachable, or firewall is blocking</div>
                            <div class="option" data-correct="false">DNS resolution failure</div>
                            <div class="option" data-correct="false">Network is too fast</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What does "tcp.analysis.zero_window" indicate?</div>
                        <div class="options">
                            <div class="option" data-correct="false">The connection is closed</div>
                            <div class="option" data-correct="false">No data is being transmitted</div>
                            <div class="option" data-correct="true">The receiver's buffer is full and can't accept more data</div>
                            <div class="option" data-correct="false">The window size is perfectly optimized</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What is generally considered an acceptable packet loss rate?</div>
                        <div class="options">
                            <div class="option" data-correct="false">5-10%</div>
                            <div class="option" data-correct="false">2-5%</div>
                            <div class="option" data-correct="true">0-1%</div>
                            <div class="option" data-correct="false">Any amount is acceptable</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. Where is Wireshark's Expert Information located?</div>
                        <div class="options">
                            <div class="option" data-correct="false">File menu</div>
                            <div class="option" data-correct="true">Analyze menu, or colored circle in bottom left status bar</div>
                            <div class="option" data-correct="false">View menu</div>
                            <div class="option" data-correct="false">It's not available in Wireshark</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What typically indicates a DNS server problem?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Fast DNS responses</div>
                            <div class="option" data-correct="true">DNS queries sent with no responses received</div>
                            <div class="option" data-correct="false">Too many DNS responses</div>
                            <div class="option" data-correct="false">DNS queries using UDP instead of TCP</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Security Analysis →</button>
                </div>
            </div>

            <!-- Module 5: Security Analysis -->
            <div class="module" data-module-id="5">
                <div class="module-header">
                    <h2>Module 6: Security Analysis & Threat Detection</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 60 minutes</span>
                        <span>📚 Topics: 7</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Using Wireshark for Security Analysis</h3>
                    <p>Wireshark is a powerful tool for detecting security threats, analyzing malware traffic, and investigating security incidents. This module teaches you how to identify common attack patterns and suspicious activity.</p>

                    <div class="warning-box">
                        <strong>⚠️ Important:</strong> Only capture and analyze traffic on networks you own or have explicit permission to monitor. Unauthorized network monitoring is illegal and unethical.
                    </div>

                    <div class="info-box">
                        <strong>Security Analysis Approach:</strong>
                        <ol>
                            <li><strong>Establish baseline:</strong> Know what "normal" looks like</li>
                            <li><strong>Look for anomalies:</strong> Unusual traffic patterns, protocols, or behaviors</li>
                            <li><strong>Investigate indicators:</strong> Follow suspicious connections</li>
                            <li><strong>Correlate evidence:</strong> Piece together the attack timeline</li>
                            <li><strong>Document findings:</strong> Preserve evidence properly</li>
                        </ol>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Reconnaissance & Scanning Attacks</h3>
                    <p>Attackers often start by scanning networks to find targets. These patterns are distinctive in Wireshark.</p>

                    <h4>Port Scanning Detection</h4>
                    <div class="code-block">
# SYN scan (stealthy) - many SYNs to different ports, same destination
tcp.flags.syn == 1 and tcp.flags.ack == 0

# Look for SYN packets to many ports from single source
# Statistics → Conversations → TCP
# Sort by packets or bytes

# Connect scan - full TCP handshakes then immediate close
tcp.flags.syn == 1 or tcp.flags.fin == 1

# NULL scan - no flags set (unusual)
tcp.flags == 0x000

# XMAS scan - multiple flags set (FIN, PSH, URG)
tcp.flags.fin == 1 and tcp.flags.push == 1 and tcp.flags.urg == 1

# ACK scan - ACK flag without prior connection
tcp.flags == 0x010 and !tcp.connection.syn
                    </div>

                    <h4>Network Mapping (ARP Scanning)</h4>
                    <div class="code-block">
# Excessive ARP requests to sequential IPs
arp.opcode == 1

# Look for patterns in Statistics → Conversations → Ethernet
                    </div>

                    <h4>OS Fingerprinting</h4>
                    <p>Attackers use tools like Nmap to identify operating systems. Look for:</p>
                    <ul>
                        <li>Unusual TCP options in SYN packets</li>
                        <li>Specific window sizes</li>
                        <li>TTL values</li>
                        <li>Specific packet patterns</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Red Flags for Scanning:</strong>
                        <ul>
                            <li>Many connections to sequential ports from one source</li>
                            <li>SYN packets without full handshakes</li>
                            <li>Connections to uncommon/closed ports</li>
                            <li>Unusually fast connection rate (faster than human)</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Denial of Service (DoS) Attacks</h3>
                    <p>DoS attacks overwhelm systems with traffic. Wireshark helps identify the attack type and source.</p>

                    <h4>SYN Flood Attack</h4>
                    <div class="code-block">
# Many SYN packets, potentially from spoofed IPs
tcp.flags.syn == 1 and tcp.flags.ack == 0

# Look in Statistics → Endpoints for unusual sources
# Check for:
# - High volume of SYNs
# - Random/spoofed source IPs
# - No SYN-ACK responses (server overwhelmed)
                    </div>

                    <h4>ICMP Flood (Ping Flood)</h4>
                    <div class="code-block">
# Excessive ICMP echo requests
icmp.type == 8

# High volume in short time
# Statistics → I/O Graph → Filter: icmp
                    </div>

                    <h4>UDP Flood</h4>
                    <div class="code-block">
# Excessive UDP packets to random ports
udp

# Look for high volume to unusual ports
# Statistics → Conversations → UDP
                    </div>

                    <h4>Amplification Attacks (DNS, NTP)</h4>
                    <div class="code-block">
# Large DNS responses (potential amplification)
dns and frame.len > 512

# NTP amplification
ntp and frame.len > 100

# Look for small requests resulting in large responses
                    </div>

                    <table>
                        <tr>
                            <th>DoS Type</th>
                            <th>Characteristics</th>
                            <th>Filter</th>
                        </tr>
                        <tr>
                            <td>SYN Flood</td>
                            <td>Many SYN packets, few completions</td>
                            <td><span class="command">tcp.flags.syn==1 && tcp.flags.ack==0</span></td>
                        </tr>
                        <tr>
                            <td>HTTP Flood</td>
                            <td>Many GET/POST requests</td>
                            <td><span class="command">http.request</span></td>
                        </tr>
                        <tr>
                            <td>Slowloris</td>
                            <td>Partial HTTP requests, held open</td>
                            <td>Long-lived TCP connections with little data</td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Man-in-the-Middle (MITM) Attacks</h3>
                    <p>MITM attacks intercept communications. Common types include ARP spoofing and SSL stripping.</p>

                    <h4>ARP Spoofing/Poisoning</h4>
                    <div class="code-block">
# Duplicate IP addresses with different MAC addresses
# This is THE key indicator

# Look for gratuitous ARP (unsolicited ARP replies)
arp.opcode == 2 and !arp.isgratuitous == 0

# Watch for:
# 1. Multiple MACs claiming same IP
# 2. ARP replies you didn't request
# 3. MAC address of gateway suddenly changing

# Check ARP cache consistency
# Statistics → Endpoints → Ethernet
# Look for IP-to-MAC mapping changes
                    </div>

                    <h4>SSL/TLS Issues</h4>
                    <div class="code-block">
# Invalid or self-signed certificates
tls.handshake.type == 11

# Look in packet details for certificate issues
# Examine certificate chain

# Downgrade attacks (forcing old TLS versions)
ssl.record.version == 0x0301    # TLS 1.0 (old)
ssl.record.version == 0x0300    # SSL 3.0 (very old, insecure)

# Weak ciphers
ssl.handshake.ciphersuite
# Look for "NULL", "EXPORT", or "DES" in cipher names
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ MITM Red Flags:</strong>
                        <ul>
                            <li>Same IP with multiple MAC addresses</li>
                            <li>Unexpected ARP traffic volume</li>
                            <li>Certificate warnings or mismatches</li>
                            <li>Downgrade to older, insecure protocols</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Malware Traffic Analysis</h3>
                    <p>Malware often exhibits distinctive network behavior that Wireshark can detect.</p>

                    <h4>Command & Control (C2) Communications</h4>
                    <div class="code-block">
# Periodic beacons to external IPs
# Look for:
# - Regular intervals (every N seconds/minutes)
# - Same destination, same packet size
# - Unusual ports or protocols

# DNS beaconing (data exfiltration via DNS)
dns.qry.name.len > 50          # Long domain names
dns.qry.type == 16             # TXT records
dns and frame.len > 512        # Large DNS queries

# Look for suspicious domains in DNS queries
dns.qry.name contains "random-looking-string"
                    </div>

                    <h4>Data Exfiltration</h4>
                    <div class="code-block">
# Large uploads (unusual for typical clients)
# Filter for upload traffic
tcp.srcport > 1024 and tcp.dstport > 1024

# Statistics → Conversations
# Sort by bytes - look for large outbound transfers

# HTTP POST with large payloads
http.request.method == "POST" and frame.len > 10000

# ICMP data exfiltration (unusual use of ICMP)
icmp and frame.len > 100
                    </div>

                    <h4>Suspicious Protocols & Ports</h4>
                    <div class="code-block">
# IRC (often used by botnets)
tcp.port == 6667 or tcp.port == 6666

# Common C2 ports
tcp.port == 4444 or tcp.port == 5555 or tcp.port == 8080

# Look for HTTP on non-standard ports
http and !(tcp.port == 80 or tcp.port == 443 or tcp.port == 8080)

# Encrypted traffic on unusual ports
ssl and !(tcp.port == 443)
                    </div>

                    <h4>Malware Traffic Patterns</h4>
                    <table>
                        <tr>
                            <th>Indicator</th>
                            <th>What to Look For</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td>Beaconing</td>
                            <td>Regular, periodic connections</td>
                            <td>Connection every 60 seconds to same IP</td>
                        </tr>
                        <tr>
                            <td>DGA Domains</td>
                            <td>Random-looking domain names</td>
                            <td>dns queries for "xf7dh3k2j.com"</td>
                        </tr>
                        <tr>
                            <td>Port hopping</td>
                            <td>Connections to many sequential ports</td>
                            <td>Connects to 8080, 8081, 8082...</td>
                        </tr>
                        <tr>
                            <td>High entropy data</td>
                            <td>Encrypted/encoded payloads</td>
                            <td>Random-looking bytes in payload</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 Practice Safely:</strong> Download malware PCAP samples from:
                        <ul>
                            <li><a href="https://www.malware-traffic-analysis.net/" target="_blank" style="color: inherit;">malware-traffic-analysis.net</a></li>
                            <li><a href="https://www.netresec.com/?page=PcapFiles" target="_blank" style="color: inherit;">netresec.com PCAP files</a></li>
                        </ul>
                        Never download actual malware unless you have a proper isolated lab environment!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Exploitation Attempts</h3>
                    <p>Many attacks try to exploit vulnerabilities. Wireshark can capture the exploit attempts.</p>

                    <h4>SQL Injection</h4>
                    <div class="code-block">
# HTTP requests with SQL keywords
http.request.uri contains "SELECT"
http.request.uri contains "UNION"
http.request.uri contains "' OR '"
http.request.uri contains "--"

# Look in HTTP stream for:
# - Single quotes and SQL commands in parameters
# - Unusual characters (%27 = ', %20 = space)
                    </div>

                    <h4>Cross-Site Scripting (XSS)</h4>
                    <div class="code-block">
# HTTP requests with script tags
http.request.uri contains "&lt;script"
http.request.uri contains "javascript:"
http.request.uri contains "onerror"
                    </div>

                    <h4>Buffer Overflow Attempts</h4>
                    <div class="code-block">
# Unusually large packets
frame.len > 2000

# Look for:
# - Very long strings (AAAAAAAA...)
# - Shellcode patterns in payload
# - Packets to vulnerable services
                    </div>

                    <h4>Brute Force Attacks</h4>
                    <div class="code-block">
# Multiple authentication attempts
# Look for patterns in protocols like:

# SSH brute force
tcp.port == 22

# FTP brute force
tcp.port == 21

# HTTP basic auth attempts
http.authbasic

# Check Statistics → Conversations
# Many short connections from same source = likely brute force
                    </div>
                </div>

                <div class="content-section">
                    <h3>Network Forensics</h3>
                    <p>When investigating security incidents, proper evidence collection and analysis is critical.</p>

                    <h4>Best Practices for Evidence Collection</h4>
                    <ol>
                        <li><strong>Document everything:</strong> Time, date, location, who captured</li>
                        <li><strong>Use tcpdump or dumpcap:</strong> More reliable than GUI for long captures</li>
                        <li><strong>Calculate hash:</strong> SHA256 of capture file for integrity</li>
                        <li><strong>Chain of custody:</strong> Document who handled the file</li>
                        <li><strong>Don't modify original:</strong> Work on copies</li>
                    </ol>

                    <h4>Timeline Reconstruction</h4>
                    <div class="code-block">
# Change time display format
View → Time Display Format → Date and Time of Day

# Sort by time to see chronological order
# (Click "Time" column header)

# Export timeline
# Statistics → Conversations
# File → Export → As CSV
                    </div>

                    <h4>Extracting Evidence</h4>
                    <div class="code-block">
# Export HTTP objects (files downloaded/uploaded)
File → Export Objects → HTTP

# Export specific protocols
File → Export Packet Dissections

# Follow and save streams
Right-click packet → Follow → TCP/UDP/HTTP Stream
# Then: Save As...

# Extract files from SMB/FTP traffic
File → Export Objects → SMB/FTP
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Legal Considerations:</strong>
                        <ul>
                            <li>Only capture traffic on networks you're authorized to monitor</li>
                            <li>Follow your organization's policies</li>
                            <li>Be aware of privacy laws (GDPR, etc.)</li>
                            <li>Preserve evidence properly for potential legal proceedings</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Indicators of Compromise (IoCs)</h3>
                    <p>Common network-based IoCs you can detect with Wireshark:</p>

                    <table>
                        <tr>
                            <th>IoC Type</th>
                            <th>What to Look For</th>
                            <th>Action</th>
                        </tr>
                        <tr>
                            <td>Suspicious IPs</td>
                            <td>Connections to known bad IPs</td>
                            <td>Check threat intelligence feeds</td>
                        </tr>
                        <tr>
                            <td>Suspicious Domains</td>
                            <td>DNS queries for known malicious domains</td>
                            <td>Filter: <span class="command">dns.qry.name</span></td>
                        </tr>
                        <tr>
                            <td>User Agents</td>
                            <td>Unusual HTTP User-Agent strings</td>
                            <td>Filter: <span class="command">http.user_agent</span></td>
                        </tr>
                        <tr>
                            <td>File Hashes</td>
                            <td>Extract files and hash them</td>
                            <td>Compare with VirusTotal, malware databases</td>
                        </tr>
                        <tr>
                            <td>Port Usage</td>
                            <td>Services on unusual ports</td>
                            <td>Investigate why common services use non-standard ports</td>
                        </tr>
                    </table>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Security Analysis</h4>
                    
                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Port Scan Detection:</strong>
                                <ul>
                                    <li>Download a sample with port scanning from <a href="https://wiki.wireshark.org/SampleCaptures" style="color: white; text-decoration: underline;" target="_blank">Wireshark samples</a></li>
                                    <li>Filter: <span class="command">tcp.flags.syn==1 and tcp.flags.ack==0</span></li>
                                    <li>Statistics → Conversations → TCP</li>
                                    <li>Look for one source connecting to many ports</li>
                                    <li>What ports were scanned?</li>
                                </ul>
                            </li>
                            <li><strong>ARP Analysis:</strong>
                                <ul>
                                    <li>Capture local network traffic</li>
                                    <li>Filter: <span class="command">arp</span></li>
                                    <li>Statistics → Endpoints → Ethernet</li>
                                    <li>Check for duplicate IPs with different MACs</li>
                                </ul>
                            </li>
                            <li><strong>Malware Traffic (Safe Sample):</strong>
                                <ul>
                                    <li>Download a malware PCAP from <a href="https://www.malware-traffic-analysis.net/" style="color: white; text-decoration: underline;" target="_blank">malware-traffic-analysis.net</a></li>
                                    <li>Identify C2 communications</li>
                                    <li>Look for beaconing patterns</li>
                                    <li>Extract any HTTP objects</li>
                                    <li>Document suspicious IPs and domains</li>
                                </ul>
                            </li>
                            <li><strong>Export Evidence:</strong>
                                <ul>
                                    <li>Open any HTTP capture</li>
                                    <li>File → Export Objects → HTTP</li>
                                    <li>Save interesting files</li>
                                    <li>Follow HTTP streams and save conversations</li>
                                </ul>
                            </li>
                        </ol>
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Remember:</strong> Only use sample captures or traffic from your own authorized lab environment. Never analyze real malware without proper isolation!
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 6</h3>

                    <div class="question">
                        <div class="question-text">1. What is a key indicator of port scanning activity?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Many DNS queries</div>
                            <div class="option" data-correct="true">Many SYN packets from one source to many ports on one destination</div>
                            <div class="option" data-correct="false">HTTP GET requests</div>
                            <div class="option" data-correct="false">Large file transfers</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What is the PRIMARY indicator of ARP spoofing?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Too many ARP requests</div>
                            <div class="option" data-correct="true">Same IP address associated with multiple different MAC addresses</div>
                            <div class="option" data-correct="false">ARP using UDP instead of operating at Layer 2</div>
                            <div class="option" data-correct="false">ARP packets are encrypted</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What characterizes a SYN flood attack?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Many completed TCP handshakes</div>
                            <div class="option" data-correct="true">Many SYN packets without corresponding SYN-ACK or completed handshakes</div>
                            <div class="option" data-correct="false">Excessive DNS queries</div>
                            <div class="option" data-correct="false">Large UDP packets</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What might indicate C2 (Command & Control) beaconing?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Random, unpredictable connections</div>
                            <div class="option" data-correct="true">Regular, periodic connections to the same external IP at consistent intervals</div>
                            <div class="option" data-correct="false">Many HTTP GET requests to different domains</div>
                            <div class="option" data-correct="false">Large file downloads</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. How can you extract files transferred over HTTP?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Right-click → Export Packet</div>
                            <div class="option" data-correct="true">File → Export Objects → HTTP</div>
                            <div class="option" data-correct="false">Edit → Copy → Files</div>
                            <div class="option" data-correct="false">Files cannot be extracted from network captures</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Advanced Features →</button>
                </div>
            </div>

            <!-- Module 6: Advanced Features -->
            <div class="module" data-module-id="6">
                <div class="module-header">
                    <h2>Module 7: Advanced Features & Techniques</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 5</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Command-Line Tools: tshark</h3>
                    <p>TShark is Wireshark's command-line version, perfect for automation, remote analysis, and scripting.</p>

                    <h4>Why Use TShark?</h4>
                    <ul>
                        <li><strong>Automation:</strong> Script recurring capture tasks</li>
                        <li><strong>Remote servers:</strong> Analyze traffic on headless systems</li>
                        <li><strong>Performance:</strong> Lower resource usage than GUI</li>
                        <li><strong>Integration:</strong> Pipe output to other tools</li>
                    </ul>

                    <h4>Basic TShark Commands</h4>
                    <div class="code-block">
# List available interfaces
tshark -D

# Capture on specific interface
tshark -i eth0

# Capture to file
tshark -i eth0 -w capture.pcap

# Read from file
tshark -r capture.pcap

# Apply display filter
tshark -r capture.pcap -Y "http.request"

# Capture with filter and count
tshark -i eth0 -f "tcp port 80" -c 100

# Show only specific fields
tshark -r capture.pcap -T fields -e ip.src -e ip.dst -e tcp.port

# Statistics
tshark -r capture.pcap -q -z io,phs    # Protocol hierarchy
tshark -r capture.pcap -q -z conv,tcp  # Conversations
                    </div>

                    <h4>Useful TShark One-Liners</h4>
                    <div class="code-block">
# Count packets per protocol
tshark -r capture.pcap -q -z io,phs

# Extract HTTP hosts
tshark -r capture.pcap -Y "http.request" -T fields -e http.host

# Find large packets
tshark -r capture.pcap -Y "frame.len > 1000"

# Export HTTP objects
tshark -r capture.pcap --export-objects http,/tmp/http_objects

# Real-time monitoring
tshark -i eth0 -Y "tcp.port == 80" -T fields -e ip.src -e http.host

# Continuous capture with file rotation
tshark -i eth0 -w capture.pcap -b filesize:100000 -b files:10
                    </div>

                    <div class="tip-box">
                        <strong>💡 TShark for Automation:</strong> Create cron jobs or scheduled tasks to capture traffic during specific times or events. Perfect for troubleshooting intermittent issues!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Custom Profiles & Configurations</h3>
                    <p>Profiles let you save different Wireshark configurations for different tasks.</p>

                    <h4>Creating Profiles</h4>
                    <ol>
                        <li>Edit → Configuration Profiles</li>
                        <li>Click "+" to create new profile</li>
                        <li>Name it (e.g., "Security Analysis", "Web Debugging", "VoIP")</li>
                        <li>Configure preferences, colors, filters, columns</li>
                        <li>Switch profiles via status bar dropdown</li>
                    </ol>

                    <h4>Profile Use Cases</h4>
                    <table>
                        <tr>
                            <th>Profile</th>
                            <th>Customizations</th>
                        </tr>
                        <tr>
                            <td><strong>Security Analysis</strong></td>
                            <td>
                                - Highlight suspicious protocols<br>
                                - Custom columns for threat indicators<br>
                                - Filters for common attacks
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Web Development</strong></td>
                            <td>
                                - HTTP/HTTPS focus<br>
                                - Show response times<br>
                                - Highlight errors (4xx, 5xx)
                            </td>
                        </tr>
                        <tr>
                            <td><strong>VoIP Troubleshooting</strong></td>
                            <td>
                                - RTP/SIP columns<br>
                                - Jitter/packet loss columns<br>
                                - VoIP-specific colors
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Performance Analysis</strong></td>
                            <td>
                                - TCP analysis columns<br>
                                - Highlight retransmissions<br>
                                - Show delta times
                            </td>
                        </tr>
                    </table>

                    <h4>Custom Columns</h4>
                    <p>Add columns for fields you frequently need:</p>
                    <ol>
                        <li>Right-click column header → Column Preferences</li>
                        <li>Click "+" to add new column</li>
                        <li>Choose field type or custom field</li>
                        <li>Examples:
                            <ul>
                                <li><strong>HTTP Method:</strong> Field type: http.request.method</li>
                                <li><strong>DNS Query Name:</strong> Field type: dns.qry.name</li>
                                <li><strong>TCP Stream:</strong> Field type: tcp.stream</li>
                                <li><strong>Delta Time:</strong> Field type: frame.time_delta</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Decryption & Decoding</h3>
                    
                    <h4>HTTPS/TLS Decryption</h4>
                    <p>To decrypt HTTPS traffic, you need the session keys. Two methods:</p>

                    <h5>Method 1: Using SSLKEYLOGFILE (Browser)</h5>
                    <div class="code-block">
# 1. Set environment variable before launching browser
# Windows (Command Prompt):
set SSLKEYLOGFILE=C:\Users\YourName\sslkeys.log

# Linux/Mac:
export SSLKEYLOGFILE=~/sslkeys.log

# 2. Launch browser (it will log keys to file)
# 3. In Wireshark:
Edit → Preferences → Protocols → TLS
Browse to your sslkeys.log file in "(Pre)-Master-Secret log filename"

# 4. Open capture - TLS traffic should now be decrypted!
                    </div>

                    <h5>Method 2: Using Server Private Key</h5>
                    <div class="code-block">
# Only works if:
# - You control the server
# - Server uses RSA key exchange (not DHE/ECDHE)

# In Wireshark:
Edit → Preferences → Protocols → TLS → RSA keys list
Click Edit → Add new key
Enter: IP, Port, Protocol (http), Key file path
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Ethical Note:</strong> Only decrypt traffic you're authorized to analyze. This technique is for lab/development environments you control, not for snooping!
                    </div>

                    <h4>802.11 Wi-Fi Decryption</h4>
                    <div class="code-block">
# To decrypt WPA/WPA2:
Edit → Preferences → Protocols → IEEE 802.11

# Add decryption keys:
wpa-pwd:password:SSID

# Example:
wpa-pwd:MySecurePassword123:HomeNetwork

# Restart Wireshark or reload capture
                    </div>

                    <h4>"Decode As" Feature</h4>
                    <p>Force Wireshark to interpret traffic as a specific protocol:</p>
                    <ol>
                        <li>Right-click packet</li>
                        <li>Decode As...</li>
                        <li>Choose protocol</li>
                        <li>Useful when services run on non-standard ports</li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Name Resolution</h3>
                    <p>Convert addresses to readable names for easier analysis.</p>

                    <h4>Types of Name Resolution</h4>
                    <table>
                        <tr>
                            <th>Type</th>
                            <th>What It Resolves</th>
                            <th>Setting</th>
                        </tr>
                        <tr>
                            <td><strong>MAC Resolution</strong></td>
                            <td>MAC → Manufacturer</td>
                            <td>View → Name Resolution → Resolve Physical Addresses</td>
                        </tr>
                        <tr>
                            <td><strong>Network Resolution</strong></td>
                            <td>IP → Hostname (DNS)</td>
                            <td>View → Name Resolution → Resolve Network Addresses</td>
                        </tr>
                        <tr>
                            <td><strong>Transport Resolution</strong></td>
                            <td>Port → Service Name</td>
                            <td>View → Name Resolution → Resolve Transport Addresses</td>
                        </tr>
                    </table>

                    <div class="warning-box">
                        <strong>⚠️ Performance Warning:</strong> Network name resolution (DNS lookups) can slow down Wireshark and potentially alert targets to your analysis. Enable it carefully!
                    </div>

                    <h4>Custom Name Files</h4>
                    <p>Create custom name mappings:</p>
                    <div class="code-block">
# hosts file (IP to name)
# Location: C:\Program Files\Wireshark\hosts (Windows)
#           /etc/hosts (Linux/Mac)

192.168.1.1     gateway
192.168.1.100   webserver
10.0.0.5        database

# ethers file (MAC to name)
# Location: same as hosts file, named "ethers"

00:11:22:33:44:55  server1
aa:bb:cc:dd:ee:ff  laptop
                    </div>
                </div>

                <div class="content-section">
                    <h3>Plugins & Extensions</h3>
                    <p>Extend Wireshark's functionality with plugins and scripts.</p>

                    <h4>Lua Dissectors</h4>
                    <p>Write custom protocol dissectors in Lua:</p>
                    <div class="code-block">
-- Simple example: custom protocol dissector
-- File: myprotocol.lua (place in plugins directory)

local myproto = Proto("myprotocol", "My Custom Protocol")

function myproto.dissector(buffer, pinfo, tree)
    pinfo.cols.protocol = "MYPROTO"
    local subtree = tree:add(myproto, buffer(), "My Protocol Data")
    -- Add parsing logic here
end

-- Register on port 9999
local tcp_table = DissectorTable.get("tcp.port")
tcp_table:add(9999, myproto)
                    </div>

                    <h4>Finding Plugins Directory</h4>
                    <div class="code-block">
# In Wireshark:
Help → About Wireshark → Folders tab
Look for "Personal Lua Plugins" or "Global Lua Plugins"

# Common locations:
# Windows: C:\Users\YourName\AppData\Roaming\Wireshark\plugins
# Linux: ~/.local/lib/wireshark/plugins
# Mac: ~/Library/Application Support/Wireshark/plugins
                    </div>

                    <h4>Useful Third-Party Tools</h4>
                    <ul>
                        <li><strong>CloudShark:</strong> Web-based collaborative packet analysis</li>
                        <li><strong>PacketTotal:</strong> Online malware traffic analysis</li>
                        <li><strong>NetworkMiner:</strong> Network forensics tool (uses same captures)</li>
                        <li><strong>Moloch:</strong> Large-scale packet capture and search</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Performance Optimization</h3>
                    <p>Tips for handling large captures and improving Wireshark performance:</p>

                    <h4>Best Practices</h4>
                    <ul>
                        <li><strong>Use capture filters:</strong> Capture only what you need</li>
                        <li><strong>Split large files:</strong> Tools → Editcap → Split by time/size</li>
                        <li><strong>Disable name resolution:</strong> Speeds up display</li>
                        <li><strong>Close unneeded columns:</strong> Each column adds processing</li>
                        <li><strong>Use TShark for huge files:</strong> Command-line is faster</li>
                        <li><strong>Increase memory:</strong> Preferences → Capture → adjust buffer</li>
                    </ul>

                    <h4>Working with Large Captures</h4>
                    <div class="code-block">
# Split capture into 100MB chunks
editcap -c 100000 large.pcap split.pcap

# Extract specific time range
editcap -A "2025-10-01 12:00:00" -B "2025-10-01 13:00:00" input.pcap output.pcap

# Remove duplicate packets
editcap -d input.pcap output.pcap

# Merge multiple captures
mergecap -w merged.pcap file1.pcap file2.pcap file3.pcap
                    </div>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Advanced Techniques</h4>
                    
                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Create a Custom Profile:</strong>
                                <ul>
                                    <li>Edit → Configuration Profiles → New</li>
                                    <li>Name it "My Analysis Profile"</li>
                                    <li>Add custom column: tcp.stream</li>
                                    <li>Add custom column: frame.time_delta</li>
                                    <li>Create a filter button for HTTP errors</li>
                                </ul>
                            </li>
                            <li><strong>Try TShark:</strong>
                                <ul>
                                    <li>Open terminal/command prompt</li>
                                    <li>Run: <span class="command">tshark -D</span> (list interfaces)</li>
                                    <li>Capture 20 packets: <span class="command">tshark -i [interface] -c 20</span></li>
                                    <li>Read existing file: <span class="command">tshark -r [file.pcap] -Y "http"</span></li>
                                    <li>Extract specific fields: <span class="command">tshark -r [file.pcap] -T fields -e ip.src -e ip.dst</span></li>
                                </ul>
                            </li>
                            <li><strong>HTTPS Decryption (Optional, if you have browser traffic):</strong>
                                <ul>
                                    <li>Set SSLKEYLOGFILE environment variable</li>
                                    <li>Browse HTTPS sites</li>
                                    <li>Capture traffic</li>
                                    <li>Load keylog file in Wireshark</li>
                                    <li>Verify you can see decrypted HTTP/2 or HTTP/1.1</li>
                                </ul>
                            </li>
                            <li><strong>Custom Name Resolution:</strong>
                                <ul>
                                    <li>Create custom hosts file</li>
                                    <li>Add your local IPs with friendly names</li>
                                    <li>Reload Wireshark</li>
                                    <li>Open capture and verify names appear</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 7</h3>

                    <div class="question">
                        <div class="question-text">1. What is TShark?</div>
                        <div class="options">
                            <div class="option" data-correct="false">A separate packet analyzer unrelated to Wireshark</div>
                            <div class="option" data-correct="true">Wireshark's command-line version</div>
                            <div class="option" data-correct="false">A firewall tool</div>
                            <div class="option" data-correct="false">A network speed testing tool</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What do Wireshark profiles allow you to do?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Create different user accounts</div>
                            <div class="option" data-correct="true">Save different sets of preferences, columns, and filters for different tasks</div>
                            <div class="option" data-correct="false">Run multiple instances of Wireshark</div>
                            <div class="option" data-correct="false">Share captures with other users</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. To decrypt HTTPS traffic using browser session keys, what must you set?</div>
                        <div class="options">
                            <div class="option" data-correct="false">HTTP_DECRYPT environment variable</div>
                            <div class="option" data-correct="true">SSLKEYLOGFILE environment variable</div>
                            <div class="option" data-correct="false">WIRESHARK_DECRYPT preference</div>
                            <div class="option" data-correct="false">HTTPS traffic cannot be decrypted</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What is the purpose of "Decode As" in Wireshark?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Decrypt encrypted traffic</div>
                            <div class="option" data-correct="true">Force Wireshark to interpret traffic as a specific protocol</div>
                            <div class="option" data-correct="false">Convert binary to ASCII</div>
                            <div class="option" data-correct="false">Decode compressed files</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Which tool would you use to merge multiple capture files?</div>
                        <div class="options">
                            <div class="option" data-correct="false">tshark</div>
                            <div class="option" data-correct="false">editcap</div>
                            <div class="option" data-correct="true">mergecap</div>
                            <div class="option" data-correct="false">capturemerge</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Capstone Project →</button>
                </div>
            </div>

            <!-- Module 7: Capstone Project -->
            <div class="module" data-module-id="7">
                <div class="module-header">
                    <h2>Module 8: Capstone Project</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>🎯 Project: Comprehensive Analysis</span>
                        <span>✅ Final Assessment Included</span>
                    </div>
                </div>

                <div class="capstone">
                    <h3>🎓 Capstone Project: Real-World Network Investigation</h3>
                    <p>Congratulations on reaching the final module! Now it's time to apply everything you've learned in a comprehensive, real-world scenario.</p>

                    <div class="scenario-box">
                        <h4>📋 Scenario: Small Business Network Investigation</h4>
                        <p><strong>Your Role:</strong> Network Analyst at TechStart Solutions</p>
                        
                        <p><strong>The Situation:</strong></p>
                        <p>TechStart Solutions, a small software company with 50 employees, has been experiencing mysterious network issues over the past week:</p>
                        <ul>
                            <li>Intermittent slowdowns in the afternoon (2-4 PM)</li>
                            <li>Employees report difficulty accessing the internal web application</li>
                            <li>Some users can't connect to the file server</li>
                            <li>The security team suspects possible malicious activity</li>
                            <li>DNS resolution seems slow or fails occasionally</li>
                        </ul>

                        <p><strong>Your Mission:</strong></p>
                        <p>You've been given a packet capture taken during yesterday's incident. Your job is to:</p>
                        <ol>
                            <li>Identify all network and security issues present</li>
                            <li>Determine the root causes</li>
                            <li>Document evidence of any security threats</li>
                            <li>Provide recommendations for remediation</li>
                            <li>Create a comprehensive report</li>
                        </ol>
                    </div>

                    <div class="requirements-list">
                        <h4>📊 Project Requirements</h4>
                        <p>Your analysis must include:</p>
                        
                        <h5>1. Initial Assessment (10 minutes)</h5>
                        <ul>
                            <li>Examine capture file properties</li>
                            <li>Review protocol hierarchy statistics</li>
                            <li>Identify top talkers and conversations</li>
                            <li>Document capture timeframe and interface</li>
                        </ul>

                        <h5>2. Performance Analysis (10 minutes)</h5>
                        <ul>
                            <li>Identify TCP retransmissions and their percentage</li>
                            <li>Analyze response times for web and file server access</li>
                            <li>Check for zero window conditions or duplicate ACKs</li>
                            <li>Review I/O graphs for traffic patterns</li>
                            <li>Measure DNS resolution times</li>
                        </ul>

                        <h5>3. Security Analysis (15 minutes)</h5>
                        <ul>
                            <li>Look for signs of port scanning</li>
                            <li>Check for suspicious connections or protocols</li>
                            <li>Identify any potential malware beaconing</li>
                            <li>Look for ARP spoofing or other MITM indicators</li>
                            <li>Check for any data exfiltration attempts</li>
                            <li>Review unusual HTTP/HTTPS traffic</li>
                        </ul>

                        <h5>4. Documentation (10 minutes)</h5>
                        <ul>
                            <li>Take screenshots of key evidence</li>
                            <li>Export relevant packet ranges</li>
                            <li>Document IP addresses of interest</li>
                            <li>Save important filter expressions used</li>
                            <li>Create timeline of events</li>
                        </ul>
                    </div>

                    <div class="scenario-box">
                        <h4>🔍 Project Tasks</h4>
                        
                        <p><strong>Task 1: Baseline Analysis</strong></p>
                        <ol>
                            <li>Download a sample capture (or use one provided by your instructor)</li>
                            <li>Open in Wireshark and note basic statistics</li>
                            <li>Create a custom profile called "Investigation"</li>
                            <li>Add useful custom columns (TCP stream, delta time, etc.)</li>
                        </ol>

                        <p><strong>Task 2: Performance Investigation</strong></p>
                        <ol>
                            <li>Filter for HTTP traffic and measure response times</li>
                            <li>Find any TCP retransmissions: <span class="command" style="background: white; color: #1976d2; padding: 3px 6px; border-radius: 3px;">tcp.analysis.retransmission</span></li>
                            <li>Check Expert Information for warnings and errors</li>
                            <li>Create I/O graph showing traffic over time</li>
                            <li>Calculate average response time for web requests</li>
                            <li>Analyze DNS: <span class="command" style="background: white; color: #1976d2; padding: 3px 6px; border-radius: 3px;">dns</span> and measure query times</li>
                        </ol>

                        <p><strong>Task 3: Security Investigation</strong></p>
                        <ol>
                            <li>Search for port scans: <span class="command" style="background: white; color: #1976d2; padding: 3px 6px; border-radius: 3px;">tcp.flags.syn==1 and tcp.flags.ack==0</span></li>
                            <li>Review Statistics → Conversations for suspicious patterns</li>
                            <li>Look for unusual protocols or ports</li>
                            <li>Check for periodic beaconing behavior</li>
                            <li>Search for suspicious HTTP User-Agents: <span class="command" style="background: white; color: #1976d2; padding: 3px 6px; border-radius: 3px;">http.user_agent</span></li>
                            <li>Look for malformed packets or anomalies</li>
                            <li>Check ARP traffic: <span class="command" style="background: white; color: #1976d2; padding: 3px 6px; border-radius: 3px;">arp</span></li>
                        </ol>

                        <p><strong>Task 4: Root Cause Analysis</strong></p>
                        <ol>
                            <li>Correlate findings from performance and security analysis</li>
                            <li>Identify the primary cause(s) of slowdowns</li>
                            <li>Determine if security threats are present</li>
                            <li>Follow TCP streams of suspicious traffic</li>
                            <li>Export any suspicious files: File → Export Objects</li>
                        </ol>

                        <p><strong>Task 5: Report Creation</strong></p>
                        <p>Create a report (text document or presentation) containing:</p>
                        <ul>
                            <li><strong>Executive Summary:</strong> Brief overview of findings</li>
                            <li><strong>Methodology:</strong> What analysis techniques you used</li>
                            <li><strong>Findings:</strong> Detailed issues discovered with evidence</li>
                            <li><strong>Impact Assessment:</strong> Severity of each issue</li>
                            <li><strong>Recommendations:</strong> How to fix identified problems</li>
                            <li><strong>Appendix:</strong> Screenshots, filters used, IPs of interest</li>
                        </ul>
                    </div>

                    <div class="scenario-box">
                        <h4>💡 Helpful Hints</h4>
                        <ul>
                            <li><strong>Start broad, then narrow:</strong> Begin with general statistics, then use filters to investigate specific issues</li>
                            <li><strong>Use Expert Information first:</strong> It highlights problems automatically</li>
                            <li><strong>Document as you go:</strong> Take notes and screenshots throughout your analysis</li>
                            <li><strong>Follow the evidence:</strong> Use Follow Stream to see full conversations</li>
                            <li><strong>Compare normal vs abnormal:</strong> Know what typical traffic looks like</li>
                            <li><strong>Check multiple indicators:</strong> Don't rely on single evidence; correlate findings</li>
                        </ul>
                    </div>

                    <div class="scenario-box">
                        <h4>📝 Deliverables Checklist</h4>
                        <p>By the end of this capstone, you should have:</p>
                        <ul>
                            <li>☐ Completed all analysis tasks</li>
                            <li>☐ Identified at least 3-5 network issues</li>
                            <li>☐ Documented evidence with screenshots</li>
                            <li>☐ Created list of suspicious IPs/domains</li>
                            <li>☐ Calculated key metrics (retransmission %, response times)</li>
                            <li>☐ Generated timeline of events</li>
                            <li>☐ Provided actionable recommendations</li>
                            <li>☐ Written comprehensive report (2-4 pages)</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Sample Captures for Capstone</h3>
                    <p>If your instructor hasn't provided a capture, you can use these publicly available samples that contain various issues to analyze:</p>

                    <div class="resource-card">
                        <h4>Option 1: Wireshark Sample Captures</h4>
                        <p>Try "http_with_jpegs.cap" or any large HTTP capture that contains various traffic types</p>
                        <a href="https://wiki.wireshark.org/SampleCaptures" class="resource-link" target="_blank">wiki.wireshark.org/SampleCaptures</a>
                    </div>

                    <div class="resource-card">
                        <h4>Option 2: Malware Traffic Analysis</h4>
                        <p>Choose a recent exercise from malware-traffic-analysis.net for security-focused analysis</p>
                        <a href="https://www.malware-traffic-analysis.net/" class="resource-link" target="_blank">malware-traffic-analysis.net</a>
                    </div>

                    <div class="resource-card">
                        <h4>Option 3: NETRESEC PCAP Files</h4>
                        <p>Various real-world captures including malware, attacks, and normal traffic</p>
                        <a href="https://www.netresec.com/?page=PcapFiles" class="resource-link" target="_blank">netresec.com/?page=PcapFiles</a>
                    </div>
                </div>

                <!-- Final Assessment -->
                <div class="knowledge-check">
                    <h3>✅ Final Assessment - Complete Course</h3>
                    <p><em>Test your overall knowledge from the entire course. This comprehensive assessment covers all modules.</em></p>

                    <div class="question">
                        <div class="question-text">1. What is the correct order of the TCP three-way handshake?</div>
                        <div class="options">
                            <div class="option" data-correct="true">Client sends SYN → Server sends SYN-ACK → Client sends ACK</div>
                            <div class="option" data-correct="false">Server sends SYN → Client sends ACK → Server sends FIN</div>
                            <div class="option" data-correct="false">Client sends CONNECT → Server sends ACCEPT → Client sends READY</div>
                            <div class="option" data-correct="false">Both send SYN simultaneously</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which filter would show only HTTP GET requests with response code 404?</div>
                        <div class="options">
                            <div class="option" data-correct="false">http.method == GET and http.code == 404</div>
                            <div class="option" data-correct="true">http.request.method == "GET" and http.response.code == 404</div>
                            <div class="option" data-correct="false">tcp.port == 80 and error == 404</div>
                            <div class="option" data-correct="false">This combination cannot be filtered</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What does the Expert Information feature help you identify?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Only syntax errors in filters</div>
                            <div class="option" data-correct="false">Only security threats</div>
                            <div class="option" data-correct="true">Errors, warnings, notes, and chats detected in the capture</div>
                            <div class="option" data-correct="false">Only protocol version mismatches</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. If you see the same IP address associated with multiple MAC addresses, what should you suspect?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Normal network behavior</div>
                            <div class="option" data-correct="true">Possible ARP spoofing attack</div>
                            <div class="option" data-correct="false">DNS misconfiguration</div>
                            <div class="option" data-correct="false">TCP retransmission issue</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What is TShark primarily used for?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Graphical packet analysis only</div>
                            <div class="option" data-correct="true">Command-line packet capture and analysis, automation, and scripting</div>
                            <div class="option" data-correct="false">Creating custom Wireshark themes</div>
                            <div class="option" data-correct="false">Network speed testing</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">6. What indicates packet loss in a TCP connection?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Large window sizes</div>
                            <div class="option" data-correct="false">High TTL values</div>
                            <div class="option" data-correct="true">TCP retransmissions and duplicate ACKs</div>
                            <div class="option" data-correct="false">Many SYN packets</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">7. Why should you use .pcapng format instead of .pcap?</div>
                        <div class="options">
                            <div class="option" data-correct="false">.pcapng is smaller in file size</div>
                            <div class="option" data-correct="true">.pcapng supports more features like multiple interfaces, comments, and name resolution</div>
                            <div class="option" data-correct="false">.pcapng is required for HTTPS decryption</div>
                            <div class="option" data-correct="false">There is no difference between them</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">8. What's the primary difference between capture filters and display filters?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Capture filters are faster</div>
                            <div class="option" data-correct="true">Capture filters prevent packets from being saved; display filters hide packets after capture</div>
                            <div class="option" data-correct="false">Display filters use BPF syntax</div>
                            <div class="option" data-correct="false">They are identical</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">9. What might periodic connections to the same external IP at regular intervals indicate?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Normal web browsing</div>
                            <div class="option" data-correct="false">Email synchronization</div>
                            <div class="option" data-correct="true">Potential C2 (Command & Control) beaconing from malware</div>
                            <div class="option" data-correct="false">DNS resolution</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">10. Which tool would you use to split a large capture file into smaller chunks?</div>
                        <div class="options">
                            <div class="option" data-correct="true">editcap</div>
                            <div class="option" data-correct="false">tshark</div>
                            <div class="option" data-correct="false">mergecap</div>
                            <div class="option" data-correct="false">splitcap</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>🎉 Congratulations!</h3>
                    <p>You've completed the Comprehensive Wireshark Training Course! You now have:</p>
                    
                    <ul>
                        <li>✅ Solid understanding of Wireshark's interface and features</li>
                        <li>✅ Mastery of capture and display filters</li>
                        <li>✅ Ability to analyze major network protocols</li>
                        <li>✅ Skills to troubleshoot network performance issues</li>
                        <li>✅ Knowledge to detect security threats</li>
                        <li>✅ Experience with advanced features and automation</li>
                        <li>✅ Completed a comprehensive real-world analysis project</li>
                    </ul>

                    <div class="info-box">
                        <h4>📚 Next Steps for Continued Learning:</h4>
                        <ol>
                            <li><strong>Practice regularly:</strong> Analyze different types of traffic</li>
                            <li><strong>Build a lab:</strong> Set up VMs to generate controlled traffic</li>
                            <li><strong>Join the community:</strong> Wireshark Q&A, SharkFest conference</li>
                            <li><strong>Consider certification:</strong> Wireshark Certified Network Analyst (WCNA)</li>
                            <li><strong>Contribute:</strong> Report bugs, create dissectors, help others</li>
                            <li><strong>Stay updated:</strong> Follow Wireshark blog and release notes</li>
                        </ol>
                    </div>

                    <div class="tip-box">
                        <h4>🔗 Useful Resources:</h4>
                        <ul>
                            <li><strong>Official Documentation:</strong> <a href="https://www.wireshark.org/docs/" target="_blank" style="color: inherit;">wireshark.org/docs</a></li>
                            <li><strong>Wireshark Wiki:</strong> <a href="https://wiki.wireshark.org/" target="_blank" style="color: inherit;">wiki.wireshark.org</a></li>
                            <li><strong>Ask Questions:</strong> <a href="https://ask.wireshark.org/" target="_blank" style="color: inherit;">ask.wireshark.org</a></li>
                            <li><strong>Sample Captures:</strong> <a href="https://wiki.wireshark.org/SampleCaptures" target="_blank" style="color: inherit;">wiki.wireshark.org/SampleCaptures</a></li>
                            <li><strong>Laura Chappell University:</strong> Advanced Wireshark training</li>
                        </ul>
                    </div>

                    <h4>Thank you for your dedication to learning!</h4>
                    <p>Wireshark is a powerful tool that will serve you throughout your career in networking and cybersecurity. Keep practicing, stay curious, and never stop learning!</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-success" onclick="alert('Congratulations on completing the course! Print this page or save as PDF for your records.')">🎓 Complete Course</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Module navigation
        let currentModule = 0;
        const totalModules = 8;

        function showModule(moduleIndex) {
            // Hide all modules
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });

            // Show selected module
            const selectedModule = document.querySelector(`[data-module-id="${moduleIndex}"]`);
            if (selectedModule) {
                selectedModule.classList.add('active');
                currentModule = moduleIndex;
                
                // Update navigation items
                document.querySelectorAll('.nav-item').forEach((item, index) => {
                    item.classList.remove('active');
                    if (index === moduleIndex) {
                        item.classList.add('active');
                    }
                });

                // Update progress
                updateProgress();

                // Scroll to top
                window.scrollTo(0, 0);
            }
        }

        function nextModule() {
            if (currentModule < totalModules - 1) {
                showModule(currentModule + 1);
            }
        }

        function previousModule() {
            if (currentModule > 0) {
                showModule(currentModule - 1);
            }
        }

        function updateProgress() {
            const progress = ((currentModule + 1) / totalModules) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '% Complete';
        }

        // Navigation click handlers
        document.querySelectorAll('.nav-item').forEach((item, index) => {
            item.addEventListener('click', () => {
                showModule(index);
            });
        });

        // OS tabs functionality
        document.querySelectorAll('.os-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const os = this.getAttribute('data-os');
                
                // Update tabs
                document.querySelectorAll('.os-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update content
                document.querySelectorAll('.os-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.getAttribute('data-os-content') === os) {
                        content.classList.add('active');
                    }
                });
            });
        });

        // Knowledge check functionality
        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', function() {
                // Prevent multiple clicks
                const question = this.closest('.question');
                if (question.querySelector('.option.correct') || question.querySelector('.option.incorrect')) {
                    return;
                }

                const isCorrect = this.getAttribute('data-correct') === 'true';
                const feedback = question.querySelector('.feedback');
                
                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.textContent = '✓ Correct! Well done.';
                    feedback.classList.add('correct', 'show');
                } else {
                    this.classList.add('incorrect');
                    feedback.textContent = '✗ Incorrect. Review the module content and try again.';
                    feedback.classList.add('incorrect', 'show');
                    
                    // Also highlight the correct answer
                    setTimeout(() => {
                        question.querySelectorAll('.option').forEach(opt => {
                            if (opt.getAttribute('data-correct') === 'true') {
                                opt.style.border = '2px solid #4caf50';
                            }
                        });
                    }, 1000);
                }
            });
        });

        // Interactive Wireshark Interface Component Information
        const componentInfo = {
            'menu-bar': {
                title: '📋 Menu Bar',
                content: `
                    <p>The <strong>Menu Bar</strong> is located at the very top of Wireshark and provides access to all of Wireshark's features and functions.</p>
                    
                    <h4>Main Menus:</h4>
                    <ul>
                        <li><strong>File:</strong> Open, save, import, export capture files and objects</li>
                        <li><strong>Edit:</strong> Find packets, mark packets, set preferences, manage profiles</li>
                        <li><strong>View:</strong> Customize interface appearance, time display, name resolution</li>
                        <li><strong>Go:</strong> Navigate between packets (first, last, next, previous)</li>
                        <li><strong>Capture:</strong> Start, stop, restart captures; configure capture options</li>
                        <li><strong>Analyze:</strong> Apply display filters, enable/disable protocols, follow streams</li>
                        <li><strong>Statistics:</strong> View capture statistics, protocol hierarchy, conversations, endpoints</li>
                        <li><strong>Telephony:</strong> Analyze VoIP calls, RTP streams, SIP flows</li>
                        <li><strong>Wireless:</strong> Analyze Bluetooth and IEEE 802.11 wireless traffic</li>
                        <li><strong>Tools:</strong> Firewall ACL rules, Lua scripts, custom tools</li>
                        <li><strong>Help:</strong> Documentation, user guide, sample captures, keyboard shortcuts</li>
                    </ul>

                    <p><strong>💡 Tip:</strong> Most menu items have keyboard shortcuts for faster access. Hover over menu items to see their shortcuts!</p>
                `
            },
            'main-toolbar': {
                title: '🔧 Main Toolbar',
                content: `
                    <p>The <strong>Main Toolbar</strong> provides quick access to frequently used functions from the menu.</p>
                    
                    <h4>Common Toolbar Buttons:</h4>
                    <ul>
                        <li><strong>Start Capture (▶):</strong> Begin capturing packets on selected interface</li>
                        <li><strong>Stop Capture (■):</strong> Stop the current packet capture</li>
                        <li><strong>Restart Capture (↻):</strong> Stop and immediately restart capture</li>
                        <li><strong>Open File (📁):</strong> Open a saved capture file (.pcap, .pcapng)</li>
                        <li><strong>Save (💾):</strong> Save the current capture to disk</li>
                        <li><strong>Close (✖):</strong> Close the current capture file</li>
                        <li><strong>Reload (⟳):</strong> Reload the current capture file from disk</li>
                        <li><strong>Find Packet (🔍):</strong> Search for packets based on criteria</li>
                        <li><strong>Navigation Buttons (◀ ▶):</strong> Move backward/forward through packet history</li>
                        <li><strong>Go to Packet (→):</strong> Jump to a specific packet number</li>
                        <li><strong>Auto Scroll (↓):</strong> Automatically scroll as new packets arrive (live capture)</li>
                        <li><strong>Colorize (🎨):</strong> Apply colorization rules to packets</li>
                        <li><strong>Zoom (+/-):</strong> Increase or decrease font size</li>
                        <li><strong>Resize (⇔):</strong> Adjust pane sizes</li>
                    </ul>

                    <p><strong>⚠️ Note:</strong> Some buttons are disabled (greyed out) when not applicable. For example, the Stop button is only active during a live capture.</p>
                `
            },
            'filter-toolbar': {
                title: '🔍 Filter Toolbar (Display Filter)',
                content: `
                    <p>The <strong>Filter Toolbar</strong> is one of the most powerful features in Wireshark. It allows you to quickly filter which packets are displayed in the Packet List.</p>
                    
                    <h4>Components:</h4>
                    <ul>
                        <li><strong>Filter Input Field:</strong> Type your display filter here (e.g., "http", "ip.addr == 192.168.1.1")</li>
                        <li><strong>Bookmark Button (📌):</strong> Save frequently used filters for quick access</li>
                        <li><strong>Expression Button (⭐):</strong> Open the Display Filter Expression builder</li>
                        <li><strong>Clear Button (↻):</strong> Clear the current filter</li>
                        <li><strong>Apply Button (▶):</strong> Apply the typed filter to the packet list</li>
                        <li><strong>Remove Button (✖):</strong> Remove and clear the current filter</li>
                    </ul>

                    <h4>Background Colors:</h4>
                    <ul>
                        <li><strong>Green:</strong> Valid filter syntax</li>
                        <li><strong>Red:</strong> Invalid filter syntax (error)</li>
                        <li><strong>Yellow:</strong> Warning - filter may not work as expected</li>
                    </ul>

                    <h4>Example Filters:</h4>
                    <ul>
                        <li><code>http</code> - Show only HTTP packets</li>
                        <li><code>ip.addr == 192.168.1.100</code> - Show packets to/from this IP</li>
                        <li><code>tcp.port == 80</code> - Show packets using TCP port 80</li>
                        <li><code>http.request.method == "GET"</code> - Show only HTTP GET requests</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> Press Enter to apply a filter, or use Tab for autocomplete suggestions!</p>
                `
            },
            'packet-list': {
                title: '📊 Packet List Pane',
                content: `
                    <p>The <strong>Packet List Pane</strong> displays a summary of each captured packet in a table format. This is where you'll spend most of your time browsing through captured traffic.</p>
                    
                    <h4>Default Columns:</h4>
                    <ul>
                        <li><strong>No. (Number):</strong> Sequential packet number in capture (doesn't change with filters)</li>
                        <li><strong>Time:</strong> Timestamp (default: seconds since capture start; customizable)</li>
                        <li><strong>Source:</strong> Source IP address or MAC address</li>
                        <li><strong>Destination:</strong> Destination IP address or MAC address</li>
                        <li><strong>Protocol:</strong> Highest-level protocol detected (TCP, HTTP, DNS, etc.)</li>
                        <li><strong>Length:</strong> Total packet size in bytes</li>
                        <li><strong>Info:</strong> Protocol-specific summary information</li>
                    </ul>

                    <h4>Color Coding (Default):</h4>
                    <ul>
                        <li><strong>Light Purple:</strong> TCP packets</li>
                        <li><strong>Light Blue:</strong> UDP packets</li>
                        <li><strong>Light Green:</strong> HTTP packets</li>
                        <li><strong>Light Yellow:</strong> Routing protocols (ICMP, etc.)</li>
                        <li><strong>Black text:</strong> TCP errors (retransmissions, bad checksums)</li>
                        <li><strong>Blue highlight:</strong> Currently selected packet</li>
                    </ul>

                    <h4>Interactions:</h4>
                    <ul>
                        <li><strong>Click a packet:</strong> Select it and display details in lower panes</li>
                        <li><strong>Right-click:</strong> Context menu with options like "Follow Stream", "Apply as Filter"</li>
                        <li><strong>Click column header:</strong> Sort by that column</li>
                        <li><strong>Ctrl+Click:</strong> Select multiple packets</li>
                    </ul>

                    <p><strong>💡 Tip:</strong> You can customize columns by right-clicking the header and choosing "Column Preferences".</p>
                `
            },
            'packet-details': {
                title: '🔬 Packet Details Pane',
                content: `
                    <p>The <strong>Packet Details Pane</strong> shows the protocols and fields of the selected packet in a tree structure. This is where you examine packets in detail.</p>
                    
                    <h4>Structure (Top to Bottom):</h4>
                    <ul>
                        <li><strong>Frame:</strong> Capture metadata (time, interface, length)</li>
                        <li><strong>Ethernet II:</strong> Data Link layer (MAC addresses, EtherType)</li>
                        <li><strong>Internet Protocol (IP):</strong> Network layer (IP addresses, TTL, protocol)</li>
                        <li><strong>Transport Protocol:</strong> TCP or UDP (ports, flags, sequence numbers)</li>
                        <li><strong>Application Protocol:</strong> HTTP, DNS, etc. (request/response data)</li>
                    </ul>

                    <h4>Tree Navigation:</h4>
                    <ul>
                        <li><strong>▶ Collapsed:</strong> Click arrow to expand and see more details</li>
                        <li><strong>▼ Expanded:</strong> Click arrow to collapse section</li>
                        <li><strong>Blue text:</strong> Clickable links to related packets</li>
                        <li><strong>[Bracketed info]:</strong> Generated by Wireshark (analysis, warnings)</li>
                    </ul>

                    <h4>Special Features:</h4>
                    <ul>
                        <li><strong>Generated Fields:</strong> TCP analysis, response times, checksum validation</li>
                        <li><strong>Links:</strong> Jump to related packets (request/response pairs)</li>
                        <li><strong>Expert Info:</strong> Warnings and notes about unusual packet behavior</li>
                    </ul>

                    <h4>Right-Click Context Menu:</h4>
                    <ul>
                        <li><strong>Apply as Filter:</strong> Create display filter from this field</li>
                        <li><strong>Prepare as Filter:</strong> Stage a filter without applying it</li>
                        <li><strong>Copy:</strong> Copy field name, value, or bytes</li>
                        <li><strong>Export Packet Bytes:</strong> Save raw data to file</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> Click on any field in this pane to highlight the corresponding bytes in the Packet Bytes Pane!</p>
                `
            },
            'packet-bytes': {
                title: '🔢 Packet Bytes Pane',
                content: `
                    <p>The <strong>Packet Bytes Pane</strong> displays the raw contents of the selected packet in both hexadecimal and ASCII format. This is the lowest-level view of your packet data.</p>
                    
                    <h4>Display Format:</h4>
                    <ul>
                        <li><strong>Left Column (Blue):</strong> Byte offset in hexadecimal (0000, 0010, 0020...)</li>
                        <li><strong>Middle Section:</strong> Raw bytes in hexadecimal format (16 bytes per line)</li>
                        <li><strong>Right Section (Grey):</strong> ASCII representation of the bytes</li>
                    </ul>

                    <h4>Reading the Hex Dump:</h4>
                    <ul>
                        <li>Each pair of hex digits represents one byte (00-FF)</li>
                        <li>ASCII section shows printable characters; dots (.) represent non-printable bytes</li>
                        <li>Highlighted sections correspond to the field selected in Packet Details</li>
                    </ul>

                    <h4>Common Patterns You'll See:</h4>
                    <ul>
                        <li><strong>45 00:</strong> Start of IPv4 header (version 4, header length 5)</li>
                        <li><strong>08 00:</strong> ICMP/IP protocol type</li>
                        <li><strong>GET /:</strong> HTTP GET request (visible in ASCII)</li>
                        <li><strong>00 50:</strong> Port 80 in hex (HTTP)</li>
                        <li><strong>FF FF FF FF FF FF:</strong> Broadcast MAC address</li>
                    </ul>

                    <h4>Right-Click Options:</h4>
                    <ul>
                        <li><strong>Show as bits:</strong> Display data in binary format</li>
                        <li><strong>Decode as:</strong> Try to decode bytes as specific protocol</li>
                        <li><strong>Export:</strong> Save selected bytes to file</li>
                        <li><strong>Copy as hex stream:</strong> Copy bytes for use in other tools</li>
                    </ul>

                    <h4>Tab Features:</h4>
                    <p>When Wireshark reassembles data (like decompressed content or decrypted packets), multiple tabs may appear at the bottom allowing you to switch between different views of the data.</p>

                    <p><strong>💡 Tip:</strong> You can often read plaintext protocols like HTTP directly in the ASCII column!</p>
                `
            },
            'status-bar': {
                title: '📈 Status Bar',
                content: `
                    <p>The <strong>Status Bar</strong> at the bottom of Wireshark displays important information about your capture and current state.</p>
                    
                    <h4>Left Section:</h4>
                    <ul>
                        <li><strong>Expert Info Indicator (●):</strong> Colored circle showing highest severity issue
                            <ul>
                                <li>Green: Notes (informational)</li>
                                <li>Cyan: Chats (protocol-specific messages)</li>
                                <li>Yellow: Warnings (potential problems)</li>
                                <li>Red: Errors (definite problems)</li>
                            </ul>
                        </li>
                        <li><strong>File Icon:</strong> Click to view capture file properties</li>
                        <li><strong>File Name:</strong> Name and path of current capture file</li>
                    </ul>

                    <h4>Center Section:</h4>
                    <ul>
                        <li><strong>Packets:</strong> Total number of packets in capture</li>
                        <li><strong>Displayed:</strong> Number of packets matching current display filter</li>
                        <li><strong>Marked:</strong> Number of manually marked packets</li>
                        <li><strong>Load Time:</strong> How long it took to load the capture (for files)</li>
                    </ul>

                    <h4>Right Section:</h4>
                    <ul>
                        <li><strong>Profile:</strong> Current configuration profile being used
                            <ul>
                                <li>Click to quickly switch between profiles</li>
                                <li>Profiles save your preferences, columns, colors, and filters</li>
                            </ul>
                        </li>
                        <li><strong>Additional Info:</strong> Context-dependent information (varies based on current action)</li>
                    </ul>

                    <h4>Using Expert Info:</h4>
                    <p>Click the colored indicator or go to <strong>Analyze → Expert Information</strong> to see:</p>
                    <ul>
                        <li>Errors: Malformed packets, checksum errors</li>
                        <li>Warnings: Retransmissions, out-of-order packets, zero windows</li>
                        <li>Notes: Interesting protocol behaviors</li>
                        <li>Chats: Normal protocol flows and conversations</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> The Expert Info indicator is your first stop for troubleshooting - it automatically highlights potential problems!</p>
                `
            }
        };

        // Handle clicks on clickable areas
        document.querySelectorAll('.clickable-area').forEach(area => {
            area.addEventListener('click', function(e) {
                const component = this.getAttribute('data-component');
                if (component && componentInfo[component]) {
                    showComponentInfo(component);
                    e.stopPropagation();
                }
            });
        });

        function showComponentInfo(component) {
            const modal = document.getElementById('componentModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            
            const info = componentInfo[component];
            title.textContent = info.title;
            body.innerHTML = info.content;
            
            modal.style.display = 'block';
            
            // Prevent body scroll when modal is open
            document.body.style.overflow = 'hidden';
        }

        // Close modal
        document.querySelector('.component-modal-close').addEventListener('click', function() {
            document.getElementById('componentModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('componentModal');
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('componentModal');
                if (modal.style.display === 'block') {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            }
        });

        // Initialize
        updateProgress();
        console.log('Wireshark Training Course loaded successfully!');
    </script>
</body>
</html>