<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive and Transfer Files - Interactive Lesson</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #ee0000;
            --secondary-color: #c00;
            --dark-bg: #1a1a1a;
            --light-bg: #f5f5f5;
            --card-bg: #ffffff;
            --text-dark: #333;
            --text-light: #666;
            --border-color: #ddd;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --code-bg: #f8f9fa;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        header {
            background: var(--primary-color);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: var(--dark-bg);
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: var(--dark-bg);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95em;
            border-bottom: 3px solid transparent;
        }

        .nav-tab:hover {
            background: #2a2a2a;
        }

        .nav-tab.active {
            background: var(--primary-color);
            border-bottom-color: white;
        }

        .content {
            padding: 40px;
        }

        .module {
            display: none;
            animation: fadeIn 0.5s;
        }

        .module.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 2em;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .module h3 {
            color: var(--text-dark);
            margin: 25px 0 15px;
            font-size: 1.5em;
        }

        .card {
            background: var(--light-bg);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid var(--primary-color);
        }

        .option-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid var(--border-color);
        }

        .checkbox-option:hover {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .checkbox-option input {
            margin-right: 10px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-option label {
            cursor: pointer;
            flex: 1;
        }

        .command-output {
            background: var(--dark-bg);
            color: #0f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin: 20px 0;
            overflow-x: auto;
            border: 2px solid var(--primary-color);
        }

        .command-output.empty {
            color: #888;
        }

        .explanation {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--warning-color);
            margin: 15px 0;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(238, 0, 0, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: var(--light-bg);
        }

        .comparison-chart {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .chart-item {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .chart-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .chart-item h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .bar-chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            margin: 20px 0;
        }

        .bar {
            width: 80px;
            background: linear-gradient(to top, var(--primary-color), #ff6b6b);
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: all 0.5s;
        }

        .bar-label {
            position: absolute;
            bottom: -30px;
            width: 100%;
            text-align: center;
            font-weight: bold;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        .visual-diagram {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid var(--border-color);
        }

        .file-tree {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: var(--code-bg);
            border-radius: 8px;
        }

        .file-tree-item {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .file-tree-item::before {
            content: '‚îú‚îÄ';
            position: absolute;
            left: 0;
        }

        .file-tree-item.dir {
            color: #0066cc;
            font-weight: bold;
        }

        .sftp-simulator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .terminal {
            background: var(--dark-bg);
            color: #0f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            min-height: 400px;
            overflow-y: auto;
        }

        .terminal-input {
            display: flex;
            margin-top: 10px;
        }

        .terminal-prompt {
            color: #0f0;
            margin-right: 10px;
        }

        .terminal input {
            flex: 1;
            background: transparent;
            border: none;
            color: #0f0;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            outline: none;
        }

        .command-list {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
        }

        .command-item {
            padding: 10px;
            margin: 5px 0;
            background: var(--light-bg);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .command-item:hover {
            background: var(--primary-color);
            color: white;
        }

        .matching-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .matching-column h4 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .match-item {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
            cursor: grab;
            border: 2px solid var(--border-color);
            transition: all 0.3s;
        }

        .match-item:active {
            cursor: grabbing;
        }

        .match-item.selected {
            border-color: var(--primary-color);
            background: #ffe0e0;
        }

        .match-item.correct {
            border-color: var(--success-color);
            background: #d4edda;
        }

        .match-item.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .decision-tree {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .decision-node {
            background: var(--info-color);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .decision-options {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .decision-btn {
            flex: 1;
            margin: 0 10px;
            padding: 15px;
            background: var(--light-bg);
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .decision-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .result-box {
            background: var(--success-color);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
        }

        .file-system-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .fs-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }

        .fs-panel h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .sync-visualization {
            margin: 20px 0;
        }

        .sync-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            margin: 15px 0;
            align-items: center;
        }

        .sync-file {
            padding: 10px;
            background: white;
            border-radius: 5px;
            border: 2px solid var(--border-color);
        }

        .sync-file.modified {
            border-color: var(--warning-color);
            background: #fff3cd;
        }

        .sync-file.new {
            border-color: var(--success-color);
            background: #d4edda;
        }

        .sync-file.deleted {
            border-color: #dc3545;
            background: #f8d7da;
            text-decoration: line-through;
        }

        .sync-arrow {
            color: var(--primary-color);
            font-size: 2em;
            font-weight: bold;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 5px solid var(--info-color);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid var(--warning-color);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid var(--success-color);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        code {
            background: var(--code-bg);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: var(--primary-color);
        }

        .input-group {
            margin: 20px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .input-group input[type="text"],
        .input-group input[type="number"],
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            font-size: 1em;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .comparison-chart {
                grid-template-columns: 1fr;
            }

            .sftp-simulator {
                grid-template-columns: 1fr;
            }

            .matching-game {
                grid-template-columns: 1fr;
            }

            .file-system-view {
                grid-template-columns: 1fr;
            }

            .sync-row {
                grid-template-columns: 1fr;
            }

            .sync-arrow {
                transform: rotate(90deg);
            }

            header h1 {
                font-size: 1.8em;
            }

            .nav-tab {
                min-width: 100px;
                font-size: 0.85em;
                padding: 12px 15px;
            }
        }

        .score-badge {
            display: inline-block;
            padding: 5px 15px;
            background: var(--success-color);
            color: white;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--light-bg);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--success-color), var(--primary-color));
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üì¶ Archive and Transfer Files</h1>
            <p>Interactive Learning Module for Red Hat Linux Administration</p>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showModule(0)">tar Builder</button>
            <button class="nav-tab" onclick="showModule(1)">Compression</button>
            <button class="nav-tab" onclick="showModule(2)">Path Simulator</button>
            <button class="nav-tab" onclick="showModule(3)">SFTP Simulator</button>
            <button class="nav-tab" onclick="showModule(4)">rsync Builder</button>
            <button class="nav-tab" onclick="showModule(5)">Matching Game</button>
            <button class="nav-tab" onclick="showModule(6)">Tool Selector</button>
            <button class="nav-tab" onclick="showModule(7)">Extract Practice</button>
            <button class="nav-tab" onclick="showModule(8)">rsync Visual</button>
        </nav>

        <div class="content">
            <!-- Module 1: Interactive tar Command Builder -->
            <div class="module active" id="module-0">
                <h2>üîß Interactive tar Command Builder</h2>
                <p>Build your tar command by selecting options below. See the command and explanation update in real-time!</p>

                <div class="card">
                    <h3>Step 1: Select Action</h3>
                    <div class="option-group">
                        <div class="checkbox-option">
                            <input type="radio" name="tar-action" id="tar-create" value="-c" checked onchange="updateTarCommand()">
                            <label for="tar-create">
                                <strong>-c (--create)</strong><br>
                                Create a new archive
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="radio" name="tar-action" id="tar-extract" value="-x" onchange="updateTarCommand()">
                            <label for="tar-extract">
                                <strong>-x (--extract)</strong><br>
                                Extract files from archive
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="radio" name="tar-action" id="tar-list" value="-t" onchange="updateTarCommand()">
                            <label for="tar-list">
                                <strong>-t (--list)</strong><br>
                                List archive contents
                            </label>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Step 2: Compression Options</h3>
                    <div class="option-group">
                        <div class="checkbox-option">
                            <input type="radio" name="tar-compression" id="tar-no-compress" value="" checked onchange="updateTarCommand()">
                            <label for="tar-no-compress">
                                <strong>No Compression</strong><br>
                                .tar file
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="radio" name="tar-compression" id="tar-gzip" value="-z" onchange="updateTarCommand()">
                            <label for="tar-gzip">
                                <strong>-z (--gzip)</strong><br>
                                gzip (.tar.gz)
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="radio" name="tar-compression" id="tar-bzip2" value="-j" onchange="updateTarCommand()">
                            <label for="tar-bzip2">
                                <strong>-j (--bzip2)</strong><br>
                                bzip2 (.tar.bz2)
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="radio" name="tar-compression" id="tar-xz" value="-J" onchange="updateTarCommand()">
                            <label for="tar-xz">
                                <strong>-J (--xz)</strong><br>
                                xz (.tar.xz)
                            </label>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Step 3: Additional Options</h3>
                    <div class="option-group">
                        <div class="checkbox-option">
                            <input type="checkbox" id="tar-verbose" value="-v" onchange="updateTarCommand()">
                            <label for="tar-verbose">
                                <strong>-v (--verbose)</strong><br>
                                Show files being processed
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="tar-preserve" value="-p" onchange="updateTarCommand()">
                            <label for="tar-preserve">
                                <strong>-p (--preserve-permissions)</strong><br>
                                Preserve file permissions
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="tar-xattrs" value="--xattrs" onchange="updateTarCommand()">
                            <label for="tar-xattrs">
                                <strong>--xattrs</strong><br>
                                Enable extended attributes
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="tar-selinux" value="--selinux" onchange="updateTarCommand()">
                            <label for="tar-selinux">
                                <strong>--selinux</strong><br>
                                Enable SELinux contexts
                            </label>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Step 4: File Names</h3>
                    <div class="input-group">
                        <label for="tar-archive-name">Archive filename:</label>
                        <input type="text" id="tar-archive-name" value="backup.tar" onkeyup="updateTarCommand()" placeholder="backup.tar">
                    </div>
                    <div class="input-group" id="tar-source-group">
                        <label for="tar-source">Source files/directories:</label>
                        <input type="text" id="tar-source" value="/etc" onkeyup="updateTarCommand()" placeholder="/etc /home/user">
                    </div>
                </div>

                <h3>Generated Command:</h3>
                <div class="command-output" id="tar-command-output">
                    tar -cf backup.tar /etc
                </div>

                <div class="explanation" id="tar-explanation">
                    <strong>Explanation:</strong> This command creates (-c) a new archive file (-f) named backup.tar containing the /etc directory.
                </div>

                <div class="info-box">
                    <strong>üí° Pro Tip:</strong> The -f option must be followed immediately by the archive filename. Always check your command before executing!
                </div>
            </div>

            <!-- Module 2: Compression Algorithm Comparison Tool -->
            <div class="module" id="module-1">
                <h2>üìä Compression Algorithm Comparison</h2>
                <p>Compare gzip, bzip2, and xz compression algorithms for speed and compression ratio.</p>

                <div class="card">
                    <h3>Compression Characteristics</h3>
                    <div class="comparison-chart">
                        <div class="chart-item">
                            <h4>gzip</h4>
                            <p>üöÄ <strong>Speed:</strong> Fast</p>
                            <p>üì¶ <strong>Compression:</strong> Good</p>
                            <p>üíª <strong>CPU:</strong> Low</p>
                            <p>‚úÖ <strong>Best for:</strong> Quick backups, widely compatible files</p>
                        </div>
                        <div class="chart-item">
                            <h4>bzip2</h4>
                            <p>üê¢ <strong>Speed:</strong> Medium</p>
                            <p>üì¶ <strong>Compression:</strong> Better</p>
                            <p>üíª <strong>CPU:</strong> Medium</p>
                            <p>‚úÖ <strong>Best for:</strong> Smaller archives, less common now</p>
                        </div>
                        <div class="chart-item">
                            <h4>xz</h4>
                            <p>üêå <strong>Speed:</strong> Slow</p>
                            <p>üì¶ <strong>Compression:</strong> Best</p>
                            <p>üíª <strong>CPU:</strong> High</p>
                            <p>‚úÖ <strong>Best for:</strong> Maximum compression, long-term storage</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Interactive Compression Calculator</h3>
                    <div class="input-group">
                        <label for="file-size">Original File Size (MB):</label>
                        <input type="number" id="file-size" value="1000" min="1" onchange="calculateCompression()">
                    </div>

                    <h4>Estimated Compressed Sizes:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Algorithm</th>
                                <th>Compressed Size</th>
                                <th>Compression Ratio</th>
                                <th>Time Estimate</th>
                            </tr>
                        </thead>
                        <tbody id="compression-results">
                            <tr>
                                <td><strong>gzip (-z)</strong></td>
                                <td id="gzip-size">~600 MB</td>
                                <td id="gzip-ratio">60%</td>
                                <td id="gzip-time">~30 sec</td>
                            </tr>
                            <tr>
                                <td><strong>bzip2 (-j)</strong></td>
                                <td id="bzip2-size">~500 MB</td>
                                <td id="bzip2-ratio">50%</td>
                                <td id="bzip2-time">~60 sec</td>
                            </tr>
                            <tr>
                                <td><strong>xz (-J)</strong></td>
                                <td id="xz-size">~400 MB</td>
                                <td id="xz-ratio">40%</td>
                                <td id="xz-time">~120 sec</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>Visual Comparison</h3>
                    <div class="bar-chart">
                        <div class="bar" id="bar-gzip" style="height: 120px;">
                            <div class="bar-value">60%</div>
                            <div class="bar-label">gzip</div>
                        </div>
                        <div class="bar" id="bar-bzip2" style="height: 100px;">
                            <div class="bar-value">50%</div>
                            <div class="bar-label">bzip2</div>
                        </div>
                        <div class="bar" id="bar-xz" style="height: 80px;">
                            <div class="bar-value">40%</div>
                            <div class="bar-label">xz</div>
                        </div>
                    </div>
                    <p style="text-align: center;"><em>Lower bars = better compression</em></p>
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Important:</strong> Already compressed files (like JPEGs, MP4s, or RPM packages) won't compress much further. Compression algorithms work best on text and uncompressed data.
                </div>

                <div class="card">
                    <h3>When to Use Each Algorithm</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Recommended</th>
                                <th>Reason</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Daily backups</td>
                                <td><code>gzip</code></td>
                                <td>Fast creation, good enough compression</td>
                            </tr>
                            <tr>
                                <td>Network transfer</td>
                                <td><code>xz</code></td>
                                <td>Smallest file size reduces transfer time</td>
                            </tr>
                            <tr>
                                <td>Long-term archival</td>
                                <td><code>xz</code></td>
                                <td>Maximum space savings</td>
                            </tr>
                            <tr>
                                <td>Quick file sharing</td>
                                <td><code>gzip</code></td>
                                <td>Universally supported, fast</td>
                            </tr>
                            <tr>
                                <td>Software distribution</td>
                                <td><code>gzip</code> or <code>xz</code></td>
                                <td>Balance compatibility and size</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Module 3: Archive File Path Simulator -->
            <div class="module" id="module-2">
                <h2>üóÇÔ∏è Archive File Path Simulator</h2>
                <p>Understand the critical difference between absolute and relative paths in tar archives.</p>

                <div class="card">
                    <h3>The Path Problem</h3>
                    <p>When creating archives, tar removes the leading forward slash (/) from absolute paths. This is a safety feature!</p>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Safety First:</strong> Extracting archives with absolute paths could overwrite system files. Tar converts absolute paths to relative paths to protect your system.
                    </div>
                </div>

                <div class="card">
                    <h3>Interactive Demonstration</h3>
                    
                    <div class="input-group">
                        <label>Choose a path to archive:</label>
                        <select id="path-select" onchange="updatePathDemo()">
                            <option value="/etc/hosts">Absolute: /etc/hosts</option>
                            <option value="/home/user/documents">Absolute: /home/user/documents</option>
                            <option value="etc/hosts">Relative: etc/hosts</option>
                            <option value="documents/file.txt">Relative: documents/file.txt</option>
                        </select>
                    </div>

                    <h4>When Creating Archive:</h4>
                    <div class="visual-diagram">
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;">
                            <div>
                                <h5>Original Path:</h5>
                                <div class="command-output" id="original-path">/etc/hosts</div>
                            </div>
                            <div style="font-size: 2em; color: var(--primary-color);">‚Üí</div>
                            <div>
                                <h5>Stored in Archive:</h5>
                                <div class="command-output" id="stored-path">etc/hosts</div>
                            </div>
                        </div>
                    </div>

                    <div class="explanation" id="path-explanation">
                        <strong>What happened:</strong> The leading '/' was removed. The file is stored with a relative path "etc/hosts" instead of absolute path "/etc/hosts".
                    </div>
                </div>

                <div class="card">
                    <h3>Extraction Behavior</h3>
                    
                    <div class="input-group">
                        <label>Current directory when extracting:</label>
                        <input type="text" id="extract-dir" value="/tmp/restore" onkeyup="updateExtractionDemo()">
                    </div>

                    <h4>Where Files Will Be Extracted:</h4>
                    <div class="visual-diagram">
                        <div class="file-tree">
                            <div id="extraction-tree">
                                <div class="file-tree-item dir">/tmp/restore/</div>
                                <div class="file-tree-item dir" style="padding-left: 40px;">etc/</div>
                                <div class="file-tree-item" style="padding-left: 60px;">hosts</div>
                            </div>
                        </div>
                    </div>

                    <div class="success-box">
                        <strong>‚úÖ Safe Extraction:</strong> Files are extracted relative to your current directory, not to the root filesystem. This prevents accidentally overwriting system files.
                    </div>
                </div>

                <div class="card">
                    <h3>Real-World Examples</h3>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Original Path</th>
                                <th>In Archive</th>
                                <th>Extracted To (from /tmp)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>/etc/hosts</td>
                                <td>etc/hosts</td>
                                <td>/tmp/etc/hosts</td>
                            </tr>
                            <tr>
                                <td>/home/user/doc.txt</td>
                                <td>home/user/doc.txt</td>
                                <td>/tmp/home/user/doc.txt</td>
                            </tr>
                            <tr>
                                <td>/var/log/messages</td>
                                <td>var/log/messages</td>
                                <td>/tmp/var/log/messages</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>Best Practices</h3>
                    
                    <div class="info-box">
                        <strong>üìù Tip 1:</strong> Always extract archives in an empty directory first to see what's inside before moving files to their final location.
                    </div>

                    <div class="info-box">
                        <strong>üìù Tip 2:</strong> Use <code>tar -tf archive.tar</code> to list contents before extracting.
                    </div>

                    <div class="info-box">
                        <strong>üìù Tip 3:</strong> When backing up system directories like /etc, the relative path structure is preserved, making restoration straightforward.
                    </div>
                </div>

                <div class="card">
                    <h3>Try It Yourself</h3>
                    <button class="btn" onclick="showPathQuiz()">Test Your Understanding</button>
                    <div id="path-quiz" style="display: none; margin-top: 20px;">
                        <p><strong>Question:</strong> If you create an archive of /var/log while in your home directory, and later extract it in /tmp, where will the log files be?</p>
                        <button class="btn btn-secondary" onclick="checkPathAnswer('A')">A) /var/log</button>
                        <button class="btn btn-secondary" onclick="checkPathAnswer('B')">B) /tmp/var/log</button>
                        <button class="btn btn-secondary" onclick="checkPathAnswer('C')">C) /tmp/log</button>
                        <div id="path-answer" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>

            <!-- Module 4: SFTP Command Reference & Simulator -->
            <div class="module" id="module-3">
                <h2>üîê SFTP Simulator & Command Reference</h2>
                <p>Practice SFTP commands in a safe, simulated environment.</p>

                <div class="warning-box">
                    <strong>üîí Security Note:</strong> SFTP (Secure File Transfer Protocol) uses SSH for encrypted file transfers. Always use SFTP instead of plain FTP for secure data transfer.
                </div>

                <div class="sftp-simulator">
                    <div>
                        <h3>SFTP Terminal</h3>
                        <div class="terminal" id="sftp-output">
                            <div>Connected to remotehost.</div>
                            <div>sftp&gt; <span style="color: #888;">Type a command or click a command from the list ‚Üí</span></div>
                        </div>
                        <div class="terminal-input">
                            <span class="terminal-prompt">sftp&gt;</span>
                            <input type="text" id="sftp-input" placeholder="Type command and press Enter" onkeypress="handleSftpCommand(event)">
                        </div>
                        <button class="btn btn-secondary" onclick="clearSftpTerminal()">Clear Terminal</button>
                    </div>

                    <div>
                        <h3>Available Commands</h3>
                        <div class="command-list">
                            <div class="command-item" onclick="insertSftpCommand('help')">
                                <strong>help</strong> - Show available commands
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('pwd')">
                                <strong>pwd</strong> - Print remote working directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('lpwd')">
                                <strong>lpwd</strong> - Print local working directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('ls')">
                                <strong>ls</strong> - List remote directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('lls')">
                                <strong>lls</strong> - List local directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('cd documents')">
                                <strong>cd [path]</strong> - Change remote directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('lcd /tmp')">
                                <strong>lcd [path]</strong> - Change local directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('mkdir backup')">
                                <strong>mkdir [name]</strong> - Create remote directory
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('put file.txt')">
                                <strong>put [file]</strong> - Upload file to remote
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('put -r directory')">
                                <strong>put -r [dir]</strong> - Upload directory recursively
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('get remote.txt')">
                                <strong>get [file]</strong> - Download file from remote
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('get -r logs')">
                                <strong>get -r [dir]</strong> - Download directory recursively
                            </div>
                            <div class="command-item" onclick="insertSftpCommand('exit')">
                                <strong>exit</strong> - Close SFTP connection
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>SFTP Command Quick Reference</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>put file</code></td>
                                <td>Upload local file to remote</td>
                                <td><code>put backup.tar.gz</code></td>
                            </tr>
                            <tr>
                                <td><code>get file</code></td>
                                <td>Download remote file to local</td>
                                <td><code>get config.txt</code></td>
                            </tr>
                            <tr>
                                <td><code>ls</code></td>
                                <td>List remote directory contents</td>
                                <td><code>ls -la</code></td>
                            </tr>
                            <tr>
                                <td><code>lls</code></td>
                                <td>List local directory contents</td>
                                <td><code>lls</code></td>
                            </tr>
                            <tr>
                                <td><code>cd</code></td>
                                <td>Change remote directory</td>
                                <td><code>cd /var/www</code></td>
                            </tr>
                            <tr>
                                <td><code>lcd</code></td>
                                <td>Change local directory</td>
                                <td><code>lcd ~/downloads</code></td>
                            </tr>
                            <tr>
                                <td><code>pwd</code></td>
                                <td>Show remote working directory</td>
                                <td><code>pwd</code></td>
                            </tr>
                            <tr>
                                <td><code>lpwd</code></td>
                                <td>Show local working directory</td>
                                <td><code>lpwd</code></td>
                            </tr>
                            <tr>
                                <td><code>mkdir</code></td>
                                <td>Create remote directory</td>
                                <td><code>mkdir backups</code></td>
                            </tr>
                            <tr>
                                <td><code>chmod</code></td>
                                <td>Change remote file permissions</td>
                                <td><code>chmod 644 file.txt</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>Connecting to SFTP</h3>
                    <p>To start an SFTP session, use the following syntax:</p>
                    <div class="command-output">
                        sftp [user]@[remotehost]
                    </div>
                    <p><strong>Example:</strong></p>
                    <div class="command-output">
                        sftp student@servera
                    </div>
                    <p>For a single file download without interactive session:</p>
                    <div class="command-output">
                        sftp student@servera:/path/to/file ./localfile
                    </div>
                </div>

                <div class="info-box">
                    <strong>üí° Pro Tip:</strong> Use the <code>-r</code> option with put and get commands to recursively transfer entire directories!
                </div>

                <div class="card">
                    <h3>Practice Scenario</h3>
                    <p>Try these commands in order to complete a common workflow:</p>
                    <ol>
                        <li>Check your remote location: <code>pwd</code></li>
                        <li>List remote files: <code>ls</code></li>
                        <li>Create a backup directory: <code>mkdir backup</code></li>
                        <li>Change to that directory: <code>cd backup</code></li>
                        <li>Upload a file: <code>put file.txt</code></li>
                        <li>Check local directory: <code>lpwd</code></li>
                        <li>Download from remote: <code>get remote.txt</code></li>
                    </ol>
                </div>
            </div>

            <!-- Module 5: rsync Option Builder -->
            <div class="module" id="module-4">
                <h2>üîÑ rsync Option Builder</h2>
                <p>Build powerful rsync commands to efficiently synchronize files between systems.</p>

                <div class="info-box">
                    <strong>üí° What is rsync?</strong> rsync is a fast, versatile tool for synchronizing files. It only transfers the differences between source and destination, making it much more efficient than copying entire directories.
                </div>

                <div class="card">
                    <h3>Archive Mode (-a)</h3>
                    <p>Archive mode is the most common option. It enables several important options automatically:</p>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="rsync-archive" onchange="updateRsyncCommand()" checked>
                        <label for="rsync-archive">
                            <strong>-a (--archive)</strong><br>
                            Enable archive mode (equivalent to -rlptgoD)
                        </label>
                    </div>

                    <div style="margin-left: 40px; margin-top: 15px;">
                        <p><strong>Archive mode includes:</strong></p>
                        <ul style="list-style-type: none; padding: 0;">
                            <li>‚úÖ <code>-r</code> - Recursive (copy directories)</li>
                            <li>‚úÖ <code>-l</code> - Copy symbolic links</li>
                            <li>‚úÖ <code>-p</code> - Preserve permissions</li>
                            <li>‚úÖ <code>-t</code> - Preserve modification times</li>
                            <li>‚úÖ <code>-g</code> - Preserve group ownership</li>
                            <li>‚úÖ <code>-o</code> - Preserve owner (requires root)</li>
                            <li>‚úÖ <code>-D</code> - Preserve device files</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3>Additional Options</h3>
                    <div class="option-group">
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-verbose" onchange="updateRsyncCommand()">
                            <label for="rsync-verbose">
                                <strong>-v (--verbose)</strong><br>
                                Show detailed progress
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-dry-run" onchange="updateRsyncCommand()">
                            <label for="rsync-dry-run">
                                <strong>-n (--dry-run)</strong><br>
                                Simulate changes without executing
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-delete" onchange="updateRsyncCommand()">
                            <label for="rsync-delete">
                                <strong>--delete</strong><br>
                                Delete files in dest that don't exist in source
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-acls" onchange="updateRsyncCommand()">
                            <label for="rsync-acls">
                                <strong>-A</strong><br>
                                Preserve ACLs (Access Control Lists)
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-xattrs" onchange="updateRsyncCommand()">
                            <label for="rsync-xattrs">
                                <strong>-X</strong><br>
                                Preserve extended attributes
                            </label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="rsync-hard-links" onchange="updateRsyncCommand()">
                            <label for="rsync-hard-links">
                                <strong>-H</strong><br>
                                Preserve hard links
                            </label>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Source and Destination</h3>
                    <div class="input-group">
                        <label for="rsync-source">Source (local or remote):</label>
                        <input type="text" id="rsync-source" value="/var/log/" onkeyup="updateRsyncCommand()" placeholder="/path/to/source/ or user@host:/path/">
                    </div>
                    <div class="input-group">
                        <label for="rsync-dest">Destination (local or remote):</label>
                        <input type="text" id="rsync-dest" value="/backup/logs/" onkeyup="updateRsyncCommand()" placeholder="/path/to/dest/ or user@host:/path/">
                    </div>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Trailing Slash Matters!</strong><br>
                        <code>/source/</code> = sync contents of source into destination<br>
                        <code>/source</code> = sync source directory itself into destination
                    </div>
                </div>

                <h3>Generated rsync Command:</h3>
                <div class="command-output" id="rsync-command-output">
                    rsync -av /var/log/ /backup/logs/
                </div>

                <div class="explanation" id="rsync-explanation">
                    <strong>Explanation:</strong> This command synchronizes the contents of /var/log/ to /backup/logs/ in archive mode with verbose output.
                </div>

                <button class="btn" onclick="explainTrailingSlash()">Explain Trailing Slash Behavior</button>

                <div class="card" id="trailing-slash-demo" style="display: none; margin-top: 20px;">
                    <h3>Trailing Slash Demonstration</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>With Trailing Slash:</h4>
                            <div class="command-output">rsync -av /var/log/ /backup/</div>
                            <p><strong>Result:</strong></p>
                            <div class="file-tree">
                                <div class="file-tree-item dir">/backup/</div>
                                <div class="file-tree-item" style="padding-left: 40px;">messages</div>
                                <div class="file-tree-item" style="padding-left: 40px;">secure</div>
                                <div class="file-tree-item" style="padding-left: 40px;">boot.log</div>
                            </div>
                            <p><em>Contents copied directly into /backup/</em></p>
                        </div>
                        <div>
                            <h4>Without Trailing Slash:</h4>
                            <div class="command-output">rsync -av /var/log /backup/</div>
                            <p><strong>Result:</strong></p>
                            <div class="file-tree">
                                <div class="file-tree-item dir">/backup/</div>
                                <div class="file-tree-item dir" style="padding-left: 40px;">log/</div>
                                <div class="file-tree-item" style="padding-left: 60px;">messages</div>
                                <div class="file-tree-item" style="padding-left: 60px;">secure</div>
                                <div class="file-tree-item" style="padding-left: 60px;">boot.log</div>
                            </div>
                            <p><em>Directory itself copied to /backup/log/</em></p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Common rsync Examples</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Command</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Local backup</td>
                                <td><code>rsync -av /home/user/ /backup/home/</code></td>
                            </tr>
                            <tr>
                                <td>Remote to local</td>
                                <td><code>rsync -av user@remote:/data/ /local/data/</code></td>
                            </tr>
                            <tr>
                                <td>Local to remote</td>
                                <td><code>rsync -av /local/files/ user@remote:/backup/</code></td>
                            </tr>
                            <tr>
                                <td>Dry run first</td>
                                <td><code>rsync -avn --delete /source/ /dest/</code></td>
                            </tr>
                            <tr>
                                <td>Mirror exactly</td>
                                <td><code>rsync -av --delete /source/ /dest/</code></td>
                            </tr>
                            <tr>
                                <td>With progress</td>
                                <td><code>rsync -av --progress /source/ /dest/</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="success-box">
                    <strong>‚úÖ Best Practice:</strong> Always run rsync with <code>-n</code> (dry-run) first to preview changes before executing the actual sync!
                </div>
            </div>

            <!-- Module 6: tar Command Matching Game -->
            <div class="module" id="module-5">
                <h2>üéÆ tar Command Matching Game</h2>
                <p>Match tar commands with their descriptions. Click an option from each column to make a match!</p>

                <div class="card">
                    <h3>Score: <span class="score-badge" id="match-score">0 / 8</span></h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="match-progress" style="width: 0%;">0%</div>
                    </div>
                </div>

                <div class="matching-game">
                    <div class="matching-column">
                        <h4>Commands</h4>
                        <div class="match-item" data-id="1" onclick="selectMatch('cmd', 1)">
                            <code>tar -czf backup.tar.gz /etc</code>
                        </div>
                        <div class="match-item" data-id="2" onclick="selectMatch('cmd', 2)">
                            <code>tar -xzf archive.tar.gz</code>
                        </div>
                        <div class="match-item" data-id="3" onclick="selectMatch('cmd', 3)">
                            <code>tar -tzf logs.tar.gz</code>
                        </div>
                        <div class="match-item" data-id="4" onclick="selectMatch('cmd', 4)">
                            <code>tar -xpf backup.tar</code>
                        </div>
                        <div class="match-item" data-id="5" onclick="selectMatch('cmd', 5)">
                            <code>tar -cjf archive.tar.bz2 /home</code>
                        </div>
                        <div class="match-item" data-id="6" onclick="selectMatch('cmd', 6)">
                            <code>tar -cJf data.tar.xz /data</code>
                        </div>
                        <div class="match-item" data-id="7" onclick="selectMatch('cmd', 7)">
                            <code>tar -cf --exclude='*.log' backup.tar /var</code>
                        </div>
                        <div class="match-item" data-id="8" onclick="selectMatch('cmd', 8)">
                            <code>tar -xvf archive.tar -C /tmp</code>
                        </div>
                    </div>

                    <div class="matching-column">
                        <h4>Descriptions</h4>
                        <div class="match-item" data-id="1" onclick="selectMatch('desc', 1)">
                            Create a gzip-compressed archive of /etc directory
                        </div>
                        <div class="match-item" data-id="2" onclick="selectMatch('desc', 2)">
                            Extract a gzip-compressed archive
                        </div>
                        <div class="match-item" data-id="3" onclick="selectMatch('desc', 3)">
                            List contents of a gzip-compressed archive
                        </div>
                        <div class="match-item" data-id="4" onclick="selectMatch('desc', 4)">
                            Extract archive preserving original permissions
                        </div>
                        <div class="match-item" data-id="5" onclick="selectMatch('desc', 5)">
                            Create a bzip2-compressed archive of /home
                        </div>
                        <div class="match-item" data-id="6" onclick="selectMatch('desc', 6)">
                            Create an xz-compressed archive of /data
                        </div>
                        <div class="match-item" data-id="7" onclick="selectMatch('desc', 7)">
                            Create archive excluding all .log files
                        </div>
                        <div class="match-item" data-id="8" onclick="selectMatch('desc', 8)">
                            Extract archive to /tmp directory with verbose output
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="resetMatchingGame()">Reset Game</button>
                    <button class="btn btn-secondary" onclick="showMatchingHints()">Show Hints</button>
                </div>

                <div class="card" id="matching-hints" style="display: none;">
                    <h3>üí° Hints</h3>
                    <ul>
                        <li><code>-c</code> = create, <code>-x</code> = extract, <code>-t</code> = list</li>
                        <li><code>-z</code> = gzip (.gz), <code>-j</code> = bzip2 (.bz2), <code>-J</code> = xz (.xz)</li>
                        <li><code>-v</code> = verbose (show files), <code>-p</code> = preserve permissions</li>
                        <li><code>-C</code> = change to directory before extracting</li>
                        <li><code>--exclude</code> = skip files matching pattern</li>
                    </ul>
                </div>

                <div class="success-box" id="match-complete" style="display: none;">
                    <h3>üéâ Congratulations!</h3>
                    <p>You've successfully matched all commands! You're becoming a tar expert!</p>
                </div>
            </div>

            <!-- Module 7: File Transfer Method Selector -->
            <div class="module" id="module-6">
                <h2>üîÄ File Transfer Method Selector</h2>
                <p>Answer questions about your scenario to find the best file transfer method.</p>

                <div class="card">
                    <h3>Interactive Decision Tree</h3>
                    <div class="decision-tree" id="decision-tree">
                        <div class="decision-node" id="decision-question">
                            What best describes your situation?
                        </div>
                        <div class="decision-options" id="decision-options">
                            <div class="decision-btn" onclick="decisionStep('one-time')">
                                One-time file transfer
                            </div>
                            <div class="decision-btn" onclick="decisionStep('ongoing')">
                                Ongoing synchronization
                            </div>
                            <div class="decision-btn" onclick="decisionStep('archive')">
                                Creating backups/archives
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="resetDecisionTree()" style="margin-top: 20px;">Start Over</button>
                </div>

                <div class="card">
                    <h3>Quick Comparison Table</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Tool</th>
                                <th>Best For</th>
                                <th>Advantages</th>
                                <th>Disadvantages</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>tar</strong></td>
                                <td>Archives, backups, compression</td>
                                <td>
                                    ‚Ä¢ Creates single file<br>
                                    ‚Ä¢ Preserves structure<br>
                                    ‚Ä¢ Multiple compression options
                                </td>
                                <td>
                                    ‚Ä¢ Not for real-time sync<br>
                                    ‚Ä¢ Must extract to access files
                                </td>
                            </tr>
                            <tr>
                                <td><strong>scp</strong></td>
                                <td>Simple file copies</td>
                                <td>
                                    ‚Ä¢ Simple syntax<br>
                                    ‚Ä¢ Works like cp<br>
                                    ‚Ä¢ SSH-based security
                                </td>
                                <td>
                                    ‚Ä¢ Copies everything every time<br>
                                    ‚Ä¢ Security concerns with -O flag<br>
                                    ‚Ä¢ Less flexible than rsync
                                </td>
                            </tr>
                            <tr>
                                <td><strong>sftp</strong></td>
                                <td>Interactive transfers, multiple files</td>
                                <td>
                                    ‚Ä¢ Interactive session<br>
                                    ‚Ä¢ Browse remote system<br>
                                    ‚Ä¢ Safe and secure
                                </td>
                                <td>
                                    ‚Ä¢ Manual interaction required<br>
                                    ‚Ä¢ Not ideal for automation
                                </td>
                            </tr>
                            <tr>
                                <td><strong>rsync</strong></td>
                                <td>Synchronization, efficient updates</td>
                                <td>
                                    ‚Ä¢ Only transfers changes<br>
                                    ‚Ä¢ Very efficient<br>
                                    ‚Ä¢ Many options for control<br>
                                    ‚Ä¢ Great for automation
                                </td>
                                <td>
                                    ‚Ä¢ More complex syntax<br>
                                    ‚Ä¢ Trailing slash behavior can confuse
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>Common Scenarios</h3>
                    
                    <div class="info-box">
                        <strong>Scenario 1:</strong> Daily backup of /etc directory<br>
                        <strong>Best choice:</strong> <code>tar</code> + <code>rsync</code><br>
                        <strong>Why:</strong> Use tar to create compressed archive, rsync to transfer only if changed
                    </div>

                    <div class="info-box">
                        <strong>Scenario 2:</strong> Copy a single config file once<br>
                        <strong>Best choice:</strong> <code>scp</code> or <code>sftp</code><br>
                        <strong>Why:</strong> Simple, quick, no need for efficiency
                    </div>

                    <div class="info-box">
                        <strong>Scenario 3:</strong> Keep two web servers in sync<br>
                        <strong>Best choice:</strong> <code>rsync</code><br>
                        <strong>Why:</strong> Efficient updates, only changed files transferred
                    </div>

                    <div class="info-box">
                        <strong>Scenario 4:</strong> Transfer entire directory structure once<br>
                        <strong>Best choice:</strong> <code>rsync -a</code> or <code>tar + scp</code><br>
                        <strong>Why:</strong> Preserves permissions and structure
                    </div>

                    <div class="info-box">
                        <strong>Scenario 5:</strong> Download logs from multiple servers<br>
                        <strong>Best choice:</strong> <code>sftp</code> in a script<br>
                        <strong>Why:</strong> Can connect to multiple hosts, download specific files
                    </div>
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Security Reminder:</strong>
                    <ul>
                        <li>Never use plain FTP - always use SFTP or SCP</li>
                        <li>Avoid <code>scp -O</code> flag due to security vulnerabilities</li>
                        <li>Use SSH keys instead of passwords when possible</li>
                        <li>Always verify file integrity after transfer for critical data</li>
                    </ul>
                </div>
            </div>

            <!-- Module 8: Archive Extraction Practice -->
            <div class="module" id="module-7">
                <h2>üìÇ Archive Extraction Practice</h2>
                <p>Practice extracting archives in a visual file system simulator.</p>

                <div class="card">
                    <h3>Virtual File System</h3>
                    <div class="file-system-view">
                        <div class="fs-panel">
                            <h4>üì¶ Available Archives</h4>
                            <div style="margin-top: 15px;">
                                <div class="match-item" onclick="selectArchive('backup.tar.gz')">
                                    üì¶ backup.tar.gz (gzip compressed)
                                </div>
                                <div class="match-item" onclick="selectArchive('logs.tar.bz2')">
                                    üì¶ logs.tar.bz2 (bzip2 compressed)
                                </div>
                                <div class="match-item" onclick="selectArchive('config.tar.xz')">
                                    üì¶ config.tar.xz (xz compressed)
                                </div>
                                <div class="match-item" onclick="selectArchive('data.tar')">
                                    üì¶ data.tar (no compression)
                                </div>
                            </div>

                            <div style="margin-top: 30px;">
                                <h4>Selected Archive:</h4>
                                <div class="command-output" id="selected-archive">None selected</div>
                                
                                <h4 style="margin-top: 20px;">Contents:</h4>
                                <div class="file-tree" id="archive-contents">
                                    <div style="color: #888;">Select an archive to see contents</div>
                                </div>
                            </div>
                        </div>

                        <div class="fs-panel">
                            <h4>üíª Current Directory: <span id="current-dir">/home/student</span></h4>
                            
                            <div style="margin-top: 15px;">
                                <label><strong>Change directory before extracting:</strong></label>
                                <select id="extract-location" onchange="updateExtractionPreview()">
                                    <option value="/home/student">/home/student (current)</option>
                                    <option value="/tmp">/tmp</option>
                                    <option value="/home/student/restore">/home/student/restore</option>
                                    <option value="/var/tmp">/var/tmp</option>
                                </select>
                            </div>

                            <div style="margin-top: 20px;">
                                <h4>Extraction Options:</h4>
                                <div class="checkbox-option">
                                    <input type="checkbox" id="extract-preserve" onchange="updateExtractionPreview()">
                                    <label for="extract-preserve">Preserve permissions (-p)</label>
                                </div>
                                <div class="checkbox-option">
                                    <input type="checkbox" id="extract-verbose" onchange="updateExtractionPreview()">
                                    <label for="extract-verbose">Verbose output (-v)</label>
                                </div>
                            </div>

                            <h4 style="margin-top: 20px;">Generated Command:</h4>
                            <div class="command-output" id="extract-command">
                                Select an archive and options
                            </div>

                            <button class="btn" onclick="performExtraction()" style="margin-top: 15px;">Extract Archive</button>

                            <div id="extraction-result" style="margin-top: 20px;"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Before You Extract: List Contents</h3>
                    <p>Always check what's in an archive before extracting!</p>
                    
                    <div class="command-output">
                        # List contents of gzip archive<br>
                        tar -tzf archive.tar.gz<br><br>
                        # List contents of bzip2 archive<br>
                        tar -tjf archive.tar.bz2<br><br>
                        # List contents of xz archive<br>
                        tar -tJf archive.tar.xz<br><br>
                        # List contents of uncompressed archive<br>
                        tar -tf archive.tar
                    </div>
                </div>

                <div class="card">
                    <h3>Extraction Best Practices</h3>
                    
                    <div class="warning-box">
                        <strong>üîí Security Check:</strong>
                        <ol>
                            <li>Always list archive contents first with <code>tar -tf</code></li>
                            <li>Look for suspicious paths (like <code>../../etc/passwd</code>)</li>
                            <li>Extract into an empty directory first</li>
                            <li>Review extracted files before moving to final location</li>
                        </ol>
                    </div>

                    <div class="info-box">
                        <strong>üìù Common Patterns:</strong><br><br>
                        <strong>Extract to specific directory:</strong><br>
                        <code>tar -xzf archive.tar.gz -C /destination/path</code><br><br>
                        <strong>Extract single file:</strong><br>
                        <code>tar -xzf archive.tar.gz path/to/file.txt</code><br><br>
                        <strong>Extract with original permissions (as root):</strong><br>
                        <code>tar -xpzf archive.tar.gz</code>
                    </div>
                </div>

                <div class="card">
                    <h3>Practice Scenarios</h3>
                    <button class="btn btn-secondary" onclick="showExtractionScenario(1)">Scenario 1: System Backup</button>
                    <button class="btn btn-secondary" onclick="showExtractionScenario(2)">Scenario 2: User Files</button>
                    <button class="btn btn-secondary" onclick="showExtractionScenario(3)">Scenario 3: Web Directory</button>
                    
                    <div id="extraction-scenario" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- Module 9: rsync Sync vs. No-Sync Visualizer -->
            <div class="module" id="module-8">
                <h2>üîÑ rsync Synchronization Visualizer</h2>
                <p>See exactly what rsync does when synchronizing directories.</p>

                <div class="card">
                    <h3>Setup Your Scenario</h3>
                    <div class="input-group">
                        <label>Select Synchronization Type:</label>
                        <select id="sync-type" onchange="updateSyncVisualization()">
                            <option value="initial">Initial Sync (empty destination)</option>
                            <option value="update">Update Existing Files</option>
                            <option value="new-files">New Files Added to Source</option>
                            <option value="deleted">Files Deleted from Source</option>
                            <option value="complex">Complex Scenario (mixed changes)</option>
                        </select>
                    </div>

                    <div class="checkbox-option" style="margin-top: 15px;">
                        <input type="checkbox" id="sync-delete" onchange="updateSyncVisualization()">
                        <label for="sync-delete">
                            <strong>Use --delete flag</strong> (remove files from destination that don't exist in source)
                        </label>
                    </div>
                </div>

                <div class="card">
                    <h3>Before Sync</h3>
                    <div class="file-system-view">
                        <div class="fs-panel">
                            <h4>üìÅ Source: /var/log/</h4>
                            <div class="file-tree" id="source-before">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                        <div class="fs-panel">
                            <h4>üìÅ Destination: /backup/logs/</h4>
                            <div class="file-tree" id="dest-before">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>rsync Command</h3>
                    <div class="command-output" id="sync-command">
                        rsync -av /var/log/ /backup/logs/
                    </div>
                    <button class="btn" onclick="performSync()">Run Synchronization</button>
                </div>

                <div class="card" id="sync-changes" style="display: none;">
                    <h3>Changes Being Made</h3>
                    <div class="sync-visualization" id="sync-actions">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <div class="card" id="sync-after" style="display: none;">
                    <h3>After Sync</h3>
                    <div class="file-system-view">
                        <div class="fs-panel">
                            <h4>üìÅ Source: /var/log/</h4>
                            <div class="file-tree" id="source-after">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                        <div class="fs-panel">
                            <h4>üìÅ Destination: /backup/logs/ (synchronized)</h4>
                            <div class="file-tree" id="dest-after">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" id="sync-stats" style="display: none;">
                    <h3>Synchronization Statistics</h3>
                    <table id="sync-stats-table">
                        <tbody>
                            <tr>
                                <td><strong>Files transferred:</strong></td>
                                <td id="stat-transferred">0</td>
                            </tr>
                            <tr>
                                <td><strong>Files unchanged:</strong></td>
                                <td id="stat-unchanged">0</td>
                            </tr>
                            <tr>
                                <td><strong>Files deleted:</strong></td>
                                <td id="stat-deleted">0</td>
                            </tr>
                            <tr>
                                <td><strong>Total size:</strong></td>
                                <td id="stat-size">0 KB</td>
                            </tr>
                            <tr>
                                <td><strong>Data transferred:</strong></td>
                                <td id="stat-data">0 KB</td>
                            </tr>
                            <tr>
                                <td><strong>Speedup:</strong></td>
                                <td id="stat-speedup">1.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>Understanding rsync Efficiency</h3>
                    <div class="info-box">
                        <strong>First Sync (Initial Copy):</strong><br>
                        rsync transfers all files, similar to a regular copy. Speedup = 1.0
                    </div>
                    <div class="success-box">
                        <strong>Subsequent Syncs:</strong><br>
                        rsync only transfers changes! This can be 10x-100x faster. Speedup > 1.0
                    </div>
                    <div class="info-box">
                        <strong>How rsync Detects Changes:</strong><br>
                        ‚Ä¢ Compares file modification times<br>
                        ‚Ä¢ Checks file sizes<br>
                        ‚Ä¢ Only transfers different blocks within changed files<br>
                        ‚Ä¢ Uses compression during transfer
                    </div>
                </div>

                <div class="card">
                    <h3>Real-World Example</h3>
                    <div style="background: white; padding: 20px; border-radius: 8px;">
                        <p><strong>Scenario:</strong> Syncing a 10 GB directory daily</p>
                        <table>
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Method</th>
                                    <th>Data Transferred</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Day 1</td>
                                    <td>cp / scp</td>
                                    <td>10 GB</td>
                                    <td>20 minutes</td>
                                </tr>
                                <tr>
                                    <td>Day 1</td>
                                    <td>rsync (first run)</td>
                                    <td>10 GB</td>
                                    <td>20 minutes</td>
                                </tr>
                                <tr style="background: #d4edda;">
                                    <td>Day 2</td>
                                    <td>cp / scp</td>
                                    <td>10 GB</td>
                                    <td>20 minutes</td>
                                </tr>
                                <tr style="background: #d4edda;">
                                    <td>Day 2</td>
                                    <td><strong>rsync</strong></td>
                                    <td><strong>50 MB</strong> (only changes)</td>
                                    <td><strong>30 seconds</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="margin-top: 15px;"><strong>Result:</strong> rsync is 40x faster for daily updates! üöÄ</p>
                    </div>
                </div>

                <div class="card">
                    <h3>Common rsync Patterns for System Admins</h3>
                    
                    <div class="command-output">
                        # Daily backup with progress<br>
                        rsync -av --progress /data/ /backup/data/<br><br>
                        # Mirror with deletion<br>
                        rsync -av --delete /source/ /mirror/<br><br>
                        # Dry run to preview changes<br>
                        rsync -avn --delete /source/ /dest/<br><br>
                        # Exclude patterns<br>
                        rsync -av --exclude='*.log' --exclude='tmp/' /data/ /backup/<br><br>
                        # With bandwidth limit (1000 KB/s)<br>
                        rsync -av --bwlimit=1000 /data/ remote:/backup/<br><br>
                        # Preserve everything (as root)<br>
                        rsync -aAXv /source/ /dest/
                    </div>
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è --delete Flag Warning:</strong><br>
                    The <code>--delete</code> flag makes the destination exactly match the source by removing files that don't exist in source. Always test with <code>-n</code> (dry-run) first!
                </div>
            </div>

        </div>
    </div>

    <script>
        // Global variables for tracking state
        let currentModule = 0;
        let sftpHistory = [];
        let sftpCurrentDir = '/home/remoteuser';
        let sftpLocalDir = '/home/user';
        
        let matchingGameState = {
            selectedCmd: null,
            selectedDesc: null,
            matches: [],
            score: 0
        };

        let extractionState = {
            selectedArchive: null,
            archiveContents: {}
        };

        // Module navigation
        function showModule(index) {
            const modules = document.querySelectorAll('.module');
            const tabs = document.querySelectorAll('.nav-tab');
            
            modules.forEach((module, i) => {
                module.classList.remove('active');
                if (i === index) {
                    module.classList.add('active');
                }
            });
            
            tabs.forEach((tab, i) => {
                tab.classList.remove('active');
                if (i === index) {
                    tab.classList.add('active');
                }
            });
            
            currentModule = index;
            
            // Initialize module-specific content
            if (index === 8) {
                initializeSyncVisualization();
            }
        }

        // Module 1: tar Command Builder
        function updateTarCommand() {
            const action = document.querySelector('input[name="tar-action"]:checked').value;
            const compression = document.querySelector('input[name="tar-compression"]:checked').value;
            const verbose = document.getElementById('tar-verbose').checked;
            const preserve = document.getElementById('tar-preserve').checked;
            const xattrs = document.getElementById('tar-xattrs').checked;
            const selinux = document.getElementById('tar-selinux').checked;
            const archiveName = document.getElementById('tar-archive-name').value || 'backup.tar';
            const source = document.getElementById('tar-source').value || '/etc';

            let command = 'tar ' + action;
            
            if (compression) command += compression;
            if (verbose) command += 'v';
            command += 'f';
            if (preserve) command += 'p';
            
            command += ' ' + archiveName;

            // Update archive name extension based on compression
            if (compression === '-z' && !archiveName.includes('.gz')) {
                document.getElementById('tar-archive-name').value = archiveName.replace(/\.tar.*$/, '.tar.gz');
            } else if (compression === '-j' && !archiveName.includes('.bz2')) {
                document.getElementById('tar-archive-name').value = archiveName.replace(/\.tar.*$/, '.tar.bz2');
            } else if (compression === '-J' && !archiveName.includes('.xz')) {
                document.getElementById('tar-archive-name').value = archiveName.replace(/\.tar.*$/, '.tar.xz');
            }

            if (action === '-c') {
                command += ' ' + source;
                document.getElementById('tar-source-group').style.display = 'block';
            } else {
                document.getElementById('tar-source-group').style.display = 'none';
            }

            if (xattrs) command += ' --xattrs';
            if (selinux) command += ' --selinux';

            document.getElementById('tar-command-output').textContent = command;

            // Generate explanation
            let explanation = 'This command ';
            if (action === '-c') {
                explanation += 'creates (-c) a new archive ';
            } else if (action === '-x') {
                explanation += 'extracts (-x) files from the archive ';
            } else {
                explanation += 'lists (-t) the contents of the archive ';
            }

            explanation += 'named ' + archiveName;

            if (compression === '-z') {
                explanation += ' using gzip compression (.tar.gz)';
            } else if (compression === '-j') {
                explanation += ' using bzip2 compression (.tar.bz2)';
            } else if (compression === '-J') {
                explanation += ' using xz compression (.tar.xz)';
            }

            if (action === '-c') {
                explanation += ' containing ' + source;
            }

            if (verbose) explanation += '. The -v flag will show each file being processed';
            if (preserve) explanation += '. The -p flag preserves original file permissions';
            if (xattrs) explanation += '. Extended attributes will be preserved';
            if (selinux) explanation += '. SELinux contexts will be preserved';

            explanation += '.';

            document.getElementById('tar-explanation').innerHTML = '<strong>Explanation:</strong> ' + explanation;
        }

        // Module 2: Compression Calculator
        function calculateCompression() {
            const size = parseFloat(document.getElementById('file-size').value) || 1000;
            
            // Realistic compression ratios (averages)
            const gzipRatio = 0.6;  // 60% of original
            const bzip2Ratio = 0.5; // 50% of original
            const xzRatio = 0.4;    // 40% of original
            
            // Calculate sizes
            const gzipSize = (size * gzipRatio).toFixed(0);
            const bzip2Size = (size * bzip2Ratio).toFixed(0);
            const xzSize = (size * xzRatio).toFixed(0);
            
            // Calculate times (very rough estimates - 100MB/sec for gzip baseline)
            const gzipTime = Math.max(1, Math.round(size / 100 * 3));
            const bzip2Time = Math.max(1, Math.round(size / 100 * 6));
            const xzTime = Math.max(1, Math.round(size / 100 * 12));
            
            // Update table
            document.getElementById('gzip-size').textContent = `~${gzipSize} MB`;
            document.getElementById('gzip-ratio').textContent = `${(gzipRatio * 100).toFixed(0)}%`;
            document.getElementById('gzip-time').textContent = `~${gzipTime} sec`;
            
            document.getElementById('bzip2-size').textContent = `~${bzip2Size} MB`;
            document.getElementById('bzip2-ratio').textContent = `${(bzip2Ratio * 100).toFixed(0)}%`;
            document.getElementById('bzip2-time').textContent = `~${bzip2Time} sec`;
            
            document.getElementById('xz-size').textContent = `~${xzSize} MB`;
            document.getElementById('xz-ratio').textContent = `${(xzRatio * 100).toFixed(0)}%`;
            document.getElementById('xz-time').textContent = `~${xzTime} sec`;
            
            // Update bar chart
            const maxHeight = 200;
            document.getElementById('bar-gzip').style.height = (gzipRatio * maxHeight) + 'px';
            document.getElementById('bar-bzip2').style.height = (bzip2Ratio * maxHeight) + 'px';
            document.getElementById('bar-xz').style.height = (xzRatio * maxHeight) + 'px';
            
            document.querySelector('#bar-gzip .bar-value').textContent = `${(gzipRatio * 100).toFixed(0)}%`;
            document.querySelector('#bar-bzip2 .bar-value').textContent = `${(bzip2Ratio * 100).toFixed(0)}%`;
            document.querySelector('#bar-xz .bar-value').textContent = `${(xzRatio * 100).toFixed(0)}%`;
        }

        // Module 3: Path Simulator
        function updatePathDemo() {
            const path = document.getElementById('path-select').value;
            const isAbsolute = path.startsWith('/');
            
            document.getElementById('original-path').textContent = path;
            
            if (isAbsolute) {
                const relativePath = path.substring(1);
                document.getElementById('stored-path').textContent = relativePath;
                document.getElementById('path-explanation').innerHTML = 
                    '<strong>What happened:</strong> The leading \'/\' was removed. The file is stored with a relative path "' + 
                    relativePath + '" instead of absolute path "' + path + '".';
            } else {
                document.getElementById('stored-path').textContent = path;
                document.getElementById('path-explanation').innerHTML = 
                    '<strong>What happened:</strong> This is already a relative path, so it\'s stored as-is: "' + path + '".';
            }
            
            updateExtractionDemo();
        }

        function updateExtractionDemo() {
            const path = document.getElementById('path-select').value;
            const extractDir = document.getElementById('extract-dir').value || '/tmp/restore';
            const storedPath = path.startsWith('/') ? path.substring(1) : path;
            
            const finalPath = extractDir + '/' + storedPath;
            
            // Build file tree
            const parts = storedPath.split('/');
            let treeHtml = `<div class="file-tree-item dir">${extractDir}/</div>`;
            
            let currentIndent = 40;
            for (let i = 0; i < parts.length; i++) {
                const part = parts[i];
                const isLast = (i === parts.length - 1);
                const className = isLast ? 'file-tree-item' : 'file-tree-item dir';
                treeHtml += `<div class="${className}" style="padding-left: ${currentIndent}px;">${part}${isLast ? '' : '/'}</div>`;
                currentIndent += 20;
            }
            
            document.getElementById('extraction-tree').innerHTML = treeHtml;
        }

        function showPathQuiz() {
            document.getElementById('path-quiz').style.display = 'block';
            document.getElementById('path-answer').innerHTML = '';
        }

        function checkPathAnswer(answer) {
            const answerDiv = document.getElementById('path-answer');
            if (answer === 'B') {
                answerDiv.innerHTML = '<div class="success-box"><strong>‚úÖ Correct!</strong> Files from /var/log will be extracted to /tmp/var/log because tar removes the leading slash, storing files with relative paths.</div>';
            } else {
                answerDiv.innerHTML = '<div class="warning-box"><strong>‚ùå Not quite.</strong> Remember, tar removes the leading slash from absolute paths and stores files with relative paths. When extracted in /tmp, they go to /tmp/var/log.</div>';
            }
        }

        // Module 4: SFTP Simulator
        const sftpCommands = {
            'help': 'Available commands:\nbye                 Quit sftp\ncd path            Change remote directory to \'path\'\nchgrp [-h] grp path Change group of file \'path\' to \'grp\'\nchmod [-h] mode path Change permissions of file \'path\' to \'mode\'\nchown [-h] own path Change owner of file \'path\' to \'own\'\nget remote         Download file\nlcd path           Change local directory\nlls [path]         Display local directory listing\nls [path]          Display remote directory listing\nmkdir path         Create remote directory\nput local          Upload file\npwd                Display remote working directory\nrename old new     Rename remote file\nrm path            Delete remote file',
            'pwd': sftpCurrentDir,
            'lpwd': 'Local working directory: ' + sftpLocalDir,
            'ls': 'documents    downloads    scripts    backup    config.txt    data.tar.gz',
            'lls': 'Desktop    Documents    Downloads    Pictures    file.txt    backup.tar.gz',
            'cd': 'Changed directory',
            'lcd': 'Changed local directory',
            'mkdir': 'Directory created',
            'put': 'Uploading {file} to {remote}\n{file}                                100%  1024KB  512.0KB/s   00:02',
            'get': 'Fetching {file} to {local}\n{file}                                100%  2048KB  1024.0KB/s   00:02',
            'exit': 'Goodbye!',
            'bye': 'Goodbye!'
        };

        function handleSftpCommand(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('sftp-input');
                const command = input.value.trim();
                
                if (command) {
                    executeSftpCommand(command);
                    input.value = '';
                }
            }
        }

        function insertSftpCommand(command) {
            document.getElementById('sftp-input').value = command;
            document.getElementById('sftp-input').focus();
        }

        function executeSftpCommand(command) {
            const output = document.getElementById('sftp-output');
            const parts = command.split(' ');
            const cmd = parts[0].toLowerCase();
            
            // Add command to output
            const cmdLine = document.createElement('div');
            cmdLine.innerHTML = `sftp&gt; <span style="color: #fff;">${command}</span>`;
            output.appendChild(cmdLine);
            
            // Process command
            let response = '';
            
            if (cmd === 'pwd') {
                response = sftpCurrentDir;
            } else if (cmd === 'lpwd') {
                response = sftpCommands.lpwd;
            } else if (cmd === 'ls' || cmd === 'lls') {
                response = sftpCommands[cmd];
            } else if (cmd === 'cd') {
                if (parts.length > 1) {
                    const newDir = parts[1];
                    if (newDir === '..') {
                        sftpCurrentDir = sftpCurrentDir.substring(0, sftpCurrentDir.lastIndexOf('/')) || '/';
                    } else if (newDir.startsWith('/')) {
                        sftpCurrentDir = newDir;
                    } else {
                        sftpCurrentDir += '/' + newDir;
                    }
                    response = 'Changed directory to ' + sftpCurrentDir;
                } else {
                    response = 'cd: no directory specified';
                }
            } else if (cmd === 'lcd') {
                if (parts.length > 1) {
                    sftpLocalDir = parts[1];
                    response = 'Local directory changed to ' + sftpLocalDir;
                } else {
                    response = 'lcd: no directory specified';
                }
            } else if (cmd === 'mkdir') {
                if (parts.length > 1) {
                    response = 'Directory "' + parts[1] + '" created on remote server';
                } else {
                    response = 'mkdir: no directory name specified';
                }
            } else if (cmd === 'put') {
                if (parts.length > 1) {
                    const file = parts[1];
                    const recursive = parts.includes('-r');
                    response = sftpCommands.put
                        .replace('{file}', file)
                        .replace('{file}', file)
                        .replace('{remote}', sftpCurrentDir + '/' + file);
                } else {
                    response = 'put: no file specified';
                }
            } else if (cmd === 'get') {
                if (parts.length > 1) {
                    const file = parts[1];
                    response = sftpCommands.get
                        .replace('{file}', file)
                        .replace('{file}', file)
                        .replace('{local}', sftpLocalDir + '/' + file);
                } else {
                    response = 'get: no file specified';
                }
            } else if (cmd === 'help') {
                response = sftpCommands.help;
            } else if (cmd === 'exit' || cmd === 'bye') {
                response = sftpCommands.exit;
            } else {
                response = `Command not recognized: ${cmd}. Type 'help' for available commands.`;
            }
            
            // Add response to output
            const responseLine = document.createElement('div');
            responseLine.textContent = response;
            responseLine.style.whiteSpace = 'pre-wrap';
            output.appendChild(responseLine);
            
            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
        }

        function clearSftpTerminal() {
            const output = document.getElementById('sftp-output');
            output.innerHTML = '<div>Connected to remotehost.</div><div>sftp&gt; <span style="color: #888;">Type a command or click a command from the list ‚Üí</span></div>';
        }

        // Module 5: rsync Command Builder
        function updateRsyncCommand() {
            let command = 'rsync ';
            let options = [];
            
            if (document.getElementById('rsync-archive').checked) {
                options.push('-a');
            }
            if (document.getElementById('rsync-verbose').checked) {
                options.push('-v');
            }
            if (document.getElementById('rsync-dry-run').checked) {
                options.push('-n');
            }
            if (document.getElementById('rsync-delete').checked) {
                options.push('--delete');
            }
            if (document.getElementById('rsync-acls').checked) {
                options.push('-A');
            }
            if (document.getElementById('rsync-xattrs').checked) {
                options.push('-X');
            }
            if (document.getElementById('rsync-hard-links').checked) {
                options.push('-H');
            }
            
            if (options.length > 0) {
                // Combine short options
                let shortOpts = options.filter(o => o.length === 2).join('').replace(/-/g, '');
                let longOpts = options.filter(o => o.length > 2);
                
                if (shortOpts) command += '-' + shortOpts + ' ';
                command += longOpts.join(' ') + ' ';
            }
            
            const source = document.getElementById('rsync-source').value || '/var/log/';
            const dest = document.getElementById('rsync-dest').value || '/backup/logs/';
            
            command += source + ' ' + dest;
            
            document.getElementById('rsync-command-output').textContent = command;
            
            // Generate explanation
            let explanation = 'This command synchronizes ';
            
            if (source.includes('@')) {
                explanation += 'from remote system ';
            } else {
                explanation += 'from local ';
            }
            
            explanation += source;
            
            if (dest.includes('@')) {
                explanation += ' to remote system ' + dest;
            } else {
                explanation += ' to local ' + dest;
            }
            
            if (document.getElementById('rsync-archive').checked) {
                explanation += ' in archive mode (preserving permissions, times, ownership, etc.)';
            }
            
            if (document.getElementById('rsync-verbose').checked) {
                explanation += ' with verbose output';
            }
            
            if (document.getElementById('rsync-dry-run').checked) {
                explanation += '. This is a DRY RUN - no changes will be made';
            }
            
            if (document.getElementById('rsync-delete').checked) {
                explanation += '. Files in destination that don\'t exist in source will be DELETED';
            }
            
            explanation += '.';
            
            document.getElementById('rsync-explanation').innerHTML = '<strong>Explanation:</strong> ' + explanation;
        }

        function explainTrailingSlash() {
            const demo = document.getElementById('trailing-slash-demo');
            if (demo.style.display === 'none') {
                demo.style.display = 'block';
            } else {
                demo.style.display = 'none';
            }
        }

        // Module 6: Matching Game
        function selectMatch(type, id) {
            if (type === 'cmd') {
                // Deselect previous command
                document.querySelectorAll('.matching-column:first-child .match-item').forEach(item => {
                    item.classList.remove('selected');
                });
                
                matchingGameState.selectedCmd = id;
                document.querySelector(`.matching-column:first-child .match-item[data-id="${id}"]`).classList.add('selected');
            } else {
                // Deselect previous description
                document.querySelectorAll('.matching-column:last-child .match-item').forEach(item => {
                    item.classList.remove('selected');
                });
                
                matchingGameState.selectedDesc = id;
                document.querySelector(`.matching-column:last-child .match-item[data-id="${id}"]`).classList.add('selected');
            }
            
            // Check if we have a match
            if (matchingGameState.selectedCmd && matchingGameState.selectedDesc) {
                checkMatch();
            }
        }

        function checkMatch() {
            const cmd = matchingGameState.selectedCmd;
            const desc = matchingGameState.selectedDesc;
            
            const cmdElement = document.querySelector(`.matching-column:first-child .match-item[data-id="${cmd}"]`);
            const descElement = document.querySelector(`.matching-column:last-child .match-item[data-id="${desc}"]`);
            
            if (cmd === desc) {
                // Correct match!
                cmdElement.classList.remove('selected');
                cmdElement.classList.add('correct');
                descElement.classList.remove('selected');
                descElement.classList.add('correct');
                
                matchingGameState.matches.push(cmd);
                matchingGameState.score++;
                
                updateMatchScore();
                
                // Check if game complete
                if (matchingGameState.score === 8) {
                    setTimeout(() => {
                        document.getElementById('match-complete').style.display = 'block';
                    }, 500);
                }
            } else {
                // Incorrect match
                cmdElement.classList.add('incorrect');
                descElement.classList.add('incorrect');
                
                setTimeout(() => {
                    cmdElement.classList.remove('incorrect', 'selected');
                    descElement.classList.remove('incorrect', 'selected');
                }, 1000);
            }
            
            matchingGameState.selectedCmd = null;
            matchingGameState.selectedDesc = null;
        }

        function updateMatchScore() {
            document.getElementById('match-score').textContent = matchingGameState.score + ' / 8';
            const percentage = (matchingGameState.score / 8) * 100;
            document.getElementById('match-progress').style.width = percentage + '%';
            document.getElementById('match-progress').textContent = Math.round(percentage) + '%';
        }

        function resetMatchingGame() {
            matchingGameState = {
                selectedCmd: null,
                selectedDesc: null,
                matches: [],
                score: 0
            };
            
            document.querySelectorAll('.match-item').forEach(item => {
                item.classList.remove('selected', 'correct', 'incorrect');
            });
            
            updateMatchScore();
            document.getElementById('match-complete').style.display = 'none';
        }

        function showMatchingHints() {
            const hints = document.getElementById('matching-hints');
            if (hints.style.display === 'none') {
                hints.style.display = 'block';
            } else {
                hints.style.display = 'none';
            }
        }

        // Module 7: Decision Tree
        let decisionPath = [];

        function decisionStep(choice) {
            decisionPath.push(choice);
            
            const questionDiv = document.getElementById('decision-question');
            const optionsDiv = document.getElementById('decision-options');
            
            if (choice === 'one-time') {
                questionDiv.textContent = 'How many files are you transferring?';
                optionsDiv.innerHTML = `
                    <div class="decision-btn" onclick="decisionStep('single')">Single file</div>
                    <div class="decision-btn" onclick="decisionStep('multiple')">Multiple files or directory</div>
                `;
            } else if (choice === 'single') {
                showDecisionResult('scp or sftp', 
                    'For a single file transfer, use <strong>scp</strong> for quick command-line copy or <strong>sftp</strong> for interactive transfer.',
                    '<code>scp file.txt user@remote:/path/</code><br>or<br><code>sftp user@remote</code> then <code>put file.txt</code>');
            } else if (choice === 'multiple') {
                questionDiv.textContent = 'Do you need to preserve file attributes and structure?';
                optionsDiv.innerHTML = `
                    <div class="decision-btn" onclick="decisionStep('preserve-yes')">Yes, preserve everything</div>
                    <div class="decision-btn" onclick="decisionStep('preserve-no')">No, just copy files</div>
                `;
            } else if (choice === 'preserve-yes') {
                showDecisionResult('rsync -a', 
                    'Use <strong>rsync</strong> with archive mode to preserve all file attributes.',
                    '<code>rsync -av /source/ user@remote:/dest/</code>');
            } else if (choice === 'preserve-no') {
                showDecisionResult('rsync or scp -r', 
                    'Use <strong>scp -r</strong> for simple recursive copy or <strong>rsync</strong> for efficiency.',
                    '<code>scp -r /source/ user@remote:/dest/</code>');
            } else if (choice === 'ongoing') {
                showDecisionResult('rsync', 
                    '<strong>rsync</strong> is perfect for ongoing synchronization. It only transfers changes, making it very efficient for regular updates.',
                    '<code>rsync -av --delete /source/ user@remote:/dest/</code>');
            } else if (choice === 'archive') {
                questionDiv.textContent = 'Do you need compression?';
                optionsDiv.innerHTML = `
                    <div class="decision-btn" onclick="decisionStep('compress-yes')">Yes, compress for storage or transfer</div>
                    <div class="decision-btn" onclick="decisionStep('compress-no')">No compression needed</div>
                `;
            } else if (choice === 'compress-yes') {
                showDecisionResult('tar with compression', 
                    'Use <strong>tar</strong> with compression. Choose gzip (-z) for speed, xz (-J) for maximum compression.',
                    '<code>tar -czf backup.tar.gz /data/</code><br>or<br><code>tar -cJf backup.tar.xz /data/</code>');
            } else if (choice === 'compress-no') {
                showDecisionResult('tar without compression', 
                    'Use <strong>tar</strong> without compression for fast archiving.',
                    '<code>tar -cf backup.tar /data/</code>');
            }
        }

        function showDecisionResult(tool, explanation, example) {
            const tree = document.getElementById('decision-tree');
            tree.innerHTML = `
                <div class="result-box">
                    <h3>Recommended: ${tool}</h3>
                    <p>${explanation}</p>
                    <div class="command-output" style="margin-top: 15px;">${example}</div>
                </div>
            `;
        }

        function resetDecisionTree() {
            decisionPath = [];
            const tree = document.getElementById('decision-tree');
            tree.innerHTML = `
                <div class="decision-node" id="decision-question">
                    What best describes your situation?
                </div>
                <div class="decision-options" id="decision-options">
                    <div class="decision-btn" onclick="decisionStep('one-time')">
                        One-time file transfer
                    </div>
                    <div class="decision-btn" onclick="decisionStep('ongoing')">
                        Ongoing synchronization
                    </div>
                    <div class="decision-btn" onclick="decisionStep('archive')">
                        Creating backups/archives
                    </div>
                </div>
            `;
        }

        // Module 8: Archive Extraction Practice
        const archiveData = {
            'backup.tar.gz': {
                type: 'gzip',
                contents: ['etc/', 'etc/hosts', 'etc/passwd', 'etc/group', 'etc/ssh/', 'etc/ssh/sshd_config'],
                size: '4.5 MB'
            },
            'logs.tar.bz2': {
                type: 'bzip2',
                contents: ['var/', 'var/log/', 'var/log/messages', 'var/log/secure', 'var/log/boot.log'],
                size: '12 MB'
            },
            'config.tar.xz': {
                type: 'xz',
                contents: ['home/', 'home/user/', 'home/user/.bashrc', 'home/user/.vimrc', 'home/user/config.txt'],
                size: '850 KB'
            },
            'data.tar': {
                type: 'none',
                contents: ['data/', 'data/file1.txt', 'data/file2.txt', 'data/file3.txt', 'data/subdir/', 'data/subdir/file4.txt'],
                size: '25 MB'
            }
        };

        function selectArchive(archiveName) {
            extractionState.selectedArchive = archiveName;
            const archive = archiveData[archiveName];
            
            document.getElementById('selected-archive').textContent = archiveName + ' (' + archive.size + ')';
            
            // Display contents
            let contentsHtml = '';
            archive.contents.forEach(item => {
                const isDir = item.endsWith('/');
                const indent = (item.split('/').length - 1) * 20;
                const className = isDir ? 'file-tree-item dir' : 'file-tree-item';
                contentsHtml += `<div class="${className}" style="padding-left: ${indent}px;">${item}</div>`;
            });
            
            document.getElementById('archive-contents').innerHTML = contentsHtml;
            
            updateExtractionPreview();
        }

        function updateExtractionPreview() {
            if (!extractionState.selectedArchive) return;
            
            const archive = archiveData[extractionState.selectedArchive];
            const location = document.getElementById('extract-location').value;
            const preserve = document.getElementById('extract-preserve').checked;
            const verbose = document.getElementById('extract-verbose').checked;
            
            let command = 'tar -x';
            
            if (archive.type === 'gzip') command += 'z';
            else if (archive.type === 'bzip2') command += 'j';
            else if (archive.type === 'xz') command += 'J';
            
            if (verbose) command += 'v';
            command += 'f';
            if (preserve) command += 'p';
            
            command += ' ' + extractionState.selectedArchive;
            
            if (location !== '/home/student') {
                command += ' -C ' + location;
            }
            
            document.getElementById('extract-command').textContent = command;
        }

        function performExtraction() {
            if (!extractionState.selectedArchive) {
                alert('Please select an archive first!');
                return;
            }
            
            const archive = archiveData[extractionState.selectedArchive];
            const location = document.getElementById('extract-location').value;
            const resultDiv = document.getElementById('extraction-result');
            
            let resultHtml = '<div class="success-box"><h4>‚úÖ Extraction Complete!</h4>';
            resultHtml += '<p><strong>Extracted to:</strong> ' + location + '</p>';
            resultHtml += '<p><strong>Files extracted:</strong></p>';
            resultHtml += '<div class="file-tree">';
            
            archive.contents.forEach(item => {
                const fullPath = location + '/' + item;
                const indent = (item.split('/').length - 1) * 20;
                const isDir = item.endsWith('/');
                const className = isDir ? 'file-tree-item dir' : 'file-tree-item';
                resultHtml += `<div class="${className}" style="padding-left: ${indent}px;">${fullPath}</div>`;
            });
            
            resultHtml += '</div></div>';
            
            resultDiv.innerHTML = resultHtml;
        }

        function showExtractionScenario(num) {
            const scenarioDiv = document.getElementById('extraction-scenario');
            let html = '<div class="card">';
            
            if (num === 1) {
                html += '<h4>Scenario 1: System Backup Restoration</h4>';
                html += '<p><strong>Situation:</strong> You have a backup of /etc directory and need to restore it.</p>';
                html += '<p><strong>Challenge:</strong> You must preserve original permissions and SELinux contexts.</p>';
                html += '<div class="info-box">';
                html += '<strong>Solution:</strong><br>';
                html += '<code>mkdir /tmp/etc-restore</code><br>';
                html += '<code>cd /tmp/etc-restore</code><br>';
                html += '<code>tar -xzpf /backup/etc-backup.tar.gz --selinux --xattrs</code><br>';
                html += '<code># Review contents before copying to /etc</code>';
                html += '</div>';
                html += '<p><strong>Why this works:</strong> Extracting to a temporary location lets you verify before overwriting system files. The -p flag preserves permissions, --selinux and --xattrs preserve contexts.</p>';
            } else if (num === 2) {
                html += '<h4>Scenario 2: User Home Directory</h4>';
                html += '<p><strong>Situation:</strong> Restoring a user\'s home directory from backup.</p>';
                html += '<p><strong>Challenge:</strong> Files should be owned by the user, not root.</p>';
                html += '<div class="info-box">';
                html += '<strong>Solution:</strong><br>';
                html += '<code>su - username</code><br>';
                html += '<code>cd ~</code><br>';
                html += '<code>tar -xzf /backup/home-backup.tar.gz</code><br>';
                html += '<code># Files will be owned by current user</code>';
                html += '</div>';
                html += '<p><strong>Why this works:</strong> Running tar as the user ensures extracted files have correct ownership.</p>';
            } else if (num === 3) {
                html += '<h4>Scenario 3: Web Server Directory</h4>';
                html += '<p><strong>Situation:</strong> Deploying a website from an archive.</p>';
                html += '<p><strong>Challenge:</strong> Extract directly to /var/www/html, preserve permissions.</p>';
                html += '<div class="info-box">';
                html += '<strong>Solution:</strong><br>';
                html += '<code>tar -tzf website.tar.gz | head -10  # Check contents first</code><br>';
                html += '<code>cd /var/www/html</code><br>';
                html += '<code>tar -xzpf /backup/website.tar.gz</code><br>';
                html += '<code>chown -R apache:apache .</code>';
                html += '</div>';
                html += '<p><strong>Why this works:</strong> Always list contents first. Change to target directory before extracting. Fix ownership after extraction.</p>';
            }
            
            html += '</div>';
            scenarioDiv.innerHTML = html;
        }

        // Module 9: rsync Visualization
        const syncScenarios = {
            'initial': {
                sourceBefore: ['messages', 'secure', 'boot.log', 'cron.log'],
                destBefore: [],
                description: 'First sync - destination is empty'
            },
            'update': {
                sourceBefore: ['messages (modified)', 'secure', 'boot.log', 'cron.log'],
                destBefore: ['messages (old)', 'secure', 'boot.log', 'cron.log'],
                description: 'One file has been modified in source'
            },
            'new-files': {
                sourceBefore: ['messages', 'secure', 'boot.log', 'cron.log', 'audit.log (new)'],
                destBefore: ['messages', 'secure', 'boot.log', 'cron.log'],
                description: 'New file added to source'
            },
            'deleted': {
                sourceBefore: ['messages', 'secure', 'boot.log'],
                destBefore: ['messages', 'secure', 'boot.log', 'cron.log (deleted from source)'],
                description: 'File deleted from source'
            },
            'complex': {
                sourceBefore: ['messages (modified)', 'secure', 'boot.log', 'audit.log (new)'],
                destBefore: ['messages (old)', 'secure', 'boot.log', 'cron.log (deleted from source)'],
                description: 'Multiple changes: modified file, new file, deleted file'
            }
        };

        function initializeSyncVisualization() {
            updateSyncVisualization();
        }

        function updateSyncVisualization() {
            const syncType = document.getElementById('sync-type').value;
            const scenario = syncScenarios[syncType];
            const deleteFlag = document.getElementById('sync-delete').checked;
            
            // Update before state
            let sourceHtml = '';
            scenario.sourceBefore.forEach(file => {
                const isModified = file.includes('(modified)');
                const isNew = file.includes('(new)');
                const fileName = file.replace(/\s*\(.*?\)/g, '');
                let className = 'file-tree-item';
                if (isModified) className += ' modified';
                if (isNew) className += ' new';
                sourceHtml += `<div class="${className}">${fileName}</div>`;
            });
            document.getElementById('source-before').innerHTML = sourceHtml;
            
            let destHtml = '';
            if (scenario.destBefore.length === 0) {
                destHtml = '<div style="color: #888; font-style: italic;">Empty directory</div>';
            } else {
                scenario.destBefore.forEach(file => {
                    const isOld = file.includes('(old)');
                    const isDeleted = file.includes('(deleted');
                    const fileName = file.replace(/\s*\(.*?\)/g, '');
                    let className = 'file-tree-item';
                    if (isOld) className += ' modified';
                    if (isDeleted) className += ' deleted';
                    destHtml += `<div class="${className}">${fileName}</div>`;
                });
            }
            document.getElementById('dest-before').innerHTML = destHtml;
            
            // Update command
            let command = 'rsync -av';
            if (deleteFlag) command += ' --delete';
            command += ' /var/log/ /backup/logs/';
            document.getElementById('sync-command').textContent = command;
            
            // Hide results
            document.getElementById('sync-changes').style.display = 'none';
            document.getElementById('sync-after').style.display = 'none';
            document.getElementById('sync-stats').style.display = 'none';
        }

        function performSync() {
            const syncType = document.getElementById('sync-type').value;
            const scenario = syncScenarios[syncType];
            const deleteFlag = document.getElementById('sync-delete').checked;
            
            // Show changes
            document.getElementById('sync-changes').style.display = 'block';
            
            let changesHtml = '<p>' + scenario.description + '</p>';
            
            // Build actions list
            let transferred = 0;
            let deleted = 0;
            let unchanged = 0;
            
            const sourceFiles = scenario.sourceBefore.map(f => f.replace(/\s*\(.*?\)/g, ''));
            const destFiles = scenario.destBefore.map(f => f.replace(/\s*\(.*?\)/g, ''));
            
            sourceFiles.forEach(file => {
                const isInDest = destFiles.includes(file);
                const isModified = scenario.sourceBefore.find(f => f.includes(file) && f.includes('(modified)'));
                const isNew = scenario.sourceBefore.find(f => f.includes(file) && f.includes('(new)'));
                
                if (isNew || !isInDest) {
                    changesHtml += `
                        <div class="sync-row">
                            <div class="sync-file new">${file}</div>
                            <div class="sync-arrow">‚Üí</div>
                            <div class="sync-file new">${file} (copied)</div>
                        </div>
                    `;
                    transferred++;
                } else if (isModified) {
                    changesHtml += `
                        <div class="sync-row">
                            <div class="sync-file modified">${file} (updated)</div>
                            <div class="sync-arrow">‚Üí</div>
                            <div class="sync-file modified">${file} (updated)</div>
                        </div>
                    `;
                    transferred++;
                } else {
                    changesHtml += `
                        <div class="sync-row">
                            <div class="sync-file">${file}</div>
                            <div class="sync-arrow" style="color: #888;">‚úì</div>
                            <div class="sync-file">${file} (unchanged)</div>
                        </div>
                    `;
                    unchanged++;
                }
            });
            
            // Handle deletions
            destFiles.forEach(file => {
                if (!sourceFiles.includes(file)) {
                    if (deleteFlag) {
                        changesHtml += `
                            <div class="sync-row">
                                <div class="sync-file deleted">-</div>
                                <div class="sync-arrow" style="color: #dc3545;">‚úï</div>
                                <div class="sync-file deleted">${file} (deleted)</div>
                            </div>
                        `;
                        deleted++;
                    } else {
                        changesHtml += `
                            <div class="sync-row">
                                <div class="sync-file">-</div>
                                <div class="sync-arrow" style="color: #888;">‚óã</div>
                                <div class="sync-file">${file} (kept - no --delete)</div>
                            </div>
                        `;
                    }
                }
            });
            
            document.getElementById('sync-actions').innerHTML = changesHtml;
            
            // Show after state
            document.getElementById('sync-after').style.display = 'block';
            
            // Source doesn't change
            document.getElementById('source-after').innerHTML = document.getElementById('source-before').innerHTML;
            
            // Destination is synchronized
            let destAfterHtml = '';
            sourceFiles.forEach(file => {
                destAfterHtml += `<div class="file-tree-item">${file}</div>`;
            });
            
            // If no delete flag, keep extra files
            if (!deleteFlag) {
                destFiles.forEach(file => {
                    if (!sourceFiles.includes(file)) {
                        destAfterHtml += `<div class="file-tree-item">${file}</div>`;
                    }
                });
            }
            
            document.getElementById('dest-after').innerHTML = destAfterHtml;
            
            // Show stats
            document.getElementById('sync-stats').style.display = 'block';
            
            const totalSize = (transferred + unchanged) * 100; // KB
            const dataTransferred = transferred * 100; // KB
            const speedup = totalSize > 0 ? (totalSize / Math.max(dataTransferred, 1)).toFixed(2) : '1.00';
            
            document.getElementById('stat-transferred').textContent = transferred;
            document.getElementById('stat-unchanged').textContent = unchanged;
            document.getElementById('stat-deleted').textContent = deleted;
            document.getElementById('stat-size').textContent = totalSize + ' KB';
            document.getElementById('stat-data').textContent = dataTransferred + ' KB';
            document.getElementById('stat-speedup').textContent = speedup;
        }

        // Initialize on load
        window.addEventListener('load', function() {
            updateTarCommand();
            calculateCompression();
            updatePathDemo();
            updateRsyncCommand();
            clearSftpTerminal();
        });
    </script>
</body>
</html>