<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Splunk Training Course - 6 Hour Program</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #000000;
            --secondary-color: #1a1a1a;
            --accent-color: #65a637;
            --splunk-green: #65a637;
            --splunk-orange: #f58025;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f5f5f5;
            --dark-text: #333;
            --border-color: #ddd;
        }

        body {
            font-family: 'Splunk Platform Sans', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background: var(--light-bg);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background: var(--primary-color);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--splunk-green);
            border-radius: 4px;
        }

        .sidebar h1 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--splunk-green);
        }

        .splunk-logo {
            color: var(--splunk-green);
            font-weight: bold;
        }

        .course-info {
            font-size: 0.9rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            opacity: 0.7;
            color: var(--splunk-green);
        }

        .nav-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(101, 166, 55, 0.1);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(101, 166, 55, 0.2);
            transform: translateX(5px);
            border-left-color: var(--splunk-green);
        }

        .nav-item.active {
            background: var(--splunk-green);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            border-left-color: var(--splunk-orange);
        }

        .nav-item .duration {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .progress-indicator {
            margin-top: 20px;
            padding: 15px;
            background: rgba(101, 166, 55, 0.1);
            border-radius: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--splunk-green), var(--splunk-orange));
            transition: width 0.3s;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 40px;
            background: white;
        }

        .module {
            display: none;
        }

        .module.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module-header {
            background: linear-gradient(135deg, var(--primary-color), var(--splunk-green));
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .module-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .module-meta {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .content-section {
            margin-bottom: 40px;
        }

        .content-section h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .content-section h4 {
            color: var(--splunk-green);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        .info-box {
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid var(--splunk-green);
            background: #e8f5e9;
        }

        .warning-box {
            border-left-color: var(--warning-color);
            background: #fff3e0;
        }

        .tip-box {
            border-left-color: var(--splunk-orange);
            background: #fff3e0;
        }

        .code-block {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .command {
            background: #37474f;
            color: #ffeb3b;
            padding: 5px 10px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
        }

        tr:nth-child(even) {
            background: var(--light-bg);
        }

        /* Knowledge Check */
        .knowledge-check {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
            border: 2px solid var(--splunk-green);
        }

        .question {
            margin-bottom: 25px;
        }

        .question-text {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .options {
            margin-left: 20px;
        }

        .option {
            padding: 10px;
            margin: 8px 0;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--splunk-green);
            transform: translateX(5px);
        }

        .option.correct {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .option.incorrect {
            background: var(--danger-color);
            color: white;
            border-color: var(--danger-color);
        }

        .feedback {
            margin-top: 10px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Hands-on Exercise */
        .exercise {
            background: linear-gradient(135deg, var(--splunk-green) 0%, #4a7c2c 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .exercise h4 {
            color: white;
            font-size: 1.4rem;
            margin-bottom: 15px;
        }

        .exercise-steps {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .exercise-steps ol {
            margin-left: 20px;
        }

        .exercise-steps li {
            margin: 10px 0;
        }

        /* Buttons */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .btn-primary {
            background: var(--splunk-green);
            color: white;
        }

        .btn-primary:hover {
            background: #4a7c2c;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-secondary {
            background: #757575;
            color: white;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        /* Resource Section */
        .resource-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 4px solid var(--splunk-green);
        }

        .resource-card:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transform: translateY(-3px);
        }

        .resource-card h4 {
            color: var(--splunk-green);
            margin-bottom: 10px;
        }

        .resource-link {
            color: var(--splunk-green);
            text-decoration: none;
            font-weight: bold;
        }

        .resource-link:hover {
            text-decoration: underline;
            color: var(--splunk-orange);
        }

        /* Installation Guide */
        .os-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .os-tab {
            padding: 10px 20px;
            background: var(--light-bg);
            border: 2px solid var(--border-color);
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .os-tab.active {
            background: var(--splunk-green);
            color: white;
            border-color: var(--splunk-green);
        }

        .os-content {
            display: none;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 0 5px 5px 5px;
        }

        .os-content.active {
            display: block;
        }

        /* Capstone Project */
        .capstone {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--splunk-green) 100%);
            color: white;
            padding: 40px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .scenario-box {
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .requirements-list {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Splunk Interface Simulator */
        .splunk-simulator {
            margin: 30px 0;
            padding: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            border: 2px solid #ccc;
        }

        .splunk-interface {
            background: white;
            border: 2px solid #333;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
        }

        .clickable-area {
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .clickable-area:hover {
            background: rgba(101, 166, 55, 0.1) !important;
            transform: scale(1.01);
            z-index: 10;
            box-shadow: 0 0 0 3px rgba(101, 166, 55, 0.5);
        }

        .splunk-navbar {
            background: var(--primary-color);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .splunk-navbar .logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--splunk-green);
        }

        .splunk-navbar .user-menu {
            display: flex;
            gap: 15px;
        }

        .splunk-tabs {
            background: #2d2d2d;
            padding: 0;
            display: flex;
            border-bottom: 2px solid var(--splunk-green);
        }

        .splunk-tab {
            padding: 12px 20px;
            color: #aaa;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .splunk-tab.active {
            color: white;
            background: #1a1a1a;
            border-bottom-color: var(--splunk-green);
        }

        .splunk-tab:hover {
            background: #1a1a1a;
            color: white;
        }

        .search-bar-container {
            background: #f5f5f5;
            padding: 15px;
            border-bottom: 1px solid #ddd;
        }

        .search-bar {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid var(--splunk-green);
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
        }

        .search-button {
            padding: 10px 30px;
            background: var(--splunk-green);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .search-button:hover {
            background: #4a7c2c;
        }

        .search-mode {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .mode-btn {
            padding: 5px 15px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }

        .mode-btn.active {
            background: var(--splunk-green);
            color: white;
            border-color: var(--splunk-green);
        }

        .main-panels {
            display: flex;
            height: 500px;
        }

        .results-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: white;
        }

        .sidebar-panel {
            width: 250px;
            padding: 15px;
            background: #f9f9f9;
            border-left: 1px solid #ddd;
            overflow-y: auto;
        }

        .event-list {
            margin-top: 15px;
        }

        .event-item {
            background: #f5f5f5;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 3px solid var(--splunk-green);
            font-size: 11px;
            cursor: pointer;
        }

        .event-item:hover {
            background: #e8f5e9;
            transform: translateX(3px);
        }

        .event-timestamp {
            color: #666;
            font-size: 10px;
        }

        .event-content {
            margin-top: 5px;
            font-family: 'Consolas', monospace;
            color: #333;
        }

        .field-item {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .field-item:hover {
            background: #e8f5e9;
        }

        .field-name {
            font-weight: bold;
            color: var(--splunk-green);
        }

        .field-count {
            float: right;
            color: #666;
            font-size: 11px;
        }

        /* Modal Styles */
        .component-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            animation: fadeIn 0.3s;
        }

        .component-modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border: 2px solid var(--splunk-green);
            border-radius: 10px;
            width: 80%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .component-modal-close {
            color: #aaa;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            line-height: 20px;
        }

        .component-modal-close:hover,
        .component-modal-close:focus {
            color: #000;
        }

        #modalTitle {
            color: var(--splunk-green);
            margin-top: 0;
            margin-bottom: 20px;
        }

        #modalBody {
            font-size: 1rem;
            line-height: 1.8;
        }

        #modalBody ul {
            margin-left: 20px;
        }

        #modalBody strong {
            color: var(--primary-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .container {
                flex-direction: column;
            }

            .main-panels {
                flex-direction: column;
                height: auto;
            }

            .sidebar-panel {
                width: 100%;
                border-left: none;
                border-top: 1px solid #ddd;
            }
        }

        /* Print Styles */
        @media print {
            .sidebar, .navigation-buttons {
                display: none;
            }

            .main-content {
                margin-left: 0;
            }

            .component-modal {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <h1><span class="splunk-logo">Splunk</span> Mastery</h1>
            <div class="course-info">
                <p><strong>Duration:</strong> 6 Hours</p>
                <p><strong>Level:</strong> Beginner to Intermediate</p>
            </div>

            <div class="nav-section">
                <h3>Course Modules</h3>
                <div class="nav-item active" data-module="0">
                    <span>Introduction & Setup</span>
                    <span class="duration">30m</span>
                </div>
                <div class="nav-item" data-module="1">
                    <span>Interface & Basics</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="2">
                    <span>Search Processing Language</span>
                    <span class="duration">60m</span>
                </div>
                <div class="nav-item" data-module="3">
                    <span>Data Inputs & Parsing</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="4">
                    <span>Visualizations & Dashboards</span>
                    <span class="duration">60m</span>
                </div>
                <div class="nav-item" data-module="5">
                    <span>Alerting & Monitoring</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="6">
                    <span>Advanced Features</span>
                    <span class="duration">45m</span>
                </div>
                <div class="nav-item" data-module="7">
                    <span>Capstone Project</span>
                    <span class="duration">45m</span>
                </div>
            </div>

            <div class="progress-indicator">
                <strong>Course Progress</strong>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                </div>
                <p id="progressText">0% Complete</p>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Module 0: Introduction & Setup -->
            <div class="module active" data-module-id="0">
                <div class="module-header">
                    <h2>Module 1: Introduction & Setup</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 30 minutes</span>
                        <span>📚 Topics: 5</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Welcome to Splunk Mastery</h3>
                    <p>Welcome to this comprehensive 6-hour training course on Splunk, the industry-leading platform for searching, monitoring, and analyzing machine-generated data. Whether you're pursuing a career in IT operations, security, or data analytics, Splunk is an essential tool that will empower you to turn data into doing.</p>
                    
                    <div class="info-box">
                        <strong>What You'll Learn:</strong>
                        <ul>
                            <li>Search and analyze log data in real-time</li>
                            <li>Create visualizations and interactive dashboards</li>
                            <li>Monitor systems and applications for issues</li>
                            <li>Detect security threats and anomalies</li>
                            <li>Configure alerts and automated responses</li>
                            <li>Apply Splunk to real-world IT and security scenarios</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>What is Splunk?</h3>
                    <p>Splunk is a powerful platform designed to make machine data accessible, usable, and valuable to everyone. It collects, indexes, and correlates real-time data in a searchable repository from which it can generate graphs, reports, alerts, dashboards, and visualizations.</p>
                    
                    <h4>Key Features</h4>
                    <ul>
                        <li><strong>Universal Data Collection:</strong> Ingest any type of machine data from any source</li>
                        <li><strong>Real-Time Indexing:</strong> Index data as it arrives for instant searchability</li>
                        <li><strong>Powerful Search:</strong> Use SPL (Search Processing Language) to query billions of events in seconds</li>
                        <li><strong>Rich Visualizations:</strong> Create charts, graphs, and dashboards from your data</li>
                        <li><strong>Alerting & Monitoring:</strong> Set up automated alerts based on conditions</li>
                        <li><strong>Machine Learning:</strong> Apply ML algorithms for anomaly detection and forecasting</li>
                        <li><strong>Apps & Add-ons:</strong> Extend functionality with thousands of pre-built solutions</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Did You Know?</strong> Splunk processes over 100 petabytes of data per day across thousands of customers worldwide, making it one of the most trusted platforms for operational intelligence and security!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Splunk Products Overview</h3>
                    <p>Splunk offers several products tailored to different use cases:</p>

                    <table>
                        <tr>
                            <th>Product</th>
                            <th>Description</th>
                            <th>Primary Use Case</th>
                        </tr>
                        <tr>
                            <td><strong>Splunk Enterprise</strong></td>
                            <td>Core platform for searching, monitoring, and analyzing data</td>
                            <td>IT Operations, Log Management</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk Cloud</strong></td>
                            <td>Cloud-hosted Splunk service</td>
                            <td>SaaS deployment, scalability</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk Enterprise Security (ES)</strong></td>
                            <td>SIEM solution built on Splunk</td>
                            <td>Security Operations, Threat Detection</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk IT Service Intelligence (ITSI)</strong></td>
                            <td>AIOps and monitoring solution</td>
                            <td>Service Monitoring, Predictive Analytics</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk Observability</strong></td>
                            <td>Full-stack observability platform</td>
                            <td>APM, Infrastructure Monitoring</td>
                        </tr>
                    </table>

                    <p><strong>For this course:</strong> We'll focus on Splunk Enterprise fundamentals, which form the foundation for all Splunk products.</p>
                </div>

                <div class="content-section">
                    <h3>Installation Guide</h3>
                    <p>Follow these instructions to install Splunk Enterprise on your operating system:</p>

                    <div class="warning-box">
                        <strong>⚠️ System Requirements:</strong>
                        <ul>
                            <li><strong>RAM:</strong> Minimum 4GB (8GB+ recommended)</li>
                            <li><strong>Disk Space:</strong> 20GB free space minimum</li>
                            <li><strong>CPU:</strong> 2+ cores recommended</li>
                            <li><strong>OS:</strong> Windows, Linux, or macOS</li>
                        </ul>
                    </div>

                    <div class="os-tabs">
                        <div class="os-tab active" data-os="windows">Windows</div>
                        <div class="os-tab" data-os="linux">Linux</div>
                        <div class="os-tab" data-os="macos">macOS</div>
                    </div>

                    <div class="os-content active" data-os-content="windows">
                        <h4>Installing Splunk Enterprise on Windows</h4>
                        <ol>
                            <li><strong>Download:</strong> Visit <a href="https://www.splunk.com/en_us/download.html" class="resource-link" target="_blank">splunk.com/download</a></li>
                            <li>Create a free Splunk account (or log in)</li>
                            <li>Download <strong>Splunk Enterprise for Windows (64-bit)</strong></li>
                            <li>Run the <span class="command">.msi</span> installer</li>
                            <li>Accept the license agreement</li>
                            <li>Choose installation directory (default: <span class="command">C:\Program Files\Splunk</span>)</li>
                            <li>Create admin username and password (save these!)</li>
                            <li>Complete installation</li>
                            <li>Splunk will automatically start and open in your browser at <span class="command">http://localhost:8000</span></li>
                        </ol>

                        <div class="info-box">
                            <strong>Default Credentials:</strong>
                            <ul>
                                <li><strong>URL:</strong> http://localhost:8000</li>
                                <li><strong>Username:</strong> admin</li>
                                <li><strong>Password:</strong> (the one you created during installation)</li>
                            </ul>
                        </div>

                        <div class="code-block">
# Start Splunk (if not running)
cd "C:\Program Files\Splunk\bin"
splunk.exe start

# Stop Splunk
splunk.exe stop

# Restart Splunk
splunk.exe restart

# Check Splunk status
splunk.exe status
                        </div>
                    </div>

                    <div class="os-content" data-os-content="linux">
                        <h4>Installing Splunk Enterprise on Linux</h4>
                        
                        <strong>Download and Install:</strong>
                        <div class="code-block">
# Download Splunk (replace version number as needed)
wget -O splunk-9.1.0-linux-2.6-amd64.deb \
  'https://download.splunk.com/products/splunk/releases/9.1.0/linux/splunk-9.1.0-linux-2.6-amd64.deb'

# Install on Debian/Ubuntu
sudo dpkg -i splunk-9.1.0-linux-2.6-amd64.deb

# OR for RPM-based systems (RHEL, CentOS, Fedora)
# sudo rpm -i splunk-9.1.0-linux-2.6-x86_64.rpm

# Navigate to Splunk directory
cd /opt/splunk/bin

# Start Splunk and accept license
sudo ./splunk start --accept-license

# Create admin password when prompted

# Enable Splunk to start at boot
sudo ./splunk enable boot-start
                        </div>

                        <strong>Managing Splunk Service:</strong>
                        <div class="code-block">
# Start Splunk
sudo /opt/splunk/bin/splunk start

# Stop Splunk
sudo /opt/splunk/bin/splunk stop

# Restart Splunk
sudo /opt/splunk/bin/splunk restart

# Check status
sudo /opt/splunk/bin/splunk status

# Access web interface
# Open browser to: http://localhost:8000
                        </div>

                        <div class="tip-box">
                            <strong>💡 Firewall Note:</strong> If accessing Splunk from another machine, ensure port 8000 is open:
                            <div class="code-block">
sudo firewall-cmd --permanent --add-port=8000/tcp
sudo firewall-cmd --reload
                            </div>
                        </div>
                    </div>

                    <div class="os-content" data-os-content="macos">
                        <h4>Installing Splunk Enterprise on macOS</h4>
                        <ol>
                            <li><strong>Download:</strong> Visit <a href="https://www.splunk.com/en_us/download.html" class="resource-link" target="_blank">splunk.com/download</a></li>
                            <li>Download <strong>Splunk Enterprise for macOS</strong> (.dmg file)</li>
                            <li>Open the .dmg file</li>
                            <li>Drag Splunk to Applications folder</li>
                            <li>Open Terminal and navigate to Splunk</li>
                        </ol>

                        <div class="code-block">
# Navigate to Splunk directory
cd /Applications/Splunk/bin

# Start Splunk and accept license
./splunk start --accept-license

# Create admin username and password when prompted

# Enable start at login (optional)
./splunk enable boot-start -user $(whoami)

# Access web interface
# Open browser to: http://localhost:8000
                        </div>

                        <strong>Managing Splunk:</strong>
                        <div class="code-block">
# Start Splunk
/Applications/Splunk/bin/splunk start

# Stop Splunk
/Applications/Splunk/bin/splunk stop

# Restart Splunk
/Applications/Splunk/bin/splunk restart

# Check status
/Applications/Splunk/bin/splunk status
                        </div>

                        <div class="warning-box">
                            <strong>⚠️ macOS Security:</strong> You may need to allow Splunk in System Preferences â†’ Security & Privacy if macOS blocks it on first run.
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Getting Sample Data</h3>
                    <p>To practice Splunk without generating your own data, you can use sample datasets:</p>

                    <div class="resource-card">
                        <h4>📑Š Splunk Tutorial Data</h4>
                        <p>Built-in tutorial data that comes with Splunk Enterprise. Access it through the "Add Data" interface.</p>
                        <ul>
                            <li><strong>tutorialdata.zip:</strong> Sample web server logs, error logs, and metrics</li>
                            <li><strong>Location:</strong> $SPLUNK_HOME/etc/apps/search/samples/</li>
                        </ul>
                    </div>

                    <div class="resource-card">
                        <h4>📑Š Boss of the SOC (BOTS) Dataset</h4>
                        <p>Realistic security dataset from Splunk's "Boss of the SOC" competition.</p>
                        <a href="https://github.com/splunk/botsv3" class="resource-link" target="_blank">github.com/splunk/botsv3</a>
                    </div>

                    <div class="resource-card">
                        <h4>📑Š Splunk Public Datasets</h4>
                        <p>Community-contributed datasets for various use cases.</p>
                        <a href="https://www.splunk.com/en_us/resources/sample-data.html" class="resource-link" target="_blank">splunk.com/sample-data</a>
                    </div>

                    <h4>Adding Tutorial Data</h4>
                    <div class="code-block">
# Method 1: Through Web UI
1. Log in to Splunk Web (http://localhost:8000)
2. Click "Settings" â†’ "Add Data"
3. Select "Upload"
4. Browse to $SPLUNK_HOME/etc/apps/search/samples/tutorialdata.zip
5. Click "Next" â†’ "Review" â†’ "Submit"

# Method 2: Command Line
cd /opt/splunk/bin  # or appropriate Splunk directory
./splunk add oneshot $SPLUNK_HOME/etc/apps/search/samples/tutorialdata.zip \
  -sourcetype access_combined -index main
                    </div>
                </div>

                <div class="content-section">
                    <h3>First Login & Orientation</h3>
                    <p>After installation, follow these steps to get oriented:</p>

                    <ol>
                        <li>Open your web browser and navigate to <strong>http://localhost:8000</strong></li>
                        <li>Log in with your admin credentials</li>
                        <li>You'll see the Splunk Home page with:
                            <ul>
                                <li><strong>Search & Reporting:</strong> Main app for searching data</li>
                                <li><strong>Getting Started:</strong> Quick tour and tutorials</li>
                                <li><strong>Apps:</strong> Browse and install additional apps</li>
                            </ul>
                        </li>
                        <li>Click on <strong>"Search & Reporting"</strong> to access the search interface</li>
                        <li>Take a moment to explore the interface (we'll cover it in detail in Module 2)</li>
                    </ol>

                    <div class="tip-box">
                        <strong>💡 First Steps:</strong>
                        <ul>
                            <li>Bookmark the Splunk Web URL</li>
                            <li>Take the built-in tour (Help â†’ Tour)</li>
                            <li>Review the documentation (Help â†’ Documentation)</li>
                            <li>Join the Splunk Community at <a href="https://community.splunk.com" target="_blank" style="color: inherit;">community.splunk.com</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 1</h3>
                    <p><em>Test your understanding of this module. Click on your answer to check if you're correct.</em></p>

                    <div class="question">
                        <div class="question-text">1. What is the primary purpose of Splunk?</div>
                        <div class="options">
                            <div class="option" data-correct="true">To collect, index, search, analyze, and visualize machine-generated data</div>
                            <div class="option" data-correct="false">To create databases for structured data storage</div>
                            <div class="option" data-correct="false">To replace traditional antivirus software</div>
                            <div class="option" data-correct="false">To automatically fix system errors</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What is the default port for accessing Splunk Web?</div>
                        <div class="options">
                            <div class="option" data-correct="false">80</div>
                            <div class="option" data-correct="false">443</div>
                            <div class="option" data-correct="true">8000</div>
                            <div class="option" data-correct="false">9997</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What is SPL?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Splunk Programming Library</div>
                            <div class="option" data-correct="true">Search Processing Language - Splunk's query language</div>
                            <div class="option" data-correct="false">System Performance Log</div>
                            <div class="option" data-correct="false">Security Protocol Layer</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. Which Splunk product is designed specifically for security operations?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Splunk Cloud</div>
                            <div class="option" data-correct="true">Splunk Enterprise Security (ES)</div>
                            <div class="option" data-correct="false">Splunk ITSI</div>
                            <div class="option" data-correct="false">Splunk Lite</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What is the minimum recommended RAM for running Splunk Enterprise?</div>
                        <div class="options">
                            <div class="option" data-correct="false">2 GB</div>
                            <div class="option" data-correct="false">4 GB minimum (8GB+ recommended)</div>
                            <div class="option" data-correct="true">8 GB</div>
                            <div class="option" data-correct="false">16 GB</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" disabled>â† Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Interface & Basics â†’</button>
                </div>
            </div>

            <!-- Module 1: Interface & Basics -->
            <div class="module" data-module-id="1">
                <div class="module-header">
                    <h2>Module 2: Interface & Basics</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding the Splunk Interface</h3>
                    <p>When you first log in to Splunk Web and open the Search & Reporting app, you'll see a powerful interface designed for data exploration and analysis. Let's explore each component:</p>

                    <div class="info-box">
                        <strong>🖱️ Interactive Demo Below:</strong> Click on any colored area in the interface diagram to learn what that component does!
                    </div>

                    <!-- Interactive Splunk Interface Simulator -->
                    <div class="splunk-simulator">
                        <h4 style="text-align: center; margin-bottom: 15px;">Interactive Splunk Interface</h4>
                        
                        <div class="splunk-interface">
                            <!-- Navigation Bar -->
                            <div class="splunk-navbar clickable-area" data-component="navbar">
                                <div class="logo">Splunk&gt;</div>
                                <div class="user-menu">
                                    <span>Apps</span>
                                    <span>Settings</span>
                                    <span>Activity</span>
                                    <span>Help</span>
                                    <span>👤 admin</span>
                                </div>
                            </div>

                            <!-- Tabs -->
                            <div class="splunk-tabs clickable-area" data-component="tabs">
                                <div class="splunk-tab active">Search</div>
                                <div class="splunk-tab">Dashboards</div>
                                <div class="splunk-tab">Reports</div>
                                <div class="splunk-tab">Alerts</div>
                                <div class="splunk-tab">Data Summary</div>
                            </div>

                            <!-- Search Bar -->
                            <div class="search-bar-container clickable-area" data-component="search-bar">
                                <div class="search-bar">
                                    <input type="text" class="search-input" value="index=main sourcetype=access_combined status=200 | stats count by clientip | sort - count" readonly>
                                    <button class="search-button">🔍 Search</button>
                                </div>
                                <div class="search-mode">
                                    <button class="mode-btn">Fast Mode</button>
                                    <button class="mode-btn active">Smart Mode</button>
                                    <button class="mode-btn">Verbose Mode</button>
                                    <span style="margin-left: 20px; font-size: 11px;">📑… Last 24 hours</span>
                                </div>
                            </div>

                            <!-- Main Panels -->
                            <div class="main-panels">
                                <!-- Results Panel -->
                                <div class="results-panel clickable-area" data-component="results">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="display: flex; gap: 10px;">
                                            <button class="mode-btn active">Events</button>
                                            <button class="mode-btn">Patterns</button>
                                            <button class="mode-btn">Statistics</button>
                                            <button class="mode-btn">Visualization</button>
                                        </div>
                                        <span style="font-size: 12px; color: #666;">245,893 events</span>
                                    </div>

                                    <div class="event-list">
                                        <div class="event-item">
                                            <div class="event-timestamp">10/29/2025 10:15:23.456</div>
                                            <div class="event-content">192.168.1.100 - - [29/Oct/2025:10:15:23] "GET /products HTTP/1.1" 200 2456</div>
                                        </div>
                                        <div class="event-item">
                                            <div class="event-timestamp">10/29/2025 10:15:22.123</div>
                                            <div class="event-content">192.168.1.105 - - [29/Oct/2025:10:15:22] "POST /cart/add HTTP/1.1" 200 512</div>
                                        </div>
                                        <div class="event-item">
                                            <div class="event-timestamp">10/29/2025 10:15:20.789</div>
                                            <div class="event-content">10.0.0.50 - - [29/Oct/2025:10:15:20] "GET /api/search HTTP/1.1" 200 8192</div>
                                        </div>
                                        <div class="event-item">
                                            <div class="event-timestamp">10/29/2025 10:15:19.456</div>
                                            <div class="event-content">192.168.1.100 - - [29/Oct/2025:10:15:19] "GET /index.html HTTP/1.1" 200 1024</div>
                                        </div>
                                        <div class="event-item">
                                            <div class="event-timestamp">10/29/2025 10:15:18.234</div>
                                            <div class="event-content">172.16.0.25 - - [29/Oct/2025:10:15:18] "GET /images/logo.png HTTP/1.1" 200 45678</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sidebar Panel -->
                                <div class="sidebar-panel clickable-area" data-component="sidebar">
                                    <h4 style="margin-bottom: 10px;">Fields</h4>
                                    <div>
                                        <div class="field-item">
                                            <span class="field-name">host</span>
                                            <span class="field-count">3</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">source</span>
                                            <span class="field-count">2</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">sourcetype</span>
                                            <span class="field-count">1</span>
                                        </div>
                                    </div>
                                    <h4 style="margin: 15px 0 10px 0;">Selected Fields</h4>
                                    <div>
                                        <div class="field-item">
                                            <span class="field-name">clientip</span>
                                            <span class="field-count">1,234</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">status</span>
                                            <span class="field-count">5</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">method</span>
                                            <span class="field-count">4</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">uri</span>
                                            <span class="field-count">567</span>
                                        </div>
                                    </div>
                                    <h4 style="margin: 15px 0 10px 0;">Interesting Fields</h4>
                                    <div>
                                        <div class="field-item">
                                            <span class="field-name">bytes</span>
                                            <span class="field-count">245,893</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">referer</span>
                                            <span class="field-count">12,456</span>
                                        </div>
                                        <div class="field-item">
                                            <span class="field-name">useragent</span>
                                            <span class="field-count">89</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal for component information -->
                    <div id="componentModal" class="component-modal">
                        <div class="component-modal-content">
                            <span class="component-modal-close">&times;</span>
                            <h3 id="modalTitle"></h3>
                            <div id="modalBody"></div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Main Interface Components</h3>
                    <table>
                        <tr>
                            <th>Component</th>
                            <th>Description</th>
                            <th>Purpose</th>
                        </tr>
                        <tr>
                            <td><strong>Navigation Bar</strong></td>
                            <td>Top bar with app selector and menus</td>
                            <td>Access different apps, settings, and help</td>
                        </tr>
                        <tr>
                            <td><strong>Tab Bar</strong></td>
                            <td>Tabs for Search, Dashboards, Reports, etc.</td>
                            <td>Navigate between different views</td>
                        </tr>
                        <tr>
                            <td><strong>Search Bar</strong></td>
                            <td>Input field for SPL queries</td>
                            <td>Enter searches and filters</td>
                        </tr>
                        <tr>
                            <td><strong>Time Range Picker</strong></td>
                            <td>Control for selecting time range</td>
                            <td>Define the time period to search</td>
                        </tr>
                        <tr>
                            <td><strong>Results Pane</strong></td>
                            <td>Main area showing search results</td>
                            <td>View events, statistics, or visualizations</td>
                        </tr>
                        <tr>
                            <td><strong>Fields Sidebar</strong></td>
                            <td>Right sidebar with field information</td>
                            <td>Explore and select fields for analysis</td>
                        </tr>
                        <tr>
                            <td><strong>Timeline</strong></td>
                            <td>Visual representation of event distribution</td>
                            <td>See when events occurred over time</td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Running Your First Search</h3>
                    <p>Let's run a simple search to get familiar with the interface:</p>

                    <h4>Step 1: Access the Search Interface</h4>
                    <ol>
                        <li>Click on <strong>Search & Reporting</strong> app from the home page</li>
                        <li>You'll see the search bar at the top of the page</li>
                    </ol>

                    <h4>Step 2: Enter a Simple Search</h4>
                    <p>Type this into the search bar:</p>
                    <div class="code-block">
index=main
                    </div>
                    <p>This searches for all events in the "main" index.</p>

                    <h4>Step 3: Select Time Range</h4>
                    <ul>
                        <li>Click the time range picker (default: "Last 24 hours")</li>
                        <li>You can select presets like "Last 15 minutes", "Last hour", etc.</li>
                        <li>Or create a custom range</li>
                    </ul>

                    <h4>Step 4: Run the Search</h4>
                    <ul>
                        <li>Click the green <strong>Search</strong> button (or press Enter)</li>
                        <li>Watch as Splunk searches through your data</li>
                        <li>Results appear in the main pane</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Search Modes:</strong>
                        <ul>
                            <li><strong>Fast Mode:</strong> Fastest, returns only essential fields</li>
                            <li><strong>Smart Mode:</strong> Balance of speed and completeness (recommended)</li>
                            <li><strong>Verbose Mode:</strong> Slowest, returns all fields and event data</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding Search Results</h3>
                    <p>Splunk can display results in multiple formats:</p>

                    <h4>1. Events View</h4>
                    <p>Shows raw events with timestamps. Each event displays:</p>
                    <ul>
                        <li><strong>Timestamp:</strong> When the event occurred</li>
                        <li><strong>Source:</strong> Where the data came from</li>
                        <li><strong>Sourcetype:</strong> Type of data</li>
                        <li><strong>Host:</strong> Machine that generated the data</li>
                        <li><strong>Raw event data:</strong> The actual log entry</li>
                    </ul>

                    <h4>2. Statistics View</h4>
                    <p>Tabular display of aggregated data (when using stats commands).</p>
                    <div class="code-block">
index=main | stats count by status
                    </div>

                    <h4>3. Visualization View</h4>
                    <p>Graphical representation of your data (charts, graphs, maps).</p>

                    <h4>4. Patterns View</h4>
                    <p>Automatically identifies patterns in your data.</p>
                </div>

                <div class="content-section">
                    <h3>Working with Fields</h3>
                    <p>Fields are key-value pairs extracted from your events. They are essential for searching and analyzing data.</p>

                    <h4>Default Fields</h4>
                    <p>Every event has these default fields:</p>
                    <ul>
                        <li><strong>host:</strong> The machine/device that generated the event</li>
                        <li><strong>source:</strong> The file or stream where the event came from</li>
                        <li><strong>sourcetype:</strong> The format/type of the data</li>
                        <li><strong>index:</strong> The index where the event is stored</li>
                        <li><strong>_time:</strong> Timestamp of the event</li>
                        <li><strong>_raw:</strong> The raw event text</li>
                    </ul>

                    <h4>Extracted Fields</h4>
                    <p>Splunk automatically extracts fields based on the sourcetype. For example, in web access logs:</p>
                    <ul>
                        <li><strong>clientip:</strong> Client IP address</li>
                        <li><strong>method:</strong> HTTP method (GET, POST, etc.)</li>
                        <li><strong>status:</strong> HTTP status code</li>
                        <li><strong>uri:</strong> Requested URI</li>
                        <li><strong>bytes:</strong> Response size</li>
                    </ul>

                    <h4>Using the Fields Sidebar</h4>
                    <ol>
                        <li><strong>Selected Fields:</strong> Fields you've chosen to display in results</li>
                        <li><strong>Interesting Fields:</strong> Fields found in at least 20% of events</li>
                        <li><strong>All Fields:</strong> Every field found in the results</li>
                    </ol>

                    <div class="code-block">
# Click on a field name to:
- See top values
- Add to selected fields
- View statistics
- Create a report
- Add to search
                    </div>

                    <div class="tip-box">
                        <strong>💡 Pro Tip:</strong> Click on a field value to automatically add it to your search! This is one of the fastest ways to refine your results.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Time Range Selection</h3>
                    <p>Understanding time ranges is crucial for efficient searching.</p>

                    <h4>Preset Time Ranges</h4>
                    <ul>
                        <li>Last 15 minutes</li>
                        <li>Last 60 minutes</li>
                        <li>Last 4 hours</li>
                        <li>Last 24 hours</li>
                        <li>Last 7 days</li>
                        <li>Last 30 days</li>
                        <li>All time (use cautiously!)</li>
                    </ul>

                    <h4>Custom Time Ranges</h4>
                    <div class="code-block">
# In search:
earliest=-24h@h latest=now
earliest=-1d@d latest=@d
earliest=10/01/2025:00:00:00 latest=10/31/2025:23:59:59

# Time modifiers:
s = second
m = minute  
h = hour
d = day
w = week
mon = month
y = year

# Examples:
-1h     = 1 hour ago
-30m    = 30 minutes ago
@d      = beginning of today
-7d@d   = beginning of 7 days ago
                    </div>

                    <div class="warning-box">
                        <strong>⚠️ Performance Tip:</strong> Always use the most specific time range possible. Searching "All time" can be extremely slow and resource-intensive!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Saving and Sharing Searches</h3>
                    
                    <h4>Saving a Search</h4>
                    <ol>
                        <li>Run your search</li>
                        <li>Click <strong>Save As</strong> dropdown</li>
                        <li>Choose:
                            <ul>
                                <li><strong>Report:</strong> Save for reuse</li>
                                <li><strong>Alert:</strong> Trigger actions when conditions are met</li>
                                <li><strong>Dashboard Panel:</strong> Add to a dashboard</li>
                            </ul>
                        </li>
                        <li>Give it a name and description</li>
                        <li>Set permissions (Private, This app, All apps)</li>
                    </ol>

                    <h4>Accessing Saved Searches</h4>
                    <ul>
                        <li><strong>Reports:</strong> Click "Reports" tab</li>
                        <li><strong>Dashboards:</strong> Click "Dashboards" tab</li>
                        <li><strong>Alerts:</strong> Click "Alerts" tab</li>
                    </ul>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: Exploring the Interface</h4>
                    <p>Let's practice using the Splunk interface:</p>

                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Basic Search:</strong>
                                <ul>
                                    <li>Search: <span class="command" style="background: white; color: #333; padding: 3px 6px;">index=main</span></li>
                                    <li>Set time range to "Last 15 minutes"</li>
                                    <li>How many events do you see?</li>
                                </ul>
                            </li>
                            <li><strong>Explore Fields:</strong>
                                <ul>
                                    <li>Look at the Fields sidebar</li>
                                    <li>Click on different field names</li>
                                    <li>Notice the top values and percentages</li>
                                    <li>Try adding a field to "Selected Fields"</li>
                                </ul>
                            </li>
                            <li><strong>Filter by Field:</strong>
                                <ul>
                                    <li>Click on a field value in the sidebar</li>
                                    <li>Notice how it adds to your search</li>
                                    <li>Run the refined search</li>
                                </ul>
                            </li>
                            <li><strong>Change View:</strong>
                                <ul>
                                    <li>Try switching between Events, Patterns, Statistics, and Visualization tabs</li>
                                    <li>Observe how the data is displayed differently</li>
                                </ul>
                            </li>
                            <li><strong>Save a Search:</strong>
                                <ul>
                                    <li>Create a simple search</li>
                                    <li>Click "Save As" â†’ "Report"</li>
                                    <li>Name it "My First Search"</li>
                                    <li>Find it in the Reports tab</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 2</h3>

                    <div class="question">
                        <div class="question-text">1. What are the three search modes in Splunk?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Simple, Medium, Complex</div>
                            <div class="option" data-correct="true">Fast, Smart, Verbose</div>
                            <div class="option" data-correct="false">Quick, Normal, Detailed</div>
                            <div class="option" data-correct="false">Basic, Intermediate, Advanced</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which default field contains the raw event data?</div>
                        <div class="options">
                            <div class="option" data-correct="false">_data</div>
                            <div class="option" data-correct="false">_event</div>
                            <div class="option" data-correct="true">_raw</div>
                            <div class="option" data-correct="false">_content</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What does clicking on a field value in the Fields sidebar do?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Deletes the field</div>
                            <div class="option" data-correct="false">Exports the data</div>
                            <div class="option" data-correct="true">Adds it as a filter to your search</div>
                            <div class="option" data-correct="false">Creates a new index</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What does "-24h@h" mean in Splunk time syntax?</div>
                        <div class="options">
                            <div class="option" data-correct="false">24 hours from now</div>
                            <div class="option" data-correct="true">24 hours ago, rounded to the hour</div>
                            <div class="option" data-correct="false">The 24th hour of today</div>
                            <div class="option" data-correct="false">Every 24 hours</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Which view shows tabular aggregated data?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Events</div>
                            <div class="option" data-correct="true">Statistics</div>
                            <div class="option" data-correct="false">Patterns</div>
                            <div class="option" data-correct="false">Timeline</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">â† Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Search Processing Language â†’</button>
                </div>
            </div>

            <!-- Module 2: Search Processing Language (SPL) -->
            <div class="module" data-module-id="2">
                <div class="module-header">
                    <h2>Module 3: Search Processing Language (SPL)</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 60 minutes</span>
                        <span>📚 Topics: 8</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Introduction to SPL</h3>
                    <p>Search Processing Language (SPL) is Splunk's powerful query language. It allows you to search, analyze, and visualize your data. Think of it as SQL for machine data!</p>

                    <div class="info-box">
                        <strong>SPL Philosophy:</strong>
                        <ul>
                            <li>Searches are built using a <strong>pipeline</strong> of commands</li>
                            <li>Each command processes results from the previous command</li>
                            <li>Commands are separated by the pipe character <span class="command">|</span></li>
                            <li>SPL is case-sensitive for field names and values</li>
                        </ul>
                    </div>

                    <h4>Basic SPL Structure</h4>
                    <div class="code-block">
# Basic format:
search_terms | command1 | command2 | command3

# Example:
index=web status=500 | stats count by host | sort - count

# Breakdown:
# 1. index=web status=500  â† Search terms (find events)
# 2. stats count by host   â† Aggregate data
# 3. sort - count          â† Sort results
                    </div>
                </div>

                <div class="content-section">
                    <h3>Search Commands</h3>
                    <p>These are the fundamental building blocks of SPL.</p>

                    <h4>1. Basic Search Terms</h4>
                    <div class="code-block">
# Search for keyword
error

# Search in specific index
index=main error

# Search with multiple terms (implicit AND)
index=web error 500

# Boolean operators
index=web (error OR warning)
index=web error NOT 404

# Field-value pairs
index=web status=500
index=web status=500 method=POST
sourcetype=access_combined clientip=192.168.1.*
                    </div>

                    <h4>2. Comparison Operators</h4>
                    <div class="code-block">
# Equal
status=200

# Not equal
status!=200

# Greater than
bytes > 10000

# Less than
response_time < 1000

# Greater than or equal
status >= 400

# Less than or equal  
status <= 299

# Wildcards
host=web*
uri=/api/*
                    </div>

                    <h4>3. Time-based Searches</h4>
                    <div class="code-block">
# Using time picker (recommended)
index=main earliest=-1h

# Specific time range
index=main earliest="10/01/2025:00:00:00" latest="10/31/2025:23:59:59"

# Relative time
index=main earliest=-24h@h latest=now
index=main earliest=-7d@d latest=@d

# Search for events in specific hour
index=main date_hour=14
                    </div>
                </div>

                <div class="content-section">
                    <h3>Transforming Commands</h3>
                    <p>These commands transform your search results into statistics, tables, and charts.</p>

                    <h4>stats Command</h4>
                    <p>Aggregate and calculate statistics from your data.</p>
                    <div class="code-block">
# Count total events
index=web | stats count

# Count by field
index=web | stats count by status

# Multiple statistics
index=web | stats count, avg(bytes), max(bytes) by host

# Multiple group-by fields
index=web | stats count by status, method

# Common stats functions:
count        # Count events
sum(field)   # Sum values
avg(field)   # Average
max(field)   # Maximum value
min(field)   # Minimum value
distinct_count(field)  # Count unique values
values(field)  # List unique values
list(field)    # List all values
                    </div>

                    <h4>chart Command</h4>
                    <p>Create visualizations with time-based or categorical data.</p>
                    <div class="code-block">
# Chart over time
index=web | chart count by status

# Chart with specific time span
index=web | chart count by host span=1h

# Multiple series
index=web | chart count by status, method

# Statistical functions
index=web | chart avg(response_time) by host
                    </div>

                    <h4>timechart Command</h4>
                    <p>Special chart for time-series data.</p>
                    <div class="code-block">
# Basic timechart
index=web | timechart count

# By field
index=web | timechart count by status

# With span
index=web | timechart span=5m count

# Multiple stats
index=web | timechart count, avg(bytes), max(response_time)
                    </div>

                    <h4>table Command</h4>
                    <p>Display specific fields in tabular format.</p>
                    <div class="code-block">
# Select specific fields
index=web | table _time, clientip, status, uri

# Rename fields
index=web | table _time, clientip as "Client IP", status as "Status Code"
                    </div>
                </div>

                <div class="content-section">
                    <h3>Filtering & Manipulation</h3>

                    <h4>where Command</h4>
                    <p>Filter results using Boolean expressions and comparisons.</p>
                    <div class="code-block">
# Filter by condition
index=web | stats count by status | where count > 100

# Multiple conditions
index=web | stats avg(bytes) as avg_bytes by host 
| where avg_bytes > 1000 AND avg_bytes < 10000

# String comparisons
index=web | where like(uri, "%admin%")
index=web | where match(clientip, "192\.168\..*")
                    </div>

                    <h4>search Command</h4>
                    <p>Apply additional search filters mid-pipeline.</p>
                    <div class="code-block">
# Filter results
index=web | stats count by status | search count>100

# Multiple terms
index=web | stats count by host | search web* OR app*
                    </div>

                    <h4>dedup Command</h4>
                    <p>Remove duplicate events based on field values.</p>
                    <div class="code-block">
# Remove duplicates by single field
index=web | dedup clientip

# By multiple fields
index=web | dedup clientip, uri

# Keep first N occurrences
index=web | dedup clientip keepevents=true
                    </div>

                    <h4>head and tail Commands</h4>
                    <div class="code-block">
# First 10 results (default)
index=web | head

# First 50 results
index=web | head 50

# Last 20 results
index=web | tail 20
                    </div>
                </div>

                <div class="content-section">
                    <h3>Field Manipulation</h3>

                    <h4>eval Command</h4>
                    <p>Create or modify fields using expressions.</p>
                    <div class="code-block">
# Create new field
index=web | eval size_kb = bytes / 1024

# Mathematical operations
index=web | eval total = price * quantity
index=web | eval percentage = (failures / total) * 100

# String operations
index=web | eval full_name = first_name + " " + last_name
index=web | eval upper_status = upper(status)
index=web | eval domain = lower(host)

# Conditional logic (if)
index=web | eval status_type = if(status >= 500, "Error", 
                                 if(status >= 400, "Client Error",
                                 if(status >= 300, "Redirect", "Success")))

# Case statement
index=web | eval priority = case(
    severity="critical", "P1",
    severity="high", "P2",
    severity="medium", "P3",
    1=1, "P4"  # default case
)

# Common eval functions:
round(field, decimals)
abs(field)
sqrt(field)
len(field)
substr(field, start, length)
replace(field, "old", "new")
                    </div>

                    <h4>rename Command</h4>
                    <p>Rename fields for clarity.</p>
                    <div class="code-block">
# Rename single field
index=web | rename clientip as "Client IP"

# Rename multiple fields
index=web | rename clientip as "IP Address", status as "HTTP Status"

# Wildcards
index=web | rename web_* as *
                    </div>

                    <h4>fields Command</h4>
                    <p>Include or exclude specific fields from results.</p>
                    <div class="code-block">
# Include only specific fields
index=web | fields _time, clientip, status

# Exclude fields
index=web | fields - _raw, punct

# Exclude multiple
index=web | fields - _raw - punct - linecount
                    </div>

                    <h4>rex Command</h4>
                    <p>Extract fields using regular expressions.</p>
                    <div class="code-block">
# Extract field from _raw
index=web | rex field=_raw "user=(?<username>\w+)"

# Multiple extractions
index=web | rex "(?<method>\w+)\s+(?<uri>/\S+)\s+HTTP"

# Extract with named groups
index=web | rex field=uri "/(?<category>\w+)/(?<item_id>\d+)"
                    </div>
                </div>

                <div class="content-section">
                    <h3>Sorting & Ordering</h3>

                    <h4>sort Command</h4>
                    <div class="code-block">
# Sort ascending
index=web | stats count by host | sort count

# Sort descending (use minus sign)
index=web | stats count by host | sort - count

# Sort by multiple fields
index=web | stats count by status, host | sort - count, status

# Limit results
index=web | stats count by host | sort - count | head 10
                    </div>

                    <h4>sort Shortcuts</h4>
                    <div class="code-block">
# Top command (combines stats, sort, and head)
index=web | top clientip limit=10

# Rare command (least common values)
index=web | rare uri limit=5

# With split-by
index=web | top uri by status
                    </div>
                </div>

                <div class="content-section">
                    <h3>Advanced SPL Techniques</h3>

                    <h4>subsearch</h4>
                    <p>Use the results of one search as input to another.</p>
                    <div class="code-block">
# Basic subsearch
index=web [search index=errors | fields clientip]

# Find IPs that caused errors, then find their other requests
index=web clientip IN [search index=errors status=500 | fields clientip]

# Subsearch with return
index=web [search index=blacklist | return clientip]
                    </div>

                    <h4>transaction Command</h4>
                    <p>Group related events together.</p>
                    <div class="code-block">
# Group events by session ID
index=web | transaction session_id

# With time constraints
index=web | transaction session_id maxspan=30m

# Multiple fields
index=web | transaction clientip, session_id maxpause=5m
                    </div>

                    <h4>join Command</h4>
                    <p>Combine results from two searches.</p>
                    <div class="code-block">
# Simple join
index=sales | join customer_id [search index=customers]

# Specify type
index=sales | join type=left customer_id [search index=customers]

# Join on multiple fields
index=web | join clientip, session_id [search index=sessions]
                    </div>

                    <h4>append and appendcols</h4>
                    <div class="code-block">
# Append results from another search
index=web status=500 
| append [search index=web status=404]

# Append as columns
index=web | stats count as web_count 
| appendcols [search index=db | stats count as db_count]
                    </div>
                </div>

                <div class="content-section">
                    <h3>SPL Best Practices</h3>
                    
                    <div class="info-box">
                        <strong>Performance Tips:</strong>
                        <ol>
                            <li><strong>Filter early:</strong> Use specific index, sourcetype, and time range at the start</li>
                            <li><strong>Limit fields:</strong> Use <span class="command">fields</span> command to reduce data</li>
                            <li><strong>Avoid wildcards at start:</strong> <span class="command">*error</span> is slow, <span class="command">error*</span> is better</li>
                            <li><strong>Use summary indexing:</strong> For frequently-run expensive searches</li>
                            <li><strong>Be specific with time:</strong> Never search "All time" unless necessary</li>
                        </ol>
                    </div>

                    <div class="code-block">
# âŒ Bad: Slow and resource-intensive
* | stats count by host

# ✅ Good: Fast and efficient
index=web sourcetype=access_combined earliest=-1h | stats count by host

# âŒ Bad: Too broad
error

# ✅ Good: Specific
index=app sourcetype=app_logs level=ERROR earliest=-24h

# âŒ Bad: Unnecessary fields
index=web | stats count by status | fields *

# ✅ Good: Only needed fields
index=web | stats count by status | fields status, count
                    </div>
                </div>

                <div class="content-section">
                    <h3>Common SPL Patterns</h3>

                    <h4>Web Analytics</h4>
                    <div class="code-block">
# Top URLs
index=web | stats count by uri | sort - count | head 10

# Errors over time
index=web status>=400 | timechart count by status

# Average response time by page
index=web | stats avg(response_time) as avg_time by uri | sort - avg_time

# Unique visitors
index=web | stats dc(clientip) as unique_visitors

# Traffic by status code
index=web | chart count by status
                    </div>

                    <h4>Security Monitoring</h4>
                    <div class="code-block">
# Failed login attempts
index=security action=failed 
| stats count by user 
| where count > 5

# Login attempts by user and source IP
index=security action=login 
| stats count by user, src_ip 
| where count > 10

# Detect brute force attacks
index=security action=failed earliest=-15m 
| stats count by src_ip 
| where count > 50

# Unusual access times (weekends)
index=web date_wday=saturday OR date_wday=sunday 
| stats count by user
                    </div>

                    <h4>Performance Monitoring</h4>
                    <div class="code-block">
# Average CPU by host
index=metrics sourcetype=vmstat 
| stats avg(cpu_pct) as avg_cpu by host 
| where avg_cpu > 80

# Slow transactions
index=app | transaction session_id 
| where duration > 10 
| table session_id, duration, eventcount

# Error rate over time
index=app | timechart span=5m 
    count(eval(status="error")) as errors,
    count as total
| eval error_rate = (errors/total)*100
                    </div>
                </div>

                <!-- Hands-on Exercise -->
                <div class="exercise">
                    <h4>🔬 Hands-on Exercise: SPL Mastery</h4>
                    <p>Practice writing SPL queries with these challenges:</p>

                    <div class="exercise-steps">
                        <ol>
                            <li><strong>Basic Search:</strong>
                                <ul>
                                    <li>Find all events with status code 404</li>
                                    <li>Count how many there are</li>
                                    <li>Which host generated the most 404 errors?</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.9rem;">
                                    Hint: <span class="command" style="background: #263238; color: #aed581;">index=web status=404 | stats count by host | sort - count</span>
                                </div>
                            </li>
                            <li><strong>Time-based Analysis:</strong>
                                <ul>
                                    <li>Show the count of events per hour for the last 24 hours</li>
                                    <li>Create a timechart</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.9rem;">
                                    Hint: <span class="command" style="background: #263238; color: #aed581;">index=web earliest=-24h | timechart span=1h count</span>
                                </div>
                            </li>
                            <li><strong>Field Creation:</strong>
                                <ul>
                                    <li>Convert bytes to kilobytes</li>
                                    <li>Calculate average KB by URI</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.9rem;">
                                    Hint: <span class="command" style="background: #263238; color: #aed581;">index=web | eval kb=bytes/1024 | stats avg(kb) by uri</span>
                                </div>
                            </li>
                            <li><strong>Filtering & Sorting:</strong>
                                <ul>
                                    <li>Find URIs with more than 1000 requests</li>
                                    <li>Sort by count descending</li>
                                    <li>Show only top 5</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.9rem;">
                                    Hint: <span class="command" style="background: #263238; color: #aed581;">index=web | stats count by uri | where count>1000 | sort - count | head 5</span>
                                </div>
                            </li>
                            <li><strong>Real-world Scenario:</strong>
                                <ul>
                                    <li>Find client IPs with failed requests (status 5xx)</li>
                                    <li>Count failures per IP</li>
                                    <li>Show only IPs with more than 10 failures</li>
                                    <li>Create a table with IP and failure count</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 3</h3>

                    <div class="question">
                        <div class="question-text">1. What character separates commands in an SPL pipeline?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Semicolon (;)</div>
                            <div class="option" data-correct="true">Pipe (|)</div>
                            <div class="option" data-correct="false">Ampersand (&)</div>
                            <div class="option" data-correct="false">Comma (,)</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which command creates aggregated statistics?</div>
                        <div class="options">
                            <div class="option" data-correct="false">table</div>
                            <div class="option" data-correct="true">stats</div>
                            <div class="option" data-correct="false">search</div>
                            <div class="option" data-correct="false">fields</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What does the eval command do?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Evaluates system performance</div>
                            <div class="option" data-correct="true">Creates or modifies fields using expressions</div>
                            <div class="option" data-correct="false">Validates search syntax</div>
                            <div class="option" data-correct="false">Evaluates user permissions</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. How do you sort results in descending order?</div>
                        <div class="options">
                            <div class="option" data-correct="false">sort desc count</div>
                            <div class="option" data-correct="true">sort - count (use minus sign)</div>
                            <div class="option" data-correct="false">sort reverse count</div>
                            <div class="option" data-correct="false">sort count down</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Which command removes duplicate events based on field values?</div>
                        <div class="options">
                            <div class="option" data-correct="false">unique</div>
                            <div class="option" data-correct="false">distinct</div>
                            <div class="option" data-correct="true">dedup</div>
                            <div class="option" data-correct="false">remove_duplicates</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">â† Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Data Inputs & Parsing â†’</button>
                </div>
            </div>

            <!-- Module 3: Data Inputs & Parsing -->
            <div class="module" data-module-id="3">
                <div class="module-header">
                    <h2>Module 4: Data Inputs & Parsing</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Understanding Data Inputs</h3>
                    <p>Splunk's power comes from its ability to ingest data from virtually any source. In this module, we'll explore how to get data into Splunk and how Splunk processes that data.</p>
                    
                    <h4>Types of Data Inputs</h4>
                    <table>
                        <tr>
                            <th>Input Type</th>
                            <th>Description</th>
                            <th>Use Cases</th>
                        </tr>
                        <tr>
                            <td><strong>Files & Directories</strong></td>
                            <td>Monitor log files and directories</td>
                            <td>Application logs, system logs, audit trails</td>
                        </tr>
                        <tr>
                            <td><strong>Network Events</strong></td>
                            <td>Receive data over TCP/UDP</td>
                            <td>Syslog, network devices, firewalls</td>
                        </tr>
                        <tr>
                            <td><strong>Scripts</strong></td>
                            <td>Execute scripts to gather data</td>
                            <td>Custom metrics, API polling, database queries</td>
                        </tr>
                        <tr>
                            <td><strong>Windows Events</strong></td>
                            <td>Collect Windows event logs</td>
                            <td>Security events, application events, system logs</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Event Collector (HEC)</strong></td>
                            <td>Send data via HTTP/HTTPS</td>
                            <td>Applications, microservices, cloud services</td>
                        </tr>
                        <tr>
                            <td><strong>Forwarders</strong></td>
                            <td>Lightweight agents that forward data</td>
                            <td>Distributed environments, remote servers</td>
                        </tr>
                    </table>

                    <div class="tip-box">
                        <strong>💡 Best Practice:</strong> Use Universal Forwarders (UF) for production environments. They're lightweight, secure, and designed specifically for data collection.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Adding Data - Step by Step</h3>
                    <p>Let's walk through adding data to Splunk through the web interface:</p>

                    <h4>Method 1: Upload Files (Quick Start)</h4>
                    <ol>
                        <li>Navigate to <strong>Settings → Add Data</strong></li>
                        <li>Click <strong>Upload</strong></li>
                        <li>Select a log file from your computer</li>
                        <li>Click <strong>Next</strong> to preview the data</li>
                        <li>Set the <strong>Source Type</strong> (Splunk often auto-detects this)</li>
                        <li>Choose or create an <strong>Index</strong></li>
                        <li>Click <strong>Submit</strong> to index the data</li>
                    </ol>

                    <div class="code-block">
# Sample log file you can create to test:
# Save as "sample_app.log"

2025-01-15 10:23:45 INFO [UserService] User login successful: user=john.doe@example.com ip=192.168.1.100
2025-01-15 10:24:12 WARN [DatabaseConnection] Connection pool reaching capacity: 85/100
2025-01-15 10:24:45 ERROR [PaymentProcessor] Payment failed: transaction_id=TXN-9876 error=insufficient_funds
2025-01-15 10:25:03 INFO [UserService] User logout: user=jane.smith@example.com session_duration=3600s
2025-01-15 10:25:30 DEBUG [APIGateway] Request processed: endpoint=/api/v1/products response_time=245ms
                    </div>

                    <h4>Method 2: Monitor Files & Directories</h4>
                    <ol>
                        <li>Go to <strong>Settings → Add Data</strong></li>
                        <li>Click <strong>Monitor</strong></li>
                        <li>Select <strong>Files & Directories</strong></li>
                        <li>Enter the file or directory path (e.g., <span class="command">/var/log/apache2/access.log</span>)</li>
                        <li>Configure source type, host, and index</li>
                        <li>Review and submit</li>
                    </ol>

                    <div class="warning-box">
                        <strong>⚠️ Important:</strong> Ensure Splunk has read permissions for the files and directories you want to monitor!
                    </div>

                    <h4>Method 3: Network Inputs (TCP/UDP)</h4>
                    <ol>
                        <li>Go to <strong>Settings → Data Inputs</strong></li>
                        <li>Click <strong>TCP</strong> or <strong>UDP</strong></li>
                        <li>Click <strong>New Local TCP/UDP</strong></li>
                        <li>Enter a port number (e.g., 9997 for TCP)</li>
                        <li>Configure source name and source type</li>
                        <li>Choose index and submit</li>
                    </ol>

                    <div class="code-block">
# Test TCP input using netcat (after setting up TCP input on port 9997):
echo "Test message from netcat" | nc localhost 9997

# Or send syslog data:
logger -n localhost -P 9997 "Test syslog message"
                    </div>
                </div>

                <div class="content-section">
                    <h3>Source Types Explained</h3>
                    <p>A <strong>source type</strong> determines how Splunk formats and handles incoming data. It defines field extractions, timestamp recognition, and event breaking.</p>

                    <h4>Common Source Types:</h4>
                    <ul>
                        <li><strong>access_combined:</strong> Apache/Nginx access logs</li>
                        <li><strong>linux_secure:</strong> Linux authentication logs</li>
                        <li><strong>WinEventLog:</strong> Windows Event Logs</li>
                        <li><strong>syslog:</strong> Standard syslog format</li>
                        <li><strong>json:</strong> JSON-formatted data</li>
                        <li><strong>csv:</strong> Comma-separated values</li>
                        <li><strong>_json:</strong> Auto-extracted JSON (KV pairs)</li>
                    </ul>

                    <h4>Creating Custom Source Types:</h4>
                    <p>When Splunk doesn't have a built-in source type for your data:</p>
                    <ol>
                        <li>Go to <strong>Settings → Source Types</strong></li>
                        <li>Click <strong>New Source Type</strong></li>
                        <li>Configure event breaking and timestamp extraction</li>
                        <li>Define field extractions (optional)</li>
                        <li>Save and test</li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Indexes and Data Organization</h3>
                    <p>An <strong>index</strong> is a repository for Splunk data. Properly organizing data into indexes is crucial for performance, retention, and access control.</p>

                    <h4>Default Indexes:</h4>
                    <ul>
                        <li><strong>main:</strong> Default index for most data</li>
                        <li><strong>_internal:</strong> Splunk's internal logs and metrics</li>
                        <li><strong>_audit:</strong> Audit trail of Splunk user actions</li>
                        <li><strong>summary:</strong> Stores summary data from report acceleration</li>
                    </ul>

                    <h4>Creating Custom Indexes:</h4>
                    <ol>
                        <li>Navigate to <strong>Settings → Indexes</strong></li>
                        <li>Click <strong>New Index</strong></li>
                        <li>Enter index name (e.g., "security", "webapps", "metrics")</li>
                        <li>Set retention period (how long to keep data)</li>
                        <li>Configure storage paths (optional)</li>
                        <li>Set max size limits</li>
                        <li>Save</li>
                    </ol>

                    <div class="tip-box">
                        <strong>💡 Best Practice:</strong> Use separate indexes for different data types:
                        <ul>
                            <li><strong>security:</strong> Security logs, firewall data, IDS/IPS</li>
                            <li><strong>application:</strong> Application logs</li>
                            <li><strong>network:</strong> Network device logs</li>
                            <li><strong>web:</strong> Web server logs</li>
                        </ul>
                        This improves search performance and allows granular access control!
                    </div>
                </div>

                <div class="content-section">
                    <h3>Data Parsing Pipeline</h3>
                    <p>Understanding how Splunk processes data is essential for troubleshooting and optimization.</p>

                    <h4>The Splunk Indexing Pipeline:</h4>
                    <div class="code-block">
┌─────────────┐     ┌──────────────┐     ┌─────────────┐     ┌──────────┐
│   Input     │ ──> │   Parsing    │ ──> │  Indexing   │ ──> │  Search  │
│             │     │              │     │             │     │          │
│ - Files     │     │ - Line break │     │ - Compress  │     │ Results  │
│ - Network   │     │ - Timestamp  │     │ - Store     │     │ Returned │
│ - Scripts   │     │ - Field ext. │     │ - Index     │     │          │
└─────────────┘     └──────────────┘     └─────────────┘     └──────────┘
                    </div>

                    <h4>Parsing Phase Components:</h4>
                    <ul>
                        <li><strong>Line Breaking:</strong> How to split data into individual events</li>
                        <li><strong>Timestamp Extraction:</strong> Identifying the event time</li>
                        <li><strong>Field Extraction:</strong> Pulling out key-value pairs</li>
                        <li><strong>Event Typing:</strong> Categorizing events</li>
                    </ul>

                    <h4>Common Parsing Issues and Solutions:</h4>
                    <table>
                        <tr>
                            <th>Issue</th>
                            <th>Symptom</th>
                            <th>Solution</th>
                        </tr>
                        <tr>
                            <td>Multiple lines as one event</td>
                            <td>Multi-line logs appear as single event</td>
                            <td>Configure <span class="command">SHOULD_LINEMERGE</span> and <span class="command">LINE_BREAKER</span></td>
                        </tr>
                        <tr>
                            <td>Wrong timestamp</td>
                            <td>Events have incorrect times</td>
                            <td>Set <span class="command">TIME_FORMAT</span> and <span class="command">TIME_PREFIX</span></td>
                        </tr>
                        <tr>
                            <td>Missing fields</td>
                            <td>Expected fields not extracted</td>
                            <td>Define field extractions in props.conf</td>
                        </tr>
                    </table>
                </div>

                <div class="content-section">
                    <h3>Universal Forwarder Setup</h3>
                    <p>The Universal Forwarder (UF) is a lightweight Splunk component designed to collect and forward data to your Splunk indexers.</p>

                    <h4>Installing Universal Forwarder:</h4>
                    
                    <div class="code-block">
# Linux Installation
wget -O splunkforwarder-9.1.0-linux-x86_64.tgz \
  'https://download.splunk.com/products/universalforwarder/releases/9.1.0/linux/splunkforwarder-9.1.0-linux-x86_64.tgz'

tar xvzf splunkforwarder-9.1.0-linux-x86_64.tgz -C /opt

# Start the forwarder
/opt/splunkforwarder/bin/splunk start --accept-license

# Configure forwarding to your Splunk indexer
/opt/splunkforwarder/bin/splunk add forward-server INDEXER_IP:9997

# Add data input (monitor a log file)
/opt/splunkforwarder/bin/splunk add monitor /var/log/myapp/ \
  -sourcetype myapp_logs -index main

# Enable boot-start
/opt/splunkforwarder/bin/splunk enable boot-start
                    </div>

                    <div class="info-box">
                        <strong>Key Forwarder Concepts:</strong>
                        <ul>
                            <li><strong>Receiving Port:</strong> Indexers typically listen on port 9997</li>
                            <li><strong>SSL:</strong> Always use SSL in production (configure with certificates)</li>
                            <li><strong>Load Balancing:</strong> Can forward to multiple indexers</li>
                            <li><strong>Deployment Server:</strong> Centrally manage forwarder configurations</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Hands-On Exercise: Adding Data</h3>
                    <div class="exercise-box">
                        <h4>Exercise Tasks:</h4>
                        <ol>
                            <li><strong>Create Sample Data:</strong>
                                <ul>
                                    <li>Create a text file with sample web server logs</li>
                                    <li>Include various HTTP status codes (200, 404, 500)</li>
                                    <li>Include different IP addresses</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px;">
                                    Sample format: <span class="command">192.168.1.10 - - [15/Jan/2025:10:30:00] "GET /index.html HTTP/1.1" 200 4523</span>
                                </div>
                            </li>
                            <li><strong>Upload to Splunk:</strong>
                                <ul>
                                    <li>Use "Add Data" → "Upload"</li>
                                    <li>Set source type to "access_combined"</li>
                                    <li>Create a new index called "web"</li>
                                </ul>
                            </li>
                            <li><strong>Verify Data:</strong>
                                <ul>
                                    <li>Search: <span class="command">index=web</span></li>
                                    <li>Check if all events are properly parsed</li>
                                    <li>Verify fields are extracted (clientip, status, method)</li>
                                </ul>
                            </li>
                            <li><strong>Set Up Monitoring:</strong>
                                <ul>
                                    <li>Configure Splunk to monitor a directory</li>
                                    <li>Add new log entries to the directory</li>
                                    <li>Verify they appear in Splunk in near-real-time</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 4</h3>

                    <div class="question">
                        <div class="question-text">1. What is the default receiving port for Universal Forwarders?</div>
                        <div class="options">
                            <div class="option" data-correct="false">8000</div>
                            <div class="option" data-correct="false">8089</div>
                            <div class="option" data-correct="true">9997</div>
                            <div class="option" data-correct="false">514</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. Which component determines how Splunk formats incoming data?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Index</div>
                            <div class="option" data-correct="true">Source Type</div>
                            <div class="option" data-correct="false">Host</div>
                            <div class="option" data-correct="false">Parser</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. What is the purpose of the Universal Forwarder?</div>
                        <div class="options">
                            <div class="option" data-correct="false">To perform searches and create dashboards</div>
                            <div class="option" data-correct="true">To collect and forward data to indexers</div>
                            <div class="option" data-correct="false">To store indexed data</div>
                            <div class="option" data-correct="false">To manage user authentication</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. Which default index stores Splunk's internal logs?</div>
                        <div class="options">
                            <div class="option" data-correct="false">main</div>
                            <div class="option" data-correct="true">_internal</div>
                            <div class="option" data-correct="false">summary</div>
                            <div class="option" data-correct="false">system</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What happens during the parsing phase?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Data is compressed and stored</div>
                            <div class="option" data-correct="true">Events are broken, timestamps extracted, fields identified</div>
                            <div class="option" data-correct="false">Searches are executed</div>
                            <div class="option" data-correct="false">Dashboards are created</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Visualizations & Dashboards →</button>
                </div>
            </div>

            <!-- Module 4: Visualizations & Dashboards -->
            <div class="module" data-module-id="4">
                <div class="module-header">
                    <h2>Module 5: Visualizations & Dashboards</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 60 minutes</span>
                        <span>📚 Topics: 7</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Introduction to Splunk Visualizations</h3>
                    <p>Visualizations transform raw data into meaningful charts and graphs that make patterns, trends, and anomalies immediately apparent. Splunk offers a rich set of visualization types to suit different analytical needs.</p>

                    <h4>Why Visualizations Matter:</h4>
                    <ul>
                        <li><strong>Quick Insights:</strong> Identify trends and patterns at a glance</li>
                        <li><strong>Better Communication:</strong> Share findings with stakeholders effectively</li>
                        <li><strong>Anomaly Detection:</strong> Spot outliers and unusual behavior visually</li>
                        <li><strong>Executive Reporting:</strong> Create high-level summaries for leadership</li>
                        <li><strong>Real-time Monitoring:</strong> Track KPIs and metrics dynamically</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Visualization Types</h3>
                    
                    <h4>1. Line Chart</h4>
                    <p><strong>Best for:</strong> Time-series data, trends over time, continuous data</p>
                    <div class="code-block">
# CPU usage over time
index=os sourcetype=cpu
| timechart avg(cpu_usage) by host

# Website traffic by hour
index=web
| timechart count span=1h
                    </div>

                    <h4>2. Bar Chart / Column Chart</h4>
                    <p><strong>Best for:</strong> Comparing categories, showing distributions</p>
                    <div class="code-block">
# Top 10 URIs by request count
index=web
| stats count by uri
| sort - count
| head 10

# Failed login attempts by user
index=security action=failed
| stats count by user
| sort - count
                    </div>

                    <h4>3. Pie Chart</h4>
                    <p><strong>Best for:</strong> Showing proportions, percentage breakdowns</p>
                    <div class="code-block">
# HTTP status code distribution
index=web
| stats count by status
| eval percent=round(count/sum(count)*100,2)

# Traffic by country
index=web
| stats count by country
                    </div>

                    <h4>4. Single Value</h4>
                    <p><strong>Best for:</strong> Key metrics, KPIs, alerts</p>
                    <div class="code-block">
# Total number of errors today
index=* error OR failed
| stats count

# Average response time
index=web
| stats avg(response_time) as avg_response
| eval avg_response=round(avg_response,2)
                    </div>

                    <h4>5. Gauge Chart</h4>
                    <p><strong>Best for:</strong> Showing progress toward goals, utilization metrics</p>
                    <div class="code-block">
# Disk utilization percentage
index=os sourcetype=disk
| stats latest(disk_used_percent) as utilization
                    </div>

                    <h4>6. Scatter Plot</h4>
                    <p><strong>Best for:</strong> Correlation analysis, outlier detection</p>
                    <div class="code-block">
# Correlation between response time and bytes
index=web
| stats avg(response_time) as rt avg(bytes) as size by uri
                    </div>

                    <h4>7. Bubble Chart</h4>
                    <p><strong>Best for:</strong> Three-dimensional comparisons</p>
                    <div class="code-block">
# Compare servers by load, errors, and response time
index=web
| stats count avg(response_time) sum(errors) by host
                    </div>

                    <h4>8. Choropleth Map</h4>
                    <p><strong>Best for:</strong> Geographic data, regional comparisons</p>
                    <div class="code-block">
# Website traffic by country
index=web
| iplocation clientip
| stats count by Country
| geom geo_countries featureIdField=Country
                    </div>
                </div>

                <div class="content-section">
                    <h3>Creating Visualizations</h3>
                    
                    <h4>Step-by-Step Process:</h4>
                    <ol>
                        <li><strong>Run Your Search:</strong> Start with a search that produces transforming output (stats, chart, timechart, etc.)</li>
                        <li><strong>Switch to Visualization Tab:</strong> Click the "Visualization" tab in the search results</li>
                        <li><strong>Select Visualization Type:</strong> Choose from the available chart types</li>
                        <li><strong>Configure Options:</strong> Customize colors, labels, axes, legends</li>
                        <li><strong>Format:</strong> Adjust display settings for optimal presentation</li>
                        <li><strong>Save:</strong> Save as dashboard panel or report</li>
                    </ol>

                    <h4>Visualization Format Options:</h4>
                    <ul>
                        <li><strong>Stack Mode:</strong> Stacked vs. unstacked (for bar/area charts)</li>
                        <li><strong>Chart Overlay:</strong> Add trend lines or reference lines</li>
                        <li><strong>Color Palettes:</strong> Change color schemes</li>
                        <li><strong>Axis Settings:</strong> Scale, range, labels</li>
                        <li><strong>Legend Position:</strong> Right, left, top, bottom, none</li>
                        <li><strong>Data Labels:</strong> Show values on chart elements</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Pro Tip:</strong> Use "Format" button to access advanced options like:
                        <ul>
                            <li>Custom axis ranges</li>
                            <li>Color by value thresholds</li>
                            <li>Chart overlays</li>
                            <li>Drilldown actions</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Building Dashboards</h3>
                    <p>Dashboards combine multiple visualizations and search results into a single, interactive view. They're perfect for monitoring, reporting, and analysis.</p>

                    <h4>Creating a Dashboard:</h4>
                    
                    <h5>Method 1: From Scratch</h5>
                    <ol>
                        <li>Navigate to <strong>Dashboards</strong> tab</li>
                        <li>Click <strong>Create New Dashboard</strong></li>
                        <li>Enter dashboard title and description</li>
                        <li>Choose dashboard type:
                            <ul>
                                <li><strong>Classic Dashboards:</strong> Simple XML-based</li>
                                <li><strong>Dashboard Studio:</strong> Modern, flexible layout</li>
                            </ul>
                        </li>
                        <li>Select permissions (Private, App, Global)</li>
                        <li>Click <strong>Create</strong></li>
                    </ol>

                    <h5>Method 2: From Search Results</h5>
                    <ol>
                        <li>Run a search with visualization</li>
                        <li>Click <strong>Save As → Dashboard Panel</strong></li>
                        <li>Choose existing dashboard or create new one</li>
                        <li>Configure panel title and description</li>
                        <li>Select panel layout</li>
                        <li>Save</li>
                    </ol>

                    <h4>Dashboard Panel Types:</h4>
                    <ul>
                        <li><strong>Visualization:</strong> Charts, graphs, maps</li>
                        <li><strong>Table:</strong> Tabular data display</li>
                        <li><strong>Single Value:</strong> Key metric display</li>
                        <li><strong>Event Listing:</strong> Raw events display</li>
                        <li><strong>HTML:</strong> Custom HTML content</li>
                        <li><strong>Input:</strong> User controls (dropdowns, text boxes, time pickers)</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Dashboard Editing and Customization</h3>
                    
                    <h4>Edit Mode Options:</h4>
                    <ul>
                        <li><strong>Add Panel:</strong> Create new visualizations</li>
                        <li><strong>Edit Panel:</strong> Modify existing panels</li>
                        <li><strong>Clone Panel:</strong> Duplicate panels</li>
                        <li><strong>Delete Panel:</strong> Remove panels</li>
                        <li><strong>Resize:</strong> Drag corners to resize panels</li>
                        <li><strong>Rearrange:</strong> Drag and drop to reorder</li>
                    </ul>

                    <h4>Adding Input Controls:</h4>
                    <p>Input controls make dashboards interactive, allowing users to filter and customize data.</p>

                    <div class="code-block">
# Time Range Picker
Add Input → Time

# Dropdown Menu (e.g., select host)
Add Input → Dropdown
Token: host_token
Search: index=main | stats count by host | fields host

# In panel search, use the token:
index=main host=$host_token$
| stats count by sourcetype

# Text Input
Add Input → Text
Token: search_term
Default: error

# Radio Buttons
Add Input → Radio
Token: status_filter
Choices: 200, 404, 500, *
                    </div>

                    <h4>Dashboard Examples:</h4>
                    
                    <div class="example-box">
                        <strong>Example 1: Web Server Monitoring Dashboard</strong>
                        <p><strong>Panels:</strong></p>
                        <ul>
                            <li>Single Value: Total requests today</li>
                            <li>Line Chart: Requests per hour</li>
                            <li>Pie Chart: HTTP status code distribution</li>
                            <li>Bar Chart: Top 10 URIs by traffic</li>
                            <li>Table: Top client IPs</li>
                            <li>Choropleth Map: Traffic by country</li>
                        </ul>
                    </div>

                    <div class="example-box">
                        <strong>Example 2: Security Operations Dashboard</strong>
                        <p><strong>Panels:</strong></p>
                        <ul>
                            <li>Single Value: Failed login attempts (24h)</li>
                            <li>Gauge: Authentication success rate</li>
                            <li>Line Chart: Security events over time</li>
                            <li>Bar Chart: Top attacked services</li>
                            <li>Table: Recent security alerts</li>
                            <li>Map: Attack sources by geography</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Advanced Dashboard Features</h3>
                    
                    <h4>Drilldown Actions:</h4>
                    <p>Drilldowns allow users to click on chart elements to get more details.</p>
                    <ul>
                        <li><strong>Link to Search:</strong> Open detailed search</li>
                        <li><strong>Link to Dashboard:</strong> Navigate to another dashboard</li>
                        <li><strong>Link to URL:</strong> Open external resource</li>
                        <li><strong>Set Token:</strong> Update dashboard inputs</li>
                    </ul>

                    <h4>Scheduled Dashboard Delivery:</h4>
                    <ol>
                        <li>Open dashboard</li>
                        <li>Click <strong>Edit → Schedule PDF Delivery</strong></li>
                        <li>Set schedule (hourly, daily, weekly, monthly)</li>
                        <li>Configure recipients</li>
                        <li>Choose paper size and orientation</li>
                        <li>Save</li>
                    </ol>

                    <h4>Dashboard Permissions:</h4>
                    <ul>
                        <li><strong>Private:</strong> Only you can see it</li>
                        <li><strong>App:</strong> Visible to users with app permissions</li>
                        <li><strong>Global:</strong> Visible across all apps</li>
                    </ul>

                    <div class="info-box">
                        <strong>Dashboard Studio vs Classic Dashboards:</strong>
                        <table>
                            <tr>
                                <th>Feature</th>
                                <th>Classic</th>
                                <th>Dashboard Studio</th>
                            </tr>
                            <tr>
                                <td>Layout Control</td>
                                <td>Grid-based</td>
                                <td>Absolute positioning</td>
                            </tr>
                            <tr>
                                <td>Customization</td>
                                <td>Limited</td>
                                <td>Extensive</td>
                            </tr>
                            <tr>
                                <td>Learning Curve</td>
                                <td>Easier</td>
                                <td>Steeper</td>
                            </tr>
                            <tr>
                                <td>XML Editing</td>
                                <td>Required for advanced</td>
                                <td>Optional</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Best Practices for Dashboards</h3>
                    
                    <h4>Design Principles:</h4>
                    <ul>
                        <li><strong>Purposeful Layout:</strong> Most important metrics at the top</li>
                        <li><strong>Consistent Colors:</strong> Use color meaningfully (red=danger, green=good)</li>
                        <li><strong>Clear Labels:</strong> Make all panels and axes clearly labeled</li>
                        <li><strong>Appropriate Visualizations:</strong> Match chart type to data type</li>
                        <li><strong>Limit Clutter:</strong> 6-8 panels maximum per dashboard</li>
                        <li><strong>Fast Load Times:</strong> Optimize searches for performance</li>
                    </ul>

                    <h4>Performance Tips:</h4>
                    <ul>
                        <li>Use <span class="command">tstats</span> instead of <span class="command">stats</span> when possible</li>
                        <li>Limit time ranges to what's necessary</li>
                        <li>Use summary indexes for frequently accessed data</li>
                        <li>Enable report acceleration for base searches</li>
                        <li>Avoid wildcards at the beginning of searches</li>
                    </ul>

                    <div class="warning-box">
                        <strong>⚠️ Common Mistakes:</strong>
                        <ul>
                            <li>Too many panels causing slow load times</li>
                            <li>Using pie charts with too many slices</li>
                            <li>Inconsistent time ranges across panels</li>
                            <li>Poor color choices (red/green for colorblind users)</li>
                            <li>Missing context (no units, unclear labels)</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Hands-On Exercise: Building a Dashboard</h3>
                    <div class="exercise-box">
                        <h4>Create a Web Analytics Dashboard:</h4>
                        <ol>
                            <li><strong>Panel 1 - Total Requests (Single Value):</strong>
                                <div class="code-block">
index=web | stats count
                                </div>
                            </li>
                            <li><strong>Panel 2 - Requests Over Time (Line Chart):</strong>
                                <div class="code-block">
index=web | timechart count span=1h
                                </div>
                            </li>
                            <li><strong>Panel 3 - Status Codes (Pie Chart):</strong>
                                <div class="code-block">
index=web | stats count by status
                                </div>
                            </li>
                            <li><strong>Panel 4 - Top URIs (Bar Chart):</strong>
                                <div class="code-block">
index=web 
| stats count by uri 
| sort - count 
| head 10
                                </div>
                            </li>
                            <li><strong>Panel 5 - Top Client IPs (Table):</strong>
                                <div class="code-block">
index=web 
| stats count sum(bytes) as total_bytes by clientip 
| sort - count 
| head 20
| eval total_bytes=round(total_bytes/1024/1024,2)." MB"
                                </div>
                            </li>
                            <li><strong>Add Time Range Input:</strong>
                                <ul>
                                    <li>Add a time range picker</li>
                                    <li>Configure all panels to use the time token</li>
                                </ul>
                            </li>
                            <li><strong>Add Drilldown:</strong>
                                <ul>
                                    <li>Configure the "Top URIs" panel to drill down to detailed events</li>
                                    <li>Clicking a bar should show all events for that URI</li>
                                </ul>
                            </li>
                            <li><strong>Customize Appearance:</strong>
                                <ul>
                                    <li>Add a dashboard title and description</li>
                                    <li>Arrange panels in a logical layout</li>
                                    <li>Set appropriate colors and labels</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 5</h3>

                    <div class="question">
                        <div class="question-text">1. Which visualization is best for showing trends over time?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Pie Chart</div>
                            <div class="option" data-correct="true">Line Chart</div>
                            <div class="option" data-correct="false">Gauge</div>
                            <div class="option" data-correct="false">Single Value</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What makes dashboards interactive?</div>
                        <div class="options">
                            <div class="option" data-correct="false">More visualizations</div>
                            <div class="option" data-correct="false">Colorful charts</div>
                            <div class="option" data-correct="true">Input controls and drilldowns</div>
                            <div class="option" data-correct="false">Larger panels</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. Which command is recommended for dashboard performance?</div>
                        <div class="options">
                            <div class="option" data-correct="false">search</div>
                            <div class="option" data-correct="true">tstats</div>
                            <div class="option" data-correct="false">eval</div>
                            <div class="option" data-correct="false">table</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. How many panels is optimal for a dashboard?</div>
                        <div class="options">
                            <div class="option" data-correct="false">1-2</div>
                            <div class="option" data-correct="true">6-8</div>
                            <div class="option" data-correct="false">15-20</div>
                            <div class="option" data-correct="false">As many as possible</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What allows clicking on chart elements for more details?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Tokens</div>
                            <div class="option" data-correct="true">Drilldowns</div>
                            <div class="option" data-correct="false">Filters</div>
                            <div class="option" data-correct="false">Inputs</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Alerting & Monitoring →</button>
                </div>
            </div>

            <!-- Module 5: Alerting & Monitoring -->
            <div class="module" data-module-id="5">
                <div class="module-header">
                    <h2>Module 6: Alerting & Monitoring</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Introduction to Splunk Alerts</h3>
                    <p>Alerts automate monitoring by running searches on a schedule and triggering actions when specific conditions are met. They're essential for proactive incident response and operational awareness.</p>

                    <h4>Why Use Alerts?</h4>
                    <ul>
                        <li><strong>Proactive Monitoring:</strong> Detect issues before they impact users</li>
                        <li><strong>24/7 Vigilance:</strong> Continuous monitoring without manual effort</li>
                        <li><strong>Rapid Response:</strong> Immediate notification of critical events</li>
                        <li><strong>Compliance:</strong> Track and alert on policy violations</li>
                        <li><strong>Automation:</strong> Trigger actions automatically</li>
                    </ul>

                    <h4>Common Use Cases:</h4>
                    <ul>
                        <li>Server CPU/memory exceeding thresholds</li>
                        <li>Failed login attempts indicating attacks</li>
                        <li>Application errors or exceptions</li>
                        <li>Service availability issues</li>
                        <li>Security threats or policy violations</li>
                        <li>Business KPI thresholds</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Creating Alerts</h3>
                    
                    <h4>Step-by-Step Alert Creation:</h4>
                    <ol>
                        <li><strong>Build Your Search:</strong>
                            <div class="code-block">
# Example: High CPU usage alert
index=os sourcetype=cpu
| stats avg(cpu_usage) as avg_cpu by host
| where avg_cpu > 80
                            </div>
                        </li>
                        <li><strong>Save as Alert:</strong>
                            <ul>
                                <li>Click <strong>Save As → Alert</strong></li>
                                <li>Enter alert title and description</li>
                            </ul>
                        </li>
                        <li><strong>Configure Alert Type:</strong>
                            <ul>
                                <li><strong>Scheduled:</strong> Runs at specific intervals</li>
                                <li><strong>Real-time:</strong> Continuously monitors incoming data</li>
                            </ul>
                        </li>
                        <li><strong>Set Schedule:</strong>
                            <ul>
                                <li>Cron schedule or simple intervals</li>
                                <li>Time range to search</li>
                            </ul>
                        </li>
                        <li><strong>Define Trigger Conditions:</strong>
                            <ul>
                                <li>Number of results</li>
                                <li>Number of hosts</li>
                                <li>Number of sources</li>
                                <li>Custom condition</li>
                            </ul>
                        </li>
                        <li><strong>Configure Actions:</strong>
                            <ul>
                                <li>Send email</li>
                                <li>Log event</li>
                                <li>Webhook</li>
                                <li>Run script</li>
                                <li>Add to triggered alerts</li>
                            </ul>
                        </li>
                        <li><strong>Set Throttling:</strong>
                            <ul>
                                <li>Suppress alerts for a period</li>
                                <li>Prevent alert fatigue</li>
                            </ul>
                        </li>
                        <li><strong>Save Alert</strong></li>
                    </ol>

                    <div class="info-box">
                        <strong>Scheduled vs Real-Time Alerts:</strong>
                        <table>
                            <tr>
                                <th>Aspect</th>
                                <th>Scheduled</th>
                                <th>Real-Time</th>
                            </tr>
                            <tr>
                                <td>Trigger</td>
                                <td>At specific intervals</td>
                                <td>As data arrives</td>
                            </tr>
                            <tr>
                                <td>Performance</td>
                                <td>Lower resource usage</td>
                                <td>Higher resource usage</td>
                            </tr>
                            <tr>
                                <td>Latency</td>
                                <td>Based on schedule</td>
                                <td>Near-instant</td>
                            </tr>
                            <tr>
                                <td>Best For</td>
                                <td>Most use cases</td>
                                <td>Critical, time-sensitive events</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Alert Trigger Conditions</h3>
                    
                    <h4>Available Trigger Conditions:</h4>
                    
                    <div class="example-box">
                        <strong>1. Number of Results</strong>
                        <p>Trigger when search returns X or more results</p>
                        <div class="code-block">
# Alert when more than 10 errors occur
index=app error
| stats count
# Trigger: greater than 10
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>2. Number of Hosts</strong>
                        <p>Trigger based on unique hosts affected</p>
                        <div class="code-block">
# Alert when errors occur on 3+ servers
index=app error
| stats count by host
# Trigger: greater than 2 hosts
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>3. Number of Sources</strong>
                        <p>Trigger based on unique data sources</p>
                        <div class="code-block">
# Alert when multiple log files show issues
index=app critical
| stats count by source
# Trigger: greater than 5 sources
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>4. Custom Condition</strong>
                        <p>Advanced field-based triggers</p>
                        <div class="code-block">
# Alert when average response time exceeds threshold
index=web
| stats avg(response_time) as avg_rt
| where avg_rt > 1000
# Trigger: custom - search "avg_rt > 1000"
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>5. Per-Result Alerts</strong>
                        <p>Trigger action for each result (use cautiously!)</p>
                        <div class="code-block">
# Alert for each critical security event
index=security severity=critical
# Set: Trigger alert for each result
# Use throttling to prevent flooding!
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Alert Actions</h3>
                    
                    <h4>1. Email Notifications</h4>
                    <div class="code-block">
# Configure Email Settings:
# Settings → Server settings → Email settings
# 
# In Alert:
# - Add Action: Send email
# - To: ops-team@company.com
# - Subject: [ALERT] $name$
# - Message: Include results table and link
# - Priority: High (for critical alerts)
# - Include: Results (inline or CSV attachment)
                    </div>

                    <h4>2. Webhook</h4>
                    <p>Send alert data to external systems (Slack, PagerDuty, ServiceNow, etc.)</p>
                    <div class="code-block">
# Example: Slack Webhook
# Add Action: Webhook
# URL: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# 
# JSON Payload:
{
  "text": "Alert: $name$",
  "channel": "#alerts",
  "username": "Splunk",
  "icon_emoji": ":warning:",
  "attachments": [
    {
      "color": "danger",
      "fields": [
        {
          "title": "Count",
          "value": "$result.count$",
          "short": true
        }
      ]
    }
  ]
}
                    </div>

                    <h4>3. Run a Script</h4>
                    <div class="code-block">
# Script Location: $SPLUNK_HOME/bin/scripts/
# 
# Example Script (restart_service.sh):
#!/bin/bash
# Receives alert info via stdin
# Restart failed service

SERVICE=$1
echo "Restarting $SERVICE due to alert"
systemctl restart $SERVICE

# In Alert:
# Add Action: Run a script
# Filename: restart_service.sh
# Pass results to script as: CSV or JSON
                    </div>

                    <h4>4. Add to Triggered Alerts</h4>
                    <p>Maintain a searchable history of all triggered alerts for review and analysis.</p>

                    <h4>5. Log Event</h4>
                    <p>Write alert details to Splunk's _audit index for tracking.</p>

                    <div class="tip-box">
                        <strong>💡 Pro Tip:</strong> Use multiple actions for critical alerts:
                        <ul>
                            <li>Email for immediate notification</li>
                            <li>Add to triggered alerts for tracking</li>
                            <li>Webhook to incident management system</li>
                            <li>Script to attempt auto-remediation</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Alert Throttling and Suppression</h3>
                    <p>Throttling prevents alert fatigue by limiting how often alerts fire.</p>

                    <h4>Throttle Options:</h4>
                    <ul>
                        <li><strong>Suppress triggering for:</strong> Time period (minutes, hours, days)</li>
                        <li><strong>Suppress based on fields:</strong> Only suppress if specific field values repeat</li>
                    </ul>

                    <div class="example-box">
                        <strong>Example: Throttle by Host</strong>
                        <div class="code-block">
# Alert: High CPU on servers
index=os sourcetype=cpu cpu_usage>90

# Throttle Settings:
# - Suppress for: 30 minutes
# - Based on fields: host
# 
# Result: Each host can trigger once per 30 minutes
# Prevents flooding if one server has sustained high CPU
                        </div>
                    </div>

                    <h4>When to Use Throttling:</h4>
                    <ul>
                        <li><strong>Flapping conditions:</strong> Metrics oscillating around threshold</li>
                        <li><strong>Known issues:</strong> Temporary problems being investigated</li>
                        <li><strong>High-frequency events:</strong> Many events matching in short time</li>
                        <li><strong>Per-entity alerts:</strong> Alert once per host/user/service</li>
                    </ul>

                    <div class="warning-box">
                        <strong>⚠️ Throttling Caution:</strong> Don't over-throttle critical alerts! Balance alert fatigue with missing important notifications.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Alert Best Practices</h3>
                    
                    <h4>Design Principles:</h4>
                    <ul>
                        <li><strong>Clear Names:</strong> Use descriptive alert names
                            <ul>
                                <li>Good: "Production DB - High Query Time (>2s)"</li>
                                <li>Bad: "Database Alert 1"</li>
                            </ul>
                        </li>
                        <li><strong>Actionable Alerts:</strong> Each alert should suggest clear action</li>
                        <li><strong>Appropriate Thresholds:</strong> Tune to avoid false positives</li>
                        <li><strong>Context in Notifications:</strong> Include relevant details in email/webhook</li>
                        <li><strong>Document Alerts:</strong> Describe purpose, threshold reasoning, response procedures</li>
                    </ul>

                    <h4>Performance Optimization:</h4>
                    <ul>
                        <li>Use efficient searches (limit time ranges, use indexed fields)</li>
                        <li>Leverage summary indexes for complex calculations</li>
                        <li>Use <span class="command">tstats</span> when possible</li>
                        <li>Avoid wildcard searches at the beginning</li>
                        <li>Test alert searches during off-peak hours first</li>
                    </ul>

                    <h4>Alert Maintenance:</h4>
                    <ul>
                        <li>Regularly review triggered alerts for false positives</li>
                        <li>Adjust thresholds based on changing baselines</li>
                        <li>Disable alerts that are no longer relevant</li>
                        <li>Document changes and reasons</li>
                        <li>Review alert performance impact</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Common Alert Patterns</h3>
                    
                    <div class="example-box">
                        <strong>Pattern 1: Threshold Breach</strong>
                        <div class="code-block">
# CPU exceeds 90% for 5 minutes
index=os sourcetype=cpu
| stats avg(cpu_usage) as avg_cpu by host
| where avg_cpu > 90

Schedule: Every 5 minutes
Trigger: Number of results > 0
Action: Email ops team
Throttle: 30 minutes per host
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Pattern 2: Absence Detection</strong>
                        <div class="code-block">
# No heartbeat received from server
index=heartbeat
| stats latest(_time) as last_seen by host
| eval age=now()-last_seen
| where age > 300
| eval last_seen=strftime(last_seen, "%Y-%m-%d %H:%M:%S")

Schedule: Every 5 minutes
Trigger: Number of results > 0
Action: Page on-call engineer
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Pattern 3: Anomaly Detection</strong>
                        <div class="code-block">
# Traffic spike detection (>3 standard deviations)
index=web
| timechart span=5m count
| eventstats avg(count) as avg stdev(count) as stdev
| eval threshold=avg+(3*stdev)
| where count > threshold

Schedule: Every 10 minutes
Trigger: Number of results > 0
Action: Alert security team
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Pattern 4: Rate-Based</strong>
                        <div class="code-block">
# Brute force detection (10+ failed logins in 5 min)
index=security action=failed
| stats count by user
| where count > 10

Schedule: Every 5 minutes  
Time range: Last 5 minutes
Trigger: Number of results > 0
Action: Email + Add to incident tracker
Throttle: 1 hour per user
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Pattern 5: Correlation Alert</strong>
                        <div class="code-block">
# High errors + high response time
index=web
| stats count(eval(status>=500)) as errors avg(response_time) as avg_rt
| where errors > 100 AND avg_rt > 2000

Schedule: Every 15 minutes
Trigger: Number of results > 0
Action: Create incident ticket via webhook
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Managing Triggered Alerts</h3>
                    <p>View and manage alerts that have fired:</p>

                    <h4>Accessing Triggered Alerts:</h4>
                    <ol>
                        <li>Navigate to <strong>Activity → Triggered Alerts</strong></li>
                        <li>Or search: <span class="command">index=_audit action=alert_fired</span></li>
                    </ol>

                    <h4>Triggered Alerts Interface:</h4>
                    <ul>
                        <li><strong>View Details:</strong> See alert results and context</li>
                        <li><strong>Edit Alert:</strong> Adjust configuration</li>
                        <li><strong>Disable Alert:</strong> Temporarily stop triggering</li>
                        <li><strong>Delete Alert:</strong> Permanently remove</li>
                    </ul>

                    <h4>Analyzing Alert Effectiveness:</h4>
                    <div class="code-block">
# Alert firing frequency
index=_audit action=alert_fired
| stats count by savedsearch_name
| sort - count

# Alert response times
index=_audit action=alert_fired
| stats avg(eval(now()-_time)) as avg_response_sec by savedsearch_name

# False positive rate (requires manual tagging)
index=_audit action=alert_fired
| eval is_false_positive=if(match(tags, "false_positive"), 1, 0)
| stats sum(is_false_positive) as false_pos count as total by savedsearch_name
| eval false_positive_rate=round(false_pos/total*100, 2)."%"
                    </div>
                </div>

                <div class="content-section">
                    <h3>Hands-On Exercise: Creating Alerts</h3>
                    <div class="exercise-box">
                        <h4>Exercise Tasks:</h4>
                        <ol>
                            <li><strong>Create Threshold Alert:</strong>
                                <ul>
                                    <li>Alert when web errors (status 5xx) exceed 50 in 15 minutes</li>
                                    <li>Send email notification</li>
                                    <li>Throttle for 30 minutes</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px;">
                                    <span class="command">index=web status>=500 | stats count | where count > 50</span>
                                </div>
                            </li>
                            <li><strong>Create Failed Login Alert:</strong>
                                <ul>
                                    <li>Alert when a single user has 5+ failed logins in 5 minutes</li>
                                    <li>Include username in notification</li>
                                    <li>Throttle per user for 1 hour</li>
                                </ul>
                            </li>
                            <li><strong>Create Absence Alert:</strong>
                                <ul>
                                    <li>Alert when no data received from a monitored system for 10 minutes</li>
                                    <li>Send webhook to Slack or similar</li>
                                </ul>
                            </li>
                            <li><strong>Test Your Alerts:</strong>
                                <ul>
                                    <li>Generate test data that should trigger alerts</li>
                                    <li>Verify alerts fire correctly</li>
                                    <li>Check notification delivery</li>
                                    <li>Validate throttling works</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 6</h3>

                    <div class="question">
                        <div class="question-text">1. What is the main difference between scheduled and real-time alerts?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Scheduled alerts are more accurate</div>
                            <div class="option" data-correct="true">Real-time alerts trigger as data arrives, scheduled alerts run at intervals</div>
                            <div class="option" data-correct="false">Scheduled alerts can't send emails</div>
                            <div class="option" data-correct="false">Real-time alerts are always better</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What is throttling in the context of alerts?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Making alerts run faster</div>
                            <div class="option" data-correct="true">Suppressing repeated alerts for a time period</div>
                            <div class="option" data-correct="false">Increasing alert sensitivity</div>
                            <div class="option" data-correct="false">Deleting old alerts</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. Which alert action sends data to external systems?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Email</div>
                            <div class="option" data-correct="false">Log event</div>
                            <div class="option" data-correct="true">Webhook</div>
                            <div class="option" data-correct="false">Script only</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. Where can you view all triggered alerts?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Settings → Alerts</div>
                            <div class="option" data-correct="true">Activity → Triggered Alerts</div>
                            <div class="option" data-correct="false">Dashboards</div>
                            <div class="option" data-correct="false">Reports</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. What's a best practice for alert names?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Keep them short and generic</div>
                            <div class="option" data-correct="true">Make them descriptive and actionable</div>
                            <div class="option" data-correct="false">Use numbers only</div>
                            <div class="option" data-correct="false">Include special characters</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Advanced Features →</button>
                </div>
            </div>

            <!-- Module 6: Advanced Features -->
            <div class="module" data-module-id="6">
                <div class="module-header">
                    <h2>Module 7: Advanced Features</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: 6</span>
                        <span>✅ Knowledge Check: Yes</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Advanced SPL Commands</h3>
                    <p>Now that you're comfortable with basic SPL, let's explore advanced commands that unlock Splunk's full analytical power.</p>

                    <h4>1. Transaction Command</h4>
                    <p>Groups events that share common characteristics into transactions.</p>
                    <div class="code-block">
# Group web requests by session ID
index=web
| transaction session_id maxspan=30m maxevents=100
| stats avg(duration) as avg_session_duration

# Track user journey across multiple systems
index=* user=john.doe
| transaction user maxspan=1h startswith="login" endswith="logout"
| table _time duration eventcount

# Options:
# - maxspan: Max time between events
# - maxpause: Max gap between events
# - maxevents: Max events per transaction
# - startswith/endswith: Transaction boundaries
                    </div>

                    <h4>2. Subsearch</h4>
                    <p>Perform searches within searches for complex queries.</p>
                    <div class="code-block">
# Find errors from IPs that had failed logins
index=web status=500
[search index=security action=failed | stats count by clientip | fields clientip]

# Find hosts with high CPU that also have errors
index=app error
[search index=os cpu_usage>90 | stats count by host | fields host]

# Subsearch limitations:
# - Returns max 10,000 results
# - Can be slow - use carefully
# - Consider using join instead for large datasets
                    </div>

                    <h4>3. Join Command</h4>
                    <p>Combine results from two searches based on common fields.</p>
                    <div class="code-block">
# Join web logs with user database
index=web
| stats count avg(response_time) as avg_rt by user
| join user
    [search index=users | table user department location]
| table user count avg_rt department location

# Types of joins:
# - inner (default): Only matching records
# - left: All from left + matching from right
# - outer: All records from both
                    </div>

                    <h4>4. Append Command</h4>
                    <p>Combine results from multiple searches into one result set.</p>
                    <div class="code-block">
# Combine current and historical data
index=web earliest=-1h
| stats count as current_hour
| append
    [search index=web earliest=-25h latest=-24h
     | stats count as previous_day_same_hour]
| eval change_percent=round((current_hour-previous_day_same_hour)/previous_day_same_hour*100,2)
                    </div>

                    <h4>5. Lookup Command</h4>
                    <p>Enrich events with external data from CSV files or KV stores.</p>
                    <div class="code-block">
# Add user info from CSV lookup
index=app
| lookup user_info.csv username OUTPUT full_name department email
| stats count by department

# Geographic lookup
index=web
| lookup geo_ip.csv clientip OUTPUT country city latitude longitude
| stats count by country

# To create lookup:
# Settings → Lookups → Lookup table files → New
                    </div>
                </div>

                <div class="content-section">
                    <h3>Data Models and Pivot</h3>
                    <p>Data models provide structured views of your data, making it accessible to non-technical users through the Pivot interface.</p>

                    <h4>What are Data Models?</h4>
                    <ul>
                        <li>Hierarchical structures that organize data into objects and fields</li>
                        <li>Enable acceleration for faster searches</li>
                        <li>Power the Pivot interface for drag-and-drop analysis</li>
                        <li>Common for Splunk Enterprise Security and ITSI apps</li>
                    </ul>

                    <h4>Using Pivot:</h4>
                    <ol>
                        <li>Navigate to <strong>Pivot</strong> from the Search bar</li>
                        <li>Select a data model (e.g., "Web Intelligence")</li>
                        <li>Choose an object (e.g., "Web Request")</li>
                        <li>Add filters, split rows/columns, aggregations</li>
                        <li>Select visualization</li>
                        <li>Save as dashboard panel or report</li>
                    </ol>

                    <div class="code-block">
# Equivalent SPL from Pivot
# Pivot creates this behind the scenes:
| pivot Web_Intelligence Web_Request count(Web_Request) AS "Count" 
    SPLITROW status AS "Status" 
    SPLITROW uri AS "URI" 
    FILTER status >= 400
                    </div>

                    <div class="tip-box">
                        <strong>💡 When to Use Pivot:</strong>
                        <ul>
                            <li>Enabling self-service analytics for non-SPL users</li>
                            <li>Standardizing analysis across teams</li>
                            <li>Leveraging accelerated data models for performance</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Machine Learning with MLTK</h3>
                    <p>The Machine Learning Toolkit (MLTK) brings ML capabilities to Splunk for anomaly detection, forecasting, and clustering.</p>

                    <h4>Key ML Commands:</h4>
                    
                    <div class="example-box">
                        <strong>1. Predict (Forecasting)</strong>
                        <div class="code-block">
# Forecast web traffic for next 24 hours
index=web
| timechart span=1h count
| predict count future_timespan=24

# The predict command adds predicted values to your time series
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>2. Anomaly Detection</strong>
                        <div class="code-block">
# Detect anomalous CPU usage patterns
index=os sourcetype=cpu
| timechart span=5m avg(cpu_usage) as cpu
| anomalydetection cpu

# Flags data points that deviate from normal patterns
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>3. Clustering</strong>
                        <div class="code-block">
# Cluster users by behavior
index=web
| stats count dc(uri) as unique_pages avg(duration) as avg_duration by user
| fit KMeans count unique_pages avg_duration k=5
# Groups users into 5 clusters based on behavior
                        </div>
                    </div>

                    <h4>ML Workflow:</h4>
                    <ol>
                        <li><strong>Prepare Data:</strong> Clean and normalize</li>
                        <li><strong>Choose Algorithm:</strong> Based on use case
                            <ul>
                                <li>Time series → ARIMA, StateSpaceForecast</li>
                                <li>Classification → LogisticRegression, RandomForest</li>
                                <li>Clustering → KMeans, DBSCAN</li>
                                <li>Anomaly → DensityFunction, OneClassSVM</li>
                            </ul>
                        </li>
                        <li><strong>Train Model:</strong> Use <span class="command">fit</span> command</li>
                        <li><strong>Apply Model:</strong> Use <span class="command">apply</span> command</li>
                        <li><strong>Evaluate:</strong> Assess accuracy and tune</li>
                    </ol>

                    <div class="info-box">
                        <strong>Installing MLTK:</strong>
                        <ol>
                            <li>Go to <strong>Apps → Find More Apps</strong></li>
                            <li>Search for "Machine Learning Toolkit"</li>
                            <li>Click <strong>Install</strong></li>
                            <li>Restart Splunk</li>
                            <li>Access via <strong>Apps → Machine Learning Toolkit</strong></li>
                        </ol>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Summary Indexing</h3>
                    <p>Summary indexing pre-calculates and stores report results, dramatically improving dashboard performance.</p>

                    <h4>How It Works:</h4>
                    <ol>
                        <li>Create a scheduled report with summary data</li>
                        <li>Enable "Summary Indexing" in report settings</li>
                        <li>Results are stored in a summary index</li>
                        <li>Dashboards query the summary index (fast!)</li>
                    </ol>

                    <div class="code-block">
# Original query (slow - searches all raw data)
index=web
| stats count avg(response_time) by uri status
| where count > 100

# Create scheduled report:
# - Schedule: Every hour
# - Summary indexing: Enabled
# - Summary index: summary_web

# Dashboard query (fast - uses pre-calculated data)
index=summary_web
| stats sum(count) as total_count avg(avg_response_time) as avg_rt by uri
                    </div>

                    <h4>When to Use Summary Indexing:</h4>
                    <ul>
                        <li>Dashboards with slow-loading panels</li>
                        <li>Reports run frequently with same time range</li>
                        <li>Historical trend analysis over long time periods</li>
                        <li>Aggregations that don't need real-time accuracy</li>
                    </ul>

                    <div class="warning-box">
                        <strong>⚠️ Trade-offs:</strong>
                        <ul>
                            <li><strong>Pro:</strong> Dramatically faster queries</li>
                            <li><strong>Con:</strong> Uses additional storage</li>
                            <li><strong>Con:</strong> Slight delay in data availability</li>
                            <li><strong>Con:</strong> Less flexible - can't easily change aggregations</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Splunk Apps and Add-ons</h3>
                    <p>Extend Splunk's capabilities with pre-built solutions for specific use cases.</p>

                    <h4>Popular Splunk Apps:</h4>
                    <table>
                        <tr>
                            <th>App</th>
                            <th>Purpose</th>
                            <th>Key Features</th>
                        </tr>
                        <tr>
                            <td><strong>Splunk Enterprise Security (ES)</strong></td>
                            <td>Security Operations (SIEM)</td>
                            <td>Threat detection, incident response, compliance</td>
                        </tr>
                        <tr>
                            <td><strong>IT Service Intelligence (ITSI)</strong></td>
                            <td>IT Operations (AIOps)</td>
                            <td>Service monitoring, KPI tracking, event analytics</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk App for AWS</strong></td>
                            <td>AWS Monitoring</td>
                            <td>CloudTrail, VPC Flow, billing analysis</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk App for Unix/Linux</strong></td>
                            <td>System Monitoring</td>
                            <td>Performance metrics, log analysis, topology</td>
                        </tr>
                        <tr>
                            <td><strong>Splunk DB Connect</strong></td>
                            <td>Database Integration</td>
                            <td>Query databases, index DB data, SQL reporting</td>
                        </tr>
                    </table>

                    <h4>Installing Apps:</h4>
                    <ol>
                        <li>Navigate to <strong>Apps → Find More Apps</strong></li>
                        <li>Browse or search for apps</li>
                        <li>Click <strong>Install</strong></li>
                        <li>Enter Splunk.com credentials</li>
                        <li>Restart if required</li>
                        <li>Configure app settings</li>
                    </ol>

                    <h4>Add-ons vs Apps:</h4>
                    <ul>
                        <li><strong>Apps:</strong> Full solutions with UI, dashboards, reports</li>
                        <li><strong>Add-ons:</strong> Technical components (inputs, parsers, field extractions)</li>
                        <li>Example: "Splunk Add-on for Microsoft Windows" provides Windows data collection</li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Best Practice:</strong> Install Add-ons on forwarders/indexers for data collection, and Apps on search heads for UI/dashboards.
                    </div>
                </div>

                <div class="content-section">
                    <h3>Splunk Architecture and Scalability</h3>
                    <p>Understanding Splunk's architecture is crucial for production deployments.</p>

                    <h4>Splunk Components:</h4>
                    <ul>
                        <li><strong>Search Heads:</strong> User interface and search processing</li>
                        <li><strong>Indexers:</strong> Store and index data, perform searches</li>
                        <li><strong>Forwarders:</strong> Collect and forward data</li>
                        <li><strong>Deployment Server:</strong> Centrally manage forwarder configs</li>
                        <li><strong>License Master:</strong> Manage licensing</li>
                        <li><strong>Cluster Master:</strong> Coordinate indexer clusters</li>
                    </ul>

                    <h4>Deployment Architectures:</h4>
                    
                    <div class="example-box">
                        <strong>1. Single Instance (Development/Testing)</strong>
                        <div class="code-block">
┌─────────────────────────┐
│   Single Splunk Server  │
│                         │
│  - Search Head          │
│  - Indexer              │
│  - Forwarder            │
│  - All features         │
└─────────────────────────┘
        </div>
                    </div>

                    <div class="example-box">
                        <strong>2. Distributed (Small Production)</strong>
                        <div class="code-block">
┌──────────────┐     ┌──────────────┐
│ Search Head  │────→│   Indexer    │
│              │     │              │
└──────────────┘     └──────────────┘
                            ↑
                     ┌──────┴──────┐
                     │             │
            ┌────────┴─┐   ┌──────┴──────┐
            │Forwarder1│   │ Forwarder2  │
            └──────────┘   └─────────────┘
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>3. Clustered (Enterprise)</strong>
                        <div class="code-block">
    ┌─────────┐  ┌─────────┐  ┌─────────┐
    │  SH 1   │  │  SH 2   │  │  SH 3   │
    └────┬────┘  └────┬────┘  └────┬────┘
         └───────────┬───────────┘
                     │
         ┌───────────┴───────────┐
         │                       │
    ┌────┴────┐  ┌─────────┐  ┌┴─────────┐
    │ IDX 1   │  │ IDX 2   │  │  IDX 3   │
    │(Primary)│  │(Replica)│  │(Replica) │
    └─────────┘  └─────────┘  └──────────┘
         ↑            ↑            ↑
         └────────────┴────────────┘
              Many Forwarders
                        </div>
                    </div>

                    <h4>Clustering Benefits:</h4>
                    <ul>
                        <li><strong>High Availability:</strong> No single point of failure</li>
                        <li><strong>Data Replication:</strong> Protect against data loss</li>
                        <li><strong>Load Balancing:</strong> Distribute search load</li>
                        <li><strong>Scalability:</strong> Add capacity by adding nodes</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Performance Tuning Tips</h3>
                    
                    <h4>Search Optimization:</h4>
                    <ul>
                        <li><strong>Be Specific:</strong> Use index and sourcetype in searches</li>
                        <li><strong>Time Matters:</strong> Limit time ranges to what's needed</li>
                        <li><strong>Fields:</strong> Use <span class="command">fields</span> command early to remove unnecessary fields</li>
                        <li><strong>Stats Before Sort:</strong> Aggregate before sorting large datasets</li>
                        <li><strong>Wildcards:</strong> Avoid wildcards at the beginning of searches</li>
                    </ul>

                    <div class="code-block">
# Bad: Slow search
*error* | table _time host message | sort -_time

# Good: Optimized search
index=app sourcetype=application error
| fields _time host message
| sort -_time
| head 1000
                    </div>

                    <h4>Indexing Optimization:</h4>
                    <ul>
                        <li>Use separate indexes for different data retention periods</li>
                        <li>Configure appropriate bucket sizes</li>
                        <li>Enable data model acceleration for frequently used models</li>
                        <li>Use summary indexing for heavy dashboard queries</li>
                        <li>Monitor index size and set appropriate retention</li>
                    </ul>

                    <h4>System Resources:</h4>
                    <ul>
                        <li><strong>CPU:</strong> More cores = faster searches (aim for 12+ cores)</li>
                        <li><strong>RAM:</strong> 12GB minimum, 48GB+ for indexers</li>
                        <li><strong>Disk:</strong> Fast SSD/NVMe for hot buckets, HDD for warm/cold</li>
                        <li><strong>Network:</strong> 1Gbps minimum, 10Gbps for large deployments</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Hands-On Exercise: Advanced SPL</h3>
                    <div class="exercise-box">
                        <h4>Challenge Tasks:</h4>
                        <ol>
                            <li><strong>Transaction Analysis:</strong>
                                <ul>
                                    <li>Group web requests into user sessions</li>
                                    <li>Calculate average session duration</li>
                                    <li>Identify sessions with errors</li>
                                </ul>
                                <div style="background: white; color: #333; padding: 10px; border-radius: 5px; margin-top: 10px;">
                                    Hint: Use transaction with session_id, maxspan=30m
                                </div>
                            </li>
                            <li><strong>Join Exercise:</strong>
                                <ul>
                                    <li>Join web traffic with user department info</li>
                                    <li>Calculate traffic by department</li>
                                </ul>
                            </li>
                            <li><strong>Anomaly Detection:</strong>
                                <ul>
                                    <li>Use predict or anomalydetection on time-series data</li>
                                    <li>Identify unusual patterns</li>
                                </ul>
                            </li>
                            <li><strong>Create a Lookup:</strong>
                                <ul>
                                    <li>Create a CSV with username, department, location</li>
                                    <li>Upload as lookup table</li>
                                    <li>Use in searches to enrich user data</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Knowledge Check -->
                <div class="knowledge-check">
                    <h3>✅ Knowledge Check - Module 7</h3>

                    <div class="question">
                        <div class="question-text">1. What does the transaction command do?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Creates financial transactions</div>
                            <div class="option" data-correct="true">Groups related events into transactions</div>
                            <div class="option" data-correct="false">Speeds up searches</div>
                            <div class="option" data-correct="false">Validates data integrity</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">2. What is the purpose of summary indexing?</div>
                        <div class="options">
                            <div class="option" data-correct="false">To summarize raw events for readability</div>
                            <div class="option" data-correct="true">To pre-calculate and store report results for faster dashboards</div>
                            <div class="option" data-correct="false">To compress old data</div>
                            <div class="option" data-correct="false">To create executive summaries</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">3. Which component in Splunk architecture stores and indexes data?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Search Head</div>
                            <div class="option" data-correct="false">Forwarder</div>
                            <div class="option" data-correct="true">Indexer</div>
                            <div class="option" data-correct="false">Deployment Server</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">4. What's the main benefit of using lookups?</div>
                        <div class="options">
                            <div class="option" data-correct="false">Faster searches</div>
                            <div class="option" data-correct="true">Enrich events with external data</div>
                            <div class="option" data-correct="false">Store more data</div>
                            <div class="option" data-correct="false">Create visualizations</div>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question">
                        <div class="question-text">5. Which is best for real-time anomaly detection?</div>
                        <div class="options">
                            <div class="option" data-correct="false">stats</div>
                            <div class="option" data-correct="false">chart</div>
                            <div class="option" data-correct="true">anomalydetection or predict commands</div>
                            <div class="option" data-correct="false">table</div>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="nextModule()">Next Module: Capstone Project →</button>
                </div>
            </div>

            <!-- Module 7: Capstone Project -->
            <div class="module" data-module-id="7">
                <div class="module-header">
                    <h2>Module 8: Capstone Project</h2>
                    <div class="module-meta">
                        <span>⏱️ Duration: 45 minutes</span>
                        <span>📚 Topics: Comprehensive Exercise</span>
                        <span>✅ Final Assessment</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>🎯 Capstone Project: Security Operations Center (SOC) Dashboard</h3>
                    <p>Congratulations on making it to the final module! It's time to put everything you've learned together in a comprehensive, real-world project.</p>

                    <div class="info-box">
                        <strong>Project Overview:</strong>
                        <p>You'll build a complete Security Operations Center (SOC) monitoring solution that includes data ingestion, analysis, visualizations, alerts, and a comprehensive dashboard.</p>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Project Scenario</h3>
                    <p><strong>Company:</strong> TechCorp Inc.<br>
                    <strong>Your Role:</strong> Security Analyst / Splunk Administrator<br>
                    <strong>Objective:</strong> Implement a comprehensive security monitoring solution</p>

                    <h4>Business Requirements:</h4>
                    <ul>
                        <li>Monitor authentication events across all systems</li>
                        <li>Track and alert on failed login attempts</li>
                        <li>Analyze web application security</li>
                        <li>Provide real-time visibility into security posture</li>
                        <li>Generate reports for compliance audits</li>
                        <li>Detect and alert on potential security incidents</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Phase 1: Data Collection and Preparation</h3>
                    
                    <h4>Step 1: Create Sample Security Data</h4>
                    <p>Create the following log files to simulate a production environment:</p>

                    <div class="code-block">
# File 1: auth.log (Linux authentication logs)
# Save as: auth.log

Jan 15 08:15:23 web-server-01 sshd[12456]: Accepted password for admin from 192.168.1.100 port 45672 ssh2
Jan 15 08:16:45 web-server-01 sshd[12478]: Failed password for root from 203.0.113.45 port 42198 ssh2
Jan 15 08:17:02 web-server-01 sshd[12489]: Failed password for root from 203.0.113.45 port 42201 ssh2
Jan 15 08:17:18 web-server-01 sshd[12501]: Failed password for root from 203.0.113.45 port 42205 ssh2
Jan 15 08:18:34 db-server-01 sshd[15234]: Accepted password for dbadmin from 192.168.1.105 port 54321 ssh2
Jan 15 08:19:56 web-server-02 sshd[18765]: Failed password for admin from 198.51.100.23 port 33445 ssh2
Jan 15 08:20:12 web-server-02 sshd[18776]: Failed password for admin from 198.51.100.23 port 33448 ssh2
Jan 15 08:21:45 app-server-01 sshd[20123]: Accepted password for appuser from 192.168.1.110 port 61234 ssh2
Jan 15 08:22:30 web-server-01 sshd[12567]: Failed password for invalid user hacker from 198.51.100.67 port 55123 ssh2
Jan 15 08:23:15 web-server-01 sudo: admin : TTY=pts/0 ; PWD=/home/admin ; USER=root ; COMMAND=/bin/systemctl restart nginx
                    </div>

                    <div class="code-block">
# File 2: web_access.log (Web application logs)
# Save as: web_access.log

192.168.1.100 - - [15/Jan/2025:08:15:30 +0000] "GET /login HTTP/1.1" 200 1234 "-" "Mozilla/5.0"
192.168.1.105 - john.doe [15/Jan/2025:08:16:45 +0000] "POST /api/users HTTP/1.1" 201 567 "-" "curl/7.68.0"
203.0.113.45 - - [15/Jan/2025:08:17:12 +0000] "POST /admin/login HTTP/1.1" 401 234 "-" "python-requests/2.25.1"
203.0.113.45 - - [15/Jan/2025:08:17:15 +0000] "POST /admin/login HTTP/1.1" 401 234 "-" "python-requests/2.25.1"
203.0.113.45 - - [15/Jan/2025:08:17:18 +0000] "POST /admin/login HTTP/1.1" 401 234 "-" "python-requests/2.25.1"
192.168.1.110 - jane.smith [15/Jan/2025:08:18:34 +0000] "GET /dashboard HTTP/1.1" 200 5678 "-" "Mozilla/5.0"
198.51.100.23 - - [15/Jan/2025:08:19:45 +0000] "GET /../../../etc/passwd HTTP/1.1" 404 178 "-" "curl/7.29.0"
198.51.100.23 - - [15/Jan/2025:08:19:50 +0000] "GET /admin.php HTTP/1.1" 404 178 "-" "Nikto/2.1.6"
192.168.1.100 - admin [15/Jan/2025:08:20:15 +0000] "DELETE /api/users/42 HTTP/1.1" 204 0 "-" "Mozilla/5.0"
192.168.1.105 - john.doe [15/Jan/2025:08:21:30 +0000] "GET /reports/sales HTTP/1.1" 200 8901 "-" "Mozilla/5.0"
198.51.100.67 - - [15/Jan/2025:08:22:45 +0000] "POST /login HTTP/1.1" 500 1234 "-" "sqlmap/1.5.2"
198.51.100.67 - - [15/Jan/2025:08:23:00 +0000] "GET /admin' OR '1'='1 HTTP/1.1" 500 890 "-" "sqlmap/1.5.2"
                    </div>

                    <h4>Step 2: Ingest Data into Splunk</h4>
                    <ol>
                        <li>Create a new index called <strong>"security"</strong></li>
                        <li>Upload <span class="command">auth.log</span> with sourcetype <span class="command">linux_secure</span></li>
                        <li>Upload <span class="command">web_access.log</span> with sourcetype <span class="command">access_combined</span></li>
                        <li>Verify data appears in Splunk:
                            <div class="code-block">
index=security | stats count by sourcetype
                            </div>
                        </li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Phase 2: Analysis and Searches</h3>
                    
                    <h4>Task 1: Authentication Analysis</h4>
                    <div class="exercise-box">
                        <strong>Create these searches:</strong>
                        <ol>
                            <li><strong>Failed SSH Login Attempts:</strong>
                                <div class="code-block">
index=security sourcetype=linux_secure "Failed password"
| rex field=_raw "from (?&lt;src_ip>\d+\.\d+\.\d+\.\d+)"
| rex field=_raw "for (invalid user )?(?&lt;username>\w+)"
| stats count by src_ip username
| sort - count
                                </div>
                            </li>
                            <li><strong>Successful Logins by Server:</strong>
                                <div class="code-block">
index=security sourcetype=linux_secure "Accepted password"
| rex field=_raw "for (?&lt;user>\w+) from (?&lt;ip>[0-9.]+)"
| stats count by host user
| sort - count
                                </div>
                            </li>
                            <li><strong>Brute Force Detection (5+ failures in 5 minutes):</strong>
                                <div class="code-block">
index=security sourcetype=linux_secure "Failed password"
| bucket _time span=5m
| rex field=_raw "from (?&lt;src_ip>\d+\.\d+\.\d+\.\d+)"
| stats count by _time src_ip
| where count >= 5
| sort - count
                                </div>
                            </li>
                        </ol>
                    </div>

                    <h4>Task 2: Web Security Analysis</h4>
                    <div class="exercise-box">
                        <strong>Create these searches:</strong>
                        <ol>
                            <li><strong>Failed HTTP Requests (4xx, 5xx):</strong>
                                <div class="code-block">
index=security sourcetype=access_combined status>=400
| stats count by status clientip uri
| sort - count
                                </div>
                            </li>
                            <li><strong>Potential SQL Injection Attempts:</strong>
                                <div class="code-block">
index=security sourcetype=access_combined
(uri="*'*" OR uri="*OR*1=1*" OR uri="*UNION*SELECT*")
| table _time clientip uri status
| sort - _time
                                </div>
                            </li>
                            <li><strong>Suspicious User Agents:</strong>
                                <div class="code-block">
index=security sourcetype=access_combined
(useragent="*sqlmap*" OR useragent="*nikto*" OR useragent="*nmap*")
| stats count values(uri) as URIs by clientip useragent
| sort - count
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Phase 3: Build the SOC Dashboard</h3>
                    
                    <h4>Dashboard Requirements:</h4>
                    <p>Create a dashboard named <strong>"Security Operations Center - Real-time Monitoring"</strong> with the following panels:</p>

                    <div class="example-box">
                        <strong>Panel 1: Key Metrics (Single Values)</strong>
                        <ul>
                            <li>Total Security Events (24h)</li>
                            <li>Failed Login Attempts</li>
                            <li>Unique Attacker IPs</li>
                            <li>Critical Alerts</li>
                        </ul>
                        <div class="code-block">
# Total Events
index=security | stats count

# Failed Logins
index=security "Failed password" | stats count

# Unique Attackers
index=security "Failed password" 
| rex field=_raw "from (?&lt;ip>[0-9.]+)" 
| stats dc(ip)

# Critical Events
index=security (status>=500 OR "Failed password")
| stats count
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Panel 2: Security Events Timeline (Line Chart)</strong>
                        <div class="code-block">
index=security
| timechart span=15m count by sourcetype
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Panel 3: Top Attack Sources (Bar Chart)</strong>
                        <div class="code-block">
index=security ("Failed password" OR status>=400)
| rex field=_raw "from (?&lt;src_ip>[0-9.]+)"
| rex field=clientip "(?&lt;web_ip>[0-9.]+)"
| eval attack_ip=coalesce(src_ip, web_ip)
| stats count by attack_ip
| sort - count
| head 10
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Panel 4: Attack Types Distribution (Pie Chart)</strong>
                        <div class="code-block">
index=security
| eval attack_type=case(
    match(_raw, "Failed password"), "Failed SSH Login",
    match(_raw, "sql|SQL|UNION|SELECT"), "SQL Injection",
    match(_raw, "\.\./"), "Path Traversal",
    status>=500, "Server Error",
    status>=400 AND status<500, "Client Error",
    1=1, "Other"
)
| stats count by attack_type
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Panel 5: Recent Security Events (Table)</strong>
                        <div class="code-block">
index=security ("Failed" OR status>=400)
| rex field=_raw "from (?&lt;src_ip>[0-9.]+)"
| rex field=_raw "for (invalid user )?(?&lt;user>\w+)"
| eval event_type=case(
    match(_raw, "Failed"), "Auth Failure",
    status>=500, "Server Error",
    status>=400, "Client Error"
)
| table _time event_type host src_ip user uri status
| sort - _time
| head 20
                        </div>
                    </div>

                    <div class="example-box">
                        <strong>Panel 6: Geographic Attack Map (Choropleth)</strong>
                        <div class="code-block">
index=security ("Failed password" OR status>=400)
| rex field=_raw "from (?&lt;attack_ip>[0-9.]+)"
| rex field=clientip "(?&lt;web_ip>[0-9.]+)"
| eval ip=coalesce(attack_ip, web_ip)
| iplocation ip
| stats count by Country
| geom geo_countries featureIdField=Country
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Phase 4: Create Security Alerts</h3>
                    
                    <div class="exercise-box">
                        <strong>Alert 1: Brute Force Detection</strong>
                        <ul>
                            <li><strong>Search:</strong>
                                <div class="code-block">
index=security "Failed password"
| bucket _time span=5m
| rex field=_raw "from (?&lt;src_ip>\d+\.\d+\.\d+\.\d+)"
| stats count by _time src_ip
| where count >= 5
                                </div>
                            </li>
                            <li><strong>Schedule:</strong> Every 5 minutes</li>
                            <li><strong>Trigger:</strong> Number of results > 0</li>
                            <li><strong>Action:</strong> Send email to security team</li>
                            <li><strong>Throttle:</strong> 30 minutes per src_ip</li>
                        </ul>
                    </div>

                    <div class="exercise-box">
                        <strong>Alert 2: SQL Injection Attempt</strong>
                        <ul>
                            <li><strong>Search:</strong>
                                <div class="code-block">
index=security sourcetype=access_combined
(uri="*'*" OR uri="*OR*1=1*" OR uri="*UNION*SELECT*" OR uri="*DROP*TABLE*")
| stats count by clientip uri
                                </div>
                            </li>
                            <li><strong>Schedule:</strong> Real-time</li>
                            <li><strong>Trigger:</strong> Per result</li>
                            <li><strong>Action:</strong> Send email + webhook</li>
                            <li><strong>Throttle:</strong> 1 hour per clientip</li>
                        </ul>
                    </div>

                    <div class="exercise-box">
                        <strong>Alert 3: Multiple Failed Logins from Single User</strong>
                        <ul>
                            <li><strong>Search:</strong>
                                <div class="code-block">
index=security "Failed password"
| rex field=_raw "for (?&lt;username>\w+)"
| stats count by username
| where count > 3
                                </div>
                            </li>
                            <li><strong>Schedule:</strong> Every 10 minutes</li>
                            <li><strong>Trigger:</strong> Number of results > 0</li>
                            <li><strong>Action:</strong> Add to triggered alerts + email</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Phase 5: Documentation and Presentation</h3>
                    
                    <h4>Create a Report Document Including:</h4>
                    <ol>
                        <li><strong>Executive Summary</strong>
                            <ul>
                                <li>Overview of security monitoring implementation</li>
                                <li>Key findings from initial data analysis</li>
                                <li>Recommendations for improvement</li>
                            </ul>
                        </li>
                        <li><strong>Technical Implementation</strong>
                            <ul>
                                <li>Data sources configured</li>
                                <li>Indexes created</li>
                                <li>Searches developed</li>
                                <li>Dashboard panels</li>
                                <li>Alerts configured</li>
                            </ul>
                        </li>
                        <li><strong>Security Findings</strong>
                            <ul>
                                <li>Number of attack attempts identified</li>
                                <li>Top attack sources</li>
                                <li>Most common attack types</li>
                                <li>Potential vulnerabilities discovered</li>
                            </ul>
                        </li>
                        <li><strong>Screenshots</strong>
                            <ul>
                                <li>Dashboard view</li>
                                <li>Key search results</li>
                                <li>Alert configurations</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Bonus Challenges</h3>
                    
                    <div class="exercise-box">
                        <h4>Take it Further:</h4>
                        <ol>
                            <li><strong>Advanced Correlation:</strong>
                                <ul>
                                    <li>Correlate failed SSH attempts with failed web logins</li>
                                    <li>Identify IPs attacking multiple services</li>
                                </ul>
                            </li>
                            <li><strong>Threat Intelligence:</strong>
                                <ul>
                                    <li>Create a lookup table of known malicious IPs</li>
                                    <li>Enrich alerts with threat intel data</li>
                                </ul>
                            </li>
                            <li><strong>User Behavior Analytics:</strong>
                                <ul>
                                    <li>Baseline normal user activity</li>
                                    <li>Alert on anomalous behavior</li>
                                </ul>
                            </li>
                            <li><strong>Automated Response:</strong>
                                <ul>
                                    <li>Create a script that blocks attacking IPs</li>
                                    <li>Trigger the script from an alert</li>
                                </ul>
                            </li>
                            <li><strong>Compliance Reporting:</strong>
                                <ul>
                                    <li>Create scheduled reports for audit requirements</li>
                                    <li>Export to PDF and email weekly</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="content-section">
                    <h3>🎓 Course Completion</h3>
                    
                    <div class="success-box" style="background: linear-gradient(135deg, #4caf50, #8bc34a); color: white; padding: 30px; border-radius: 10px; text-align: center; margin: 30px 0;">
                        <h2 style="color: white; margin-bottom: 15px;">🎉 Congratulations!</h2>
                        <p style="font-size: 1.1rem; margin-bottom: 20px;">You've completed the Splunk Mastery Training Course!</p>
                        
                        <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 5px; margin: 20px 0;">
                            <strong>Skills Acquired:</strong>
                            <ul style="list-style: none; padding: 0; margin: 15px 0;">
                                <li>✅ Splunk Installation and Configuration</li>
                                <li>✅ Search Processing Language (SPL)</li>
                                <li>✅ Data Ingestion and Parsing</li>
                                <li>✅ Visualizations and Dashboards</li>
                                <li>✅ Alerting and Monitoring</li>
                                <li>✅ Advanced Features and Architecture</li>
                                <li>✅ Real-world Security Operations</li>
                            </ul>
                        </div>
                    </div>

                    <h4>Next Steps in Your Splunk Journey:</h4>
                    <ul>
                        <li><strong>Splunk Certifications:</strong>
                            <ul>
                                <li>Splunk Core Certified User</li>
                                <li>Splunk Core Certified Power User</li>
                                <li>Splunk Enterprise Certified Admin</li>
                                <li>Splunk Enterprise Security Certified Admin</li>
                            </ul>
                        </li>
                        <li><strong>Continue Learning:</strong>
                            <ul>
                                <li>Explore Splunk Apps (ES, ITSI, UBA)</li>
                                <li>Learn Splunk architecture for large deployments</li>
                                <li>Practice with real datasets</li>
                                <li>Join Splunk community forums</li>
                            </ul>
                        </li>
                        <li><strong>Resources:</strong>
                            <ul>
                                <li><a href="https://www.splunk.com/en_us/training.html" target="_blank">Splunk Education</a></li>
                                <li><a href="https://docs.splunk.com/" target="_blank">Splunk Documentation</a></li>
                                <li><a href="https://community.splunk.com/" target="_blank">Splunk Community</a></li>
                                <li><a href="https://www.splunk.com/en_us/blog" target="_blank">Splunk Blog</a></li>
                            </ul>
                        </li>
                    </ul>

                    <div class="tip-box">
                        <strong>💡 Final Tips:</strong>
                        <ul>
                            <li>Practice regularly - build your own dashboards and alerts</li>
                            <li>Explore public datasets and use cases</li>
                            <li>Stay updated with Splunk's latest features</li>
                            <li>Network with other Splunk professionals</li>
                            <li>Consider contributing to the Splunk community</li>
                        </ul>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousModule()">← Previous Module</button>
                    <button class="btn btn-primary" onclick="location.reload()">🎓 Course Complete - Start Over</button>
                </div>
            </div>
            
        </main>
    </div>

    <script>
        // Module navigation
        let currentModule = 0;
        const totalModules = 8;

        function showModule(moduleIndex) {
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });

            const selectedModule = document.querySelector(`[data-module-id="${moduleIndex}"]`);
            if (selectedModule) {
                selectedModule.classList.add('active');
                currentModule = moduleIndex;
                
                document.querySelectorAll('.nav-item').forEach((item, index) => {
                    item.classList.remove('active');
                    if (index === moduleIndex) {
                        item.classList.add('active');
                    }
                });

                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        function nextModule() {
            if (currentModule < totalModules - 1) {
                showModule(currentModule + 1);
            }
        }

        function previousModule() {
            if (currentModule > 0) {
                showModule(currentModule - 1);
            }
        }

        function updateProgress() {
            const progress = ((currentModule + 1) / totalModules) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '% Complete';
        }

        // Navigation click handlers
        document.querySelectorAll('.nav-item').forEach((item, index) => {
            item.addEventListener('click', () => {
                showModule(index);
            });
        });

        // OS tabs functionality
        document.querySelectorAll('.os-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const os = this.getAttribute('data-os');
                
                document.querySelectorAll('.os-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.os-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.getAttribute('data-os-content') === os) {
                        content.classList.add('active');
                    }
                });
            });
        });

        // Knowledge check functionality
        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', function() {
                const question = this.closest('.question');
                if (question.querySelector('.option.correct') || question.querySelector('.option.incorrect')) {
                    return;
                }

                const isCorrect = this.getAttribute('data-correct') === 'true';
                const feedback = question.querySelector('.feedback');
                
                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.textContent = '✔ Correct! Well done.';
                    feedback.classList.add('correct', 'show');
                } else {
                    this.classList.add('incorrect');
                    feedback.textContent = '✗ Incorrect. Review the module content and try again.';
                    feedback.classList.add('incorrect', 'show');
                    
                    setTimeout(() => {
                        question.querySelectorAll('.option').forEach(opt => {
                            if (opt.getAttribute('data-correct') === 'true') {
                                opt.style.border = '2px solid #4caf50';
                            }
                        });
                    }, 1000);
                }
            });
        });

        // Interactive Splunk Interface Component Information
        const componentInfo = {
            'navbar': {
                title: '🎯 Navigation Bar',
                content: `
                    <p>The <strong>Navigation Bar</strong> appears at the top of every Splunk page and provides access to key features.</p>
                    
                    <h4>Components:</h4>
                    <ul>
                        <li><strong>Splunk Logo:</strong> Click to return to home page</li>
                        <li><strong>Apps Menu:</strong> Switch between installed Splunk apps</li>
                        <li><strong>Settings:</strong> Configure Splunk (data inputs, users, distributed search, etc.)</li>
                        <li><strong>Activity:</strong> View system activity, jobs, and searches</li>
                        <li><strong>Help:</strong> Access documentation, tours, and support</li>
                        <li><strong>User Menu:</strong> Account settings, preferences, and logout</li>
                    </ul>

                    <h4>Common Navigation Patterns:</h4>
                    <ul>
                        <li>Apps menu lets you quickly switch contexts (Security, IT Service Intelligence, etc.)</li>
                        <li>Settings is where administrators configure data inputs, users, and system settings</li>
                        <li>Activity shows running and completed searches/jobs</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> Bookmark specific Splunk apps for quick access instead of always starting from the home page!</p>
                `
            },
            'tabs': {
                title: '📑‘ Tab Bar',
                content: `
                    <p>The <strong>Tab Bar</strong> provides quick access to different views within the Search & Reporting app.</p>
                    
                    <h4>Main Tabs:</h4>
                    <ul>
                        <li><strong>Search:</strong> Main search interface for ad-hoc queries</li>
                        <li><strong>Dashboards:</strong> View and manage saved dashboards</li>
                        <li><strong>Reports:</strong> Access saved searches and reports</li>
                        <li><strong>Alerts:</strong> Configure and manage alerts and scheduled searches</li>
                        <li><strong>Data Summary:</strong> Browse available data sources, hosts, and sourcetypes</li>
                    </ul>

                    <h4>Typical Workflow:</h4>
                    <ol>
                        <li>Start with <strong>Search</strong> to explore data</li>
                        <li>Save useful queries as <strong>Reports</strong></li>
                        <li>Add report visualizations to <strong>Dashboards</strong></li>
                        <li>Configure <strong>Alerts</strong> for automated monitoring</li>
                        <li>Use <strong>Data Summary</strong> to discover available data</li>
                    </ol>

                    <p><strong>💡 Pro Tip:</strong> The Data Summary tab is great for discovering what data is available in your Splunk instance!</p>
                `
            },
            'search-bar': {
                title: '🔍 Search Bar',
                content: `
                    <p>The <strong>Search Bar</strong> is where you enter your SPL (Search Processing Language) queries.</p>
                    
                    <h4>Features:</h4>
                    <ul>
                        <li><strong>Search Input:</strong> Type your SPL query here</li>
                        <li><strong>Search Button:</strong> Execute your search (or press Enter)</li>
                        <li><strong>Time Range Picker:</strong> Select the time period to search</li>
                        <li><strong>Search Modes:</strong> Choose between Fast, Smart, or Verbose mode</li>
                    </ul>

                    <h4>Search Modes Explained:</h4>
                    <ul>
                        <li><strong>Fast Mode:</strong> Returns only the essential fields for speed</li>
                        <li><strong>Smart Mode (Default):</strong> Balances performance and field extraction</li>
                        <li><strong>Verbose Mode:</strong> Extracts and returns all available fields (slowest)</li>
                    </ul>

                    <h4>Auto-complete & Syntax Help:</h4>
                    <ul>
                        <li>Start typing to see command suggestions</li>
                        <li>Use Tab to auto-complete commands</li>
                        <li>Syntax errors are highlighted in red</li>
                        <li>Valid syntax turns green</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> Press Ctrl+\\ (or Cmd+\\ on Mac) to open the search assistant for help with SPL syntax!</p>
                `
            },
            'results': {
                title: '📑Š Results Panel',
                content: `
                    <p>The <strong>Results Panel</strong> displays your search results in various formats.</p>
                    
                    <h4>View Modes:</h4>
                    <ul>
                        <li><strong>Events:</strong> Shows raw event data with timestamps (default for non-transforming searches)</li>
                        <li><strong>Patterns:</strong> Automatically identifies patterns in your data</li>
                        <li><strong>Statistics:</strong> Tabular view of aggregated data (appears when using stats, chart, etc.)</li>
                        <li><strong>Visualization:</strong> Charts and graphs (available after using transforming commands)</li>
                    </ul>

                    <h4>Event Details:</h4>
                    <ul>
                        <li>Click on an event to expand it and see all fields</li>
                        <li>Click on field values to add them to your search</li>
                        <li>Use the arrow to show/hide event details</li>
                    </ul>

                    <h4>Timeline:</h4>
                    <ul>
                        <li>Visual bar chart showing event distribution over time</li>
                        <li>Click and drag to zoom into specific time ranges</li>
                        <li>Hover to see exact counts</li>
                    </ul>

                    <h4>Export Options:</h4>
                    <ul>
                        <li>Export results to CSV, XML, or JSON</li>
                        <li>Print or share results</li>
                        <li>Save as report or dashboard panel</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> Use the timeline to quickly identify when anomalies occurred!</p>
                `
            },
            'sidebar': {
                title: '🎛️ Fields Sidebar',
                content: `
                    <p>The <strong>Fields Sidebar</strong> shows all fields extracted from your search results.</p>
                    
                    <h4>Field Categories:</h4>
                    <ul>
                        <li><strong>Selected Fields:</strong> Fields currently displayed in the events (default: host, source, sourcetype)</li>
                        <li><strong>Interesting Fields:</strong> Fields present in at least 20% of events</li>
                        <li><strong>All Fields:</strong> Every field found in the results</li>
                    </ul>

                    <h4>Field Actions (Click on field name):</h4>
                    <ul>
                        <li><strong>Top Values:</strong> See most common values with percentages</li>
                        <li><strong>Add to Selected:</strong> Include field in event display</li>
                        <li><strong>Reports:</strong> Quick pivot and reporting options</li>
                        <li><strong>Click value:</strong> Adds field=value to your search</li>
                    </ul>

                    <h4>Field Information:</h4>
                    <ul>
                        <li>Each field shows the count of events containing it</li>
                        <li>Percentage indicates prevalence in results</li>
                        <li>Field types are automatically detected (string, number, boolean)</li>
                    </ul>

                    <h4>Quick Analysis:</h4>
                    <ul>
                        <li>Click field name â†’ "Top values" for instant distribution</li>
                        <li>Click specific value to filter results instantly</li>
                        <li>Use "Reports" option for quick visualization</li>
                    </ul>

                    <p><strong>💡 Pro Tip:</strong> The Fields sidebar is your fastest way to explore and understand your data without writing SPL!</p>
                `
            }
        };

        // Handle clicks on clickable areas
        document.querySelectorAll('.clickable-area').forEach(area => {
            area.addEventListener('click', function(e) {
                const component = this.getAttribute('data-component');
                if (component && componentInfo[component]) {
                    showComponentInfo(component);
                    e.stopPropagation();
                }
            });
        });

        function showComponentInfo(component) {
            const modal = document.getElementById('componentModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            
            const info = componentInfo[component];
            title.textContent = info.title;
            body.innerHTML = info.content;
            
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Close modal
        document.querySelector('.component-modal-close').addEventListener('click', function() {
            document.getElementById('componentModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        window.addEventListener('click', function(event) {
            const modal = document.getElementById('componentModal');
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('componentModal');
                if (modal.style.display === 'block') {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            }
        });

        // Initialize
        updateProgress();
        console.log('Splunk Training Course loaded successfully!');
    </script>
</body>
</html>