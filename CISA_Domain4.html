<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISA Domain 4 Learning Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 50%, #45B7D1 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
            max-width: 900px;
            width: 90%;
            position: relative;
            overflow: hidden;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #FF6B6B, #45B7D1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 15px;
            background: linear-gradient(135deg, #FF6B6B 0%, #45B7D1 100%);
            border-radius: 15px;
            color: white;
            font-weight: bold;
        }

        .game-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .mode-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border-color: #45B7D1;
        }

        .mode-card.active {
            background: linear-gradient(135deg, #45B7D1 0%, #4ECDC4 100%);
            color: white;
            border-color: #45B7D1;
        }

        .mode-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .mode-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .mode-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .topic-selector {
            margin: 20px 0;
        }

        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .topic-btn {
            padding: 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
        }

        .topic-btn:hover, .topic-btn.active {
            border-color: #45B7D1;
            background: #45B7D1;
            color: white;
        }

        .content-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            display: none;
            max-height: 600px;
            overflow-y: auto;
        }

        .content-container::-webkit-scrollbar {
            width: 8px;
        }

        .content-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .content-container::-webkit-scrollbar-thumb {
            background: #45B7D1;
            border-radius: 4px;
        }

        .content-container::-webkit-scrollbar-thumb:hover {
            background: #3498db;
        }

        .content-container.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }

        .option:hover {
            border-color: #45B7D1;
            background: #e8f7ff;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #45B7D1;
            background: #45B7D1;
            color: white;
        }

        .option.correct {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }

        .option.incorrect {
            border-color: #dc3545;
            background: #dc3545;
            color: white;
        }

        .option:disabled {
            cursor: not-allowed;
        }

        .explanation {
            margin-top: 20px;
            padding: 20px;
            background: #e8f7ff;
            border-left: 4px solid #45B7D1;
            border-radius: 8px;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }

        .explanation.show {
            display: block;
            opacity: 1;
        }

        .flashcard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            min-height: 300px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .flashcard:hover {
            transform: rotateY(5deg);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }

        .flashcard.flipped {
            background: linear-gradient(135deg, #FF6B6B 0%, #45B7D1 100%);
            color: white;
        }

        .card-content {
            font-size: 1.3rem;
            line-height: 1.6;
        }

        .card-hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .card-controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }

        .card-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .card-btn.correct {
            background: #28a745;
            color: white;
        }

        .card-btn.incorrect {
            background: #dc3545;
            color: white;
        }

        .card-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .learning-content h3 {
            color: #45B7D1;
            margin-bottom: 15px;
            font-size: 1.4rem;
            border-bottom: 2px solid #4ECDC4;
            padding-bottom: 8px;
        }

        .learning-content p {
            line-height: 1.6;
            margin-bottom: 15px;
            text-align: justify;
            font-size: 1rem;
        }

        .learning-example {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f0f8ff 0%, #e8f7ff 100%);
            border-radius: 12px;
            border-left: 5px solid #45B7D1;
            box-shadow: 0 3px 10px rgba(69, 183, 209, 0.1);
        }

        .learning-example strong {
            color: #FF6B6B;
            font-size: 1.1rem;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 15px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #45B7D1 0%, #FF6B6B 100%);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: #45B7D1;
            border: 2px solid #45B7D1;
        }

        .btn-outline:hover {
            background: #45B7D1;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
        }

        .results-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .results-actions .btn {
            padding: 15px 20px;
            font-size: 0.9rem;
            border-radius: 12px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #45B7D1, #4ECDC4);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .results-container {
            text-align: center;
            padding: 30px;
            display: none;
        }

        .results-container.show {
            display: block;
            animation: bounceIn 0.6s ease-out;
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .results-score {
            font-size: 3rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .answer-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
        }

        .answer-status.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .answer-status.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .game-container {
                padding: 20px;
                width: 95%;
            }
            
            .score-board {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }

            .game-modes {
                grid-template-columns: 1fr;
            }

            .results-actions {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .results-actions .btn {
                padding: 12px 15px;
                font-size: 0.9rem;
            }

            .card-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1 class="title">CISA Domain 4 Mastery</h1>
            <p class="subtitle">Information Systems Operations & Business Resilience (26% of Exam)</p>
            <div class="score-board">
                <div>Total Score: <span id="score">0</span></div>
                <div>Current Streak: <span id="streak">0</span></div>
                <div>Section Progress: <span id="progress">0</span>%</div>
            </div>
        </div>

        <div class="game-modes" id="gameMode">
            <div class="mode-card" data-mode="learn">
                <div class="mode-icon">📚</div>
                <div class="mode-title">Learn Mode</div>
                <div class="mode-description">Study operations and business resilience concepts</div>
            </div>
            <div class="mode-card" data-mode="quiz">
                <div class="mode-icon">🎯</div>
                <div class="mode-title">Quiz Mode</div>
                <div class="mode-description">Test your knowledge with comprehensive questions</div>
            </div>
            <div class="mode-card" data-mode="flashcards">
                <div class="mode-icon">🃏</div>
                <div class="mode-title">Flashcards</div>
                <div class="mode-description">Review key terms and definitions</div>
            </div>
            <div class="mode-card" data-mode="scenario">
                <div class="mode-icon">🔍</div>
                <div class="mode-title">Scenarios</div>
                <div class="mode-description">Practice with real-world audit situations</div>
            </div>
        </div>

        <div class="topic-selector" id="topicSelector" style="display: none;">
            <h3>Choose Your Focus Area:</h3>
            <div class="topic-grid">
                <div class="topic-btn" data-topic="operations">IT Operations & Maintenance</div>
                <div class="topic-btn" data-topic="resilience">Business Resilience & Continuity</div>
                <div class="topic-btn" data-topic="incident">Incident & Problem Management</div>
                <div class="topic-btn" data-topic="recovery">Disaster Recovery & Backup</div>
                <div class="topic-btn" data-topic="mixed">Mixed Topics</div>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-secondary" onclick="goBackToModes()">← Back to Game Modes</button>
            </div>
        </div>

        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="content-container" id="questionContainer">
            <div class="question" id="question"></div>
            <div class="options" id="options"></div>
            <div class="answer-status" id="answerStatus" style="display: none;"></div>
            <div class="explanation" id="explanation"></div>
        </div>

        <div class="content-container" id="learningContainer">
            <div class="learning-content">
                <h3 id="learningTitle"></h3>
                <p id="learningText"></p>
                <div class="learning-example" id="learningExample"></div>
            </div>
        </div>

        <div class="flashcard" id="flashcard" style="display: none;">
            <div class="card-content" id="cardContent"></div>
            <div class="card-hint">Click to flip</div>
            <div class="card-controls" id="cardControls" style="display: none;">
                <button class="card-btn correct" onclick="markCard(true)">✓ Got it right</button>
                <button class="card-btn incorrect" onclick="markCard(false)">✗ Need more practice</button>
            </div>
        </div>

        <div class="controls" id="controls" style="display: none;">
            <button class="btn btn-secondary" id="prevBtn">Previous</button>
            <button class="btn btn-secondary" onclick="goBackToTopics()">← Back to Topics</button>
            <button class="btn btn-primary" id="nextBtn">Next</button>
        </div>

        <div class="results-container" id="results">
            <h2>🎉 Complete!</h2>
            <div class="results-score" id="finalScore"></div>
            <p id="resultMessage"></p>
            <div id="detailedResults" style="margin: 20px 0;"></div>
            <div class="results-actions">
                <button class="btn btn-primary" onclick="playAgain()">🔄 Play Again</button>
                <button class="btn btn-secondary" onclick="goToMainScreen()">🏠 Main Menu</button>
                <button class="btn btn-secondary" onclick="chooseAnotherSection()">📚 Try Another Section</button>
                <button class="btn btn-outline" onclick="resetGame()">🔃 Reset All Progress</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let currentMode = '';
        let currentTopic = '';
        let currentQuestion = 0;
        let score = 0;
        let streak = 0;
        let answeredQuestions = [];
        let currentQuestions = [];
        let flashcardStats = { correct: 0, needPractice: 0 };
        let answerSubmitted = false;

        // Comprehensive Question Bank for CISA Domain 4
        const questionBank = {
            operations: [
                {
                    question: "What is the primary purpose of IT service level management?",
                    options: [
                        "To ensure agreed service levels are delivered to customers",
                        "To reduce IT operational costs",
                        "To implement new technologies",
                        "To manage IT staff performance"
                    ],
                    correct: 0,
                    explanation: "Service level management ensures that agreed service levels are consistently delivered to customers and that services are measured and improved where necessary to meet business objectives."
                },
                {
                    question: "Which activity is most critical in capacity planning?",
                    options: [
                        "Purchasing additional hardware",
                        "Forecasting future resource requirements based on business needs",
                        "Training technical staff",
                        "Implementing new software"
                    ],
                    correct: 1,
                    explanation: "Capacity planning involves forecasting future resource requirements based on current usage trends, business growth projections, and planned system changes to ensure adequate capacity is available when needed."
                },
                {
                    question: "What is the main objective of system performance monitoring?",
                    options: [
                        "To reduce system costs",
                        "To train system administrators",
                        "To identify performance bottlenecks and ensure optimal system operation",
                        "To comply with audit requirements"
                    ],
                    correct: 2,
                    explanation: "System performance monitoring aims to identify performance bottlenecks, trends, and potential issues to ensure systems operate optimally and meet service level requirements."
                },
                {
                    question: "In the context of change management, what is a change advisory board (CAB)?",
                    options: [
                        "A technical team that implements changes",
                        "A compliance audit committee",
                        "A board that funds IT projects",
                        "A group that authorizes and prioritizes changes"
                    ],
                    correct: 3,
                    explanation: "A Change Advisory Board (CAB) is a group of stakeholders responsible for reviewing, authorizing, and prioritizing changes to ensure they are properly assessed for risk and business impact."
                },
                {
                    question: "What is the primary purpose of configuration management?",
                    options: [
                        "To maintain accurate information about IT components and their relationships",
                        "To reduce system downtime",
                        "To train IT staff",
                        "To implement security controls"
                    ],
                    correct: 0,
                    explanation: "Configuration management maintains accurate information about all IT components (configuration items) and their relationships, enabling effective change control and impact analysis."
                },
                {
                    question: "Which factor is most important when determining maintenance windows?",
                    options: [
                        "Technical staff availability",
                        "Business impact and operational requirements",
                        "Vendor support hours",
                        "Cost considerations"
                    ],
                    correct: 1,
                    explanation: "Maintenance windows should be determined primarily based on business impact and operational requirements to minimize disruption to critical business processes."
                },
                {
                    question: "What is the key difference between problem management and incident management?",
                    options: [
                        "Problem management is reactive, incident management is proactive",
                        "There is no difference between them",
                        "Problem management focuses on root cause analysis, incident management on service restoration",
                        "Problem management is more important than incident management"
                    ],
                    correct: 2,
                    explanation: "Problem management focuses on identifying and addressing root causes of incidents to prevent recurrence, while incident management focuses on quickly restoring service to minimize business impact."
                },
                {
                    question: "What is the primary benefit of implementing automated patch management?",
                    options: [
                        "Reduces IT staffing requirements",
                        "Eliminates all security vulnerabilities",
                        "Improves system performance",
                        "Ensures timely and consistent application of security updates"
                    ],
                    correct: 3,
                    explanation: "Automated patch management ensures that security updates and patches are applied consistently and timely across the environment, reducing security vulnerabilities and operational overhead."
                }
            ],
            resilience: [
                {
                    question: "What is the primary purpose of a Business Impact Analysis (BIA)?",
                    options: [
                        "To identify critical business functions and their recovery priorities",
                        "To assess financial losses from disasters",
                        "To evaluate insurance coverage",
                        "To test disaster recovery procedures"
                    ],
                    correct: 0,
                    explanation: "A Business Impact Analysis identifies critical business functions, assesses the impact of their loss over time, and helps determine recovery priorities and acceptable downtime thresholds."
                },
                {
                    question: "What is the difference between Recovery Time Objective (RTO) and Recovery Point Objective (RPO)?",
                    options: [
                        "RTO is for data, RPO is for systems",
                        "RTO is the maximum acceptable downtime, RPO is the maximum acceptable data loss",
                        "There is no difference",
                        "RTO is longer than RPO"
                    ],
                    correct: 1,
                    explanation: "RTO (Recovery Time Objective) defines the maximum acceptable downtime for a system or process, while RPO (Recovery Point Objective) defines the maximum acceptable amount of data loss measured in time."
                },
                {
                    question: "Which element is most critical for effective business continuity planning?",
                    options: [
                        "Having backup facilities",
                        "Training all employees",
                        "Regular testing and updating of plans",
                        "Insurance coverage"
                    ],
                    correct: 2,
                    explanation: "Regular testing and updating of business continuity plans is most critical as it ensures plans remain effective, current, and aligned with changing business requirements and technology environments."
                },
                {
                    question: "What is the main purpose of establishing alternate processing sites?",
                    options: [
                        "To reduce operational costs",
                        "To comply with audit requirements",
                        "To improve system performance",
                        "To ensure business operations can continue during disasters"
                    ],
                    correct: 3,
                    explanation: "Alternate processing sites ensure business operations can continue during disasters or major disruptions by providing backup facilities with necessary infrastructure and resources."
                },
                {
                    question: "In business continuity planning, what is the maximum tolerable period of disruption (MTPD)?",
                    options: [
                        "The maximum time a business function can be unavailable before causing irreparable harm",
                        "The time it takes to implement the recovery plan",
                        "The cost of recovery operations",
                        "The time needed to test recovery procedures"
                    ],
                    correct: 0,
                    explanation: "MTPD is the maximum time a business function can be unavailable before the disruption would cause irreparable or unacceptable damage to the organization."
                },
                {
                    question: "What type of backup site provides the fastest recovery time?",
                    options: [
                        "Cold site",
                        "Hot site", 
                        "Warm site",
                        "Mobile site"
                    ],
                    correct: 1,
                    explanation: "A hot site provides the fastest recovery time as it is fully equipped with hardware, software, and data that is continuously synchronized, allowing near-immediate failover."
                },
                {
                    question: "Which factor should be the primary consideration when selecting backup strategies?",
                    options: [
                        "Storage capacity",
                        "Backup software features",
                        "Recovery time and point objectives",
                        "Technical staff skills"
                    ],
                    correct: 2,
                    explanation: "Recovery time and point objectives should be the primary consideration as they define the business requirements that backup strategies must meet to ensure adequate protection."
                },
                {
                    question: "What is the key characteristic of a resilient IT infrastructure?",
                    options: [
                        "Low cost",
                        "High performance",
                        "Latest technology",
                        "Ability to maintain operations despite failures"
                    ],
                    correct: 3,
                    explanation: "A resilient IT infrastructure is characterized by its ability to maintain essential operations and quickly recover from failures, disruptions, or adverse conditions."
                }
            ],
            incident: [
                {
                    question: "What is the first priority in incident response?",
                    options: [
                        "Containing the incident to prevent further damage",
                        "Preserving evidence",
                        "Notifying senior management",
                        "Documenting the incident"
                    ],
                    correct: 0,
                    explanation: "The first priority in incident response is containment to prevent further damage or escalation of the incident, ensuring business operations and data are protected."
                },
                {
                    question: "What is the purpose of incident categorization?",
                    options: [
                        "To assign blame for incidents",
                        "To prioritize response efforts and allocate appropriate resources",
                        "To comply with regulations",
                        "To reduce incident costs"
                    ],
                    correct: 1,
                    explanation: "Incident categorization helps prioritize response efforts, allocate appropriate resources, and ensure incidents are handled according to their impact and urgency levels."
                },
                {
                    question: "Which metric is most important for measuring incident management effectiveness?",
                    options: [
                        "Number of incidents per month",
                        "Cost per incident",
                        "Mean time to resolution (MTTR)",
                        "Number of staff involved"
                    ],
                    correct: 2,
                    explanation: "Mean Time to Resolution (MTTR) is crucial as it measures how quickly incidents are resolved, directly impacting business operations and user satisfaction."
                },
                {
                    question: "What is the primary goal of problem management?",
                    options: [
                        "To resolve incidents quickly",
                        "To reduce IT support costs",
                        "To train technical staff",
                        "To identify and eliminate root causes of incidents"
                    ],
                    correct: 3,
                    explanation: "Problem management aims to identify and eliminate the root causes of incidents to prevent recurrence and improve overall service quality."
                },
                {
                    question: "When should an incident be escalated?",
                    options: [
                        "When predefined thresholds for time or impact are exceeded",
                        "Immediately when reported",
                        "Only for security incidents",
                        "At the end of each day"
                    ],
                    correct: 0,
                    explanation: "Incidents should be escalated when predefined thresholds for resolution time, business impact, or complexity are exceeded to ensure appropriate resources and management attention."
                },
                {
                    question: "What is a known error in ITIL terminology?",
                    options: [
                        "An incident that cannot be resolved",
                        "A problem with a documented root cause and workaround",
                        "A critical system failure",
                        "A user error"
                    ],
                    correct: 1,
                    explanation: "A known error is a problem that has been analyzed and for which the root cause has been identified and a workaround or resolution has been documented."
                },
                {
                    question: "What information should be included in an incident record?",
                    options: [
                        "Only technical details",
                        "Just the resolution steps",
                        "Comprehensive details including impact, symptoms, actions taken, and resolution",
                        "Only the business impact"
                    ],
                    correct: 2,
                    explanation: "Incident records should include comprehensive information including symptoms, impact assessment, actions taken, resolution steps, and lessons learned for future reference."
                },
                {
                    question: "What is the difference between severity and priority in incident management?",
                    options: [
                        "There is no difference",
                        "Severity is more important than priority",
                        "Priority is a technical measure, severity is business-related",
                        "Severity measures technical impact, priority determines business urgency"
                    ],
                    correct: 3,
                    explanation: "Severity typically measures the technical or operational impact of an incident, while priority determines the business urgency and order in which incidents should be addressed."
                }
            ],
            recovery: [
                {
                    question: "What is the '3-2-1' backup rule?",
                    options: [
                        "3 backups, 2 different media types, 1 offsite",
                        "3 days retention, 2 backup types, 1 restore test",
                        "3 backup servers, 2 locations, 1 administrator",
                        "3 copies of data, 2 onsite, 1 cloud"
                    ],
                    correct: 0,
                    explanation: "The 3-2-1 backup rule recommends maintaining 3 copies of important data, stored on 2 different media types, with 1 copy stored offsite for optimal protection against various failure scenarios."
                },
                {
                    question: "Which backup method captures only data changed since the last full backup?",
                    options: [
                        "Incremental backup",
                        "Differential backup",
                        "Mirror backup",
                        "Snapshot backup"
                    ],
                    correct: 1,
                    explanation: "Differential backup captures all data that has changed since the last full backup, requiring only the full backup and the latest differential backup for complete restoration."
                },
                {
                    question: "What is the primary advantage of disk-to-disk-to-tape (D2D2T) backup strategy?",
                    options: [
                        "Lower cost",
                        "Simpler management",
                        "Faster backup and restore operations with long-term archival capability",
                        "Better compression"
                    ],
                    correct: 2,
                    explanation: "D2D2T combines fast disk-based backup and restore operations for operational recovery with tape-based long-term archival for compliance and off-site storage requirements."
                },
                {
                    question: "How often should disaster recovery plans be tested?",
                    options: [
                        "Only when systems change",
                        "Every five years",
                        "Only after a disaster occurs",
                        "At least annually, or more frequently for critical systems"
                    ],
                    correct: 3,
                    explanation: "Disaster recovery plans should be tested at least annually, with more frequent testing for critical systems, to ensure they remain effective and staff remain trained."
                },
                {
                    question: "What is the purpose of a disaster recovery tabletop exercise?",
                    options: [
                        "To validate recovery procedures through discussion and walkthrough",
                        "To test actual system recovery",
                        "To train technical staff only",
                        "To meet compliance requirements"
                    ],
                    correct: 0,
                    explanation: "Tabletop exercises validate disaster recovery procedures through structured discussion and walkthrough scenarios without actually invoking recovery systems, identifying gaps and improvement areas."
                },
                {
                    question: "Which factor is most critical when establishing backup retention policies?",
                    options: [
                        "Storage cost",
                        "Legal and business requirements",
                        "Technical convenience",
                        "Vendor recommendations"
                    ],
                    correct: 1,
                    explanation: "Legal and business requirements should drive backup retention policies, as organizations must comply with regulatory requirements and meet business needs for data recovery and historical access."
                },
                {
                    question: "What is the primary benefit of implementing automated disaster recovery systems?",
                    options: [
                        "Lower costs",
                        "Better documentation",
                        "Reduced recovery time and human error",
                        "Compliance with regulations"
                    ],
                    correct: 2,
                    explanation: "Automated disaster recovery systems reduce recovery time and minimize human error during high-stress situations, improving the reliability and speed of recovery operations."
                },
                {
                    question: "In disaster recovery planning, what is meant by 'failback'?",
                    options: [
                        "The failure of recovery systems",
                        "A backup failure scenario",
                        "Emergency shutdown procedures",
                        "The process of returning operations to the primary site after recovery"
                    ],
                    correct: 3,
                    explanation: "Failback is the process of returning operations from the disaster recovery site back to the primary site once the original systems have been restored and tested."
                }
            ],
            mixed: [
                {
                    question: "Which control would best prevent unauthorized changes to production systems?",
                    options: [
                        "Segregation of duties between development and production",
                        "Regular system backups",
                        "Password complexity requirements",
                        "Antivirus software"
                    ],
                    correct: 0,
                    explanation: "Segregation of duties between development and production environments prevents unauthorized changes by ensuring that developers cannot directly modify production systems without proper review and approval."
                },
                {
                    question: "What is the most important factor when determining data classification levels?",
                    options: [
                        "Storage costs",
                        "Business impact of unauthorized disclosure or loss",
                        "Technical complexity",
                        "Regulatory requirements only"
                    ],
                    correct: 1,
                    explanation: "Business impact of unauthorized disclosure, modification, or loss should be the primary factor in determining data classification levels, as this drives appropriate protection measures."
                },
                {
                    question: "Which metric best indicates the effectiveness of a business continuity program?",
                    options: [
                        "Number of documented procedures",
                        "Frequency of plan updates",
                        "Results of regular testing and exercises",
                        "Size of the business continuity team"
                    ],
                    correct: 2,
                    explanation: "Results of regular testing and exercises provide the best indication of business continuity program effectiveness by demonstrating whether plans actually work when needed."
                },
                {
                    question: "What is the primary purpose of service level agreements (SLAs) in IT operations?",
                    options: [
                        "To reduce operational costs",
                        "To comply with audit requirements",
                        "To assign blame for failures",
                        "To define clear expectations and accountability for service delivery"
                    ],
                    correct: 3,
                    explanation: "SLAs define clear expectations for service levels, performance metrics, and accountability between service providers and customers, ensuring mutual understanding of service requirements."
                },
                {
                    question: "Which approach best ensures data integrity during system migrations?",
                    options: [
                        "Comprehensive data validation and reconciliation",
                        "Parallel processing",
                        "Faster hardware",
                        "Multiple backup copies"
                    ],
                    correct: 0,
                    explanation: "Comprehensive data validation and reconciliation processes ensure that data maintains its accuracy, completeness, and consistency during migration between systems."
                },
                {
                    question: "What should be the primary consideration when designing fault-tolerant systems?",
                    options: [
                        "Cost minimization",
                        "Elimination of single points of failure",
                        "Performance optimization",
                        "Ease of maintenance"
                    ],
                    correct: 1,
                    explanation: "Eliminating single points of failure is the primary consideration in fault-tolerant system design, ensuring that no single component failure can cause complete system unavailability."
                }
            ]
        };

        const flashcards = {
            operations: [
                { front: "Service Level Agreement (SLA)", back: "Contract defining expected service levels, performance metrics, and accountability between service providers and customers" },
                { front: "Service Level Management", back: "Process ensuring that agreed service levels are consistently delivered and services are measured and improved to meet business objectives" },
                { front: "Capacity Planning", back: "Process of forecasting future resource requirements based on current usage, business growth, and planned changes to ensure adequate capacity" },
                { front: "Performance Monitoring", back: "Continuous observation and measurement of system performance to identify bottlenecks, trends, and optimization opportunities" },
                { front: "Change Advisory Board (CAB)", back: "Group of stakeholders responsible for reviewing, authorizing, and prioritizing changes based on risk and business impact assessment" },
                { front: "Configuration Management", back: "Process maintaining accurate information about IT components (configuration items) and their relationships for effective change control" },
                { front: "Configuration Management Database (CMDB)", back: "Repository containing information about all IT components and their relationships throughout the organization" },
                { front: "Release Management", back: "Process planning, scheduling, and controlling software and hardware releases through development to live environments" },
                { front: "Patch Management", back: "Process of acquiring, testing, and installing software updates to fix vulnerabilities and improve functionality" },
                { front: "Asset Lifecycle Management", back: "Comprehensive management of IT assets from acquisition through disposal, including tracking, maintenance, and optimization" },
                { front: "Maintenance Window", back: "Scheduled time period during which systems can be taken offline for maintenance with minimal business impact" },
                { front: "Mean Time To Repair (MTTR)", back: "Average time required to repair a failed component or system and restore it to operational status" },
                { front: "Mean Time Between Failures (MTBF)", back: "Average time between system failures, used to measure system reliability and plan maintenance activities" }
            ],
            resilience: [
                { front: "Business Impact Analysis (BIA)", back: "Systematic process identifying critical business functions, assessing impact of their loss, and determining recovery priorities" },
                { front: "Business Continuity Plan (BCP)", back: "Documented procedures enabling organizations to continue critical operations during and after significant disruptions" },
                { front: "Recovery Time Objective (RTO)", back: "Maximum acceptable downtime for a system or process after a disruption before causing unacceptable impact" },
                { front: "Recovery Point Objective (RPO)", back: "Maximum acceptable amount of data loss measured in time that an organization can tolerate after a disruption" },
                { front: "Maximum Tolerable Period of Disruption (MTPD)", back: "Maximum time a business function can be unavailable before causing irreparable or unacceptable damage" },
                { front: "Business Resilience", back: "Organization's ability to adapt to disruptions and continue operations while protecting people, assets, and reputation" },
                { front: "Hot Site", back: "Fully equipped backup facility with hardware, software, and data continuously synchronized for immediate failover" },
                { front: "Cold Site", back: "Backup facility with basic infrastructure but requiring equipment installation and data restoration before use" },
                { front: "Warm Site", back: "Backup facility with some equipment and infrastructure pre-installed, requiring data restoration and final configuration" },
                { front: "Alternate Processing Site", back: "Secondary location where critical business operations can continue during disasters or major disruptions" },
                { front: "Failover", back: "Automatic switching to a backup system when the primary system fails or becomes unavailable" },
                { front: "Failback", back: "Process of returning operations from disaster recovery site back to primary site after restoration" },
                { front: "Crisis Management", back: "Process of identifying threats and responding to them to minimize impact on organizational operations and reputation" }
            ],
            incident: [
                { front: "Incident Management", back: "Process focused on restoring normal service operation as quickly as possible with minimal business impact" },
                { front: "Problem Management", back: "Process identifying and eliminating root causes of incidents to prevent recurrence and improve service quality" },
                { front: "Incident", back: "Unplanned interruption or reduction in quality of IT service that impacts business operations" },
                { front: "Problem", back: "Underlying cause of one or more incidents requiring investigation to prevent future occurrences" },
                { front: "Known Error", back: "Problem with documented root cause and workaround or resolution available for implementation" },
                { front: "Incident Severity", back: "Measure of technical or operational impact of an incident on systems and services" },
                { front: "Incident Priority", back: "Relative importance of an incident based on business impact and urgency requirements" },
                { front: "Incident Escalation", back: "Process of transferring incident to higher authority or more specialized resource when thresholds are exceeded" },
                { front: "First Call Resolution", back: "Percentage of incidents resolved during initial contact without need for escalation or additional intervention" },
                { front: "Service Desk", back: "Single point of contact for users to report incidents and request services from IT organization" },
                { front: "Root Cause Analysis", back: "Systematic investigation process identifying fundamental cause of problems to prevent recurrence" },
                { front: "Workaround", back: "Temporary solution reducing or eliminating impact of known error or problem until permanent fix available" },
                { front: "Incident Response Team", back: "Group of specialists responsible for managing and coordinating response to security incidents and major disruptions" }
            ],
            recovery: [
                { front: "Disaster Recovery Plan (DRP)", back: "Documented procedures for recovering IT systems and data after disasters to minimize downtime and data loss" },
                { front: "Backup Strategy", back: "Comprehensive approach defining what data to backup, how often, using which methods, and where to store backups" },
                { front: "Full Backup", back: "Complete copy of all selected data providing comprehensive protection but requiring most time and storage space" },
                { front: "Incremental Backup", back: "Backup containing only data changed since last backup of any type, providing fastest backup but slower restore" },
                { front: "Differential Backup", back: "Backup containing all data changed since last full backup, balancing backup speed with restore complexity" },
                { front: "3-2-1 Backup Rule", back: "Best practice maintaining 3 copies of data, on 2 different media types, with 1 copy stored offsite" },
                { front: "Offsite Storage", back: "Backup storage location physically separated from primary site to protect against site-wide disasters" },
                { front: "Data Replication", back: "Process of copying data from one location to another in real-time or near real-time for availability and protection" },
                { front: "Backup Retention Policy", back: "Rules defining how long backup copies should be kept based on legal, regulatory, and business requirements" },
                { front: "Disaster Recovery Testing", back: "Regular validation of recovery procedures through exercises ranging from tabletop discussions to full failover tests" },
                { front: "Recovery Strategy", back: "Approach defining how systems and operations will be restored after disruption based on business requirements" },
                { front: "Data Archiving", back: "Process of moving inactive data to separate storage system for long-term retention and compliance" },
                { front: "Restoration", back: "Process of recovering data and systems from backups to return to operational state after failure or disaster" }
            ],
            mixed: [
                { front: "Resilient Infrastructure", back: "IT infrastructure designed to maintain essential operations and quickly recover from failures or adverse conditions" },
                { front: "Single Point of Failure", back: "Component whose failure would cause entire system to fail, eliminated through redundancy and fault tolerance" },
                { front: "Fault Tolerance", back: "System's ability to continue operating correctly despite failure of one or more components" },
                { front: "Data Integrity", back: "Accuracy, completeness, and consistency of data throughout its lifecycle and across all systems" },
                { front: "Change Control", back: "Formal process managing modifications to systems ensuring they are properly reviewed, tested, and approved" },
                { front: "Version Control", back: "Management of changes to documents, programs, and information systems to track modifications and enable rollback" },
                { front: "Service Continuity", back: "Ability to maintain critical IT services during and after significant disruptions to ensure business operations" },
                { front: "Operational Risk", back: "Risk of loss resulting from inadequate or failed processes, people, systems, or external events affecting operations" },
                { front: "Service Catalog", back: "Centralized repository of IT services available to users with descriptions, requirements, and service levels" },
                { front: "Escalation Matrix", back: "Documented procedure defining when and how incidents or issues should be escalated to higher authorities" },
                { front: "Redundancy", back: "Duplication of critical system components to provide backup capability and eliminate single points of failure" },
                { front: "Load Balancing", back: "Distribution of workloads across multiple computing resources to optimize resource use and prevent overload" }
            ]
        };

        const learningContent = {
            operations: [
                {
                    title: "IT Service Management and Operations",
                    content: "IT Service Management (ITSM) encompasses the processes, procedures, and policies for delivering, managing, and improving IT services to meet business objectives. Service Level Management ensures that agreed service levels are consistently delivered by defining, negotiating, monitoring, and reporting on service levels. Key components include Service Level Agreements (SLAs), which specify performance metrics, availability targets, and response times. Effective ITSM requires continuous monitoring of service performance, proactive identification of potential issues, and regular review of service levels to ensure they remain aligned with business needs. The ITIL framework provides industry best practices for ITSM implementation, emphasizing the importance of people, processes, and technology working together to deliver value to customers.",
                    example: "Example: A company's email SLA specifies 99.5% availability during business hours, maximum 4-hour response time for critical issues, and monthly performance reports. Service monitoring shows 99.2% availability last month, triggering a service improvement plan to address infrastructure bottlenecks and meet the agreed targets."
                },
                {
                    title: "Capacity Planning and Performance Management",
                    content: "Capacity planning is the proactive process of forecasting future resource requirements to ensure adequate system capacity meets business demands while optimizing costs. It involves analyzing current usage patterns, understanding business growth projections, evaluating new application requirements, and planning infrastructure scaling. Performance management includes continuous monitoring of system metrics such as CPU utilization, memory usage, network throughput, and storage capacity. Key activities include establishing performance baselines, identifying trends, detecting anomalies, and implementing corrective actions. Effective capacity planning prevents performance degradation, service outages, and enables informed investment decisions. Modern approaches incorporate cloud elasticity, allowing dynamic scaling based on demand patterns while maintaining cost efficiency.",
                    example: "Example: Analysis shows database server CPU averaging 75% with 15% monthly growth. Capacity planning projects reaching 100% in 4 months, prompting upgrade planning. Performance monitoring reveals peak usage during month-end processing, enabling workload scheduling optimization and temporary capacity scaling."
                },
                {
                    title: "Change and Configuration Management",
                    content: "Change management provides a controlled approach to implementing modifications to IT systems, ensuring changes are properly assessed, approved, tested, and documented to minimize business risk. The Change Advisory Board (CAB) evaluates proposed changes based on business justification, technical impact, risk assessment, and resource requirements. Configuration management maintains accurate information about all IT components (configuration items) and their relationships through a Configuration Management Database (CMDB). This enables impact analysis, change planning, and incident resolution. Release management coordinates the deployment of changes from development through testing to production environments. Effective change and configuration management prevents unauthorized modifications, reduces failed changes, and ensures system integrity.",
                    example: "Example: A database upgrade request goes through CAB review showing business benefits, technical requirements, rollback procedures, and testing results. CMDB analysis identifies dependent applications, integration points, and affected users. The change is scheduled during maintenance window with coordinated release management ensuring systematic deployment across environments."
                },
                {
                    title: "Asset Lifecycle and Maintenance Management",
                    content: "Asset lifecycle management encompasses the complete management of IT assets from procurement through disposal, ensuring optimal value delivery throughout their operational life. Key phases include planning and acquisition, deployment and configuration, operation and maintenance, and retirement and disposal. Maintenance management involves preventive, corrective, and predictive maintenance activities to ensure asset reliability and performance. This includes scheduled maintenance windows, patch management, hardware replacement planning, and end-of-life migration strategies. Asset tracking and inventory management provide visibility into asset status, performance, and utilization. Financial management aspects include depreciation tracking, total cost of ownership analysis, and optimization of asset refresh cycles. Proper asset lifecycle management minimizes operational risks, reduces costs, and ensures compliance with licensing and regulatory requirements.",
                    example: "Example: Server asset lifecycle shows 3-year refresh cycle with quarterly maintenance windows. Predictive analytics indicate disk failure probability for servers approaching 4 years, triggering proactive replacement. Asset tracking reveals underutilized servers that can be repurposed, optimizing hardware investment while maintaining service levels."
                }
            ],
            resilience: [
                {
                    title: "Business Impact Analysis and Continuity Planning",
                    content: "Business Impact Analysis (BIA) is the foundational process for business continuity planning that identifies critical business functions, assesses the impact of their disruption over time, and determines recovery priorities. The BIA evaluates both tangible impacts (revenue loss, increased costs, regulatory fines) and intangible impacts (reputation damage, customer confidence, market share). Key outputs include Maximum Tolerable Period of Disruption (MTPD), Recovery Time Objectives (RTO), and Recovery Point Objectives (RPO) for each critical function. Business Continuity Planning (BCP) develops strategies and procedures to maintain or quickly restore critical operations during disruptions. Effective BCP requires stakeholder involvement, regular updates to reflect business changes, and comprehensive testing to validate plan effectiveness. The plan should address various scenarios including natural disasters, cyber attacks, pandemics, and supply chain disruptions.",
                    example: "Example: BIA for an e-commerce company identifies order processing as critical with MTPD of 4 hours (revenue loss of $50K/hour). RTO is set at 2 hours with RPO of 15 minutes. BCP includes alternate processing procedures, staff notification protocols, and vendor agreements for rapid system restoration."
                },
                {
                    title: "Disaster Recovery Planning and Implementation",
                    content: "Disaster Recovery Planning (DRP) focuses specifically on restoring IT systems and data following disasters to minimize downtime and data loss. DRP development involves risk assessment, recovery strategy selection, documentation of detailed procedures, and establishment of recovery sites. Recovery strategies range from simple backup restoration to complex multi-site failover arrangements. Hot sites provide immediate failover capability with fully configured systems and current data. Warm sites offer intermediate recovery times with basic infrastructure requiring data restoration. Cold sites provide minimal facilities requiring full system deployment. Cloud-based disaster recovery has become increasingly popular, offering scalability and cost-effectiveness. Testing is crucial and should include tabletop exercises, walkthrough tests, and full failover tests. Recovery procedures must be regularly updated to reflect system changes and lessons learned from tests and actual events.",
                    example: "Example: Manufacturing company's DRP includes hot site for ERP system (1-hour RTO), warm site for email systems (4-hour RTO), and cloud backup for file servers (24-hour RTO). Quarterly testing identifies communication gaps, leading to improved notification procedures and staff training updates."
                },
                {
                    title: "Risk Assessment and Resilience Strategy",
                    content: "Risk assessment for business resilience involves identifying threats, analyzing vulnerabilities, evaluating potential impacts, and determining likelihood of occurrence to prioritize protection efforts. Threats include natural disasters, technological failures, cyber attacks, supply chain disruptions, and human errors. Vulnerability assessment examines organizational weaknesses that could be exploited by threats. Risk evaluation combines threat likelihood with potential impact to create risk matrices for decision-making. Resilience strategy development balances risk tolerance with cost considerations to implement appropriate protective measures. This includes preventive controls (reducing likelihood), detective controls (early warning), and corrective controls (minimizing impact). Business resilience requires building adaptive capacity, redundancy, and recovery capabilities across people, processes, technology, and facilities. Regular risk reassessment ensures strategies remain effective as threats and business environments evolve.",
                    example: "Example: Hospital risk assessment identifies power outage as high-probability threat with critical impact on patient care. Resilience strategy includes dual utility feeds, backup generators, UPS systems, and procedures for emergency operations. Regular testing and maintenance ensure 99.99% power availability for critical systems."
                },
                {
                    title: "Crisis Management and Communication",
                    content: "Crisis management involves preparing for, responding to, and recovering from significant disruptions that threaten organizational survival or reputation. Effective crisis management requires pre-established governance structures including crisis management teams, clear roles and responsibilities, and decision-making authorities. Communication management is crucial for internal coordination and external stakeholder management during crises. Communication plans should address various audiences including employees, customers, suppliers, regulators, media, and the public with appropriate messaging for each group. Crisis response procedures include situation assessment, stakeholder notification, resource mobilization, and coordination of response activities. Recovery management focuses on returning to normal operations, conducting post-incident reviews, and implementing improvements. Crisis management capability requires regular training, simulation exercises, and continuous improvement based on lessons learned from both exercises and actual events.",
                    example: "Example: Cyber attack crisis response includes immediate incident containment, executive team notification within 30 minutes, customer communication within 4 hours, and regulatory notification within 24 hours. Post-incident review identifies communication delays and leads to improved automation and clearer escalation procedures."
                }
            ],
            incident: [
                {
                    title: "Incident Management Process and Procedures",
                    content: "Incident management is a structured process designed to restore normal service operation as quickly as possible while minimizing business impact. The process begins with incident detection and recording, followed by categorization and prioritization based on business impact and urgency. Initial diagnosis involves gathering information about symptoms, affected users, and system status. Investigation and diagnosis aim to identify the cause and develop resolution approaches. Resolution implementation may involve applying known fixes, implementing workarounds, or escalating to specialized teams. Recovery verification ensures that service is fully restored and users can resume normal operations. Incident closure includes documentation of resolution steps and communication to affected stakeholders. Effective incident management requires clear procedures, trained staff, appropriate tools, and well-defined escalation paths. Key performance indicators include first-call resolution rate, mean time to resolution, and customer satisfaction scores.",
                    example: "Example: Email server outage is detected by monitoring system at 9:15 AM, categorized as P1 (critical business impact), diagnosed within 20 minutes as storage failure, resolved using hot-spare storage by 10:30 AM, with full service verification and user notification by 10:45 AM."
                },
                {
                    title: "Problem Management and Root Cause Analysis",
                    content: "Problem management focuses on identifying and eliminating the root causes of incidents to prevent recurrence and improve overall service quality. Unlike incident management which emphasizes speed of restoration, problem management emphasizes thoroughness of investigation and permanent resolution. Problem identification can occur through analysis of recurring incidents, proactive monitoring, or trend analysis. Root Cause Analysis (RCA) uses systematic investigation techniques such as the Five Whys, fishbone diagrams, or fault tree analysis to identify underlying causes. Known Error Database maintains records of problems with documented root causes and workarounds until permanent solutions are implemented. Problem resolution may involve software patches, hardware replacements, process improvements, or configuration changes. Preventive problem management proactively identifies potential issues before they cause incidents. Success measures include reduction in incident volume, improved system reliability, and decreased resolution times.",
                    example: "Example: Analysis of 15 database connection incidents reveals root cause as connection pool exhaustion during peak usage. Problem resolution includes increasing pool size, implementing connection monitoring, and optimizing application connection handling, reducing similar incidents by 90%."
                },
                {
                    title: "Incident Classification and Prioritization",
                    content: "Incident classification and prioritization ensure that response efforts are appropriately aligned with business impact and urgency requirements. Incident categorization groups incidents by type (hardware, software, network, security) and affected service to enable proper routing and statistical analysis. Severity assessment measures the technical or operational impact, such as number of users affected, system performance degradation, or functionality loss. Priority determination considers both business impact and urgency to establish the order in which incidents should be addressed. Impact assessment evaluates effects on business operations, customer satisfaction, revenue, and compliance requirements. Urgency factors include time sensitivity, customer commitments, and escalation potentials. Priority matrices combine impact and urgency ratings to determine overall priority levels. Clear classification criteria ensure consistent handling and enable meaningful performance reporting. Dynamic re-prioritization may be necessary as situations evolve or additional information becomes available.",
                    example: "Example: Payroll system failure during pay period processing is classified as P1 (high impact - affects all employees, high urgency - pay deadline). Customer portal slowness affecting 20% of users is classified as P2 (medium impact, medium urgency) with different response targets and resource allocation."
                },
                {
                    title: "Service Desk Operations and Escalation Management",
                    content: "Service desk operations provide a single point of contact for users to report incidents, request services, and obtain information about IT services. Effective service desk operations require skilled staff, comprehensive knowledge management systems, and integrated toolsets for efficient incident handling. First-level support focuses on immediate resolution of common issues using documented procedures and known solutions. Knowledge management systems provide access to solution databases, configuration information, and historical incident records. Escalation management defines when and how incidents should be transferred to higher-level support or specialized teams. Functional escalation transfers incidents to teams with specific technical expertise. Hierarchical escalation involves management intervention when service levels are threatened or customer satisfaction is at risk. Escalation criteria include resolution time thresholds, complexity levels, and impact assessments. Effective escalation ensures incidents receive appropriate attention while avoiding unnecessary delays or resource waste.",
                    example: "Example: Service desk receives printer connectivity issue, resolves 60% through first-level support using knowledge base procedures. Complex network issues are escalated to Level 2 after 30 minutes. Manager escalation occurs for P1 incidents exceeding 2-hour resolution target, ensuring appropriate resources and management attention."
                }
            ],
            recovery: [
                {
                    title: "Data Backup Strategies and Implementation",
                    content: "Data backup strategies form the foundation of disaster recovery by ensuring that critical information can be restored following data loss incidents. The 3-2-1 backup rule provides a framework for robust backup protection: maintain 3 copies of important data, store them on 2 different media types, and keep 1 copy offsite. Full backups create complete copies of all selected data, providing comprehensive protection but requiring significant time and storage. Incremental backups capture only data changed since the last backup of any type, offering fast backup operations but potentially complex restoration. Differential backups include all data changed since the last full backup, balancing backup speed with restoration simplicity. Modern backup strategies increasingly leverage cloud storage for offsite protection, automated scheduling, and scalable capacity. Backup verification through regular restoration testing ensures that backups are reliable and recovery procedures are effective. Retention policies must balance legal requirements, business needs, and storage costs.",
                    example: "Example: Enterprise backup strategy includes daily incremental backups to local storage, weekly full backups to tape, and monthly archive to cloud storage. Quarterly restoration tests verify backup integrity and restoration procedures. Legal requirements mandate 7-year retention for financial data, implemented through automated archival policies."
                },
                {
                    title: "Recovery Testing and Validation Procedures",
                    content: "Recovery testing validates that disaster recovery plans and procedures will work effectively when needed while identifying gaps and improvement opportunities. Tabletop exercises involve structured discussions of recovery scenarios without actually invoking recovery systems, allowing teams to walk through procedures and identify potential issues. Walkthrough tests involve more detailed review of recovery procedures with actual recovery teams, often including simulated communication and coordination activities. Technical recovery tests involve actual restoration of systems and data to verify that recovery procedures work as intended. Full-scale disaster recovery tests simulate complete site failures and test end-to-end recovery capabilities including staff notification, alternate site activation, and business process continuity. Test scenarios should cover various failure types including natural disasters, cyber attacks, and equipment failures. Testing frequency should be risk-based, with critical systems tested more frequently. Post-test reviews capture lessons learned and drive improvements to recovery capabilities.",
                    example: "Example: Quarterly tabletop exercises test communication procedures and decision-making. Semi-annual technical tests restore database backups to test environment verifying data integrity and recovery time. Annual full-scale test activates disaster recovery site, tests staff notification, and validates business process continuity for 24-hour duration."
                },
                {
                    title: "Recovery Site Strategy and Management",
                    content: "Recovery site strategy involves selecting and implementing alternate facilities where critical operations can continue during disasters affecting primary locations. Hot sites provide immediate recovery capability with fully configured hardware, current software, and near real-time data replication, enabling rapid failover but at higher cost. Warm sites offer intermediate recovery with basic infrastructure and periodic data updates, requiring some configuration and data restoration. Cold sites provide minimal facilities with power, cooling, and basic connectivity, requiring full system deployment and data restoration. Mobile recovery units offer flexible deployment for specific scenarios or locations. Cloud-based recovery has become increasingly popular, offering scalability, geographic distribution, and cost-effectiveness through pay-as-used models. Recovery site management includes regular testing, maintenance of equipment and data currency, contract management, and coordination of recovery operations. Site selection considers geographic risk factors, proximity to business operations, and regulatory requirements.",
                    example: "Example: Financial services firm uses hot site for trading systems (15-minute RTO), warm site for general business applications (4-hour RTO), and cloud-based recovery for email and collaboration tools (8-hour RTO). Geographic separation ensures sites are outside regional disaster zones while maintaining acceptable latency for real-time systems."
                },
                {
                    title: "Data Recovery and System Restoration",
                    content: "Data recovery and system restoration involve the technical processes of returning systems and information to operational status following disruptions. Recovery procedures must be clearly documented with step-by-step instructions, required resources, and verification criteria. Data restoration typically follows a prioritized sequence based on business criticality and system dependencies. Database recovery may involve point-in-time restoration, transaction log replay, and consistency checks to ensure data integrity. Application restoration includes configuration restoration, integration testing, and user acceptance validation. System restoration encompasses hardware provisioning, operating system installation, application deployment, and network configuration. Recovery orchestration coordinates multiple recovery activities to optimize overall recovery time while managing dependencies. Automated recovery systems can significantly reduce recovery time and minimize human error during high-stress situations. Recovery validation ensures that restored systems operate correctly and meet performance requirements before returning to full production status. Documentation of actual recovery activities provides valuable lessons for improving future recovery operations.",
                    example: "Example: ERP system recovery follows documented sequence: restore database from backup (2 hours), validate data integrity (1 hour), restore application servers (1 hour), test integration points (1 hour), conduct user acceptance testing (1 hour), achieving 6-hour total recovery time with comprehensive validation at each step."
                }
            ],
            mixed: [
                {
                    title: "Operational Risk Management and Controls",
                    content: "Operational risk management in IT operations encompasses the identification, assessment, and mitigation of risks arising from inadequate or failed processes, people, systems, or external events. Risk identification involves systematically examining operational processes to identify potential failure points, vulnerabilities, and threat scenarios. Risk assessment evaluates the likelihood and potential impact of identified risks, considering both quantitative factors (financial loss, downtime costs) and qualitative factors (reputation, compliance). Control implementation focuses on preventive controls that reduce risk likelihood, detective controls that provide early warning, and corrective controls that minimize impact when incidents occur. Segregation of duties prevents unauthorized actions by requiring multiple people to complete critical processes. Access controls ensure that only authorized personnel can perform sensitive operations. Monitoring and alerting systems provide continuous oversight of operational activities and automated notification of anomalies. Regular risk reassessment ensures that control measures remain effective as operations and threat landscapes evolve.",
                    example: "Example: Database administration implements segregation of duties requiring two-person approval for production changes, automated monitoring for unauthorized access attempts, and quarterly access reviews. Risk assessment identifies backup failure as high-impact risk, leading to implementation of dual backup systems and daily restoration testing."
                },
                {
                    title: "Service Integration and Dependency Management",
                    content: "Service integration and dependency management ensure that interconnected IT services work together effectively to deliver business value while minimizing cascading failures. Service mapping documents the relationships between business services, IT services, and underlying infrastructure components to enable impact analysis and change planning. Dependency analysis identifies critical path services where failures would have widespread impact, enabling prioritization of resilience investments. Integration testing validates that service components work correctly together, particularly after changes or updates. Performance monitoring across service boundaries helps identify bottlenecks and optimization opportunities. Capacity planning considers cumulative demands across integrated services to ensure adequate resource allocation. Fault isolation techniques prevent failures in one service from affecting others through circuit breakers, timeouts, and graceful degradation. Service orchestration coordinates complex workflows across multiple services while managing error handling and recovery procedures. Regular architecture reviews ensure that service integrations remain aligned with business requirements and technical best practices.",
                    example: "Example: E-commerce platform service map shows dependencies between web servers, application servers, database clusters, payment gateways, and inventory systems. Dependency analysis identifies payment gateway as critical path component, leading to implementation of redundant providers and circuit breaker patterns to prevent cascading failures."
                },
                {
                    title: "Performance Optimization and Capacity Management",
                    content: "Performance optimization and capacity management ensure that IT systems deliver required performance levels while efficiently utilizing resources to meet business demands. Performance baseline establishment captures normal operating parameters for systems and services to enable anomaly detection and trend analysis. Bottleneck identification uses performance monitoring data to locate constraints that limit overall system performance. Capacity modeling predicts future resource requirements based on business growth projections, usage patterns, and planned system changes. Resource optimization involves tuning configurations, optimizing code, and redistributing workloads to improve efficiency. Scalability planning addresses both vertical scaling (adding resources to existing systems) and horizontal scaling (adding additional systems) strategies. Cloud elasticity enables dynamic resource allocation based on demand patterns while maintaining cost efficiency. Performance testing validates that systems meet requirements under various load conditions and identifies breaking points. Continuous monitoring and optimization ensure that performance levels are maintained as systems and workloads evolve over time.",
                    example: "Example: Web application performance analysis reveals database queries as primary bottleneck during peak hours. Optimization includes query tuning, index optimization, connection pooling, and read replica implementation, improving response times by 60% and supporting 3x traffic growth without additional infrastructure."
                },
                {
                    title: "Automation and Operational Efficiency",
                    content: "Automation and operational efficiency initiatives reduce manual effort, minimize human error, and improve consistency in IT operations while enabling staff to focus on higher-value activities. Process automation identifies repetitive tasks suitable for automation such as system monitoring, backup operations, patch deployment, and incident response. Infrastructure as Code treats infrastructure configuration as software, enabling version control, automated provisioning, and consistent deployments. Automated monitoring and alerting provide continuous oversight with intelligent filtering to reduce alert fatigue while ensuring critical issues receive immediate attention. Self-healing systems automatically detect and resolve common issues without human intervention. Workflow automation orchestrates complex operational procedures across multiple systems and teams. Robotic Process Automation (RPA) handles routine tasks that interact with multiple applications and systems. Automation governance ensures that automated processes are properly tested, documented, and maintained. Continuous improvement programs regularly evaluate automation opportunities and measure efficiency gains while maintaining appropriate human oversight and intervention capabilities.",
                    example: "Example: Server provisioning automation reduces deployment time from 2 days to 30 minutes while eliminating configuration errors. Automated patch management handles 90% of updates without manual intervention. Self-healing storage systems automatically migrate data from failing disks, reducing incident volume by 40% and improving system reliability."
                }
            ]
        };

        const scenarios = [
            {
                question: "During an IT audit, you discover that the organization has no formal change management process and production systems are frequently modified directly by developers. What is your primary concern and recommendation?",
                options: [
                    "Risk of unauthorized changes causing system instability and security vulnerabilities",
                    "Developers are more efficient when they can make direct changes",
                    "Direct changes are acceptable if properly documented",
                    "The organization should hire more IT staff"
                ],
                correct: 0,
                explanation: "Lack of formal change management creates significant risk of unauthorized changes, system instability, security vulnerabilities, and inability to track what changes were made when problems occur. Recommend implementing proper change control procedures with segregation of duties."
            },
            {
                question: "You are auditing a critical system and find that backups are performed nightly but have never been tested for restoration. The last restore test was attempted 18 months ago but failed, and no corrective action was taken. What should be your audit finding?",
                options: [
                    "Backup frequency is adequate",
                    "Untested backups create false sense of security and may not support recovery when needed",
                    "Testing every 18 months is sufficient",
                    "Failed restore test is not significant if backups are running"
                ],
                correct: 1,
                explanation: "Untested backups create a false sense of security and may be unusable when actually needed. The failed test indicates a serious problem that was not addressed, potentially leaving the organization unable to recover critical data during a disaster."
            },
            {
                question: "During a business continuity audit, you find that the organization's BCP was last updated 3 years ago, before significant system upgrades and process changes. Testing hasn't occurred in 2 years. What is your assessment?",
                options: [
                    "BCP updates every 3 years are adequate",
                    "System upgrades don't affect business continuity planning",
                    "BCP is likely outdated and ineffective due to lack of updates and testing",
                    "Testing every 2 years meets industry standards"
                ],
                correct: 2,
                explanation: "A BCP that hasn't been updated for 3 years, especially after significant system changes, is likely outdated and ineffective. Lack of testing means procedures may not work when needed and staff may not be familiar with their roles."
            },
            {
                question: "You discover that the organization's primary data center and disaster recovery site are located 10 miles apart in the same flood zone. Both sites were offline for 3 days during recent flooding. What should you recommend?",
                options: [
                    "The proximity allows for faster data synchronization",
                    "Flood insurance is sufficient protection",
                    "10 miles is adequate separation",
                    "Geographic separation of recovery sites to avoid regional disasters"
                ],
                correct: 3,
                explanation: "Recovery sites should be geographically separated to avoid regional disasters that could affect both primary and backup facilities. The flooding incident demonstrates this vulnerability and the need for better geographic distribution."
            },
            {
                question: "During an incident management audit, you find that 60% of incidents are reopened within 48 hours due to incomplete resolution. What does this indicate about the incident management process?",
                options: [
                    "Inadequate investigation and resolution procedures leading to recurring issues",
                    "Incident volume is too high for staff to handle",
                    "Users are too demanding about service quality",
                    "Response times need to be faster"
                ],
                correct: 0,
                explanation: "High reopening rates indicate inadequate investigation and resolution procedures. Incidents are being closed without proper root cause analysis or complete resolution, leading to recurring problems and customer dissatisfaction."
            },
            {
                question: "You find that the organization's RPO is set at 24 hours but the most recent backup is 72 hours old due to ongoing backup failures. Management states this is 'acceptable for now.' What should be your response?",
                options: [
                    "Accept management's assessment of acceptable risk",
                    "Current backup status exceeds acceptable data loss limits and creates significant business risk",
                    "72-hour old backups are better than no backups",
                    "Focus on other audit areas since management has accepted the risk"
                ],
                correct: 1,
                explanation: "The current backup status exceeds the organization's own defined acceptable data loss limits (RPO), creating significant business risk. Management acceptance doesn't eliminate the risk or the auditor's responsibility to report this control deficiency."
            },
            {
                question: "During a capacity planning review, you discover that critical servers are operating at 95% CPU utilization during normal business hours, with no capacity expansion plans. What should be your primary concern?",
                options: [
                    "High utilization indicates efficient resource usage",
                    "95% utilization is within normal operating ranges",
                    "Risk of performance degradation and service outages with minimal operational headroom",
                    "This is primarily a technical rather than audit issue"
                ],
                correct: 2,
                explanation: "Operating at 95% utilization leaves minimal headroom for normal fluctuations, system maintenance, or unexpected demand, creating high risk of performance degradation or service outages. Proper capacity planning should maintain adequate operational margin."
            },
            {
                question: "You are reviewing IT operations and find that system administrators use shared privileged accounts with the same password for the past 2 years. Account activities are not logged individually. What is your primary audit concern?",
                options: [
                    "Shared accounts improve operational efficiency",
                    "Password age is the only concern",
                    "Shared accounts are acceptable for routine maintenance",
                    "Lack of individual accountability and inability to track administrative actions"
                ],
                correct: 3,
                explanation: "Shared privileged accounts eliminate individual accountability and make it impossible to track who performed specific administrative actions. This creates significant security and audit trail concerns, especially for privileged activities."
            },
            {
                question: "During a service level management audit, you find that SLA performance reports show consistent achievement of targets, but user satisfaction surveys indicate significant dissatisfaction with service quality. How should you interpret this discrepancy?",
                options: [
                    "SLA metrics may not accurately reflect user experience or business impact",
                    "SLA metrics are accurate and user expectations are unreasonable",
                    "User satisfaction surveys are unreliable",
                    "This discrepancy is normal and expected"
                ],
                correct: 0,
                explanation: "This discrepancy suggests that SLA metrics may not accurately reflect actual user experience or business impact. The metrics may be measuring the wrong things or not capturing issues that matter most to users and business operations."
            },
            {
                question: "You discover that the organization's critical systems have documented recovery procedures but the technical staff responsible for executing them left the company 6 months ago and haven't been replaced. What should be your recommendation?",
                options: [
                    "Documentation is sufficient for any qualified technical person",
                    "Risk of ineffective disaster recovery due to lack of trained personnel",
                    "Procedures can be executed by any available IT staff",
                    "External consultants can be hired during emergencies"
                ],
                correct: 1,
                explanation: "Having procedures without trained personnel creates significant risk of ineffective disaster recovery. Complex recovery procedures require specific knowledge and practice, and expecting untrained staff to execute them successfully during high-stress emergencies is unrealistic."
            }
        ];

        // Initialize game
        function initGame() {
            document.querySelectorAll('.mode-card').forEach(card => {
                card.addEventListener('click', () => selectMode(card.dataset.mode));
            });

            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.addEventListener('click', () => selectTopic(btn.dataset.topic));
            });

            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('prevBtn').addEventListener('click', prevQuestion);
        }

        function selectMode(mode) {
            currentMode = mode;
            
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            document.getElementById('topicSelector').style.display = 'block';
        }

        function selectTopic(topic) {
            currentTopic = topic;
            
            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-topic="${topic}"]`).classList.add('active');
            
            startMode();
        }

        function startMode() {
            document.getElementById('gameMode').style.display = 'none';
            document.getElementById('topicSelector').style.display = 'none';
            document.getElementById('progressBar').style.display = 'block';
            document.getElementById('controls').style.display = 'flex';
            
            currentQuestion = 0;
            score = 0;
            streak = 0;
            answeredQuestions = [];
            flashcardStats = { correct: 0, needPractice: 0 };
            answerSubmitted = false;
            
            if (currentMode === 'quiz' || currentMode === 'scenario') {
                setupQuiz();
            } else if (currentMode === 'flashcards') {
                setupFlashcards();
            } else if (currentMode === 'learn') {
                setupLearning();
            }
        }

        function setupQuiz() {
            if (currentMode === 'scenario') {
                currentQuestions = [...scenarios];
            } else if (currentTopic === 'mixed') {
                currentQuestions = [
                    ...questionBank.operations,
                    ...questionBank.resilience,
                    ...questionBank.incident,
                    ...questionBank.recovery
                ].sort(() => Math.random() - 0.5);
            } else {
                currentQuestions = [...questionBank[currentTopic]];
            }
            
            document.getElementById('questionContainer').classList.add('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            
            showQuestion();
        }

        function setupFlashcards() {
            let cards;
            if (currentTopic === 'mixed') {
                cards = [
                    ...flashcards.operations,
                    ...flashcards.resilience,
                    ...flashcards.incident,
                    ...flashcards.recovery
                ].sort(() => Math.random() - 0.5);
            } else {
                cards = [...flashcards[currentTopic]];
            }
            
            currentQuestions = cards;
            
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'flex';
            
            showFlashcard();
            
            document.getElementById('flashcard').addEventListener('click', flipCard);
        }

        function setupLearning() {
            let lessons;
            if (currentTopic === 'mixed') {
                lessons = [
                    ...learningContent.operations,
                    ...learningContent.resilience,
                    ...learningContent.incident,
                    ...learningContent.recovery
                ];
            } else {
                lessons = [...learningContent[currentTopic]];
            }
            
            currentQuestions = lessons;
            
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.add('active');
            document.getElementById('flashcard').style.display = 'none';
            
            showLearningContent();
        }

        function showQuestion() {
            if (currentQuestion >= currentQuestions.length) {
                showResults();
                return;
            }
            
            const question = currentQuestions[currentQuestion];
            
            document.getElementById('question').textContent = question.question;
            
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(optionElement);
            });
            
            // Reset answer status and explanation
            document.getElementById('answerStatus').style.display = 'none';
            document.getElementById('explanation').style.display = 'none';
            document.getElementById('explanation').classList.remove('show');
            
            document.getElementById('nextBtn').textContent = 'Submit Answer';
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            
            answerSubmitted = false;
            
            updateProgress();
        }

        function showFlashcard() {
            if (currentQuestion >= currentQuestions.length) {
                showResults();
                return;
            }
            
            const card = currentQuestions[currentQuestion];
            document.getElementById('cardContent').textContent = card.front;
            document.getElementById('flashcard').classList.remove('flipped');
            document.getElementById('cardControls').style.display = 'none';
            
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            
            if (currentQuestion === currentQuestions.length - 1) {
                document.getElementById('nextBtn').textContent = 'Complete Flashcards';
            } else {
                document.getElementById('nextBtn').textContent = `Next Card (${currentQuestion + 2}/${currentQuestions.length})`;
            }
            
            updateProgress();
        }

        function showLearningContent() {
            if (currentQuestion >= currentQuestions.length) {
                showResults();
                return;
            }
            
            const lesson = currentQuestions[currentQuestion];
            
            document.getElementById('learningTitle').textContent = lesson.title;
            document.getElementById('learningText').innerHTML = lesson.content;
            document.getElementById('learningExample').innerHTML = `<strong>💡 Practical Example:</strong><br>${lesson.example}`;
            
            if (currentQuestion === currentQuestions.length - 1) {
                document.getElementById('nextBtn').textContent = 'Complete Learning Module';
            } else {
                document.getElementById('nextBtn').textContent = `Next Lesson (${currentQuestion + 2}/${currentQuestions.length})`;
            }
            
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').disabled = false;
            
            updateProgress();
        }

        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            const card = currentQuestions[currentQuestion];
            
            if (flashcard.classList.contains('flipped')) {
                document.getElementById('cardContent').textContent = card.front;
                flashcard.classList.remove('flipped');
                document.getElementById('cardControls').style.display = 'none';
            } else {
                document.getElementById('cardContent').textContent = card.back;
                flashcard.classList.add('flipped');
                document.getElementById('cardControls').style.display = 'flex';
            }
        }

        function markCard(correct) {
            if (correct) {
                flashcardStats.correct++;
                score += 10;
            } else {
                flashcardStats.needPractice++;
                score += 5; // Partial credit for reviewing
            }
            updateScore();
            
            // Auto-advance to next card after marking
            setTimeout(() => {
                nextQuestion();
            }, 500);
        }

        function selectOption(index) {
            if (answerSubmitted) return;
            
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            document.querySelectorAll('.option')[index].classList.add('selected');
            document.getElementById('nextBtn').disabled = false;
            
            answeredQuestions[currentQuestion] = index;
        }

        function nextQuestion() {
            if (currentMode === 'flashcards') {
                currentQuestion++;
                if (currentQuestion >= currentQuestions.length) {
                    showResults();
                } else {
                    showFlashcard();
                }
                return;
            }
            
            if (currentMode === 'learn') {
                currentQuestion++;
                score += 10;
                updateScore();
                if (currentQuestion >= currentQuestions.length) {
                    showResults();
                } else {
                    showLearningContent();
                }
                return;
            }
            
            const question = currentQuestions[currentQuestion];
            const selectedAnswer = answeredQuestions[currentQuestion];
            
            if (!answerSubmitted) {
                // Submit answer
                const options = document.querySelectorAll('.option');
                const answerStatus = document.getElementById('answerStatus');
                
                // Disable all options
                options.forEach(opt => opt.style.pointerEvents = 'none');
                
                if (selectedAnswer === question.correct) {
                    options[selectedAnswer].classList.add('correct');
                    score += 10;
                    streak++;
                    answerStatus.className = 'answer-status correct';
                    answerStatus.textContent = '✓ Correct! Well done!';
                } else {
                    options[selectedAnswer].classList.add('incorrect');
                    options[question.correct].classList.add('correct');
                    streak = 0;
                    answerStatus.className = 'answer-status incorrect';
                    answerStatus.textContent = '✗ Incorrect. The correct answer is highlighted.';
                }
                
                answerStatus.style.display = 'block';
                
                // Show explanation with animation
                const explanationElement = document.getElementById('explanation');
                explanationElement.innerHTML = `<strong>Explanation:</strong><br>${question.explanation}`;
                explanationElement.style.display = 'block';
                
                // Force reflow before adding class for animation
                explanationElement.offsetHeight;
                explanationElement.classList.add('show');
                
                if (currentQuestion === currentQuestions.length - 1) {
                    document.getElementById('nextBtn').textContent = 'View Results';
                } else {
                    document.getElementById('nextBtn').textContent = 'Next Question';
                }
                
                answerSubmitted = true;
                updateScore();
                
            } else {
                // Move to next question
                currentQuestion++;
                if (currentQuestion >= currentQuestions.length) {
                    showResults();
                } else {
                    showQuestion();
                }
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                if (currentMode === 'flashcards') {
                    showFlashcard();
                } else if (currentMode === 'learn') {
                    showLearningContent();
                } else {
                    showQuestion();
                }
            }
        }

        function goBackToModes() {
            document.getElementById('gameMode').style.display = 'grid';
            document.getElementById('topicSelector').style.display = 'none';
            
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('active');
            });
            
            currentMode = '';
            currentTopic = '';
        }

        function goBackToTopics() {
            document.getElementById('topicSelector').style.display = 'block';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            
            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            currentTopic = '';
            currentQuestion = 0;
            score = 0;
            streak = 0;
            updateScore();
        }

        function updateScore() {
            document.getElementById('score').textContent = score;
            document.getElementById('streak').textContent = streak;
        }

        function updateProgress() {
            let progress;
            if (currentQuestion >= currentQuestions.length) {
                progress = 100;
            } else {
                progress = Math.round((currentQuestion / currentQuestions.length) * 100);
            }
            document.getElementById('progress').textContent = progress;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showResults() {
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            
            // Ensure progress shows 100% when complete
            updateProgress();
            
            document.getElementById('results').classList.add('show');
            
            let resultMessage = '';
            let detailedResults = '';
            let nextSteps = '';
            
            if (currentMode === 'flashcards') {
                resultMessage = `You reviewed ${currentQuestions.length} flashcards! Great job studying CISA Domain 4 concepts.`;
                detailedResults = `<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <strong>Flashcard Results:</strong><br>
                    ✓ Got it right: ${flashcardStats.correct} cards<br>
                    ⚠️ Need more practice: ${flashcardStats.needPractice} cards<br>
                    📊 Accuracy: ${flashcardStats.correct > 0 ? Math.round((flashcardStats.correct / (flashcardStats.correct + flashcardStats.needPractice)) * 100) : 0}%
                </div>`;
                nextSteps = " Try the quiz mode to test your knowledge or explore another topic area.";
                document.getElementById('finalScore').textContent = `${currentQuestions.length} Cards Reviewed`;
            } else if (currentMode === 'learn') {
                resultMessage = `You completed ${currentQuestions.length} comprehensive learning modules! You've gained deep insights into CISA Domain 4 concepts.`;
                nextSteps = " Consider testing your knowledge with quiz mode or reviewing key terms with flashcards.";
                document.getElementById('finalScore').textContent = `${currentQuestions.length} Modules Complete`;
            } else {
                const percentage = Math.round((score / (currentQuestions.length * 10)) * 100);
                const correctAnswers = answeredQuestions.filter((answer, index) => answer === currentQuestions[index].correct).length;
                
                document.getElementById('finalScore').textContent = `${percentage}%`;
                
                detailedResults = `<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <strong>Quiz Results:</strong><br>
                    ✓ Correct answers: ${correctAnswers} / ${currentQuestions.length}<br>
                    📊 Accuracy: ${percentage}%<br>
                    🔥 Best streak: ${Math.max(...[streak, 0])}<br>
                    📝 Mode: ${currentMode === 'scenario' ? 'Scenario-based' : 'Standard quiz'}
                </div>`;
                
                if (percentage >= 90) {
                    resultMessage = '🌟 Outstanding! You have excellent mastery of CISA Domain 4 concepts! You\'re well-prepared for this section of the exam.';
                    nextSteps = " Try another topic area or challenge yourself with scenario mode.";
                } else if (percentage >= 80) {
                    resultMessage = '🎉 Great job! You have a solid understanding of the material.';
                    nextSteps = " Review the explanations for missed questions and try another topic area to broaden your knowledge.";
                } else if (percentage >= 70) {
                    resultMessage = '👍 Good work! You\'re on the right track.';
                    nextSteps = " Use the learning modules to strengthen weak areas, then practice with flashcards before retrying.";
                } else {
                    resultMessage = '📚 Keep studying! This is a challenging certification.';
                    nextSteps = " Start with the learning modules to build your foundation, then practice with flashcards before attempting quizzes.";
                }
            }
            
            document.getElementById('resultMessage').textContent = resultMessage + nextSteps;
            document.getElementById('detailedResults').innerHTML = detailedResults;
        }

        function playAgain() {
            currentQuestion = 0;
            score = 0;
            streak = 0;
            answeredQuestions = [];
            flashcardStats = { correct: 0, needPractice: 0 };
            answerSubmitted = false;
            
            document.getElementById('results').classList.remove('show');
            document.getElementById('progressBar').style.display = 'block';
            document.getElementById('controls').style.display = 'flex';
            
            if (currentMode === 'quiz' || currentMode === 'scenario') {
                setupQuiz();
            } else if (currentMode === 'flashcards') {
                setupFlashcards();
            } else if (currentMode === 'learn') {
                setupLearning();
            }
            
            updateScore();
        }

        function goToMainScreen() {
            document.getElementById('gameMode').style.display = 'grid';
            document.getElementById('topicSelector').style.display = 'none';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            currentMode = '';
            currentTopic = '';
            currentQuestion = 0;
            answeredQuestions = [];
            
            updateScore();
            document.getElementById('progress').textContent = '0';
            document.getElementById('progressFill').style.width = '0%';
        }

        function chooseAnotherSection() {
            document.getElementById('gameMode').style.display = 'none';
            document.getElementById('topicSelector').style.display = 'block';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            
            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            currentTopic = '';
            currentQuestion = 0;
            answeredQuestions = [];
            
            updateScore();
            document.getElementById('progress').textContent = '0';
            document.getElementById('progressFill').style.width = '0%';
        }

        function resetGame() {
            document.getElementById('gameMode').style.display = 'grid';
            document.getElementById('topicSelector').style.display = 'none';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('questionContainer').classList.remove('active');
            document.getElementById('learningContainer').classList.remove('active');
            document.getElementById('flashcard').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            
            currentMode = '';
            currentTopic = '';
            currentQuestion = 0;
            score = 0;
            streak = 0;
            answeredQuestions = [];
            flashcardStats = { correct: 0, needPractice: 0 };
            answerSubmitted = false;
            
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            updateScore();
            document.getElementById('progress').textContent = '0';
            document.getElementById('progressFill').style.width = '0%';
        }

        // Initialize the game when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>