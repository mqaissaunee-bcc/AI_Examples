<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH Chapter 11: Hacking Wireless Networks - Interactive Learning Module</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #e0e0e0;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        h1 {
            color: #64ffda;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
        }

        h2 {
            color: #64ffda;
            margin: 30px 0 15px 0;
            font-size: 1.8em;
            border-bottom: 2px solid rgba(100, 255, 218, 0.3);
            padding-bottom: 10px;
        }

        h3 {
            color: #a8dadc;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .content-section {
            background: rgba(0, 0, 0, 0.4);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        .info-box {
            background: rgba(100, 255, 218, 0.1);
            border-left: 4px solid #64ffda;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .danger-box {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(135deg, #1e1e2e, #2d2d44);
            margin: 5% auto;
            padding: 30px;
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 10px;
            width: 90%;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #64ffda;
        }

        .simulator {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        .scan-result {
            background: rgba(100, 255, 218, 0.05);
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #64ffda;
        }

        .channel-display {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .channel {
            padding: 10px 15px;
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .channel:hover {
            background: rgba(100, 255, 218, 0.2);
            transform: scale(1.05);
        }

        .channel.overlapping {
            background: rgba(255, 193, 7, 0.1);
            border-color: rgba(255, 193, 7, 0.5);
        }

        .channel.optimal {
            background: rgba(76, 175, 80, 0.1);
            border-color: rgba(76, 175, 80, 0.5);
        }

        .standard-card {
            background: rgba(100, 255, 218, 0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(100, 255, 218, 0.2);
            transition: all 0.3s;
        }

        .standard-card:hover {
            background: rgba(100, 255, 218, 0.1);
            transform: translateX(5px);
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .quiz-question {
            background: rgba(100, 255, 218, 0.05);
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        .quiz-option {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 20px;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        .quiz-option:hover {
            background: rgba(100, 255, 218, 0.1);
            transform: translateX(5px);
        }

        .quiz-option.correct {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4caf50;
        }

        .quiz-option.incorrect {
            background: rgba(244, 67, 54, 0.2);
            border-color: #f44336;
        }

        .encryption-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .encryption-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }

        .security-meter {
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .security-level {
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s;
        }

        .security-low { background: #f44336; width: 30%; }
        .security-medium { background: #ffc107; width: 60%; }
        .security-high { background: #4caf50; width: 100%; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(100, 255, 218, 0.2);
        }

        th {
            background: rgba(100, 255, 218, 0.1);
            color: #64ffda;
            font-weight: bold;
        }

        tr:hover {
            background: rgba(100, 255, 218, 0.05);
        }

        .interactive-demo {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 5px;
            color: #e0e0e0;
            font-size: 1em;
        }

        .terminal {
            background: #000;
            color: #0f0;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .terminal-line {
            margin: 5px 0;
        }

        .animation-container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            min-height: 200px;
            position: relative;
        }

        .wave {
            position: absolute;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #64ffda, transparent);
            animation: waveMove 2s infinite;
        }

        @keyframes waveMove {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            color: #64ffda;
            border-bottom: 1px dotted #64ffda;
            font-weight: 500;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            max-width: 90vw;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #e0e0e0;
            text-align: left;
            border-radius: 8px;
            padding: 15px 18px;
            position: fixed;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            border: 2px solid #64ffda;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(100, 255, 218, 0.1);
            font-size: 0.95em;
            line-height: 1.6;
            pointer-events: none;
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #64ffda rgba(0, 0, 0, 0.3);
        }

        /* Custom scrollbar for tooltips */
        .tooltip .tooltiptext::-webkit-scrollbar {
            width: 6px;
        }

        .tooltip .tooltiptext::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        .tooltip .tooltiptext::-webkit-scrollbar-thumb {
            background: #64ffda;
            border-radius: 3px;
        }

        .tooltip .tooltiptext::-webkit-scrollbar-thumb:hover {
            background: #52ccb8;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            border-width: 8px;
            border-style: solid;
        }

        /* Tooltip appears above by default */
        .tooltip .tooltiptext {
            bottom: auto;
        }

        /* Arrow points down when tooltip is above */
        .tooltip .tooltiptext::after {
            top: 100%;
            left: 50%;
            margin-left: -8px;
            border-color: #64ffda transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .tooltip-term {
            color: #64ffda;
            font-weight: 500;
            border-bottom: 1px dotted #64ffda;
            cursor: help;
        }

        /* Ensure modal content can scroll to show tooltips */
        .modal-content {
            overflow-y: auto;
            max-height: 85vh;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.4em; }
            .nav-buttons { flex-direction: column; }
            .modal-content { width: 95%; margin: 10% auto; }
            .tooltip .tooltiptext { width: 250px; max-width: 90vw; }
        }
    </style>
</head>
<body>
    <script>
        // Dynamic tooltip positioning to prevent cutoff
        document.addEventListener('DOMContentLoaded', function() {
            const tooltips = document.querySelectorAll('.tooltip');
            
            tooltips.forEach(tooltip => {
                const tooltipText = tooltip.querySelector('.tooltiptext');
                if (!tooltipText) return;
                
                tooltip.addEventListener('mouseenter', function(e) {
                    // Get tooltip and viewport dimensions
                    const rect = tooltip.getBoundingClientRect();
                    const tooltipRect = tooltipText.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    
                    // Calculate position
                    let top = rect.top - tooltipRect.height - 15;
                    let left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                    
                    // Adjust horizontal position if cut off
                    if (left < 10) {
                        left = 10;
                    } else if (left + tooltipRect.width > viewportWidth - 10) {
                        left = viewportWidth - tooltipRect.width - 10;
                    }
                    
                    // If tooltip would be cut off at top, position it below instead
                    if (top < 10) {
                        top = rect.bottom + 15;
                        // Change arrow direction
                        tooltipText.style.setProperty('--arrow-position', 'top');
                    } else {
                        tooltipText.style.setProperty('--arrow-position', 'bottom');
                    }
                    
                    // Apply position
                    tooltipText.style.top = top + 'px';
                    tooltipText.style.left = left + 'px';
                    tooltipText.style.transform = 'none';
                });
            });
        });
    </script>
    <div class="container">
        <header>
            <h1>üîê CEH Chapter 11: Hacking Wireless Networks</h1>
            <p style="font-size: 1.2em; margin-top: 10px;">Interactive Learning Companion</p>
            <p style="margin-top: 15px; color: #a8dadc;">Master wireless network security through hands-on demonstrations and practical exercises</p>
        </header>

        <div class="content-section">
            <h2>üì° Learning Progress</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
            </div>
            <p style="text-align: center; margin-top: 10px;">Complete all sections and quizzes to track your progress</p>
        </div>

        <div class="nav-buttons">
            <button class="btn" onclick="openModal('wirelessBasicsModal')">üì∂ Wireless Basics</button>
            <button class="btn" onclick="openModal('standardsModal')">üìã 802.11 Standards</button>
            <button class="btn" onclick="openModal('authenticationModal')">üîë Authentication</button>
            <button class="btn" onclick="openModal('wardrivingModal')">üöó Wardriving</button>
            <button class="btn" onclick="openModal('hackingModal')">üíª Wireless Hacking</button>
            <button class="btn" onclick="openModal('advancedAttacksModal')">‚öîÔ∏è Advanced Attacks</button>
            <button class="btn" onclick="openModal('bluetoothModal')">üì± Bluetooth Security</button>
            <button class="btn" onclick="openModal('defenseModal')">üõ°Ô∏è Defense & Detection</button>
            <button class="btn" onclick="openModal('analysisModal')">üîç Packet Analysis</button>
            <button class="btn" onclick="openModal('labsModal')">üß™ Hands-On Labs</button>
            <button class="btn btn-success" onclick="openModal('simulatorModal')">üéØ Network Scanner</button>
            <button class="btn btn-warning" onclick="openModal('quizModal')">üìù Assessment</button>
        </div>

        <!-- Wireless Basics Modal -->
        <div id="wirelessBasicsModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('wirelessBasicsModal')">&times;</span>
                <h2>üì∂ Wireless Networking Fundamentals</h2>
                
                <h3>Core Components</h3>
                <div class="info-box">
                    <strong>Essential Elements for Wireless Networks:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Wireless NICs (WNICs)</strong> - Transmit and receive radio signals</li>
                        <li><strong>Access Points (APs)</strong> - Bridge between wired and wireless networks</li>
                        <li><strong>Wireless Protocols</strong> - Define communication standards</li>
                        <li><strong>RF Spectrum</strong> - Radio frequency bands for transmission</li>
                    </ul>
                </div>

                <h3>üéØ Access Points (APs)</h3>
                <div class="standard-card">
                    <strong>Function:</strong> Radio transceivers connecting wireless devices to wired networks
                    <br><br>
                    <strong>Key Responsibilities:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Configure <span class="tooltip">RF channels<span class="tooltiptext">Radio Frequency channels: Specific frequency ranges within 2.4 GHz or 5 GHz bands used for wireless communication. Proper channel selection minimizes interference.</span></span></li>
                        <li>Manage wireless authentication</li>
                        <li>Bridge <span class="tooltip">WLAN<span class="tooltiptext">Wireless Local Area Network: Network that uses radio waves instead of cables to connect devices within a limited area like office or home.</span></span> to wired LAN</li>
                        <li>Define <span class="tooltip">BSA<span class="tooltiptext">Basic Service Area: The physical area covered by an access point's radio signal where clients can maintain connection.</span></span></li>
                    </ul>
                </div>

                <h3>üì° Service Set Identifier (SSID)</h3>
                <div class="interactive-demo">
                    <p><strong>SSID Characteristics:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>1-32 character alphanumeric name</li>
                        <li>Case-sensitive</li>
                        <li>Identifies specific WLAN</li>
                        <li>Broadcast by AP (can be hidden)</li>
                    </ul>
                    
                    <div class="warning-box" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è Security Warning:</strong> Many vendors use default SSIDs (e.g., "linksys", "NETGEAR"). 
                        Default SSIDs indicate poor security practices and make networks easy targets for attackers.
                    </div>
                </div>

                <h3>üìª RF Spectrum & Channels</h3>
                <div class="simulator">
                    <p><strong>2.4 GHz Band (802.11b/g/n):</strong></p>
                    <div class="channel-display">
                        <div class="channel optimal" onclick="showChannelInfo(1)">Channel 1<br>2.412 GHz</div>
                        <div class="channel overlapping">Channel 2<br>2.417 GHz</div>
                        <div class="channel overlapping">Channel 3<br>2.422 GHz</div>
                        <div class="channel overlapping">Channel 4<br>2.427 GHz</div>
                        <div class="channel overlapping">Channel 5<br>2.432 GHz</div>
                        <div class="channel optimal" onclick="showChannelInfo(6)">Channel 6<br>2.437 GHz</div>
                        <div class="channel overlapping">Channel 7<br>2.442 GHz</div>
                        <div class="channel overlapping">Channel 8<br>2.447 GHz</div>
                        <div class="channel overlapping">Channel 9<br>2.452 GHz</div>
                        <div class="channel overlapping">Channel 10<br>2.457 GHz</div>
                        <div class="channel optimal" onclick="showChannelInfo(11)">Channel 11<br>2.462 GHz</div>
                    </div>
                    <div class="info-box">
                        <strong>üéØ Non-Overlapping Channels:</strong> Only channels 1, 6, and 11 can be used simultaneously without interference.
                        Click on green (optimal) channels for more information.
                    </div>
                    <div id="channelInfo" style="margin-top: 15px;"></div>
                </div>

                <h3>üåä Wireless Technologies</h3>
                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Infrared (IR)</h4>
                        <p><strong>Range:</strong> Line of sight only</p>
                        <p><strong>Use:</strong> Remote controls, IrDA</p>
                        <p><strong>Limitation:</strong> Cannot penetrate walls</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Narrowband</h4>
                        <p><strong>Range:</strong> Microwave frequencies</p>
                        <p><strong>Use:</strong> Cordless phones, garage openers</p>
                        <p><strong>Limitation:</strong> Susceptible to interference</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Spread Spectrum</h4>
                        <p><strong>Range:</strong> Wide frequency band</p>
                        <p><strong>Use:</strong> Wi-Fi, Bluetooth</p>
                        <p><strong>Advantage:</strong> Resistant to interference</p>
                    </div>
                </div>

                <h3>üìä Spread Spectrum Methods</h3>
                <table>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                        <th>Usage</th>
                    </tr>
                    <tr>
                        <td><strong><span class="tooltip">FHSS<span class="tooltiptext">Frequency Hopping Spread Spectrum: Rapidly switches carrier frequencies in a pseudo-random sequence, making it resistant to interference and eavesdropping.</span></span></strong></td>
                        <td>Frequency Hopping Spread Spectrum</td>
                        <td>Bluetooth, older 802.11</td>
                    </tr>
                    <tr>
                        <td><strong><span class="tooltip">DSSS<span class="tooltiptext">Direct Sequence Spread Spectrum: Spreads signal over wider frequency band using a chipping code, providing interference resistance and multiple access capability.</span></span></strong></td>
                        <td>Direct Sequence Spread Spectrum</td>
                        <td>802.11b</td>
                    </tr>
                    <tr>
                        <td><strong><span class="tooltip">OFDM<span class="tooltiptext">Orthogonal Frequency Division Multiplexing: Divides channel into multiple sub-carriers, allowing parallel data transmission and better resistance to interference. Key technology in modern Wi-Fi.</span></span></strong></td>
                        <td>Orthogonal Frequency Division Multiplexing</td>
                        <td>802.11a/g/ac</td>
                    </tr>
                    <tr>
                        <td><strong><span class="tooltip">OFDMA<span class="tooltiptext">Orthogonal Frequency Division Multiple Access: Extension of OFDM that allows multiple users to share channel simultaneously, improving efficiency in dense environments. Used in Wi-Fi 6.</span></span></strong></td>
                        <td>OFDM Access</td>
                        <td>802.11ax (Wi-Fi 6)</td>
                    </tr>
                </table>

                <button class="btn" onclick="markSectionComplete('basics'); closeModal('wirelessBasicsModal')">Mark Complete</button>
            </div>
        </div>

        <!-- 802.11 Standards Modal -->
        <div id="standardsModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('standardsModal')">&times;</span>
                <h2>üìã 802.11 Wireless Standards</h2>
                
                <h3>üèóÔ∏è Standard Architecture</h3>
                <div class="info-box">
                    <strong>IEEE 802.11 Framework:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>BSS</strong> - Basic Service Set: Collection of devices in a WLAN</li>
                        <li><strong>BSA</strong> - Basic Service Area: Coverage area provided by AP</li>
                        <li><strong>DS</strong> - Distribution System: Connects multiple BSSs</li>
                        <li><strong>STA</strong> - Station: Any wireless network device</li>
                    </ul>
                </div>

                <h3>üì∂ Evolution of 802.11 Standards</h3>
                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11 (Original - 1997)</h4>
                    <strong>Frequency:</strong> 2.4 GHz<br>
                    <strong>Speed:</strong> 1-2 Mbps<br>
                    <strong>Technology:</strong> FHSS/DSSS<br>
                    <strong>Status:</strong> Obsolete
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11b (Wi-Fi - 1999)</h4>
                    <strong>Frequency:</strong> 2.4 GHz<br>
                    <strong>Speed:</strong> 11 Mbps<br>
                    <strong>Channels:</strong> 11 (USA), 3 non-overlapping<br>
                    <strong>Security:</strong> Introduced WEP<br>
                    <strong>Key Feature:</strong> First mainstream Wi-Fi standard
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11a (1999)</h4>
                    <strong>Frequency:</strong> 5 GHz<br>
                    <strong>Speed:</strong> 54 Mbps<br>
                    <strong>Technology:</strong> OFDM<br>
                    <strong>Advantage:</strong> Less interference, more channels
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11g (2003)</h4>
                    <strong>Frequency:</strong> 2.4 GHz<br>
                    <strong>Speed:</strong> 54 Mbps<br>
                    <strong>Technology:</strong> OFDM<br>
                    <strong>Compatibility:</strong> Backward compatible with 802.11b
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11n (Wi-Fi 4 - 2009)</h4>
                    <strong>Frequency:</strong> 2.4 GHz & 5 GHz (dual-band)<br>
                    <strong>Speed:</strong> Up to 600 Mbps<br>
                    <strong>Technology:</strong> <span class="tooltip">MIMO<span class="tooltiptext">Multiple Input Multiple Output: Uses multiple antennas at both transmitter and receiver to increase data throughput and improve signal reliability through spatial multiplexing.</span></span> (Multiple Input Multiple Output)<br>
                    <strong>Key Feature:</strong> Multiple antennas, wider channels (40 MHz)
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11ac (Wi-Fi 5 - 2013)</h4>
                    <strong>Frequency:</strong> 5 GHz<br>
                    <strong>Speed:</strong> Up to 1 Gbps (6.9 Gbps theoretical)<br>
                    <strong>Technology:</strong> <span class="tooltip">MU-MIMO<span class="tooltiptext">Multi-User MIMO: Allows access point to communicate with multiple devices simultaneously rather than sequentially, dramatically improving network efficiency in multi-device environments.</span></span>, <span class="tooltip">beamforming<span class="tooltiptext">Technique that focuses wireless signal directly toward client devices rather than broadcasting in all directions, improving signal strength and reducing interference.</span></span><br>
                    <strong>Channels:</strong> 20/40/80/160 MHz wide
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11ax (Wi-Fi 6 - 2019) ‚≠ê</h4>
                    <strong>Frequency:</strong> 2.4 GHz & 5 GHz<br>
                    <strong>Speed:</strong> Up to 10 Gbps<br>
                    <strong>Technology:</strong> OFDMA, 1024-QAM<br>
                    <strong>Benefits:</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Better performance in congested environments</li>
                        <li>Lower power consumption</li>
                        <li>Enhanced security (WPA3)</li>
                        <li>Target Wake Time (TWT) for IoT devices</li>
                    </ul>
                </div>

                <h3>üåê Other 802 Standards</h3>
                <table>
                    <tr>
                        <th>Standard</th>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>802.15</strong></td>
                        <td>WPAN</td>
                        <td>Wireless Personal Area Network (Bluetooth)</td>
                    </tr>
                    <tr>
                        <td><strong>802.16</strong></td>
                        <td>WiMAX</td>
                        <td>Wireless MAN for longer distances</td>
                    </tr>
                    <tr>
                        <td><strong>802.20</strong></td>
                        <td>MBWA</td>
                        <td>Mobile Broadband for high-speed travel</td>
                    </tr>
                    <tr>
                        <td><strong>802.1X</strong></td>
                        <td>Authentication</td>
                        <td>Port-based network access control</td>
                    </tr>
                </table>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Security Professional Note:</strong> Always verify which 802.11 standard your target network uses. 
                    Older standards (802.11b/g) may have weaker security implementations and are easier to attack.
                </div>

                <button class="btn" onclick="markSectionComplete('standards'); closeModal('standardsModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Authentication Modal -->
        <div id="authenticationModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('authenticationModal')">&times;</span>
                <h2>üîë Wireless Authentication & Encryption</h2>
                
                <h3>üîê Authentication Protocols</h3>
                
                <div class="standard-card">
                    <h4 style="color: #64ffda;">PPP (Point-to-Point Protocol)</h4>
                    <p><strong>Use Case:</strong> Dial-up and DSL connections</p>
                    <p><strong>Function:</strong> Basic username/password authentication</p>
                    <p><strong>Security Level:</strong> <span class="security-meter"><span class="security-level security-low"></span></span></p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">EAP (Extensible Authentication Protocol)</h4>
                    <p><strong>Function:</strong> Framework for multiple authentication methods</p>
                    <p><strong>Key Feature:</strong> Company can select authentication method</p>
                    
                    <div class="info-box" style="margin-top: 15px;">
                        <strong>How EAP Works:</strong>
                        <ol style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Initiation:</strong> Client (supplicant) connects to AP and begins authentication</li>
                            <li><strong>Identity Request:</strong> AP requests client identity</li>
                            <li><strong>Method Negotiation:</strong> Client and authentication server agree on EAP method</li>
                            <li><strong>Authentication Exchange:</strong> Credentials exchanged based on chosen method</li>
                            <li><strong>Success/Failure:</strong> Server sends EAP-Success or EAP-Failure</li>
                            <li><strong>Key Distribution:</strong> If successful, encryption keys distributed to client</li>
                        </ol>
                    </div>

                    <p style="margin-top: 15px;"><strong>Common Variants:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong><span class="tooltip">EAP-TLS<span class="tooltiptext">EAP-Transport Layer Security: Uses X.509 certificates for both client and server authentication. Most secure but requires PKI infrastructure.</span></span>:</strong> Uses certificates, strongest security
                            <div class="terminal" style="margin-top: 5px;">
                                <div class="terminal-line">1. Client ‚Üí Server: TLS ClientHello</div>
                                <div class="terminal-line">2. Server ‚Üí Client: Certificate + ServerHello</div>
                                <div class="terminal-line">3. Client ‚Üí Server: Certificate + ClientKeyExchange</div>
                                <div class="terminal-line">4. Mutual authentication via certificate validation</div>
                                <div class="terminal-line">5. Secure tunnel established</div>
                            </div>
                        </li>
                        <li style="margin-top: 10px;"><strong><span class="tooltip">PEAP<span class="tooltiptext">Protected EAP: Creates encrypted TLS tunnel first, then authenticates user credentials inside tunnel. Only server certificate required.</span></span>:</strong> Protected EAP with TLS tunnel
                            <div class="terminal" style="margin-top: 5px;">
                                <div class="terminal-line">Phase 1: Establish TLS tunnel (server cert only)</div>
                                <div class="terminal-line">Phase 2: Client authentication inside tunnel</div>
                                <div class="terminal-line">  - Commonly uses MS-CHAPv2 or EAP-GTC</div>
                                <div class="terminal-line">  - Credentials protected by outer TLS tunnel</div>
                            </div>
                        </li>
                        <li style="margin-top: 10px;"><strong><span class="tooltip">EAP-TTLS<span class="tooltiptext">EAP-Tunneled TLS: Similar to PEAP but more flexible, supporting various inner authentication methods including PAP and CHAP.</span></span>:</strong> Tunneled TLS for legacy support</li>
                        <li><strong><span class="tooltip">EAP-FAST<span class="tooltiptext">EAP-Flexible Authentication via Secure Tunneling: Cisco-developed method using PACs (Protected Access Credentials) instead of certificates.</span></span>:</strong> Cisco's fast authentication method</li>
                    </ul>
                </div>

                <div class="info-box">
                    <strong>802.1X Components in Detail:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong><span class="tooltip">Supplicant<span class="tooltiptext">The client device requesting access. Software on device handles EAP protocol negotiation and credential presentation.</span></span>:</strong> The client device requesting access
                            <ul style="margin-left: 20px;">
                                <li>Initiates authentication process</li>
                                <li>Presents credentials to network</li>
                                <li>Implements EAP method client-side</li>
                                <li>Examples: Windows WiFi client, wpa_supplicant (Linux)</li>
                            </ul>
                        </li>
                        <li style="margin-top: 10px;"><strong><span class="tooltip">Authenticator<span class="tooltiptext">The access point acting as gatekeeper. Forwards authentication traffic between supplicant and authentication server without making decisions.</span></span>:</strong> The access point (middleman)
                            <ul style="margin-left: 20px;">
                                <li>Relays authentication messages</li>
                                <li>Enforces port-based access control</li>
                                <li>Blocks/allows traffic based on auth server decision</li>
                                <li>Does NOT make authentication decision</li>
                            </ul>
                        </li>
                        <li style="margin-top: 10px;"><strong><span class="tooltip">Authentication Server<span class="tooltiptext">RADIUS server making final authentication decision. Validates credentials against database and instructs AP to allow or deny access.</span></span>:</strong> RADIUS server making access decisions
                            <ul style="margin-left: 20px;">
                                <li>Validates user credentials</li>
                                <li>Checks authorization policies</li>
                                <li>Sends Access-Accept or Access-Reject</li>
                                <li>May provide additional info (VLAN assignment, bandwidth limits)</li>
                                <li>Examples: FreeRADIUS, Microsoft NPS, Cisco ISE</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <h3>üîÑ Complete 802.1X Authentication Flow</h3>
                <div class="standard-card">
                    <h4 style="color: #64ffda;">Detailed Step-by-Step Process</h4>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line" style="color: #ffc107;">‚ïê‚ïê‚ïê Phase 1: Connection Initiation ‚ïê‚ïê‚ïê</div>
                        <div class="terminal-line">1. Client associates with AP (Open System authentication)</div>
                        <div class="terminal-line">   - No encryption yet, just physical layer connection</div>
                        <div class="terminal-line">   - Port is in "unauthorized" state</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line" style="color: #ffc107;">‚ïê‚ïê‚ïê Phase 2: EAP Exchange ‚ïê‚ïê‚ïê</div>
                        <div class="terminal-line">2. AP ‚Üí Client: EAP-Request/Identity</div>
                        <div class="terminal-line">   "Who are you?"</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">3. Client ‚Üí AP ‚Üí RADIUS: EAP-Response/Identity</div>
                        <div class="terminal-line">   "I am user@example.com"</div>
                        <div class="terminal-line">   - AP encapsulates in RADIUS Access-Request</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">4. RADIUS ‚Üí AP ‚Üí Client: EAP-Request/Auth Method</div>
                        <div class="terminal-line">   "Prove it using EAP-TLS/PEAP/TTLS"</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line" style="color: #ffc107;">‚ïê‚ïê‚ïê Phase 3: Credential Verification ‚ïê‚ïê‚ïê</div>
                        <div class="terminal-line">5. Client ‚Üí AP ‚Üí RADIUS: EAP-Response/Credentials</div>
                        <div class="terminal-line">   - For EAP-TLS: Client certificate</div>
                        <div class="terminal-line">   - For PEAP: Username/password inside TLS tunnel</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">6. RADIUS validates credentials against database</div>
                        <div class="terminal-line">   - Checks username/password OR</div>
                        <div class="terminal-line">   - Validates certificate against CA</div>
                        <div class="terminal-line">   - Applies authorization policies</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line" style="color: #ffc107;">‚ïê‚ïê‚ïê Phase 4: Decision & Key Distribution ‚ïê‚ïê‚ïê</div>
                        <div class="terminal-line">7. If VALID: RADIUS ‚Üí AP: Access-Accept + encryption keys</div>
                        <div class="terminal-line">   If INVALID: RADIUS ‚Üí AP: Access-Reject</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">8. AP ‚Üí Client: EAP-Success (if accepted)</div>
                        <div class="terminal-line">   - Port changes to "authorized" state</div>
                        <div class="terminal-line">   - Encryption keys distributed</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line" style="color: #0f0;">9. Client can now access network resources!</div>
                        <div class="terminal-line">   - All traffic encrypted with distributed keys</div>
                    </div>
                </div>

                <h3>üîê RADIUS Protocol Deep Dive</h3>
                <div class="standard-card">
                    <h4 style="color: #64ffda;">How RADIUS Works with 802.1X</h4>
                    
                    <p><strong><span class="tooltip">RADIUS<span class="tooltiptext">Remote Authentication Dial-In User Service: Client-server protocol providing centralized authentication, authorization, and accounting (AAA) for network access.</span></span> Packet Flow:</strong></p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line">AP ‚Üí RADIUS Server (UDP port 1812)</div>
                        <div class="terminal-line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
                        <div class="terminal-line">‚îÇ RADIUS Access-Request               ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ Username                         ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ NAS-IP-Address (AP address)      ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ NAS-Port (physical port)         ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ EAP-Message (encapsulated)       ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îî‚îÄ Message-Authenticator (integrity)‚îÇ</div>
                        <div class="terminal-line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">RADIUS Server ‚Üí AP (UDP port 1812)</div>
                        <div class="terminal-line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
                        <div class="terminal-line">‚îÇ RADIUS Access-Accept                ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ EAP-Message (EAP-Success)        ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ MS-MPPE-Send-Key (encryption)    ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ MS-MPPE-Recv-Key (encryption)    ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ Tunnel-Type (VLAN assignment)    ‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îú‚îÄ Tunnel-Private-Group-ID (VLAN ID)‚îÇ</div>
                        <div class="terminal-line">‚îÇ ‚îî‚îÄ Session-Timeout (optional)       ‚îÇ</div>
                        <div class="terminal-line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
                    </div>

                    <div class="info-box" style="margin-top: 15px;">
                        <strong>RADIUS Attributes Used in Wireless:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>User-Name (1):</strong> Client identity</li>
                            <li><strong>NAS-IP-Address (4):</strong> AP's IP address</li>
                            <li><strong>NAS-Port (5):</strong> Physical or logical port</li>
                            <li><strong>Service-Type (6):</strong> Type of service requested</li>
                            <li><strong>Called-Station-Id (30):</strong> AP's MAC (BSSID)</li>
                            <li><strong>Calling-Station-Id (31):</strong> Client's MAC address</li>
                            <li><strong>NAS-Identifier (32):</strong> AP name/identifier</li>
                            <li><strong>Tunnel-Type (64):</strong> VLAN tunneling</li>
                            <li><strong>Tunnel-Private-Group-ID (81):</strong> VLAN assignment</li>
                            <li><strong>EAP-Message (79):</strong> Encapsulated EAP packets</li>
                            <li><strong>Message-Authenticator (80):</strong> Integrity check</li>
                        </ul>
                    </div>
                </div>

                <h3>üîí Wireless Encryption Standards</h3>
                
                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #f44336;">WEP (Wired Equivalent Privacy)</h4>
                        <div class="security-meter">
                            <div class="security-level security-low"></div>
                        </div>
                        <p><strong>Standard:</strong> 802.11b (1999)</p>
                        <p><strong>Encryption:</strong> RC4 (40/104-bit)</p>
                        <p><strong>Status:</strong> ‚ùå BROKEN</p>
                        <br>
                        <div class="danger-box">
                            <strong>Critical Vulnerabilities:</strong>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>Weak IV (Initialization Vector)</li>
                                <li>No packet integrity</li>
                                <li>Can be cracked in minutes</li>
                            </ul>
                        </div>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #ffc107;">WPA (Wi-Fi Protected Access)</h4>
                        <div class="security-meter">
                            <div class="security-level security-medium"></div>
                        </div>
                        <p><strong>Standard:</strong> 802.11i draft (2003)</p>
                        <p><strong>Encryption:</strong> TKIP + RC4</p>
                        <p><strong>Status:</strong> ‚ö†Ô∏è Deprecated</p>
                        <br>
                        <p><strong>TKIP Enhancements:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>MIC (Message Integrity Check)</li>
                            <li>Extended IV with sequencing</li>
                            <li>Per-packet key mixing</li>
                            <li>Rekeying mechanism</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">WPA2</h4>
                        <div class="security-meter">
                            <div class="security-level security-high"></div>
                        </div>
                        <p><strong>Standard:</strong> 802.11i (2004)</p>
                        <p><strong>Encryption:</strong> AES-CCMP</p>
                        <p><strong>Status:</strong> ‚úÖ Strong (with caveats)</p>
                        <br>
                        <p><strong>Improvements:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>AES encryption (128-bit)</li>
                            <li>CCMP for data confidentiality</li>
                            <li>Strong authentication</li>
                        </ul>
                        <div class="warning-box" style="margin-top: 10px;">
                            <strong>‚ö†Ô∏è KRACK Vulnerability:</strong> WPA2 vulnerable to key reinstallation attacks. Update devices!
                        </div>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #00ff00;">WPA3 ‚≠ê</h4>
                        <div class="security-meter">
                            <div class="security-level security-high"></div>
                        </div>
                        <p><strong>Released:</strong> 2018</p>
                        <p><strong>Encryption:</strong> AES-256 (Enterprise)</p>
                        <p><strong>Status:</strong> ‚úÖ Current Best Practice</p>
                        <br>
                        <p><strong>Key Features:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li><strong>SAE:</strong> Simultaneous Authentication of Equals</li>
                            <li>Protection against brute-force attacks</li>
                            <li>Forward secrecy</li>
                            <li>192-bit security (Enterprise)</li>
                            <li>Easy Connect for IoT devices</li>
                        </ul>
                        <div class="warning-box" style="margin-top: 10px;">
                            <strong>‚ö†Ô∏è Known Issue:</strong> Susceptible to timing-based side-channel attacks. Ensure firmware is updated.
                        </div>
                    </div>
                </div>

                <h3>‚ö° WPS (Wi-Fi Protected Setup)</h3>
                <div class="danger-box">
                    <strong>üö® Security Risk: DISABLE WPS!</strong>
                    <p style="margin-top: 10px;"><strong>Purpose:</strong> Easy device pairing via push-button or PIN</p>
                    <p><strong>Problem:</strong> 8-digit PIN can be brute-forced in hours</p>
                    <p><strong>Attack:</strong> Reaver, Pixie Dust attack</p>
                    <p><strong>Recommendation:</strong> Always disable WPS in production environments</p>
                </div>

                <h3>üéØ Authentication Flow Demo</h3>
                <div class="terminal">
                    <div class="terminal-line">[Client] ‚Üí AP: EAPOL-Start (Authentication request)</div>
                    <div class="terminal-line">[AP] ‚Üí Client: EAP-Request Identity</div>
                    <div class="terminal-line">[Client] ‚Üí AP: EAP-Response Identity (username)</div>
                    <div class="terminal-line">[AP] ‚Üí RADIUS: Access-Request (forward credentials)</div>
                    <div class="terminal-line">[RADIUS] ‚Üí AP: Access-Challenge (request more info)</div>
                    <div class="terminal-line">[AP] ‚Üí Client: EAP-Request (challenge)</div>
                    <div class="terminal-line">[Client] ‚Üí AP: EAP-Response (challenge response)</div>
                    <div class="terminal-line">[AP] ‚Üí RADIUS: Access-Request (validate response)</div>
                    <div class="terminal-line">[RADIUS] ‚Üí AP: Access-Accept (authentication successful)</div>
                    <div class="terminal-line">[AP] ‚Üí Client: EAP-Success + Encryption keys</div>
                    <div class="terminal-line" style="color: #0f0;">[‚úì] Client authenticated and connected!</div>
                </div>

                <button class="btn" onclick="markSectionComplete('authentication'); closeModal('authenticationModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Wardriving Modal -->
        <div id="wardrivingModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('wardrivingModal')">&times;</span>
                <h2>üöó Wardriving & Wireless Reconnaissance</h2>
                
                <div class="warning-box">
                    <strong>‚ö†Ô∏è Legal Notice:</strong> Wardriving (scanning for wireless networks) is generally legal. 
                    However, <strong>accessing</strong> networks without authorization is illegal. This information is for 
                    authorized security testing only.
                </div>

                <h3>üéØ What is Wardriving?</h3>
                <div class="info-box">
                    <strong>Definition:</strong> The act of searching for Wi-Fi wireless networks by driving around with a 
                    laptop, smartphone, or portable device equipped with wireless scanning software.
                    <br><br>
                    <strong>Origin:</strong> Term derived from "WarDialing" (phone line scanning popularized in the 1983 film "WarGames")
                </div>

                <h3>üõ†Ô∏è Equipment Needed</h3>
                <div class="standard-card">
                    <strong>Basic Wardriving Kit:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Laptop or Smartphone:</strong> Running scanning software</li>
                        <li><strong>Compatible WNIC:</strong> Not all adapters work with monitoring mode
                            <ul style="margin-left: 20px;">
                                <li>‚úÖ Alfa AWUS036ACH (popular choice)</li>
                                <li>‚úÖ TP-Link TL-WN722N v1 (not v2/v3!)</li>
                                <li>‚úÖ Panda Wireless PAU09</li>
                            </ul>
                        </li>
                        <li><strong>External Antenna (Optional):</strong> Increases range
                            <ul style="margin-left: 20px;">
                                <li>Omnidirectional: 360¬∞ coverage</li>
                                <li>Directional (Yagi): Long-range, targeted</li>
                                <li>Typical range: 350 feet (standard) to several miles (high-gain)</li>
                            </ul>
                        </li>
                        <li><strong>GPS Device (Optional):</strong> Map network locations</li>
                        <li><strong>Power source:</strong> Mobile battery pack</li>
                    </ol>
                </div>

                <h3>üíª Popular Wardriving Tools</h3>
                
                <div class="standard-card">
                    <h4 style="color: #64ffda;">Kismet</h4>
                    <p><strong>Platform:</strong> Linux, BSD, macOS</p>
                    <p><strong>Type:</strong> Wireless network detector, sniffer, and IDS</p>
                    <p><strong>Features:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Detects 802.11a/b/g/n/ac/ax networks</li>
                        <li>Hidden SSID detection</li>
                        <li>Client/server architecture</li>
                        <li>GPS integration for mapping</li>
                        <li>Wireshark/Tcpdump compatible logging</li>
                        <li>Intrusion detection capabilities</li>
                        <li>Manufacturer identification</li>
                    </ul>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Start Kismet</div>
                        <div class="terminal-line">$ sudo kismet -c wlan0</div>
                        <div class="terminal-line"># Access web interface at http://localhost:2501</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Vistumbler</h4>
                    <p><strong>Platform:</strong> Windows</p>
                    <p><strong>Type:</strong> Freeware WLAN scanner</p>
                    <p><strong>Detects:</strong> 802.11a/b/g/n/ac networks</p>
                    <p><strong>Features:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>GPS integration for geolocation</li>
                        <li>Real-time network discovery</li>
                        <li>Export to KML (Google Earth)</li>
                        <li>Detect unauthorized APs</li>
                        <li>Signal strength monitoring</li>
                        <li>Encryption type detection</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Other Notable Tools</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>WiGLE WiFi (Android/iOS):</strong> Mobile wardriving app with global AP database</li>
                        <li><strong>NetStumbler (Legacy):</strong> Windows tool (802.11b/g only, deprecated)</li>
                        <li><strong>inSSIDer:</strong> Commercial Wi-Fi scanner with spectrum analysis</li>
                        <li><strong>WiFi Analyzer (Android):</strong> Simple signal strength and channel analyzer</li>
                    </ul>
                </div>

                <h3>üìä Information Gathered by Wardriving</h3>
                <table>
                    <tr>
                        <th>Data Point</th>
                        <th>Security Implication</th>
                    </tr>
                    <tr>
                        <td>SSID</td>
                        <td>Network identifier; default SSIDs indicate poor security</td>
                    </tr>
                    <tr>
                        <td>MAC Address</td>
                        <td>Hardware identifier; reveals manufacturer</td>
                    </tr>
                    <tr>
                        <td>Encryption Type</td>
                        <td>WEP = easy target; Open = no protection</td>
                    </tr>
                    <tr>
                        <td>Channel</td>
                        <td>Frequency being used; helps avoid interference</td>
                    </tr>
                    <tr>
                        <td>Signal Strength</td>
                        <td>Indicates proximity to AP</td>
                    </tr>
                    <tr>
                        <td>Manufacturer</td>
                        <td>May reveal known vulnerabilities</td>
                    </tr>
                    <tr>
                        <td>GPS Coordinates</td>
                        <td>Physical location of AP</td>
                    </tr>
                    <tr>
                        <td>Client Devices</td>
                        <td>Connected devices can be targeted</td>
                    </tr>
                </table>

                <h3>üéØ Wardriving Methodology</h3>
                <div class="interactive-demo">
                    <strong>Systematic Approach:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Preparation:</strong>
                            <ul style="margin-left: 20px;">
                                <li>Ensure WNIC supports monitor mode</li>
                                <li>Charge all devices</li>
                                <li>Configure GPS (if used)</li>
                                <li>Test equipment before deployment</li>
                            </ul>
                        </li>
                        <li><strong>Scanning:</strong>
                            <ul style="margin-left: 20px;">
                                <li>Drive at moderate speeds (15-25 mph optimal)</li>
                                <li>Cover target area systematically</li>
                                <li>Note areas of high AP density</li>
                            </ul>
                        </li>
                        <li><strong>Analysis:</strong>
                            <ul style="margin-left: 20px;">
                                <li>Review captured data</li>
                                <li>Identify vulnerable networks (WEP, open, default config)</li>
                                <li>Map AP locations</li>
                                <li>Prioritize targets for testing</li>
                            </ul>
                        </li>
                        <li><strong>Reporting:</strong>
                            <ul style="margin-left: 20px;">
                                <li>Document findings</li>
                                <li>Note security weaknesses</li>
                                <li>Provide remediation recommendations</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <h3>üõ°Ô∏è Defense Against Wardriving</h3>
                <div class="info-box">
                    <strong>Security Measures:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Use WPA3 or WPA2 with strong passwords</li>
                        <li>‚úÖ Change default SSID and disable broadcasting (partial security through obscurity)</li>
                        <li>‚úÖ Implement MAC address filtering (easily bypassed but adds a layer)</li>
                        <li>‚úÖ Use 802.1X authentication for enterprise</li>
                        <li>‚úÖ Reduce signal power to limit range</li>
                        <li>‚úÖ Regular security audits</li>
                        <li>‚úÖ Wireless IDS/IPS deployment</li>
                        <li>‚úÖ RF shielding for sensitive areas</li>
                        <li>‚úÖ Monitor for rogue APs</li>
                    </ul>
                </div>

                <div class="danger-box">
                    <strong>üö® Common Misconfigurations Found:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Open networks (no encryption)</li>
                        <li>WEP encryption (easily cracked)</li>
                        <li>Default SSIDs (linksys, NETGEAR, Cisco, etc.)</li>
                        <li>Default admin credentials</li>
                        <li>WPS enabled</li>
                        <li>Outdated firmware with known vulnerabilities</li>
                        <li>Guest networks with access to internal resources</li>
                    </ul>
                </div>

                <button class="btn" onclick="markSectionComplete('wardriving'); closeModal('wardrivingModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Wireless Hacking Modal -->
        <div id="hackingModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('hackingModal')">&times;</span>
                <h2>üíª Wireless Network Hacking</h2>
                
                <div class="danger-box">
                    <strong>üö® CRITICAL LEGAL WARNING:</strong>
                    <p style="margin-top: 10px;">Unauthorized access to computer networks is illegal under:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Computer Fraud and Abuse Act (CFAA) - USA</li>
                        <li>Computer Misuse Act - UK</li>
                        <li>Similar laws in most countries</li>
                    </ul>
                    <p style="margin-top: 10px;"><strong>Only perform wireless security testing with explicit written authorization!</strong></p>
                </div>

                <h3>üéØ Wireless Attack Methodology</h3>
                <div class="standard-card">
                    <strong>Attack Phases:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Reconnaissance:</strong> Wardriving, network discovery</li>
                        <li><strong>Enumeration:</strong> Identify encryption, clients, AP details</li>
                        <li><strong>Exploitation:</strong> Crack encryption, gain access</li>
                        <li><strong>Post-Exploitation:</strong> Pivot to wired network, lateral movement</li>
                    </ol>
                </div>

                <h3>üîß Essential Hacking Tools</h3>
                
                <div class="standard-card">
                    <h4 style="color: #64ffda;"><span class="tooltip">Aircrack-ng Suite<span class="tooltiptext">Industry-standard wireless security auditing toolkit. Includes tools for monitoring, attacking, testing, and cracking Wi-Fi networks.</span></span> ‚≠ê</h4>
                    <p><strong>Platform:</strong> Linux, Windows, macOS</p>
                    <p><strong>Purpose:</strong> Complete wireless auditing toolkit</p>
                    <p><strong>Components:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>airmon-ng:</strong> Enable <span class="tooltip">monitor mode<span class="tooltiptext">Special wireless adapter mode that captures all packets in range, not just those destined for your MAC address. Required for packet injection and sniffing.</span></span> on wireless cards</li>
                        <li><strong>airodump-ng:</strong> Capture packets from wireless networks</li>
                        <li><strong>aireplay-ng:</strong> Inject packets, <span class="tooltip">deauthenticate<span class="tooltiptext">Forcibly disconnect clients from AP by sending spoofed deauthentication frames. Used to capture WPA handshake or perform DoS.</span></span> clients</li>
                        <li><strong>aircrack-ng:</strong> Crack <span class="tooltip">WEP<span class="tooltiptext">Wired Equivalent Privacy: Broken encryption from 1999 using RC4 cipher. Can be cracked in minutes with captured IVs.</span></span> and <span class="tooltip">WPA/WPA2 PSK<span class="tooltiptext">Wi-Fi Protected Access Pre-Shared Key: Passphrase-based authentication. Vulnerable to dictionary attacks if weak password used.</span></span> keys</li>
                        <li><strong>airdecap-ng:</strong> Decrypt captured files</li>
                    </ul>
                    
                    <div class="terminal" style="margin-top: 15px;">
                        <div class="terminal-line"># 1. Enable monitor mode</div>
                        <div class="terminal-line">$ sudo airmon-ng start wlan0</div>
                        <div class="terminal-line"># Interface wlan0mon created</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 2. Scan for networks</div>
                        <div class="terminal-line">$ sudo airodump-ng wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 3. Capture handshake (WPA/WPA2)</div>
                        <div class="terminal-line">$ sudo airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w capture wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 4. Deauth client to force handshake</div>
                        <div class="terminal-line">$ sudo aireplay-ng --deauth 10 -a 00:11:22:33:44:55 wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 5. Crack with dictionary</div>
                        <div class="terminal-line">$ sudo aircrack-ng -w wordlist.txt capture-01.cap</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Fern WiFi Cracker</h4>
                    <p><strong>Platform:</strong> Linux</p>
                    <p><strong>Type:</strong> GUI frontend for Aircrack-ng</p>
                    <p><strong>Features:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>User-friendly graphical interface</li>
                        <li>WEP/WPA/WPA2 cracking</li>
                        <li>WPS attack support</li>
                        <li>Automatic AP discovery</li>
                        <li>Session hijacking</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">WiFi Pineapple</h4>
                    <p><strong>Type:</strong> Hardware penetration testing platform</p>
                    <p><strong>Manufacturer:</strong> Hak5</p>
                    <p><strong>Capabilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Rogue AP creation</li>
                        <li>Man-in-the-middle attacks</li>
                        <li>Credential harvesting</li>
                        <li>Traffic monitoring and manipulation</li>
                        <li>Evil twin attacks</li>
                        <li>Modular "Modules" for different attacks</li>
                    </ul>
                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>‚ö†Ô∏è Detection:</strong> WiFi Pineapple creates characteristic patterns detectable by wireless IDS
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Additional Tools</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Reaver/Pixie Dust:</strong> WPS PIN brute-forcing</li>
                        <li><strong>Wifite:</strong> Automated wireless auditing</li>
                        <li><strong>Wash:</strong> WPS-enabled network scanner</li>
                        <li><strong>Wireshark:</strong> Network protocol analyzer</li>
                        <li><strong>Hashcat:</strong> Advanced password recovery (GPU-accelerated)</li>
                        <li><strong>CoWPAtty:</strong> WPA-PSK dictionary attack</li>
                        <li><strong>MDK3:</strong> Wireless DoS testing</li>
                    </ul>
                </div>

                <h3>‚öîÔ∏è Common Attack Techniques</h3>
                
                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #f44336;">WEP Cracking</h4>
                        <p><strong>Difficulty:</strong> Very Easy</p>
                        <p><strong>Time:</strong> Minutes</p>
                        <p><strong>Method:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Capture IV packets</li>
                            <li>Need 10,000-50,000 IVs</li>
                            <li>Use packet injection to speed up</li>
                            <li>Crack with statistical analysis</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #ffc107;">WPA/WPA2 PSK</h4>
                        <p><strong>Difficulty:</strong> Moderate</p>
                        <p><strong>Time:</strong> Hours to days</p>
                        <p><strong>Method:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Capture 4-way handshake</li>
                            <li>Deauth attack to force reconnection</li>
                            <li>Dictionary/brute-force attack</li>
                            <li>GPU acceleration recommended</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #ff6b6b;">WPS PIN Attack</h4>
                        <p><strong>Difficulty:</strong> Easy</p>
                        <p><strong>Time:</strong> Hours</p>
                        <p><strong>Method:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Brute-force 8-digit PIN</li>
                            <li>Only 11,000 combinations due to checksum</li>
                            <li>Pixie Dust attack (offline PIN extraction)</li>
                            <li>Works even with WPA2</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #9b59b6;">Evil Twin / Rogue AP</h4>
                        <p><strong>Difficulty:</strong> Moderate</p>
                        <p><strong>Time:</strong> Minutes to setup</p>
                        <p><strong>Method:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Create fake AP with target's SSID</li>
                            <li>Stronger signal than legitimate AP</li>
                            <li>Capture credentials</li>
                            <li>Man-in-the-middle attacks</li>
                        </ul>
                    </div>
                </div>

                <h3>üé≠ Advanced Attack Scenarios</h3>
                
                <div class="standard-card">
                    <h4 style="color: #64ffda;">KRACK Attack (Key Reinstallation Attack)</h4>
                    <p><strong>Target:</strong> WPA2 4-way handshake</p>
                    <p><strong>Impact:</strong> Decrypt traffic, inject malicious data</p>
                    <p><strong>Mitigation:</strong> Update all devices and APs</p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Karma Attack</h4>
                    <p><strong>Method:</strong> Respond to all client probe requests</p>
                    <p><strong>Goal:</strong> Trick clients into connecting to rogue AP</p>
                    <p><strong>Tool:</strong> WiFi Pineapple, Karma module</p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Fragmentation Attack</h4>
                    <p><strong>Target:</strong> WEP networks with strict filtering</p>
                    <p><strong>Method:</strong> Obtain encryption key from small fragment</p>
                    <p><strong>Use:</strong> Generate ARP packets for injection</p>
                </div>

                <h3>üõ°Ô∏è Countermeasures & Best Practices</h3>
                
                <div class="info-box">
                    <strong>Defense in Depth Strategy:</strong>
                </div>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Network Level</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Deploy WPA3 (or WPA2 minimum)</li>
                            <li>‚úÖ Use strong, complex passphrases (20+ chars)</li>
                            <li>‚úÖ Disable WPS completely</li>
                            <li>‚úÖ Change default SSID</li>
                            <li>‚úÖ Disable SSID broadcast (limited effectiveness)</li>
                            <li>‚úÖ Reduce AP transmission power</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Enterprise Level</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ 802.1X with RADIUS authentication</li>
                            <li>‚úÖ Certificate-based authentication (EAP-TLS)</li>
                            <li>‚úÖ Separate guest network (VLAN isolation)</li>
                            <li>‚úÖ Place APs in DMZ</li>
                            <li>‚úÖ Wireless IDS/IPS (WIPS)</li>
                            <li>‚úÖ Regular firmware updates</li>
                        </ul>
                    </div>

                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Additional Security</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ MAC filtering (limited effectiveness)</li>
                            <li>‚úÖ Static IP assignments</li>
                            <li>‚úÖ Firewall rules to restrict traffic</li>
                            <li>‚úÖ VPN for sensitive data</li>
                            <li>‚úÖ RF shielding for critical areas</li>
                            <li>‚úÖ Regular wireless audits</li>
                            <li>‚úÖ Rogue AP detection</li>
                        </ul>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Reality Check:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Hidden SSID:</strong> Easily discovered by monitoring for probe responses</li>
                        <li><strong>MAC Filtering:</strong> MAC addresses are easily spoofed</li>
                        <li><strong>Disabling DHCP:</strong> Attacker can observe traffic and configure static IP</li>
                    </ul>
                    <p style="margin-top: 10px;">These measures provide minor obstacles, not security. Focus on strong encryption and authentication!</p>
                </div>

                <h3>üîç Detection Indicators</h3>
                <table>
                    <tr>
                        <th>Indicator</th>
                        <th>Potential Attack</th>
                    </tr>
                    <tr>
                        <td>Unexpected deauthentication</td>
                        <td>Deauth attack, handshake capture attempt</td>
                    </tr>
                    <tr>
                        <td>Duplicate SSID names</td>
                        <td>Evil twin / rogue AP</td>
                    </tr>
                    <tr>
                        <td>Unknown devices connected</td>
                        <td>Unauthorized access</td>
                    </tr>
                    <tr>
                        <td>Unusual traffic patterns</td>
                        <td>Man-in-the-middle, data exfiltration</td>
                    </tr>
                    <tr>
                        <td>Weak signal strength changes</td>
                        <td>Attacker with directional antenna</td>
                    </tr>
                </table>

                <button class="btn" onclick="markSectionComplete('hacking'); closeModal('hackingModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Network Scanner Simulator Modal -->
        <div id="simulatorModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('simulatorModal')">&times;</span>
                <h2>üéØ Wireless Network Scanner Simulator</h2>
                
                <div class="info-box">
                    <strong>Practice Tool:</strong> This simulator demonstrates wireless network scanning and analysis.
                    Use the "Scan Networks" button to discover wireless networks in range.
                </div>

                <div class="simulator">
                    <button class="btn btn-success" onclick="scanNetworks()">üîç Scan for Networks</button>
                    <button class="btn btn-danger" onclick="clearScan()" style="margin-left: 10px;">Clear Results</button>
                    
                    <div id="scanResults" style="margin-top: 20px;"></div>
                    
                    <div id="scanDetails" style="margin-top: 20px; display: none;">
                        <h3>Selected Network Details</h3>
                        <div id="networkDetails"></div>
                    </div>
                </div>

                <h3>üìä Channel Overlap Visualizer</h3>
                <div class="simulator">
                    <p>Select channels to see overlap:</p>
                    <div style="margin: 15px 0;">
                        <label style="margin-right: 20px;">
                            <input type="checkbox" id="ch1" onchange="updateOverlap()"> Channel 1
                        </label>
                        <label style="margin-right: 20px;">
                            <input type="checkbox" id="ch6" onchange="updateOverlap()"> Channel 6
                        </label>
                        <label>
                            <input type="checkbox" id="ch11" onchange="updateOverlap()"> Channel 11
                        </label>
                    </div>
                    <div id="overlapViz" style="min-height: 100px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 5px; margin-top: 15px;">
                        <p style="text-align: center; color: #64ffda;">Select channels above to visualize overlap</p>
                    </div>
                </div>

                <h3>üîê Encryption Strength Calculator</h3>
                <div class="interactive-demo">
                    <label>Enter password for strength analysis:</label>
                    <input type="text" id="passwordInput" placeholder="Enter a Wi-Fi password..." oninput="analyzePassword()">
                    <div id="passwordStrength" style="margin-top: 15px;"></div>
                </div>

                <button class="btn" onclick="closeModal('simulatorModal')">Close Simulator</button>
            </div>
        </div>

        <!-- Advanced Attacks Modal -->
        <div id="advancedAttacksModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('advancedAttacksModal')">&times;</span>
                <h2>‚öîÔ∏è Advanced Wireless Attack Techniques</h2>
                
                <div class="danger-box">
                    <strong>üö® LEGAL WARNING:</strong> These techniques are for authorized security testing only. 
                    Unauthorized network attacks are illegal and unethical.
                </div>

                <h3>üí• Wireless Denial of Service (DoS) Attacks</h3>
                
                <div class="standard-card">
                    <h4 style="color: #f44336;">Deauthentication Flood</h4>
                    <p><strong>Method:</strong> Flood network with deauth frames</p>
                    <p><strong>Impact:</strong> Disconnects all clients from AP</p>
                    <p><strong>Tool:</strong> Aireplay-ng, MDK3</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Deauth all clients on an AP</div>
                        <div class="terminal-line">$ sudo aireplay-ng --deauth 0 -a [AP_MAC] wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Deauth specific client</div>
                        <div class="terminal-line">$ sudo aireplay-ng --deauth 0 -a [AP_MAC] -c [CLIENT_MAC] wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Using MDK3 for more aggressive attack</div>
                        <div class="terminal-line">$ sudo mdk3 wlan0mon d -c 6</div>
                    </div>
                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Detection:</strong> Look for excessive deauth frames in wireless IDS logs
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Authentication Flood</h4>
                    <p><strong>Method:</strong> Flood AP with authentication requests</p>
                    <p><strong>Impact:</strong> Overwhelms AP resources, denies service to legitimate clients</p>
                    <p><strong>Tool:</strong> MDK3, void11</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Authentication DoS with MDK3</div>
                        <div class="terminal-line">$ sudo mdk3 wlan0mon a -a [AP_MAC] -m</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Beacon Flood</h4>
                    <p><strong>Method:</strong> Create hundreds of fake APs</p>
                    <p><strong>Impact:</strong> Overwhelms wireless scanners, hides real networks</p>
                    <p><strong>Tool:</strong> MDK3</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Beacon flood attack</div>
                        <div class="terminal-line">$ sudo mdk3 wlan0mon b -n "FakeAP" -g -m</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">CTS/RTS Flood</h4>
                    <p><strong>Method:</strong> Send continuous CTS (Clear To Send) frames</p>
                    <p><strong>Impact:</strong> Blocks all wireless communication in range</p>
                    <p><strong>Note:</strong> Affects entire channel, not just target network</p>
                </div>

                <h3>üé≠ Man-in-the-Middle (MITM) Attacks</h3>

                <div class="standard-card">
                    <h4 style="color: #ff6b6b;">Evil Twin Attack (Detailed)</h4>
                    <p><strong>Objective:</strong> Impersonate legitimate AP to intercept traffic</p>
                    
                    <p style="margin-top: 15px;"><strong>Attack Steps:</strong></p>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Reconnaissance:</strong> Identify target AP details (SSID, channel, MAC)</li>
                        <li><strong>Deauth legitimate AP:</strong> Force clients to disconnect</li>
                        <li><strong>Create rogue AP:</strong> Same SSID, stronger signal</li>
                        <li><strong>Client connection:</strong> Victims connect to evil twin</li>
                        <li><strong>Traffic interception:</strong> Capture credentials, cookies, data</li>
                    </ol>

                    <div class="terminal" style="margin-top: 15px;">
                        <div class="terminal-line"># 1. Create evil twin with hostapd</div>
                        <div class="terminal-line">$ sudo airbase-ng -e "CorporateWiFi" -c 6 wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 2. Configure DHCP for clients</div>
                        <div class="terminal-line">$ sudo dhcpd -cf /etc/dhcp/dhcpd.conf at0</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 3. Enable IP forwarding for MITM</div>
                        <div class="terminal-line">$ sudo echo 1 > /proc/sys/net/ipv4/ip_forward</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 4. Setup iptables for routing</div>
                        <div class="terminal-line">$ sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 5. Capture traffic with Wireshark or tcpdump</div>
                        <div class="terminal-line">$ sudo wireshark -i at0 &</div>
                    </div>

                    <div class="info-box" style="margin-top: 15px;">
                        <strong>Tools for Evil Twin:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li><strong>Airbase-ng:</strong> Create rogue AP</li>
                            <li><strong>WiFi Pineapple:</strong> Automated evil twin platform</li>
                            <li><strong>Fluxion:</strong> Automated MITM with captive portal</li>
                            <li><strong>Wifiphisher:</strong> Automated phishing-based MITM</li>
                        </ul>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #ff6b6b;">Captive Portal Attack</h4>
                    <p><strong>Method:</strong> Create fake login page that mimics legitimate portal</p>
                    <p><strong>Goal:</strong> Harvest credentials when users try to authenticate</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Using Wifiphisher for automated attack</div>
                        <div class="terminal-line">$ sudo wifiphisher -aI wlan0 -jI wlan1 -p firmware-upgrade</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Common phishing scenarios:</div>
                        <div class="terminal-line"># - Firmware upgrade requiring password</div>
                        <div class="terminal-line"># - OAuth login page</div>
                        <div class="terminal-line"># - Browser plugin update</div>
                    </div>

                    <div class="danger-box" style="margin-top: 10px;">
                        <strong>User Defense:</strong> Always verify SSL certificates and domain names. Legitimate network updates never ask for your Wi-Fi password!
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #ff6b6b;">SSL Stripping</h4>
                    <p><strong>Method:</strong> Downgrade HTTPS connections to HTTP</p>
                    <p><strong>Tool:</strong> sslstrip, mitmproxy</p>
                    <p><strong>Impact:</strong> Intercept supposedly secure communications</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Setup SSL stripping with sslstrip</div>
                        <div class="terminal-line">$ sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080</div>
                        <div class="terminal-line">$ sudo sslstrip -l 8080</div>
                    </div>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Modern Defense:</strong> HSTS (HTTP Strict Transport Security) prevents SSL stripping on compliant sites
                    </div>
                </div>

                <h3>üîì WPA/WPA2 Attack Vectors</h3>

                <div class="standard-card">
                    <h4 style="color: #9b59b6;">PMKID Attack (Hashcat Method)</h4>
                    <p><strong>Advantage:</strong> Capture hash without waiting for client connection</p>
                    <p><strong>Discovery:</strong> Found by Jens Steube (atom) in 2018</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># 1. Capture PMKID from AP</div>
                        <div class="terminal-line">$ sudo hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 2. Convert to hashcat format</div>
                        <div class="terminal-line">$ hcxpcaptool -z hash.16800 capture.pcapng</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 3. Crack with hashcat (mode 16800)</div>
                        <div class="terminal-line">$ hashcat -m 16800 hash.16800 wordlist.txt</div>
                    </div>

                    <div class="info-box" style="margin-top: 10px;">
                        <strong>Why it works:</strong> PMKID is derived from PMK (which is derived from password). 
                        It's transmitted in the first frame of the 4-way handshake or in reassociation requests.
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #9b59b6;">KRACK Attack (Key Reinstallation)</h4>
                    <p><strong>CVE:</strong> CVE-2017-13077 through CVE-2017-13088</p>
                    <p><strong>Impact:</strong> Decrypt WPA2 traffic, inject/manipulate packets</p>
                    <p><strong>Vulnerability:</strong> Flaw in 4-way handshake implementation</p>
                    
                    <div class="info-box" style="margin-top: 10px;">
                        <strong>How KRACK Works:</strong>
                        <ol style="margin-left: 20px; margin-top: 10px;">
                            <li>Attacker manipulates and replays messages in 4-way handshake</li>
                            <li>Forces victim to reinstall already-in-use key</li>
                            <li>Resets nonce and replay counter values</li>
                            <li>Allows decryption and injection of packets</li>
                        </ol>
                    </div>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Mitigation:</strong> Update all devices (clients and APs). Most vendors released patches by end of 2017.
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #9b59b6;">Dragonblood Attacks (WPA3)</h4>
                    <p><strong>Discovery:</strong> 2019 by Mathy Vanhoef and Eyal Ronen</p>
                    <p><strong>Vulnerabilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Downgrade Attack:</strong> Force WPA3 to WPA2</li>
                        <li><strong>Side-Channel Leak:</strong> Timing-based password partitioning</li>
                        <li><strong>Cache-based Attack:</strong> Extract password information</li>
                        <li><strong>DoS via Resource Consumption:</strong> Computational exhaustion</li>
                    </ul>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Status:</strong> Addressed in WPA3 version 1.1 and later. Ensure firmware is updated!
                    </div>
                </div>

                <h3>üì° Rogue Access Point Attacks</h3>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Internal Rogue AP</h4>
                    <p><strong>Scenario:</strong> Unauthorized AP connected to corporate network</p>
                    <p><strong>Risk:</strong> Bypasses perimeter security, provides backdoor access</p>
                    <p><strong>Common Sources:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Employees setting up personal wireless routers</li>
                        <li>Forgotten test equipment left connected</li>
                        <li>Compromised devices acting as APs</li>
                        <li>Malicious insider threats</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Karma Attack (Client Mis-association)</h4>
                    <p><strong>Method:</strong> Respond to all client probe requests with matching SSIDs</p>
                    <p><strong>Vulnerability:</strong> Clients broadcast previously connected network names</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># WiFi Pineapple Karma module automatically:</div>
                        <div class="terminal-line"># 1. Captures probe requests from clients</div>
                        <div class="terminal-line"># 2. Responds with matching SSIDs</div>
                        <div class="terminal-line"># 3. Client connects thinking it's familiar network</div>
                        <div class="terminal-line"># 4. Attacker performs MITM</div>
                    </div>

                    <div class="info-box" style="margin-top: 10px;">
                        <strong>Modern Defense:</strong> iOS and Android now randomize MAC addresses and limit probe request broadcasts
                    </div>
                </div>

                <h3>üåê Ad-Hoc Network Attacks</h3>

                <div class="standard-card">
                    <h4 style="color: #3498db;">Computer-to-Computer Attack</h4>
                    <p><strong>Scenario:</strong> Creating ad-hoc network to trick users</p>
                    <p><strong>Method:</strong> Create open ad-hoc network with enticing name</p>
                    <p><strong>Risk:</strong> Users may connect thinking it's infrastructure mode</p>
                    <p><strong>Impact:</strong> Direct access to victim computer, no AP filtering</p>
                </div>

                <h3>üéØ Client-Side Attacks</h3>

                <div class="standard-card">
                    <h4 style="color: #f39c12;">Caffe Latte Attack</h4>
                    <p><strong>Target:</strong> Offline WEP clients (not connected to any AP)</p>
                    <p><strong>Method:</strong> Manipulate stored network profiles to extract WEP key</p>
                    <p><strong>Tool:</strong> Aircrack-ng suite</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Caffe Latte attack</div>
                        <div class="terminal-line">$ sudo airbase-ng -c 6 -e "TargetNetwork" -L -W 1 wlan0mon</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f39c12;">Hirte Attack</h4>
                    <p><strong>Target:</strong> WEP clients that actively probe for networks</p>
                    <p><strong>Evolution:</strong> Improved version of Caffe Latte</p>
                    <p><strong>Advantage:</strong> Works against more client implementations</p>
                </div>

                <h3>üìä Attack Success Factors</h3>

                <table>
                    <tr>
                        <th>Factor</th>
                        <th>Impact on Attack</th>
                        <th>Defender's Control</th>
                    </tr>
                    <tr>
                        <td>Signal Strength</td>
                        <td>Stronger signal = easier to attack and maintain connection</td>
                        <td>Reduce AP power, use directional antennas</td>
                    </tr>
                    <tr>
                        <td>Encryption Type</td>
                        <td>WEP: minutes | WPA2-PSK: hours-days | WPA3: significantly harder</td>
                        <td>Use WPA3, strong passphrases (20+ chars)</td>
                    </tr>
                    <tr>
                        <td>Client Density</td>
                        <td>More clients = more handshakes = easier to capture</td>
                        <td>Implement anomaly detection for capture attempts</td>
                    </tr>
                    <tr>
                        <td>User Awareness</td>
                        <td>Unaware users will connect to evil twins</td>
                        <td>Train users on wireless security best practices</td>
                    </tr>
                    <tr>
                        <td>Update Status</td>
                        <td>Outdated firmware = known vulnerabilities</td>
                        <td>Regular patching and firmware updates</td>
                    </tr>
                </table>

                <h3>üõ†Ô∏è Complete Attack Tool Arsenal</h3>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Reconnaissance</h4>
                        <ul style="margin-left: 20px;">
                            <li>Kismet - Network detector</li>
                            <li>inSSIDer - Channel analyzer</li>
                            <li>NetStumbler - Legacy scanner</li>
                            <li>WiGLE - Global AP database</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Exploitation</h4>
                        <ul style="margin-left: 20px;">
                            <li>Aircrack-ng - WEP/WPA cracking</li>
                            <li>Reaver - WPS attacks</li>
                            <li>Hashcat - GPU password cracking</li>
                            <li>CoWPAtty - Rainbow tables</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">MITM</h4>
                        <ul style="margin-left: 20px;">
                            <li>Airbase-ng - Rogue AP</li>
                            <li>WiFi Pineapple - Complete platform</li>
                            <li>Wifiphisher - Phishing attacks</li>
                            <li>mitmproxy - Traffic manipulation</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">DoS/Disruption</h4>
                        <ul style="margin-left: 20px;">
                            <li>MDK3 - Multiple DoS modes</li>
                            <li>Aireplay-ng - Deauth attacks</li>
                            <li>void11 - Protocol fuzzing</li>
                            <li>WIDS tools - Jamming</li>
                        </ul>
                    </div>
                </div>

                <button class="btn" onclick="markSectionComplete('advanced'); closeModal('advancedAttacksModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Bluetooth Security Modal -->
        <div id="bluetoothModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('bluetoothModal')">&times;</span>
                <h2>üì± Bluetooth Security & Attacks</h2>
                
                <h3>üì° Bluetooth Technology Overview</h3>
                
                <div class="info-box">
                    <strong>Bluetooth Basics:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Standard:</strong> IEEE 802.15.1 (WPAN - Wireless Personal Area Network)</li>
                        <li><strong>Frequency:</strong> 2.4 GHz ISM band (2.402-2.480 GHz)</li>
                        <li><strong>Channels:</strong> 79 channels (1 MHz spacing)</li>
                        <li><strong>Range:</strong> Class 1: 100m | Class 2: 10m | Class 3: 1m</li>
                        <li><strong>Topology:</strong> Master-slave (piconet), up to 8 devices</li>
                    </ul>
                </div>

                <h3>üìä Bluetooth Versions</h3>

                <table>
                    <tr>
                        <th>Version</th>
                        <th>Speed</th>
                        <th>Key Features</th>
                        <th>Security Notes</th>
                    </tr>
                    <tr>
                        <td>1.0/1.1</td>
                        <td>721 Kbps</td>
                        <td>Original specification</td>
                        <td>Many security issues, avoid</td>
                    </tr>
                    <tr>
                        <td>2.0 + EDR</td>
                        <td>3 Mbps</td>
                        <td>Enhanced Data Rate</td>
                        <td>Improved security, still vulnerable</td>
                    </tr>
                    <tr>
                        <td>3.0 + HS</td>
                        <td>24 Mbps</td>
                        <td>High Speed (802.11 for data)</td>
                        <td>Better encryption support</td>
                    </tr>
                    <tr>
                        <td>4.0 (LE)</td>
                        <td>1 Mbps</td>
                        <td>Low Energy for IoT</td>
                        <td>AES-128 encryption</td>
                    </tr>
                    <tr>
                        <td>5.0+</td>
                        <td>2 Mbps</td>
                        <td>Extended range, mesh</td>
                        <td>Improved pairing security</td>
                    </tr>
                </table>

                <h3>üîê Bluetooth Security Modes</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Security Mode 1: No Security</h4>
                    <p>No authentication or encryption - completely open</p>
                    <div class="danger-box" style="margin-top: 10px;">
                        <strong>Risk:</strong> Anyone can connect and intercept communications
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Security Mode 2: Service-Level Security</h4>
                    <p>Security enforced after connection establishment</p>
                    <p>Authorization and authentication managed by L2CAP</p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Security Mode 3: Link-Level Security</h4>
                    <p>Authentication and encryption before connection</p>
                    <p>Uses 128-bit encryption key</p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Security Mode 4: SSP (Secure Simple Pairing)</h4>
                    <p>Introduced in Bluetooth 2.1</p>
                    <p>Elliptic Curve Diffie-Hellman (ECDH) for key exchange</p>
                    <p>Protection against MITM during pairing</p>
                </div>

                <h3>‚öîÔ∏è Bluetooth Attack Techniques</h3>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Bluejacking</h4>
                    <p><strong>Definition:</strong> Sending unsolicited messages to Bluetooth devices</p>
                    <p><strong>Method:</strong> Exploit Object Exchange (OBEX) protocol</p>
                    <p><strong>Risk Level:</strong> Low (annoying, not dangerous)</p>
                    <p><strong>Prevention:</strong> Set device to non-discoverable mode</p>
                    
                    <div class="info-box" style="margin-top: 10px;">
                        <strong>Example:</strong> Attacker sends vCard with message in the name field. 
                        Recipient sees notification with unsolicited message.
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #ff6b6b;">Bluesnarfing</h4>
                    <p><strong>Definition:</strong> Unauthorized access to information from device</p>
                    <p><strong>Data at Risk:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Contacts and calendar</li>
                        <li>Text messages and emails</li>
                        <li>Photos and files</li>
                        <li>Call history</li>
                    </ul>
                    <p><strong>Vulnerability:</strong> Older devices with firmware flaws</p>
                    <p><strong>Tool:</strong> Bluesnarfer</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Enumerate Bluetooth devices</div>
                        <div class="terminal-line">$ hcitool scan</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Attempt to read phone book</div>
                        <div class="terminal-line">$ bluesnarfer -r 1-100 -b [MAC_ADDRESS]</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Bluebugging</h4>
                    <p><strong>Definition:</strong> Taking control of Bluetooth device</p>
                    <p><strong>Capabilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Make phone calls</li>
                        <li>Send/receive messages</li>
                        <li>Access internet</li>
                        <li>Modify contacts</li>
                        <li>Eavesdrop on conversations</li>
                    </ul>
                    <p><strong>Severity:</strong> Critical - full device compromise</p>
                    
                    <div class="danger-box" style="margin-top: 10px;">
                        <strong>Risk:</strong> Attacker maintains backdoor access even after initial exploit
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #9b59b6;">BlueBorne</h4>
                    <p><strong>Discovery:</strong> September 2017 by Armis Security</p>
                    <p><strong>CVEs:</strong> CVE-2017-0781, CVE-2017-0782, others</p>
                    <p><strong>Impact:</strong> Remote code execution without authentication</p>
                    <p><strong>Affected:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Android devices (all versions before patch)</li>
                        <li>iOS devices (before iOS 10)</li>
                        <li>Windows devices</li>
                        <li>Linux kernel (BlueZ)</li>
                    </ul>
                    
                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Attack Vector:</strong> Exploits Bluetooth stack without requiring pairing or user interaction
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #3498db;">KNOB Attack (Key Negotiation of Bluetooth)</h4>
                    <p><strong>Discovery:</strong> August 2019</p>
                    <p><strong>CVE:</strong> CVE-2019-9506</p>
                    <p><strong>Method:</strong> Force weak encryption key (1 byte) during pairing</p>
                    <p><strong>Impact:</strong> Brute-force encryption in real-time</p>
                    <p><strong>Affected:</strong> Bluetooth BR/EDR devices</p>
                </div>

                <div class="standard-card">
                    <h4 style="color: #3498db;">BIAS Attack (Bluetooth Impersonation AttackS)</h4>
                    <p><strong>Discovery:</strong> May 2020</p>
                    <p><strong>Method:</strong> Exploit authentication procedure flaws</p>
                    <p><strong>Impact:</strong> Impersonate previously paired device</p>
                    <p><strong>Risk:</strong> No user warning, appears as legitimate connection</p>
                </div>

                <h3>üîç Bluetooth Reconnaissance Tools</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">hcitool</h4>
                    <p><strong>Purpose:</strong> Configure Bluetooth connections</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Scan for nearby devices</div>
                        <div class="terminal-line">$ hcitool scan</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Get device information</div>
                        <div class="terminal-line">$ hcitool info [MAC_ADDRESS]</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Display local device info</div>
                        <div class="terminal-line">$ hciconfig -a</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">sdptool</h4>
                    <p><strong>Purpose:</strong> Query Bluetooth services (SDP - Service Discovery Protocol)</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Browse available services</div>
                        <div class="terminal-line">$ sdptool browse [MAC_ADDRESS]</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Search for specific service</div>
                        <div class="terminal-line">$ sdptool search --bdaddr [MAC] FTP</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">btscanner</h4>
                    <p><strong>Purpose:</strong> Extract device information</p>
                    <p><strong>Features:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Device name and class</li>
                        <li>Supported services</li>
                        <li>Manufacturer information</li>
                        <li>OUI lookup</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">BlueMaho</h4>
                    <p><strong>Purpose:</strong> GUI tool for Bluetooth testing</p>
                    <p><strong>Capabilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Device scanning and tracking</li>
                        <li>Service enumeration</li>
                        <li>File transfer testing</li>
                        <li>SDP browsing</li>
                    </ul>
                </div>

                <h3>üõ°Ô∏è Bluetooth Security Best Practices</h3>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Device Configuration</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Set to non-discoverable when not pairing</li>
                            <li>‚úÖ Disable Bluetooth when not in use</li>
                            <li>‚úÖ Use Security Mode 4 (SSP)</li>
                            <li>‚úÖ Require authentication for all connections</li>
                            <li>‚úÖ Use strong PINs (avoid 0000, 1234)</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Pairing Security</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Verify pairing codes on both devices</li>
                            <li>‚úÖ Only pair in secure environments</li>
                            <li>‚úÖ Delete old/unused pairings</li>
                            <li>‚úÖ Use out-of-band (OOB) pairing when available</li>
                            <li>‚úÖ Monitor for unexpected pairing requests</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Ongoing Security</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Keep firmware updated</li>
                            <li>‚úÖ Monitor connected devices regularly</li>
                            <li>‚úÖ Use Bluetooth 5.0+ when possible</li>
                            <li>‚úÖ Implement network-level Bluetooth security</li>
                            <li>‚úÖ Train users on Bluetooth risks</li>
                        </ul>
                    </div>
                </div>

                <h3>üè¢ Enterprise Bluetooth Security</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Bluetooth Policy Considerations</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Define acceptable use policies for Bluetooth devices</li>
                        <li>Implement Mobile Device Management (MDM) controls</li>
                        <li>Restrict Bluetooth usage in sensitive areas</li>
                        <li>Deploy Bluetooth detection and monitoring systems</li>
                        <li>Regular security audits of Bluetooth-enabled devices</li>
                        <li>Incident response procedures for Bluetooth compromises</li>
                    </ul>
                </div>

                <div class="info-box">
                    <strong>üîç Detection Tools for Enterprise:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>BlueScanner:</strong> Network-wide Bluetooth device detection</li>
                        <li><strong>Wireless IPS:</strong> Some solutions include Bluetooth monitoring</li>
                        <li><strong>Mobile Threat Defense:</strong> Solutions like Lookout, Zimperium</li>
                        <li><strong>Custom scripts:</strong> Automated hcitool/btscanner scanning</li>
                    </ul>
                </div>

                <button class="btn" onclick="markSectionComplete('bluetooth'); closeModal('bluetoothModal')">Mark Complete</button>
            </div>
        </div>

            </div>
        </div>

        <!-- Defense & Detection Modal -->
        <div id="defenseModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('defenseModal')">&times;</span>
                <h2>üõ°Ô∏è Wireless Defense & Detection</h2>
                
                <h3>üîç Wireless Intrusion Detection Systems (WIDS)</h3>
                
                <div class="info-box">
                    <strong>Purpose:</strong> Monitor wireless networks for suspicious activity, policy violations, and security threats
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">WIDS Components</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Sensors:</strong> Dedicated APs or adapters in monitor mode</li>
                        <li><strong>Console/Controller:</strong> Centralized management and analysis</li>
                        <li><strong>Database:</strong> Historical data and baseline behavior</li>
                        <li><strong>Alerting System:</strong> Real-time notifications of threats</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">WIDS Detection Methods</h4>
                    
                    <p style="margin-top: 10px;"><strong>Signature-Based Detection:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Match traffic patterns against known attack signatures</li>
                        <li>Effective against known attacks</li>
                        <li>Low false positive rate</li>
                        <li>Cannot detect zero-day attacks</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Anomaly-Based Detection:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Establish baseline of normal behavior</li>
                        <li>Alert on deviations from baseline</li>
                        <li>Can detect unknown attacks</li>
                        <li>Higher false positive rate</li>
                        <li>Requires tuning period</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Policy-Based Detection:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Enforce organizational security policies</li>
                        <li>Detect unauthorized encryption types</li>
                        <li>Flag non-compliant configurations</li>
                        <li>Identify prohibited SSIDs</li>
                    </ul>
                </div>

                <h3>üö® Common WIDS Alerts</h3>

                <table>
                    <tr>
                        <th>Alert Type</th>
                        <th>Indicator</th>
                        <th>Potential Threat</th>
                    </tr>
                    <tr>
                        <td>Rogue AP</td>
                        <td>Unauthorized AP on network</td>
                        <td>Backdoor access, data theft</td>
                    </tr>
                    <tr>
                        <td>Evil Twin</td>
                        <td>Duplicate SSID with different MAC</td>
                        <td>MITM, credential harvesting</td>
                    </tr>
                    <tr>
                        <td>Deauth Flood</td>
                        <td>Excessive deauth frames</td>
                        <td>DoS, handshake capture attempt</td>
                    </tr>
                    <tr>
                        <td>Probe Flood</td>
                        <td>Excessive probe requests</td>
                        <td>Network mapping, DoS</td>
                    </tr>
                    <tr>
                        <td>MAC Spoofing</td>
                        <td>Same MAC on different channels</td>
                        <td>Unauthorized access attempt</td>
                    </tr>
                    <tr>
                        <td>WEP Usage</td>
                        <td>Weak encryption detected</td>
                        <td>Policy violation, easy target</td>
                    </tr>
                    <tr>
                        <td>Ad-Hoc Network</td>
                        <td>Peer-to-peer connection</td>
                        <td>Policy violation, security bypass</td>
                    </tr>
                    <tr>
                        <td>Honeypot Trigger</td>
                        <td>Connection to decoy AP</td>
                        <td>Active attacker present</td>
                    </tr>
                </table>

                <h3>‚ö° Wireless Intrusion Prevention Systems (WIPS)</h3>

                <div class="info-box">
                    <strong>WIPS = WIDS + Active Response:</strong> Automatically respond to detected threats
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">WIPS Response Actions</h4>
                    
                    <p><strong>1. Deauthentication Containment:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Send deauth frames to rogue AP clients</li>
                        <li>Disconnect attackers from target network</li>
                        <li>Continuous monitoring and disruption</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>2. RF Jamming (Physical Layer):</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Transmit noise on rogue AP channel</li>
                        <li>Makes channel unusable for attacker</li>
                        <li>May affect legitimate traffic nearby</li>
                    </ul>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>‚ö†Ô∏è Legal Warning:</strong> RF jamming may be illegal in many jurisdictions. Verify local regulations!
                    </div>

                    <p style="margin-top: 15px;"><strong>3. Bridge VLAN Tagging:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Quarantine suspicious devices to isolated VLAN</li>
                        <li>Maintain connection for forensic analysis</li>
                        <li>Prevent access to sensitive resources</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>4. Port Shutdown:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Disable wired port connected to rogue AP</li>
                        <li>Requires integration with switching infrastructure</li>
                        <li>Effective for internal rogue APs</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>5. Alert and Log:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Notify security team immediately</li>
                        <li>Capture forensic data</li>
                        <li>Track attacker behavior</li>
                        <li>Feed into SIEM systems</li>
                    </ul>
                </div>

                <h3>üîé Rogue AP Detection Techniques</h3>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Method 1: RF Scanning</h4>
                    <p><strong>Approach:</strong> Dedicated sensors scan all channels continuously</p>
                    <p><strong>Advantages:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Detects all wireless activity</li>
                        <li>Works even if not on corporate network</li>
                        <li>Can locate approximate physical position</li>
                    </ul>
                    <p><strong>Limitations:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Requires dedicated hardware</li>
                        <li>Coverage gaps possible</li>
                        <li>Cannot definitively identify internal rogues</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Method 2: Network Traffic Analysis</h4>
                    <p><strong>Approach:</strong> Monitor wired network for wireless device signatures</p>
                    <p><strong>Detection Indicators:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>DHCP requests from unknown MAC addresses</li>
                        <li>Traffic patterns consistent with wireless bridging</li>
                        <li>OUI lookup indicating wireless vendor</li>
                        <li>Timing analysis (wireless latency patterns)</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Method 3: Active Probing</h4>
                    <p><strong>Approach:</strong> Attempt to connect to suspected rogues</p>
                    <p><strong>Process:</strong></p>
                    <ol style="margin-left: 20px; margin-top: 5px;">
                        <li>Identify suspicious APs via RF scan</li>
                        <li>Attempt connection to gather more data</li>
                        <li>Perform DNS/HTTP requests to identify network</li>
                        <li>Traceroute to determine if on corporate network</li>
                    </ol>
                    
                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Caution:</strong> May trigger alerts on attacker's systems or legitimate third-party networks
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #e74c3c;">Method 4: MAC Address Correlation</h4>
                    <p><strong>Approach:</strong> Cross-reference wireless MAC with wired network</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Wireless scan finds AP: 00:11:22:33:44:55</div>
                        <div class="terminal-line"># Check if MAC exists on wired network:</div>
                        <div class="terminal-line">$ grep "00:11:22:33:44:55" /var/log/dhcp.log</div>
                        <div class="terminal-line"># Check switch ARP tables</div>
                        <div class="terminal-line"># If found on wired = likely internal rogue</div>
                    </div>
                </div>

                <h3>üì° Wireless Site Survey</h3>

                <div class="info-box">
                    <strong>Purpose:</strong> Plan optimal AP placement, identify coverage gaps, and detect interference
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Site Survey Types</h4>
                    
                    <p><strong>Passive Survey:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Measure existing RF environment</li>
                        <li>Identify interference sources</li>
                        <li>Map competitor/neighbor APs</li>
                        <li>No configuration changes needed</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Active Survey:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Connect to APs and measure performance</li>
                        <li>Test throughput and latency</li>
                        <li>Verify authentication mechanisms</li>
                        <li>Validate roaming behavior</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Predictive Survey:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Software-based modeling before deployment</li>
                        <li>Import building blueprints</li>
                        <li>Define material types (walls, floors)</li>
                        <li>Simulate AP placement and coverage</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Site Survey Tools</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Ekahau Site Survey:</strong> Professional-grade, heat mapping</li>
                        <li><strong>AirMagnet Survey:</strong> Enterprise wireless planning</li>
                        <li><strong>NetSpot:</strong> Cost-effective, visual heat maps</li>
                        <li><strong>inSSIDer:</strong> Basic channel analysis</li>
                        <li><strong>Ubiquiti WiFiman:</strong> Mobile survey tool</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Survey Best Practices</h4>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Plan Coverage Areas:</strong> Identify critical zones requiring coverage</li>
                        <li><strong>Consider Capacity:</strong> Plan for user density, not just coverage</li>
                        <li><strong>Overlap Planning:</strong> Ensure 15-20% overlap for roaming</li>
                        <li><strong>Channel Selection:</strong> Use non-overlapping channels (1, 6, 11)</li>
                        <li><strong>Power Optimization:</strong> Reduce power to minimize cell size</li>
                        <li><strong>Dual-Band:</strong> Deploy both 2.4 GHz and 5 GHz</li>
                        <li><strong>Test at Peak Times:</strong> Survey during normal business hours</li>
                        <li><strong>Document Everything:</strong> Record AP locations, settings, measurements</li>
                    </ol>
                </div>

                <h3>üéØ Wireless Honeypots</h3>

                <div class="standard-card">
                    <h4 style="color: #ffc107;">Honeypot Strategy</h4>
                    <p><strong>Purpose:</strong> Attract and study attackers in controlled environment</p>
                    
                    <p style="margin-top: 15px;"><strong>Configuration Ideas:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li><strong>"Default" SSIDs:</strong> "linksys", "NETGEAR" - attract opportunistic attackers</li>
                        <li><strong>Open Network:</strong> No encryption to appear as easy target</li>
                        <li><strong>WEP Encryption:</strong> Known weak encryption attracts specific attackers</li>
                        <li><strong>Enticing Names:</strong> "Company-Finance", "Executive-WiFi"</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>Monitoring Capabilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Log all connection attempts</li>
                        <li>Capture full packet traces</li>
                        <li>Identify attack tools and techniques</li>
                        <li>Track attacker behavior patterns</li>
                        <li>Generate threat intelligence</li>
                    </ul>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>‚ö†Ô∏è Legal Considerations:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Ensure honeypot is isolated from production</li>
                            <li>Document purpose and monitoring procedures</li>
                            <li>Consider liability if honeypot is used to attack others</li>
                            <li>Review with legal counsel before deployment</li>
                        </ul>
                    </div>
                </div>

                <h3>üîí Defense in Depth Strategy</h3>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Layer 1: Physical</h4>
                        <ul style="margin-left: 20px;">
                            <li>RF shielding in sensitive areas</li>
                            <li>Directional antennas</li>
                            <li>Controlled AP placement</li>
                            <li>Reduced transmission power</li>
                            <li>Faraday cage for critical zones</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Layer 2: Network</h4>
                        <ul style="margin-left: 20px;">
                            <li>WPA3 encryption</li>
                            <li>802.1X authentication</li>
                            <li>VLAN segmentation</li>
                            <li>MAC filtering (limited value)</li>
                            <li>Guest network isolation</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Layer 3: Application</h4>
                        <ul style="margin-left: 20px;">
                            <li>VPN for sensitive data</li>
                            <li>End-to-end encryption</li>
                            <li>Certificate validation</li>
                            <li>Multi-factor authentication</li>
                            <li>Application-layer firewalls</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #4caf50;">Layer 4: Monitoring</h4>
                        <ul style="margin-left: 20px;">
                            <li>WIDS/WIPS deployment</li>
                            <li>Continuous RF scanning</li>
                            <li>SIEM integration</li>
                            <li>Regular security audits</li>
                            <li>Penetration testing</li>
                        </ul>
                    </div>
                </div>

                <h3>üìã Wireless Security Checklist</h3>

                <div class="standard-card">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <p><strong>Encryption & Authentication:</strong></p>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>‚òê WPA3 or WPA2 with AES</li>
                                <li>‚òê Strong passphrase (20+ characters)</li>
                                <li>‚òê 802.1X for enterprise</li>
                                <li>‚òê EAP-TLS with certificates</li>
                                <li>‚òê Disable WPS completely</li>
                                <li>‚òê Regular password rotation</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>Access Point Security:</strong></p>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>‚òê Change default credentials</li>
                                <li>‚òê Custom SSID (not default)</li>
                                <li>‚òê Disable remote management</li>
                                <li>‚òê Updated firmware</li>
                                <li>‚òê Disable unused features</li>
                                <li>‚òê Enable management encryption</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>Network Configuration:</strong></p>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>‚òê VLAN segmentation</li>
                                <li>‚òê Guest network isolation</li>
                                <li>‚òê DMZ for APs</li>
                                <li>‚òê Firewall rules</li>
                                <li>‚òê DHCP snooping</li>
                                <li>‚òê ARP inspection</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>Monitoring & Detection:</strong></p>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>‚òê WIDS/WIPS deployed</li>
                                <li>‚òê Rogue AP detection</li>
                                <li>‚òê Client monitoring</li>
                                <li>‚òê Traffic analysis</li>
                                <li>‚òê Log aggregation (SIEM)</li>
                                <li>‚òê Regular audits</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <h3>üè¢ Enterprise Deployment Recommendations</h3>

                <div class="info-box">
                    <strong>Scalable Wireless Architecture:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Centralized Controller:</strong> Manage all APs from single console</li>
                        <li><strong>Lightweight APs:</strong> Thin APs with controller-based intelligence</li>
                        <li><strong>Role-Based Access:</strong> Different policies for different user groups</li>
                        <li><strong>Location Services:</strong> Track devices for security and analytics</li>
                        <li><strong>Application Visibility:</strong> Identify and control applications</li>
                        <li><strong>Cloud Management:</strong> Remote monitoring and configuration</li>
                        <li><strong>Automated Remediation:</strong> Self-healing wireless networks</li>
                    </ul>
                </div>

                <button class="btn" onclick="markSectionComplete('defense'); closeModal('defenseModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Packet Analysis Modal -->
        <div id="analysisModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('analysisModal')">&times;</span>
                <h2>üîç Wireless Packet Analysis</h2>
                
                <h3>üì° Understanding 802.11 Frame Structure</h3>
                
                <div class="info-box">
                    <strong>802.11 Frame Types:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Management Frames:</strong> Network management (beacon, probe, auth, assoc)</li>
                        <li><strong>Control Frames:</strong> Medium access control (RTS, CTS, ACK)</li>
                        <li><strong>Data Frames:</strong> Actual data transmission</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">802.11 Frame Components</h4>
                    <table style="margin-top: 10px;">
                        <tr>
                            <th>Component</th>
                            <th>Size</th>
                            <th>Purpose</th>
                        </tr>
                        <tr>
                            <td>Frame Control</td>
                            <td>2 bytes</td>
                            <td>Protocol version, frame type/subtype</td>
                        </tr>
                        <tr>
                            <td>Duration/ID</td>
                            <td>2 bytes</td>
                            <td>Channel reservation time or AID</td>
                        </tr>
                        <tr>
                            <td>Address 1</td>
                            <td>6 bytes</td>
                            <td>Destination MAC (receiver)</td>
                        </tr>
                        <tr>
                            <td>Address 2</td>
                            <td>6 bytes</td>
                            <td>Source MAC (transmitter)</td>
                        </tr>
                        <tr>
                            <td>Address 3</td>
                            <td>6 bytes</td>
                            <td>BSSID or additional address</td>
                        </tr>
                        <tr>
                            <td>Sequence Control</td>
                            <td>2 bytes</td>
                            <td>Fragment and sequence numbers</td>
                        </tr>
                        <tr>
                            <td>Address 4</td>
                            <td>6 bytes</td>
                            <td>Optional, used in WDS mode</td>
                        </tr>
                        <tr>
                            <td>Frame Body</td>
                            <td>0-2304 bytes</td>
                            <td>Actual payload data</td>
                        </tr>
                        <tr>
                            <td>FCS</td>
                            <td>4 bytes</td>
                            <td>Frame Check Sequence (CRC)</td>
                        </tr>
                    </table>
                </div>

                <h3>üéØ Key Management Frames</h3>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Beacon Frame</h4>
                        <p><strong>Subtype:</strong> 0x08</p>
                        <p><strong>Purpose:</strong> Advertise network presence</p>
                        <p><strong>Contains:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>SSID</li>
                            <li>Supported rates</li>
                            <li>Channel number</li>
                            <li>Encryption capabilities</li>
                            <li>Beacon interval (usually 100ms)</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Probe Request/Response</h4>
                        <p><strong>Subtype:</strong> 0x04 / 0x05</p>
                        <p><strong>Purpose:</strong> Active scanning</p>
                        <p><strong>Security Note:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Clients broadcast previously connected SSIDs</li>
                            <li>Reveals user's network history</li>
                            <li>Used in Karma attacks</li>
                        </ul>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Authentication Frame</h4>
                        <p><strong>Subtype:</strong> 0x0B</p>
                        <p><strong>Methods:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Open System (no actual auth)</li>
                            <li>Shared Key (WEP)</li>
                        </ul>
                        <p style="margin-top: 5px;"><strong>Note:</strong> Real security happens at association</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Association Request/Response</h4>
                        <p><strong>Subtype:</strong> 0x00 / 0x01</p>
                        <p><strong>Purpose:</strong> Establish connection</p>
                        <p><strong>Contains:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Supported rates</li>
                            <li>Capabilities</li>
                            <li>AID assignment (response)</li>
                        </ul>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Deauthentication Frame</h4>
                    <p><strong>Subtype:</strong> 0x0C</p>
                    <p><strong>Purpose:</strong> Terminate connection</p>
                    <p><strong>Reason Codes:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>1: Unspecified reason</li>
                        <li>2: Previous authentication no longer valid</li>
                        <li>3: Station leaving (or has left) BSS</li>
                        <li>6: Class 2 frame from non-authenticated station</li>
                        <li>7: Class 3 frame from non-associated station</li>
                    </ul>
                    
                    <div class="danger-box" style="margin-top: 10px;">
                        <strong>Attack Vector:</strong> Deauth frames are NOT encrypted or authenticated in WPA2! 
                        Attackers can forge them. WPA3's Protected Management Frames (PMF) addresses this.
                    </div>
                </div>

                <h3>üîê WPA/WPA2 4-Way Handshake Analysis</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">EAPOL (Extensible Authentication Protocol over LAN)</h4>
                    <p><strong>Used for:</strong> Key exchange in WPA/WPA2</p>
                    
                    <p style="margin-top: 15px;"><strong>4-Way Handshake Steps:</strong></p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line">Message 1: AP ‚Üí Client</div>
                        <div class="terminal-line">  - ANonce (AP nonce)</div>
                        <div class="terminal-line">  - Client generates PTK</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">Message 2: Client ‚Üí AP</div>
                        <div class="terminal-line">  - SNonce (Station nonce)</div>
                        <div class="terminal-line">  - MIC (proves client has PSK)</div>
                        <div class="terminal-line">  - RSN Information Element</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">Message 3: AP ‚Üí Client</div>
                        <div class="terminal-line">  - ANonce (again)</div>
                        <div class="terminal-line">  - GTK (Group Temporal Key) encrypted</div>
                        <div class="terminal-line">  - MIC (proves AP has PSK)</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line">Message 4: Client ‚Üí AP</div>
                        <div class="terminal-line">  - Acknowledgment with MIC</div>
                        <div class="terminal-line">  - Handshake complete, encrypted data can flow</div>
                    </div>

                    <div class="info-box" style="margin-top: 15px;">
                        <strong>What Attackers Need:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>All 4 messages (or just Message 2 & 3 with MIC)</li>
                            <li>ESSID (network name)</li>
                            <li>Then perform offline dictionary/brute-force attack</li>
                        </ul>
                    </div>
                </div>

                <h3>üõ†Ô∏è Wireshark for Wireless Analysis</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Setting Up Wireshark</h4>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># 1. Put interface in monitor mode</div>
                        <div class="terminal-line">$ sudo airmon-ng start wlan0</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 2. Start Wireshark on monitor interface</div>
                        <div class="terminal-line">$ sudo wireshark -i wlan0mon &</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># 3. Set channel (if needed)</div>
                        <div class="terminal-line">$ sudo iwconfig wlan0mon channel 6</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Essential Wireshark Display Filters</h4>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Show only beacon frames</div>
                        <div class="terminal-line">wlan.fc.type_subtype == 0x08</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Show only deauthentication frames</div>
                        <div class="terminal-line">wlan.fc.type_subtype == 0x0c</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Show EAPOL handshake packets</div>
                        <div class="terminal-line">eapol</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Filter by BSSID (AP MAC)</div>
                        <div class="terminal-line">wlan.bssid == 00:11:22:33:44:55</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Show all traffic for specific SSID</div>
                        <div class="terminal-line">wlan.ssid == "CorporateWiFi"</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Show probe requests (reveals client history)</div>
                        <div class="terminal-line">wlan.fc.type_subtype == 0x04</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Show data frames only</div>
                        <div class="terminal-line">wlan.fc.type == 2</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Find WEP encrypted traffic</div>
                        <div class="terminal-line">wlan.fc.protected == 1 && wlan.wep.iv</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Decrypting WPA2 Traffic in Wireshark</h4>
                    <p><strong>Requirements:</strong> Captured 4-way handshake + know the PSK</p>
                    
                    <p style="margin-top: 15px;"><strong>Steps:</strong></p>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Edit ‚Üí Preferences ‚Üí Protocols ‚Üí IEEE 802.11</li>
                        <li>Enable decryption checkbox</li>
                        <li>Click "Edit" next to "Decryption Keys"</li>
                        <li>Add key: Type "wpa-pwd", Key format: "password:SSID"</li>
                        <li>Example: <code>MyPassword123:CorporateWiFi</code></li>
                        <li>Click OK - encrypted frames now show decrypted payload</li>
                    </ol>

                    <div class="info-box" style="margin-top: 10px;">
                        <strong>Pro Tip:</strong> You must have the complete 4-way handshake in your capture for decryption to work!
                    </div>
                </div>

                <h3>üéØ Identifying Attack Patterns</h3>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Deauth Attack Detection</h4>
                    <p><strong>Indicators:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>High volume of deauth frames (>10/second)</li>
                        <li>Deauth frames with reason code 7 (Class 3 frame from non-associated)</li>
                        <li>Deauth frames from same source to multiple clients</li>
                        <li>Broadcast deauths (destination FF:FF:FF:FF:FF:FF)</li>
                    </ul>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Wireshark filter to detect deauth flood</div>
                        <div class="terminal-line">wlan.fc.type_subtype == 0x0c</div>
                        <div class="terminal-line"># Look at Statistics ‚Üí Packet Lengths</div>
                        <div class="terminal-line"># Spike in deauth frames = likely attack</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">Evil Twin Detection</h4>
                    <p><strong>Indicators:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Same SSID with different BSSID (MAC address)</li>
                        <li>Stronger signal than known legitimate AP</li>
                        <li>Different channel than expected</li>
                        <li>Missing or different vendor-specific information elements</li>
                        <li>Unusual supported rates or capabilities</li>
                    </ul>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Find all APs with same SSID</div>
                        <div class="terminal-line">wlan.ssid == "TargetNetwork" && wlan.fc.type_subtype == 0x08</div>
                        <div class="terminal-line"># Check BSSID field - if multiple different MACs = potential evil twin</div>
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #f44336;">WEP Cracking Detection</h4>
                    <p><strong>Indicators:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Massive increase in ARP request packets</li>
                        <li>Identical packet payloads (IV reuse)</li>
                        <li>Packet injection from unknown source</li>
                    </ul>
                </div>

                <h3>üìä Statistical Analysis</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Wireshark Statistics Features</h4>
                    
                    <p><strong>Useful Statistics (Statistics menu):</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Protocol Hierarchy:</strong> See distribution of packet types</li>
                        <li><strong>Conversations:</strong> Identify chatty devices</li>
                        <li><strong>Endpoints:</strong> See all MACs with traffic statistics</li>
                        <li><strong>WLAN Traffic:</strong> Wireless-specific statistics</li>
                        <li><strong>I/O Graphs:</strong> Visualize traffic over time</li>
                    </ul>
                </div>

                <h3>üî¨ Advanced Analysis Techniques</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Channel Hopping Analysis</h4>
                    <p><strong>Purpose:</strong> Capture packets across all channels</p>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Script to hop through channels</div>
                        <div class="terminal-line">$ for channel in {1..11}; do</div>
                        <div class="terminal-line">    sudo iwconfig wlan0mon channel $channel</div>
                        <div class="terminal-line">    sleep 2</div>
                        <div class="terminal-line">done</div>
                    </div>
                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Limitation:</strong> You'll miss packets on other channels while listening on one. 
                        Use multiple adapters for simultaneous multi-channel capture.
                    </div>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Exporting Objects</h4>
                    <p><strong>Extract files from HTTP traffic:</strong></p>
                    <p>File ‚Üí Export Objects ‚Üí HTTP</p>
                    <p style="margin-top: 10px;">Shows all files transferred over HTTP (images, documents, etc.)</p>
                    
                    <div class="danger-box" style="margin-top: 10px;">
                        <strong>Privacy Warning:</strong> This demonstrates why HTTPS is critical on wireless networks!
                    </div>
                </div>

                <button class="btn" onclick="markSectionComplete('analysis'); closeModal('analysisModal')">Mark Complete</button>
            </div>
        </div>

            </div>
        </div>

        <!-- Hands-On Labs Modal -->
        <div id="labsModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('labsModal')">&times;</span>
                <h2>üß™ Hands-On Wireless Security Labs</h2>
                
                <div class="danger-box">
                    <strong>üö® CRITICAL - READ BEFORE PROCEEDING:</strong>
                    <p style="margin-top: 10px;">These labs are for AUTHORIZED testing on YOUR OWN equipment or in controlled lab environments with written permission ONLY.</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Use isolated lab networks</li>
                        <li>‚úÖ Get written authorization</li>
                        <li>‚úÖ Document all activities</li>
                        <li>‚ùå NEVER test on networks you don't own</li>
                        <li>‚ùå NEVER attack public/neighbor networks</li>
                    </ul>
                </div>

                <h3>üõ†Ô∏è Lab Setup Requirements</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Required Hardware</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Host Machine:</strong> Laptop with 8GB+ RAM</li>
                        <li><strong>Wireless Adapter:</strong> Monitor mode capable
                            <ul style="margin-left: 20px;">
                                <li>Alfa AWUS036ACH (recommended)</li>
                                <li>TP-Link TL-WN722N v1</li>
                                <li>Panda Wireless PAU09</li>
                            </ul>
                        </li>
                        <li><strong>Test Access Point:</strong> Router you own for testing</li>
                        <li><strong>Target Device:</strong> Smartphone or second laptop</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Software Environment</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Operating System:</strong> Kali Linux (recommended) or Parrot Security OS</li>
                        <li><strong>Alternative:</strong> Ubuntu/Debian with tools installed</li>
                        <li><strong>Virtualization:</strong> VirtualBox or VMware (with USB passthrough)</li>
                        <li><strong>Essential Tools:</strong> aircrack-ng suite, Wireshark, kismet</li>
                    </ul>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Verify aircrack-ng installation</div>
                        <div class="terminal-line">$ aircrack-ng --help</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># If not installed (on Debian/Ubuntu):</div>
                        <div class="terminal-line">$ sudo apt update</div>
                        <div class="terminal-line">$ sudo apt install aircrack-ng wireshark kismet</div>
                    </div>
                </div>

                <h3>üî¨ Lab 1: Wireless Network Discovery</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Scan for wireless networks and analyze their configurations</p>
                    
                    <h4 style="color: #64ffda; margin-top: 20px;">Procedure</h4>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Step 1: Check wireless interface</div>
                        <div class="terminal-line">$ iwconfig</div>
                        <div class="terminal-line"># Look for wlan0 or similar</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 2: Kill interfering processes</div>
                        <div class="terminal-line">$ sudo airmon-ng check kill</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 3: Enable monitor mode</div>
                        <div class="terminal-line">$ sudo airmon-ng start wlan0</div>
                        <div class="terminal-line"># Interface becomes wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 4: Scan for networks</div>
                        <div class="terminal-line">$ sudo airodump-ng wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Press Ctrl+C to stop after 1-2 minutes</div>
                    </div>

                    <h4 style="color: #64ffda; margin-top: 20px;">Analysis Tasks</h4>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Identify networks using WEP (ENC column shows "WEP")</li>
                        <li>Find networks with default SSIDs (linksys, NETGEAR, etc.)</li>
                        <li>Note which channels are most congested</li>
                        <li>Identify networks with no encryption (Open)</li>
                        <li>Calculate signal strength (-30 dBm = strong, -80 dBm = weak)</li>
                        <li>Look for hidden SSIDs (show as "&lt;length: X&gt;")</li>
                    </ol>

                    <div class="info-box" style="margin-top: 15px;">
                        <strong>Expected Output Fields:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li><strong>BSSID:</strong> MAC address of AP</li>
                            <li><strong>PWR:</strong> Signal strength (closer to 0 = stronger)</li>
                            <li><strong>Beacons:</strong> Number of announcement packets</li>
                            <li><strong>Data:</strong> Number of data packets</li>
                            <li><strong>CH:</strong> Channel number</li>
                            <li><strong>ENC:</strong> Encryption type</li>
                            <li><strong>ESSID:</strong> Network name</li>
                        </ul>
                    </div>
                </div>

                <h3>üî¨ Lab 2: Monitoring Specific Network</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Capture traffic from a specific network and observe connected clients</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Step 1: Target specific network</div>
                        <div class="terminal-line"># Replace with your test AP's MAC and channel</div>
                        <div class="terminal-line">$ sudo airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w capture wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># -c 6: Channel 6</div>
                        <div class="terminal-line"># --bssid: Target AP MAC</div>
                        <div class="terminal-line"># -w capture: Write to files starting with "capture"</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Let it run for 5-10 minutes</div>
                        <div class="terminal-line"># Watch the "Data" column - you want packets!</div>
                    </div>

                    <h4 style="color: #64ffda; margin-top: 20px;">Analysis Tasks</h4>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Count number of connected clients (bottom section of output)</li>
                        <li>Identify most active client (highest packet count)</li>
                        <li>Note if any clients have weak signal (probe values)</li>
                        <li>Observe beacon interval (usually 100 TU = 102.4 ms)</li>
                        <li>Check for WPS enabled (look in beacon frame details)</li>
                    </ol>
                </div>

                <h3>üî¨ Lab 3: WPA2 Handshake Capture</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Capture the 4-way handshake for WPA2 network analysis</p>
                    
                    <div class="warning-box">
                        <strong>Important:</strong> Only perform on your own test network!
                    </div>

                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Terminal 1: Start capture on target</div>
                        <div class="terminal-line">$ sudo airodump-ng -c 6 --bssid [AP_MAC] -w handshake wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Terminal 2: Force client reconnection (deauth)</div>
                        <div class="terminal-line"># Wait for a client to show up in first terminal, then:</div>
                        <div class="terminal-line">$ sudo aireplay-ng --deauth 5 -a [AP_MAC] -c [CLIENT_MAC] wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Watch Terminal 1 for "WPA handshake: [MAC]" message</div>
                        <div class="terminal-line"># Press Ctrl+C in both terminals once captured</div>
                    </div>

                    <h4 style="color: #64ffda; margin-top: 20px;">Verification</h4>
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Verify handshake capture</div>
                        <div class="terminal-line">$ aircrack-ng handshake-01.cap</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Should show:</div>
                        <div class="terminal-line"># "1 handshake" next to target BSSID</div>
                    </div>

                    <div class="info-box" style="margin-top: 15px;">
                        <strong>Troubleshooting:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>If no handshake: Try more deauth packets (--deauth 10)</li>
                            <li>Ensure you're on correct channel</li>
                            <li>Client must reconnect while capturing</li>
                            <li>Some devices take longer to reconnect</li>
                        </ul>
                    </div>
                </div>

                <h3>üî¨ Lab 4: Packet Analysis with Wireshark</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Analyze captured wireless packets and identify frame types</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Open capture file in Wireshark</div>
                        <div class="terminal-line">$ wireshark handshake-01.cap &</div>
                    </div>

                    <h4 style="color: #64ffda; margin-top: 20px;">Analysis Exercises</h4>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Find Beacon Frames:</strong>
                            <br>Filter: <code>wlan.fc.type_subtype == 0x08</code>
                            <br>Task: Identify SSID, supported rates, channel
                        </li>
                        <li><strong>Locate Handshake:</strong>
                            <br>Filter: <code>eapol</code>
                            <br>Task: Identify all 4 EAPOL messages, examine MIC values
                        </li>
                        <li><strong>View Deauth Frames:</strong>
                            <br>Filter: <code>wlan.fc.type_subtype == 0x0c</code>
                            <br>Task: Check reason codes, source/destination MACs
                        </li>
                        <li><strong>Probe Requests:</strong>
                            <br>Filter: <code>wlan.fc.type_subtype == 0x04</code>
                            <br>Task: What SSIDs is the client looking for?
                        </li>
                        <li><strong>Statistics Analysis:</strong>
                            <br>Menu: Statistics ‚Üí WLAN Traffic
                            <br>Task: Review traffic distribution by type
                        </li>
                    </ol>
                </div>

                <h3>üî¨ Lab 5: Evil Twin Demonstration (Controlled)</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Create a rogue access point to understand MITM attacks</p>
                    
                    <div class="danger-box">
                        <strong>‚ö†Ô∏è CRITICAL:</strong> Only perform in isolated lab environment with devices you own!
                    </div>

                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Step 1: Create fake AP with airbase-ng</div>
                        <div class="terminal-line">$ sudo airbase-ng -e "TestLab" -c 6 wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 2: Configure interface (new terminal)</div>
                        <div class="terminal-line">$ sudo ifconfig at0 up</div>
                        <div class="terminal-line">$ sudo ifconfig at0 10.0.0.1 netmask 255.255.255.0</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 3: Start DHCP server</div>
                        <div class="terminal-line"># (Requires dhcpd configuration file)</div>
                        <div class="terminal-line">$ sudo dhcpd -cf /etc/dhcp/dhcpd.conf at0</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 4: Enable routing</div>
                        <div class="terminal-line">$ sudo echo 1 > /proc/sys/net/ipv4/ip_forward</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 5: Setup iptables NAT</div>
                        <div class="terminal-line">$ sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</div>
                    </div>

                    <h4 style="color: #64ffda; margin-top: 20px;">Testing</h4>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Connect a test device to the fake AP "TestLab"</li>
                        <li>Monitor connections in airbase-ng terminal</li>
                        <li>Capture traffic with Wireshark on at0 interface</li>
                        <li>Observe all HTTP requests from client</li>
                        <li>Demonstrates why HTTPS is essential!</li>
                    </ol>
                </div>

                <h3>üî¨ Lab 6: WPS Attack Simulation</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Test WPS vulnerability on your own router</p>
                    
                    <div class="terminal" style="margin-top: 10px;">
                        <div class="terminal-line"># Step 1: Scan for WPS-enabled APs</div>
                        <div class="terminal-line">$ sudo wash -i wlan0mon</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># Step 2: Attack WPS PIN (use YOUR test AP only!)</div>
                        <div class="terminal-line">$ sudo reaver -i wlan0mon -b [AP_MAC] -vv</div>
                        <div class="terminal-line"></div>
                        <div class="terminal-line"># This will take several hours</div>
                        <div class="terminal-line"># Demonstrates why WPS should be disabled</div>
                    </div>

                    <div class="warning-box" style="margin-top: 10px;">
                        <strong>Note:</strong> Modern routers have WPS rate limiting. Attack may take 10+ hours or fail entirely if properly protected.
                    </div>
                </div>

                <h3>üî¨ Lab 7: Wireless Security Audit</h3>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Objective</h4>
                    <p>Perform comprehensive security assessment of your wireless network</p>
                    
                    <h4 style="color: #64ffda; margin-top: 20px;">Audit Checklist</h4>
                    <div style="margin-left: 20px; margin-top: 10px;">
                        <p><strong>1. Network Discovery</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>‚òê Scan for all APs in range</li>
                            <li>‚òê Identify encryption types used</li>
                            <li>‚òê Check for WEP networks (critical vulnerability)</li>
                            <li>‚òê Look for open networks</li>
                        </ul>

                        <p style="margin-top: 15px;"><strong>2. Configuration Review</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>‚òê Check for default SSIDs</li>
                            <li>‚òê Verify WPA2/WPA3 encryption</li>
                            <li>‚òê Test if WPS is enabled (wash scan)</li>
                            <li>‚òê Check for SSID broadcast status</li>
                        </ul>

                        <p style="margin-top: 15px;"><strong>3. Access Point Security</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>‚òê Attempt login with default credentials</li>
                            <li>‚òê Check firmware version</li>
                            <li>‚òê Verify remote management is disabled</li>
                            <li>‚òê Review enabled features</li>
                        </ul>

                        <p style="margin-top: 15px;"><strong>4. Client Analysis</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>‚òê Monitor for unauthorized clients</li>
                            <li>‚òê Check client probe requests (reveals history)</li>
                            <li>‚òê Identify clients using weak protocols</li>
                        </ul>

                        <p style="margin-top: 15px;"><strong>5. Detection Testing</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>‚òê Test rogue AP detection (if deployed)</li>
                            <li>‚òê Create test rogue AP and verify alerts</li>
                            <li>‚òê Test deauth detection</li>
                            <li>‚òê Verify IDS/IPS functionality</li>
                        </ul>
                    </div>
                </div>

                <h3>üéì Advanced Challenge Labs</h3>

                <div class="encryption-comparison">
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Challenge 1</h4>
                        <strong>Hidden SSID Discovery</strong>
                        <p style="margin-top: 10px;">Task: Use airodump-ng and deauth attacks to reveal hidden SSID</p>
                        <p>Hint: Hidden SSIDs are exposed in probe responses when clients connect</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Challenge 2</h4>
                        <strong>Channel Optimization</strong>
                        <p style="margin-top: 10px;">Task: Analyze channel usage in your area and recommend optimal configuration</p>
                        <p>Hint: Use airodump-ng and look for least congested non-overlapping channels</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Challenge 3</h4>
                        <strong>Bluetooth Scanning</strong>
                        <p style="margin-top: 10px;">Task: Use hcitool and sdptool to discover Bluetooth devices and services</p>
                        <p>Hint: Scan, then enumerate services on discovered devices</p>
                    </div>
                    <div class="encryption-card">
                        <h4 style="color: #64ffda;">Challenge 4</h4>
                        <strong>Forensic Analysis</strong>
                        <p style="margin-top: 10px;">Task: Analyze capture file to reconstruct attack timeline</p>
                        <p>Hint: Look for deauth sequence followed by EAPOL frames</p>
                    </div>
                </div>

                <h3>üìö Lab Resources</h3>

                <div class="info-box">
                    <strong>Practice Environments:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>TryHackMe:</strong> "WiFi Hacking 101" room</li>
                        <li><strong>HackTheBox:</strong> Wireless challenges</li>
                        <li><strong>PentesterLab:</strong> Wireless security exercises</li>
                        <li><strong>DVWA:</strong> Set up on local network for testing</li>
                    </ul>
                </div>

                <div class="standard-card">
                    <h4 style="color: #64ffda;">Documentation Templates</h4>
                    <p>For each lab, document:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Date and time of testing</li>
                        <li>Equipment used (adapter model, OS version)</li>
                        <li>Commands executed with output</li>
                        <li>Observations and findings</li>
                        <li>Screenshots of key steps</li>
                        <li>Challenges encountered and solutions</li>
                        <li>Recommendations for security improvements</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>Remember:</strong> The goal is to learn defensive security. Understanding attacks helps build better defenses. Always practice ethical hacking principles!
                </div>

                <button class="btn" onclick="markSectionComplete('labs'); closeModal('labsModal')">Mark Complete</button>
            </div>
        </div>

        <!-- Quiz Modal -->
        <div id="quizModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('quizModal')">&times;</span>
                <h2>üìù Chapter 11 Assessment</h2>
                
                <div class="info-box">
                    <strong>Instructions:</strong> Answer all questions to test your knowledge. 
                    You must score 70% or higher to pass. Click "Submit Quiz" when ready.
                </div>

                <div id="quizContainer"></div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-success" onclick="submitQuiz()">Submit Quiz</button>
                    <button class="btn" onclick="resetQuiz()">Reset Quiz</button>
                </div>

                <div id="quizResults" style="margin-top: 30px; display: none;"></div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="content-section">
            <h2>üìö Chapter Summary</h2>
            <p>This comprehensive interactive module provides in-depth coverage of wireless network security:</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Foundation</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Wireless technology fundamentals</li>
                        <li>‚úÖ 802.11 standards evolution (Wi-Fi 1-6)</li>
                        <li>‚úÖ RF spectrum and channel management</li>
                        <li>‚úÖ SSID, BSSID, and network architecture</li>
                        <li>‚úÖ Access point configuration</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Authentication & Encryption</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ EAP, 802.1X, RADIUS protocols</li>
                        <li>‚úÖ WEP, WPA, WPA2, WPA3 comparison</li>
                        <li>‚úÖ 4-way handshake analysis</li>
                        <li>‚úÖ Certificate-based authentication</li>
                        <li>‚úÖ WPS vulnerabilities</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Reconnaissance</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Wardriving techniques and tools</li>
                        <li>‚úÖ Kismet and Vistumbler usage</li>
                        <li>‚úÖ Network discovery methods</li>
                        <li>‚úÖ Channel analysis</li>
                        <li>‚úÖ Legal and ethical considerations</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Attack Vectors</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ WEP/WPA/WPA2 cracking (Aircrack-ng)</li>
                        <li>‚úÖ Deauthentication attacks</li>
                        <li>‚úÖ Evil twin and rogue APs</li>
                        <li>‚úÖ PMKID and KRACK attacks</li>
                        <li>‚úÖ WPS PIN exploitation</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Advanced Attacks</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Wireless DoS (beacon flood, CTS/RTS)</li>
                        <li>‚úÖ MITM attacks and SSL stripping</li>
                        <li>‚úÖ Captive portal phishing</li>
                        <li>‚úÖ Karma attacks</li>
                        <li>‚úÖ Dragonblood (WPA3 attacks)</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Bluetooth Security</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Bluetooth architecture and versions</li>
                        <li>‚úÖ Bluejacking, Bluesnarfing, Bluebugging</li>
                        <li>‚úÖ BlueBorne and KNOB attacks</li>
                        <li>‚úÖ Bluetooth reconnaissance tools</li>
                        <li>‚úÖ Security best practices</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Defense & Detection</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ WIDS/WIPS deployment</li>
                        <li>‚úÖ Rogue AP detection methods</li>
                        <li>‚úÖ Wireless site surveys</li>
                        <li>‚úÖ Honeypot strategies</li>
                        <li>‚úÖ Defense in depth approach</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Packet Analysis</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ 802.11 frame structure</li>
                        <li>‚úÖ Management frame analysis</li>
                        <li>‚úÖ Wireshark for wireless</li>
                        <li>‚úÖ Attack pattern identification</li>
                        <li>‚úÖ Traffic decryption techniques</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Hands-On Practice</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Network scanning labs</li>
                        <li>‚úÖ Handshake capture exercises</li>
                        <li>‚úÖ Wireshark analysis labs</li>
                        <li>‚úÖ Security audit checklist</li>
                        <li>‚úÖ Challenge scenarios</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>üìñ Additional Resources</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Official Documentation</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>EC-Council CEH v13:</strong> Official study guide and labs</li>
                        <li><strong>IEEE 802.11:</strong> Official wireless standards documentation</li>
                        <li><strong>Wi-Fi Alliance:</strong> WPA3 specifications and whitepapers</li>
                        <li><strong>NIST SP 800-153:</strong> Guidelines for Securing Wireless LANs</li>
                        <li><strong>NIST SP 800-97:</strong> Wireless Network Security</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Tool Documentation</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Aircrack-ng:</strong> Complete wireless auditing suite docs</li>
                        <li><strong>Wireshark:</strong> Packet analysis and filtering guides</li>
                        <li><strong>Kismet:</strong> Wireless detection and IDS documentation</li>
                        <li><strong>Hashcat:</strong> Password recovery documentation</li>
                        <li><strong>Reaver/Bully:</strong> WPS attack tool guides</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Practice Platforms</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>TryHackMe:</strong> "WiFi Hacking 101", wireless rooms</li>
                        <li><strong>HackTheBox:</strong> Wireless network challenges</li>
                        <li><strong>PentesterLab:</strong> Wireless security exercises</li>
                        <li><strong>VulnHub:</strong> Wireless pentesting VMs</li>
                        <li><strong>CyberDefenders:</strong> Wireless forensics challenges</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Research & Updates</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>CVE Database:</strong> Wireless vulnerability tracking</li>
                        <li><strong>Exploit-DB:</strong> Wireless exploit archive</li>
                        <li><strong>SecurityFocus:</strong> Wireless security advisories</li>
                        <li><strong>ArXiv:</strong> Wireless security research papers</li>
                        <li><strong>DEF CON/Black Hat:</strong> Conference presentations</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Books</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>"Hacking Exposed Wireless" - Cache, Wright, Liu</li>
                        <li>"The Basics of Hacking and Penetration Testing" - Engebretson</li>
                        <li>"Penetration Testing" - Weidman</li>
                        <li>"Wireless Networks: First-Step" - Cioara</li>
                        <li>"802.11 Wireless Networks" - Gast</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #64ffda; font-size: 1.1em;">Communities</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Reddit:</strong> r/netsec, r/AskNetsec</li>
                        <li><strong>Forums:</strong> Offensive Security, Hack Forums</li>
                        <li><strong>Discord:</strong> InfoSec servers with wireless channels</li>
                        <li><strong>Twitter/X:</strong> Follow @WifiHistory, @TheHackersNews</li>
                        <li><strong>GitHub:</strong> Wireless security tool repositories</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>üéì Certification Path</h2>
            <p style="margin-bottom: 15px;">This module prepares you for wireless security sections in:</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                <div class="standard-card">
                    <strong>CEH (Certified Ethical Hacker)</strong><br>
                    EC-Council | Module 11: Hacking Wireless Networks
                </div>
                <div class="standard-card">
                    <strong>OSWP (Offensive Security Wireless Professional)</strong><br>
                    Offensive Security | Advanced wireless attacks
                </div>
                <div class="standard-card">
                    <strong>Security+</strong><br>
                    CompTIA | Wireless security fundamentals
                </div>
                <div class="standard-card">
                    <strong>CWSP (Certified Wireless Security Professional)</strong><br>
                    CWNP | Enterprise wireless security
                </div>
            </div>
        </div>

        <footer style="text-align: center; padding: 30px; color: #a8dadc; border-top: 1px solid rgba(100, 255, 218, 0.2); margin-top: 30px;">
            <p>CEH Chapter 11: Hacking Wireless Networks - Interactive Learning Module</p>
            <p style="margin-top: 10px;">üì° Master wireless security through hands-on practice and ethical hacking principles üîê</p>
            <p style="margin-top: 10px; font-size: 0.9em;">Press ESC to close any modal | Use keyboard navigation for better experience</p>
        </footer>
    </div>

    <script>
        // Progress tracking
        let completedSections = new Set();
        let quizScore = 0;

        // Quiz questions
        const quizQuestions = [
            {
                question: "Which IEEE standard defines authentication and authorization in wireless networks?",
                options: ["802.11", "802.11a", "802.11b", "802.1X"],
                correct: 3,
                explanation: "802.1X defines port-based network access control and is used for authentication in both wired and wireless networks. It provides a framework for authentication using protocols like EAP."
            },
            {
                question: "What is the maximum throughput of 802.11ax (Wi-Fi 6)?",
                options: ["600 Mbps", "1 Gbps", "6.9 Gbps", "10 Gbps"],
                correct: 3,
                explanation: "802.11ax (Wi-Fi 6) offers theoretical speeds up to 10 Gbps. It uses OFDMA, improved MU-MIMO, and operates in both 2.4 GHz and 5 GHz bands with better efficiency in congested environments."
            },
            {
                question: "Which TKIP enhancement prevents packet forgery attacks?",
                options: ["Extended IV", "Per-packet key mixing", "MIC (Message Integrity Check)", "Rekeying mechanism"],
                correct: 2,
                explanation: "MIC (Message Integrity Check), also called Michael, is a cryptographic integrity code that prevents forgeries. It ensures packets haven't been modified or forged by attackers."
            },
            {
                question: "How many non-overlapping channels are available in the 2.4 GHz band?",
                options: ["11", "6", "3", "1"],
                correct: 2,
                explanation: "Only 3 channels (1, 6, and 11) are non-overlapping in the 2.4 GHz band. Using these channels prevents interference when multiple APs are deployed in the same area."
            },
            {
                question: "What encryption algorithm does WPA3 use in Enterprise mode?",
                options: ["AES-128", "AES-192", "AES-256", "RC4"],
                correct: 2,
                explanation: "WPA3-Enterprise uses AES-256 encryption with SHA-384 for hashing. This provides 192-bit security strength, significantly stronger than WPA2's AES-128."
            },
            {
                question: "Which tool is most commonly used for WEP cracking?",
                options: ["Wireshark", "Nmap", "Aircrack-ng", "Kismet"],
                correct: 2,
                explanation: "Aircrack-ng is the industry-standard suite for wireless security auditing. It can crack WEP in minutes and WPA/WPA2 PSK through dictionary attacks after capturing the 4-way handshake."
            },
            {
                question: "What vulnerability makes WPS a security risk?",
                options: ["Uses weak encryption", "8-digit PIN can be brute-forced", "Broadcasts password", "No authentication"],
                correct: 1,
                explanation: "WPS uses an 8-digit PIN that can be brute-forced in hours (only ~11,000 attempts needed due to checksum). The Pixie Dust attack can extract PINs even faster. Always disable WPS!"
            },
            {
                question: "What does SSID stand for?",
                options: ["Secure System Identifier", "Service Set Identifier", "System Security ID", "Secure Service Internet Domain"],
                correct: 1,
                explanation: "SSID (Service Set Identifier) is the name that identifies a wireless network. It's a 1-32 character alphanumeric string that's case-sensitive and broadcast by the AP."
            },
            {
                question: "Which authentication method is considered most secure for enterprise WLANs?",
                options: ["WPA2-PSK", "WEP", "EAP-TLS", "WPS"],
                correct: 2,
                explanation: "EAP-TLS (Extensible Authentication Protocol - Transport Layer Security) uses certificates for mutual authentication and is considered the most secure method. It requires both client and server certificates."
            },
            {
                question: "What information can be gathered through wardriving?",
                options: ["SSIDs and encryption types", "Admin passwords", "Internal network topology", "Firewall rules"],
                correct: 0,
                explanation: "Wardriving captures broadcast information including SSIDs, MAC addresses, encryption types, signal strength, and GPS coordinates. It doesn't reveal passwords or internal network details without further attacks."
            },
            {
                question: "Which 802.11 standard operates exclusively in the 5 GHz band?",
                options: ["802.11b", "802.11g", "802.11a", "802.11n"],
                correct: 2,
                explanation: "802.11a operates only in the 5 GHz band and provides 54 Mbps throughput. The 5 GHz band has less interference and more non-overlapping channels than 2.4 GHz."
            },
            {
                question: "What attack forces a client to disconnect and reconnect to capture the WPA handshake?",
                options: ["Evil Twin", "Karma Attack", "Deauthentication Attack", "Fragmentation Attack"],
                correct: 2,
                explanation: "A deauthentication attack sends deauth frames to disconnect clients from their AP. When they reconnect, the 4-way WPA handshake can be captured for offline cracking attempts."
            },
            {
                question: "Which countermeasure is LEAST effective against wireless attacks?",
                options: ["WPA3 encryption", "Disabling SSID broadcast", "802.1X authentication", "Disabling WPS"],
                correct: 1,
                explanation: "Disabling SSID broadcast provides minimal security (security through obscurity). The SSID is still visible in probe requests and responses. Focus on strong encryption and authentication instead."
            },
            {
                question: "What is the purpose of an Access Point in a wireless network?",
                options: ["Provide DHCP services", "Bridge wireless and wired networks", "Encrypt all traffic", "Block unauthorized users"],
                correct: 1,
                explanation: "An Access Point (AP) acts as a bridge between the wireless LAN and wired network. It's a radio transceiver that connects wireless clients to the wired infrastructure and manages RF channels."
            },
            {
                question: "Which component in 802.1X makes the final authentication decision?",
                options: ["Supplicant", "Authenticator", "Authentication Server", "Access Point"],
                correct: 2,
                explanation: "The Authentication Server (typically a RADIUS server) makes the final authentication decision. The supplicant requests access, the authenticator (AP) forwards the request, and the authentication server approves or denies."
            },
            {
                question: "What does the PMKID attack allow an attacker to do?",
                options: ["Crack WEP encryption", "Capture handshake without clients", "Jam wireless signals", "Decrypt traffic in real-time"],
                correct: 1,
                explanation: "The PMKID attack (discovered in 2018) allows capturing the hash needed for offline password cracking without waiting for a client to connect. The PMKID is obtained directly from the AP's response."
            },
            {
                question: "Which Bluetooth attack involves taking complete control of a device?",
                options: ["Bluejacking", "Bluesnarfing", "Bluebugging", "BlueSmack"],
                correct: 2,
                explanation: "Bluebugging allows an attacker to take complete control of a Bluetooth device - making calls, sending messages, accessing internet, and eavesdropping. It's the most severe Bluetooth attack."
            },
            {
                question: "What is the primary function of a WIPS (Wireless Intrusion Prevention System)?",
                options: ["Encrypt wireless traffic", "Detect and respond to threats", "Boost wireless signal", "Manage multiple APs"],
                correct: 1,
                explanation: "A WIPS (Wireless Intrusion Prevention System) both detects threats (like WIDS) and automatically responds to them through actions like deauthentication containment, RF jamming, or VLAN quarantine."
            },
            {
                question: "In the WPA/WPA2 4-way handshake, what does the MIC prove?",
                options: ["Client has correct PSK", "AP has latest firmware", "Connection is encrypted", "Channel is secure"],
                correct: 0,
                explanation: "The MIC (Message Integrity Check) in the 4-way handshake proves the client possesses the correct Pre-Shared Key (PSK) without transmitting the password. It's a cryptographic proof of knowledge."
            },
            {
                question: "What is the main advantage of WPA3's SAE (Simultaneous Authentication of Equals)?",
                options: ["Faster connection speed", "Protection against offline dictionary attacks", "Lower power consumption", "Longer range"],
                correct: 1,
                explanation: "SAE in WPA3 protects against offline dictionary attacks by using a password-authenticated key exchange. Even if an attacker captures the handshake, they cannot perform offline brute-force attacks like in WPA2."
            },
            {
                question: "Which Wireshark filter would show only deauthentication frames?",
                options: ["wlan.type == deauth", "wlan.fc.type_subtype == 0x0c", "802.11.deauth", "wlan.deauth == 1"],
                correct: 1,
                explanation: "The correct Wireshark display filter for deauthentication frames is 'wlan.fc.type_subtype == 0x0c' where 0x0c is the hexadecimal type/subtype value for deauth management frames."
            },
            {
                question: "What is the purpose of RF shielding in wireless security?",
                options: ["Boost signal strength", "Prevent signals from leaving/entering areas", "Improve encryption", "Reduce power consumption"],
                correct: 1,
                explanation: "RF shielding (using Faraday cages, special paint, or mesh) prevents radio signals from leaving or entering sensitive areas, providing physical layer security by containing wireless transmissions."
            },
            {
                question: "Which tool is specifically designed for WPS PIN attacks?",
                options: ["Aircrack-ng", "Reaver", "Kismet", "Wireshark"],
                correct: 1,
                explanation: "Reaver is specifically designed to exploit the WPS vulnerability by brute-forcing the 8-digit PIN. It can crack WPS-enabled networks in hours, even if they use strong WPA2 encryption."
            },
            {
                question: "What information is contained in an 802.11 beacon frame?",
                options: ["Only SSID", "SSID, channel, encryption capabilities", "User passwords", "Client MAC addresses"],
                correct: 1,
                explanation: "Beacon frames broadcast the SSID, supported data rates, channel number, encryption capabilities (WEP/WPA/WPA2/WPA3), and other network parameters. They're sent every ~100ms by the AP."
            },
            {
                question: "Why should organizations disable WPS even with WPA2/WPA3?",
                options: ["It slows down the network", "The PIN can be brute-forced", "It's incompatible with encryption", "It broadcasts the password"],
                correct: 1,
                explanation: "WPS should be disabled because its 8-digit PIN can be brute-forced in hours, bypassing even strong WPA2/WPA3 encryption. The PIN vulnerability allows attackers to obtain the Wi-Fi password."
            }
        ];

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            if (modalId === 'quizModal' && document.getElementById('quizContainer').children.length === 0) {
                loadQuiz();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Close modal on ESC key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = document.getElementsByClassName('modal');
                for (let modal of modals) {
                    modal.style.display = 'none';
                }
            }
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        function markSectionComplete(section) {
            completedSections.add(section);
            updateProgress();
        }

        function updateProgress() {
            const totalSections = 10; // basics, standards, authentication, wardriving, hacking, advanced, bluetooth, defense, analysis, labs, quiz
            const progress = (completedSections.size / totalSections) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = Math.round(progress) + '%';
        }

        function showChannelInfo(channel) {
            const info = {
                1: "Channel 1 (2.412 GHz) is one of the three non-overlapping channels. Ideal for AP deployment to minimize interference.",
                6: "Channel 6 (2.437 GHz) is the center non-overlapping channel. Most commonly used in residential deployments.",
                11: "Channel 11 (2.462 GHz) is the highest non-overlapping channel in the 2.4 GHz band. Good choice for crowded environments."
            };
            
            document.getElementById('channelInfo').innerHTML = `
                <div class="info-box">
                    <strong>Channel ${channel} Information:</strong>
                    <p>${info[channel]}</p>
                </div>
            `;
        }

        // Network Scanner Simulator
        function scanNetworks() {
            const networks = [
                { ssid: "CorporateWiFi", bssid: "00:1A:2B:3C:4D:5E", channel: 6, signal: -45, encryption: "WPA3", security: "high" },
                { ssid: "linksys", bssid: "A4:5E:60:E2:8F:1B", channel: 11, signal: -62, encryption: "WPA2", security: "medium" },
                { ssid: "NETGEAR", bssid: "B8:27:EB:D4:9C:7A", channel: 1, signal: -70, encryption: "WEP", security: "low" },
                { ssid: "GuestNetwork", bssid: "CC:40:D0:12:34:56", channel: 6, signal: -55, encryption: "Open", security: "none" },
                { ssid: "Home_5G", bssid: "D8:0D:17:AB:CD:EF", channel: 36, signal: -48, encryption: "WPA2", security: "medium" },
                { ssid: "CoffeeShop_Free", bssid: "E4:8D:8C:12:34:56", channel: 11, signal: -68, encryption: "Open", security: "none" },
                { ssid: "", bssid: "F0:9F:C2:AB:12:34", channel: 1, signal: -75, encryption: "WPA2", security: "medium", hidden: true }
            ];

            let resultsHTML = '<h3>Scan Results:</h3>';
            
            networks.forEach((network, index) => {
                const signalBars = getSignalBars(network.signal);
                const securityColor = getSecurityColor(network.security);
                const displaySSID = network.hidden ? "[Hidden SSID]" : network.ssid;
                
                resultsHTML += `
                    <div class="scan-result" onclick="showNetworkDetails(${index})">
                        <strong>${displaySSID}</strong> ${network.hidden ? 'üîí' : ''}
                        <br>BSSID: ${network.bssid}
                        <br>Channel: ${network.channel} | Signal: ${signalBars} (${network.signal} dBm)
                        <br>Encryption: <span style="color: ${securityColor}">${network.encryption}</span>
                    </div>
                `;
            });

            document.getElementById('scanResults').innerHTML = resultsHTML;
            
            // Store networks for detail view
            window.scannedNetworks = networks;
        }

        function getSignalBars(signal) {
            if (signal >= -50) return "üì∂üì∂üì∂üì∂";
            if (signal >= -60) return "üì∂üì∂üì∂";
            if (signal >= -70) return "üì∂üì∂";
            return "üì∂";
        }

        function getSecurityColor(security) {
            switch(security) {
                case "high": return "#4caf50";
                case "medium": return "#ffc107";
                case "low": return "#ff9800";
                case "none": return "#f44336";
                default: return "#e0e0e0";
            }
        }

        function showNetworkDetails(index) {
            const network = window.scannedNetworks[index];
            
            let vulnerabilities = "";
            if (network.encryption === "WEP") {
                vulnerabilities = "<div class='danger-box'><strong>‚ö†Ô∏è Critical:</strong> WEP encryption is broken and can be cracked in minutes!</div>";
            } else if (network.encryption === "Open") {
                vulnerabilities = "<div class='danger-box'><strong>‚ö†Ô∏è Critical:</strong> No encryption! All traffic visible to attackers.</div>";
            } else if (network.ssid === "linksys" || network.ssid === "NETGEAR") {
                vulnerabilities = "<div class='warning-box'><strong>‚ö†Ô∏è Warning:</strong> Default SSID detected. Likely using default configuration.</div>";
            } else if (network.encryption === "WPA2") {
                vulnerabilities = "<div class='warning-box'><strong>‚ö†Ô∏è Recommendation:</strong> Consider upgrading to WPA3 for enhanced security.</div>";
            } else {
                vulnerabilities = "<div class='info-box'><strong>‚úÖ Good:</strong> Using modern encryption standards.</div>";
            }

            const detailsHTML = `
                <div class="standard-card">
                    <h4>${network.hidden ? '[Hidden SSID]' : network.ssid}</h4>
                    <p><strong>BSSID:</strong> ${network.bssid}</p>
                    <p><strong>Channel:</strong> ${network.channel}</p>
                    <p><strong>Frequency:</strong> ${network.channel <= 14 ? '2.4 GHz' : '5 GHz'}</p>
                    <p><strong>Signal Strength:</strong> ${network.signal} dBm</p>
                    <p><strong>Encryption:</strong> ${network.encryption}</p>
                    ${vulnerabilities}
                </div>
            `;

            document.getElementById('networkDetails').innerHTML = detailsHTML;
            document.getElementById('scanDetails').style.display = 'block';
        }

        function clearScan() {
            document.getElementById('scanResults').innerHTML = '';
            document.getElementById('scanDetails').style.display = 'none';
        }

        function updateOverlap() {
            const ch1 = document.getElementById('ch1').checked;
            const ch6 = document.getElementById('ch6').checked;
            const ch11 = document.getElementById('ch11').checked;

            let message = "";
            let color = "";

            if ((ch1 && ch6) || (ch6 && ch11) || (ch1 && ch11 && ch6)) {
                message = "‚ö†Ô∏è WARNING: Selected channels will interfere with each other!";
                color = "#ff9800";
            } else if ((ch1 && !ch6 && !ch11) || (!ch1 && ch6 && !ch11) || (!ch1 && !ch6 && ch11)) {
                message = "‚úÖ GOOD: Single channel selected, no overlap.";
                color = "#4caf50";
            } else if ((ch1 && ch11) && !ch6) {
                message = "‚úÖ EXCELLENT: Channels 1 and 11 do not overlap! Optimal configuration.";
                color = "#4caf50";
            } else if ((ch1 && ch6 && ch11)) {
                message = "‚úÖ OPTIMAL: All three non-overlapping channels selected!";
                color = "#00ff00";
            } else {
                message = "Select channels above to visualize overlap";
                color = "#64ffda";
            }

            document.getElementById('overlapViz').innerHTML = `
                <p style="text-align: center; color: ${color}; font-weight: bold; font-size: 1.1em;">
                    ${message}
                </p>
            `;
        }

        function analyzePassword() {
            const password = document.getElementById('passwordInput').value;
            
            if (!password) {
                document.getElementById('passwordStrength').innerHTML = '';
                return;
            }

            let strength = 0;
            let feedback = [];

            if (password.length >= 8) strength += 20;
            if (password.length >= 12) strength += 20;
            if (password.length >= 16) strength += 10;
            if (/[a-z]/.test(password)) strength += 10;
            if (/[A-Z]/.test(password)) strength += 10;
            if (/[0-9]/.test(password)) strength += 10;
            if (/[^a-zA-Z0-9]/.test(password)) strength += 15;
            if (password.length >= 20) strength += 5;

            let strengthText = "";
            let strengthColor = "";

            if (strength < 40) {
                strengthText = "WEAK";
                strengthColor = "#f44336";
                feedback.push("‚ùå Too short or simple");
            } else if (strength < 70) {
                strengthText = "MODERATE";
                strengthColor = "#ffc107";
                feedback.push("‚ö†Ô∏è Could be stronger");
            } else if (strength < 85) {
                strengthText = "STRONG";
                strengthColor = "#4caf50";
                feedback.push("‚úÖ Good password");
            } else {
                strengthText = "VERY STRONG";
                strengthColor = "#00ff00";
                feedback.push("‚úÖ Excellent password!");
            }

            if (password.length < 12) feedback.push("‚Ä¢ Use at least 12 characters");
            if (!/[a-z]/.test(password)) feedback.push("‚Ä¢ Add lowercase letters");
            if (!/[A-Z]/.test(password)) feedback.push("‚Ä¢ Add uppercase letters");
            if (!/[0-9]/.test(password)) feedback.push("‚Ä¢ Add numbers");
            if (!/[^a-zA-Z0-9]/.test(password)) feedback.push("‚Ä¢ Add special characters");

            const timeEstimate = estimateCrackTime(password);

            const html = `
                <div class="standard-card">
                    <h4>Password Strength: <span style="color: ${strengthColor}">${strengthText}</span></h4>
                    <div class="security-meter">
                        <div class="security-level" style="width: ${strength}%; background: ${strengthColor};"></div>
                    </div>
                    <p style="margin-top: 10px;"><strong>Estimated crack time (offline attack):</strong> ${timeEstimate}</p>
                    <div style="margin-top: 15px;">
                        ${feedback.map(f => `<p>${f}</p>`).join('')}
                    </div>
                </div>
            `;

            document.getElementById('passwordStrength').innerHTML = html;
        }

        function estimateCrackTime(password) {
            const length = password.length;
            let charset = 0;
            
            if (/[a-z]/.test(password)) charset += 26;
            if (/[A-Z]/.test(password)) charset += 26;
            if (/[0-9]/.test(password)) charset += 10;
            if (/[^a-zA-Z0-9]/.test(password)) charset += 32;

            const combinations = Math.pow(charset, length);
            const hashesPerSecond = 100000000000; // 100 billion hashes/sec (modern GPU)
            const seconds = combinations / hashesPerSecond;

            if (seconds < 1) return "< 1 second";
            if (seconds < 60) return `${Math.round(seconds)} seconds`;
            if (seconds < 3600) return `${Math.round(seconds / 60)} minutes`;
            if (seconds < 86400) return `${Math.round(seconds / 3600)} hours`;
            if (seconds < 31536000) return `${Math.round(seconds / 86400)} days`;
            if (seconds < 3153600000) return `${Math.round(seconds / 31536000)} years`;
            return `${Math.round(seconds / 31536000000)} centuries`;
        }

        // Quiz Functions
        function loadQuiz() {
            let quizHTML = '';
            
            quizQuestions.forEach((q, index) => {
                quizHTML += `
                    <div class="quiz-question" id="question${index}">
                        <h3>Question ${index + 1}</h3>
                        <p>${q.question}</p>
                        ${q.options.map((option, optIndex) => `
                            <div class="quiz-option" onclick="selectAnswer(${index}, ${optIndex})">
                                <input type="radio" name="q${index}" id="q${index}_${optIndex}" value="${optIndex}">
                                <label for="q${index}_${optIndex}">${option}</label>
                            </div>
                        `).join('')}
                        <div id="explanation${index}" style="display: none; margin-top: 15px;"></div>
                    </div>
                `;
            });

            document.getElementById('quizContainer').innerHTML = quizHTML;
        }

        function selectAnswer(questionIndex, optionIndex) {
            const options = document.querySelectorAll(`#question${questionIndex} .quiz-option`);
            options.forEach((opt, idx) => {
                opt.classList.remove('correct', 'incorrect');
                if (idx === optionIndex) {
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            let score = 0;
            let answered = 0;

            quizQuestions.forEach((q, index) => {
                const selected = document.querySelector(`input[name="q${index}"]:checked`);
                
                if (selected) {
                    answered++;
                    const selectedIndex = parseInt(selected.value);
                    const options = document.querySelectorAll(`#question${index} .quiz-option`);
                    
                    if (selectedIndex === q.correct) {
                        score++;
                        options[selectedIndex].classList.add('correct');
                    } else {
                        options[selectedIndex].classList.add('incorrect');
                        options[q.correct].classList.add('correct');
                    }

                    document.getElementById(`explanation${index}`).innerHTML = `
                        <div class="info-box">
                            <strong>Explanation:</strong> ${q.explanation}
                        </div>
                    `;
                    document.getElementById(`explanation${index}`).style.display = 'block';
                }
            });

            if (answered < quizQuestions.length) {
                alert('Please answer all questions before submitting!');
                return;
            }

            const percentage = Math.round((score / quizQuestions.length) * 100);
            const passed = percentage >= 70;

            let resultsHTML = `
                <div class="content-section" style="text-align: center;">
                    <h2>Quiz Results</h2>
                    <div style="font-size: 3em; margin: 20px 0;">
                        ${passed ? '‚úÖ' : '‚ùå'}
                    </div>
                    <h3>Score: ${score} / ${quizQuestions.length} (${percentage}%)</h3>
                    <p style="font-size: 1.2em; margin: 20px 0;">
                        ${passed ? 
                            '<span style="color: #4caf50;">Congratulations! You passed the assessment.</span>' : 
                            '<span style="color: #f44336;">You need 70% or higher to pass. Review the material and try again.</span>'}
                    </p>
                </div>
            `;

            document.getElementById('quizResults').innerHTML = resultsHTML;
            document.getElementById('quizResults').style.display = 'block';

            if (passed) {
                markSectionComplete('quiz');
            }

            // Scroll to results
            document.getElementById('quizResults').scrollIntoView({ behavior: 'smooth' });
        }

        function resetQuiz() {
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('quizContainer').innerHTML = '';
            loadQuiz();
        }
    </script>
</body>
</html>