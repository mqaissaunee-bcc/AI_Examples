<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication and Account Management - Interactive Lesson</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Accessibility Toggle */
        .accessibility-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .accessibility-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .accessibility-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .accessibility-btn.active {
            background: white;
            color: #667eea;
        }

        /* High Contrast Mode */
        body.high-contrast {
            background: #000;
        }

        body.high-contrast .container {
            background: #fff;
            border: 3px solid #000;
        }

        body.high-contrast .term {
            color: #0000ff;
            border-bottom: 3px solid #0000ff;
        }

        body.high-contrast .section-header {
            background: #000 !important;
            color: #fff !important;
            border: 2px solid #fff;
        }

        body.high-contrast .quiz-options li:hover {
            border-color: #000;
            background: #ffff00;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .section:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .section-header h2 {
            font-size: 1.5em;
        }

        .section-header .toggle {
            font-size: 1.5em;
            transition: transform 0.3s ease;
        }

        .section-header.active .toggle {
            transform: rotate(180deg);
        }

        .section-content {
            padding: 30px;
            display: none;
            background: #f9f9f9;
        }

        .section-content.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .term {
            color: #667eea;
            font-weight: 600;
            cursor: help;
            border-bottom: 2px dotted #667eea;
            position: relative;
        }

        /* Improved Tooltip with Better Positioning */
        .tooltip {
            position: fixed;
            background: #333;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.9em;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: none;
            line-height: 1.4;
            pointer-events: none;
        }

        .tooltip::before {
            content: '';
            position: absolute;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid #333;
        }

        .tooltip.position-top::before {
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
        }

        .tooltip.position-bottom::before {
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%) rotate(180deg);
        }

        .credential-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .credential-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .credential-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            border-color: #667eea;
        }

        .credential-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .credential-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .quiz {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 5px solid #667eea;
        }

        .quiz-question {
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #333;
        }

        .quiz-options {
            list-style: none;
        }

        .quiz-options li {
            padding: 12px;
            margin: 8px 0;
            background: #f5f5f5;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .quiz-options li:hover {
            background: #e8e8e8;
            border-color: #667eea;
        }

        .quiz-options li.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .quiz-options li.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        .quiz-feedback.incorrect {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }

        .attack-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .attack-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .attack-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .attack-table tr:last-child td {
            border-bottom: none;
        }

        .attack-table tr:hover {
            background: #f5f5f5;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .success-box {
            background: #e8f5e9;
            border-left: 5px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .password-strength-demo {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .password-input {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }

        .strength-meter {
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }

        .strength-meter-fill {
            height: 100%;
            transition: all 0.3s ease;
            border-radius: 5px;
        }

        .strength-feedback {
            margin-top: 10px;
            font-weight: 600;
        }

        /* NEW: Password Policy Configurator */
        .policy-configurator {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .policy-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f5f5f5;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .policy-option label {
            font-weight: 600;
            flex: 1;
        }

        .policy-option input[type="number"],
        .policy-option select {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            width: 150px;
        }

        .policy-option input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .policy-result {
            margin-top: 20px;
            padding: 20px;
            background: #e3f2fd;
            border-radius: 5px;
            border-left: 5px solid #2196f3;
        }

        .policy-result h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .policy-strength-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-left: 10px;
        }

        .policy-strength-weak {
            background: #f44336;
            color: white;
        }

        .policy-strength-moderate {
            background: #ffc107;
            color: #333;
        }

        .policy-strength-strong {
            background: #4caf50;
            color: white;
        }

        /* NEW: Attack Simulator */
        .attack-simulator {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .attack-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .attack-btn {
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .attack-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .attack-result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 5px;
            display: none;
        }

        .attack-result.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .attack-result.success {
            background: #f44336;
            color: white;
            border-left: 5px solid #c62828;
        }

        .attack-result.failed {
            background: #4caf50;
            color: white;
            border-left: 5px solid #2e7d32;
        }

        /* NEW: Interactive Decision Scenario */
        .decision-scenario {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .scenario-choices {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .choice-btn {
            padding: 15px;
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s ease;
        }

        .choice-btn:hover {
            background: #e8e8e8;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .choice-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .choice-btn.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .choice-btn.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .scenario-feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 5px;
            display: none;
        }

        .scenario-feedback.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .biometric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .biometric-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .biometric-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
        }

        .biometric-card h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .completion-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-left: 10px;
        }

        ul, ol {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin: 8px 0;
        }

        .highlight {
            background: #fff59d;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }

        .scenario-box {
            background: #f3e5f5;
            border-left: 5px solid #9c27b0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .scenario-box h3 {
            color: #6a1b9a;
            margin-bottom: 10px;
        }

        /* Button Styles */
        .btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        /* Mobile Responsive Improvements */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .credential-types {
                grid-template-columns: 1fr;
            }

            .accessibility-controls {
                position: static;
                justify-content: center;
                margin-top: 15px;
                flex-wrap: wrap;
            }

            .accessibility-btn {
                font-size: 0.8em;
                padding: 6px 12px;
            }

            .attack-controls {
                grid-template-columns: 1fr;
            }

            .policy-option {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .policy-option input[type="number"],
            .policy-option select {
                width: 100%;
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }

            .accessibility-controls,
            .toggle,
            .btn {
                display: none;
            }

            .section-content {
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="accessibility-controls">
                <button class="accessibility-btn" id="highContrastBtn">High Contrast</button>
                <button class="accessibility-btn" id="largeFontBtn">Large Font</button>
            </div>
            <h1>üîê Authentication and Account Management</h1>
            <p>Securing Access to Systems and Data</p>
        </div>

        <div class="content">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <!-- Introduction Section -->
            <div class="section">
                <div class="section-header">
                    <h2>üìò Introduction to Authentication</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p><span class="term" data-tooltip="Authentication is the process of verifying the identity of a user, device, or system.">Authentication</span> is a fundamental security control that verifies "you are who you say you are." Before granting access to systems, networks, or data, authentication confirms the identity of users through various <span class="term" data-tooltip="Credentials are pieces of information used to verify identity, such as passwords, tokens, or biometric data.">credentials</span>.</p>
                    
                    <div class="info-box">
                        <h3>Why Authentication Matters</h3>
                        <p>Strong authentication is the first line of defense against unauthorized access. Weak authentication can lead to:</p>
                        <ul>
                            <li>Data breaches and theft of sensitive information</li>
                            <li>Identity theft and fraud</li>
                            <li>System compromise and malware installation</li>
                            <li>Financial losses and reputational damage</li>
                        </ul>
                    </div>

                    <p>Authentication works in conjunction with two other key security concepts:</p>
                    <ul>
                        <li><strong><span class="term" data-tooltip="Identification is the process of claiming an identity, typically through a username or ID.">Identification</span>:</strong> Claiming an identity (e.g., username)</li>
                        <li><strong>Authentication:</strong> Proving that identity</li>
                        <li><strong><span class="term" data-tooltip="Authorization determines what an authenticated user is allowed to access or do within a system.">Authorization</span>:</strong> Determining what the authenticated user can access</li>
                    </ul>
                </div>
            </div>

            <!-- Five Types of Authentication -->
            <div class="section">
                <div class="section-header">
                    <h2>üéØ The Five Types of Authentication Credentials</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Authentication credentials can be categorized into five fundamental types, each with unique characteristics and security implications:</p>
                    
                    <div class="credential-types">
                        <div class="credential-card">
                            <div class="icon">üß†</div>
                            <h3>What You Know</h3>
                            <p>Knowledge-based authentication using passwords, PINs, or security questions</p>
                        </div>
                        <div class="credential-card">
                            <div class="icon">üîë</div>
                            <h3>What You Have</h3>
                            <p>Possession-based authentication using tokens, smart cards, or mobile devices</p>
                        </div>
                        <div class="credential-card">
                            <div class="icon">üë§</div>
                            <h3>What You Are</h3>
                            <p>Biometric authentication using fingerprints, facial recognition, or iris scans</p>
                        </div>
                        <div class="credential-card">
                            <div class="icon">‚úçÔ∏è</div>
                            <h3>What You Do</h3>
                            <p>Behavioral biometrics like typing patterns or gait recognition</p>
                        </div>
                        <div class="credential-card">
                            <div class="icon">üìç</div>
                            <h3>Where You Are</h3>
                            <p>Location-based authentication using geolocation or network location</p>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h3>‚ö†Ô∏è Single-Factor vs. Multi-Factor Authentication</h3>
                        <p><span class="term" data-tooltip="Single-factor authentication uses only one type of credential to verify identity.">Single-factor authentication</span> uses only one credential type, which provides minimal security. <span class="term" data-tooltip="Multi-factor authentication (MFA) requires two or more different types of credentials for verification.">Multi-factor authentication (MFA)</span> combines two or more types, significantly improving security.</p>
                        <p><strong>Example:</strong> Using a password (what you know) AND a fingerprint (what you are) provides much stronger security than using a password alone.</p>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: Which of the following represents multi-factor authentication?</div>
                        <ul class="quiz-options" data-answer="2">
                            <li data-value="1">Entering a password and a PIN</li>
                            <li data-value="2">Entering a password and scanning your fingerprint</li>
                            <li data-value="3">Entering two different passwords</li>
                            <li data-value="4">Using facial recognition and iris scan</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Password Authentication -->
            <div class="section">
                <div class="section-header">
                    <h2>üîí Password Authentication (What You Know)</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Passwords remain the most common authentication method despite significant security weaknesses. Understanding password vulnerabilities and best practices is crucial for cybersecurity professionals.</p>

                    <h3>Why Passwords Are Weak</h3>
                    <p>The fundamental weakness of passwords stems from limitations of human memory:</p>
                    <ul>
                        <li><strong>Limited Memory:</strong> Humans can only memorize a limited number of complex passwords</li>
                        <li><strong>Multiple Accounts:</strong> Average users have dozens of accounts requiring passwords</li>
                        <li><strong>Complexity Requirements:</strong> Strong passwords are difficult to remember</li>
                        <li><strong>Frequent Changes:</strong> Security policies often require regular password changes</li>
                        <li><strong>Predictable Patterns:</strong> Users create passwords following predictable patterns</li>
                    </ul>

                    <div class="info-box">
                        <h3>Common Password Weaknesses</h3>
                        <ul>
                            <li><strong>Short passwords:</strong> Easily cracked through brute force</li>
                            <li><strong>Dictionary words:</strong> Vulnerable to dictionary attacks</li>
                            <li><strong>Personal information:</strong> Names, birthdays, addresses can be discovered</li>
                            <li><strong>Predictable substitutions:</strong> "P@ssw0rd" is as weak as "Password"</li>
                            <li><strong>Password reuse:</strong> One breach compromises multiple accounts</li>
                        </ul>
                    </div>

                    <div class="password-strength-demo">
                        <h3>Password Strength Checker</h3>
                        <p>Try creating a password and see how strong it is:</p>
                        <input type="password" class="password-input" id="passwordInput" placeholder="Enter a password...">
                        <button class="btn" onclick="document.getElementById('passwordInput').type = document.getElementById('passwordInput').type === 'password' ? 'text' : 'password'">Toggle Visibility</button>
                        <div class="strength-meter">
                            <div class="strength-meter-fill" id="strengthMeter"></div>
                        </div>
                        <div class="strength-feedback" id="strengthFeedback"></div>
                        <div id="passwordDetails" style="margin-top: 15px; font-size: 0.9em; color: #666;"></div>
                    </div>

                    <h3>Most Common Passwords (Never Use These!)</h3>
                    <div class="warning-box">
                        <p>These passwords can be cracked instantly:</p>
                        <ul style="columns: 3;">
                            <li>123456</li>
                            <li>password</li>
                            <li>12345678</li>
                            <li>qwerty</li>
                            <li>123456789</li>
                            <li>12345</li>
                            <li>111111</li>
                            <li>1234567</li>
                            <li>abc123</li>
                            <li>password1</li>
                        </ul>
                    </div>

                    <h3>Password Security Best Practices</h3>
                    <div class="success-box">
                        <h3>‚úÖ Creating Strong Passwords</h3>
                        <ul>
                            <li><strong>Length is King:</strong> Minimum 15-20 characters (longer is better)</li>
                            <li><strong>Use All Character Types:</strong> Uppercase, lowercase, numbers, symbols</li>
                            <li><strong>Avoid Dictionary Words:</strong> Don't use complete words from any language</li>
                            <li><strong>No Personal Information:</strong> Avoid names, dates, addresses</li>
                            <li><strong>Use Passphrases:</strong> Create memorable phrases like "Coffee!Morning@7:00AM"</li>
                            <li><strong>Non-Keyboard Characters:</strong> Use ALT codes for additional complexity</li>
                            <li><strong>Unique Passwords:</strong> Never reuse passwords across accounts</li>
                            <li><strong>Password Managers:</strong> Use software to generate and store complex passwords</li>
                        </ul>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: What is the MOST critical factor in password strength?</div>
                        <ul class="quiz-options" data-answer="1">
                            <li data-value="1">Password length</li>
                            <li data-value="2">Using special characters</li>
                            <li data-value="3">Mixing upper and lowercase</li>
                            <li data-value="4">Including numbers</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Password Attacks -->
            <div class="section">
                <div class="section-header">
                    <h2>‚öîÔ∏è Password Attack Methods</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Understanding how attackers compromise passwords is essential for implementing effective defenses. Modern password attacks are sophisticated and can crack weak passwords in seconds.</p>

                    <h3>Common Password Attack Techniques</h3>
                    <table class="attack-table">
                        <thead>
                            <tr>
                                <th>Attack Type</th>
                                <th>Description</th>
                                <th>Effectiveness</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Social Engineering</strong></td>
                                <td>Phishing, shoulder surfing, or tricking users into revealing passwords</td>
                                <td>Very High - Targets human weakness</td>
                            </tr>
                            <tr>
                                <td><strong>Brute Force</strong></td>
                                <td>Systematically trying every possible combination of characters</td>
                                <td>High for short passwords</td>
                            </tr>
                            <tr>
                                <td><strong>Dictionary Attack</strong></td>
                                <td>Trying common words, phrases, and known passwords</td>
                                <td>Very High for weak passwords</td>
                            </tr>
                            <tr>
                                <td><strong>Rainbow Table</strong></td>
                                <td>Using precomputed hash tables to reverse password hashes</td>
                                <td>High without salting</td>
                            </tr>
                            <tr>
                                <td><strong>Mask Attack</strong></td>
                                <td>Targeted brute force using known password patterns</td>
                                <td>High for predictable patterns</td>
                            </tr>
                            <tr>
                                <td><strong>Rule Attack</strong></td>
                                <td>Statistical analysis of stolen passwords to create attack patterns</td>
                                <td>Very High</td>
                            </tr>
                            <tr>
                                <td><strong>Password Spraying</strong></td>
                                <td>Trying common passwords against many accounts</td>
                                <td>Moderate - Avoids lockouts</td>
                            </tr>
                            <tr>
                                <td><strong>Credential Stuffing</strong></td>
                                <td>Using stolen username/password pairs from breaches</td>
                                <td>Very High for reused passwords</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- NEW: Interactive Attack Simulator -->
                    <div class="attack-simulator">
                        <h3>üéÆ Interactive Attack Simulator</h3>
                        <p>See how different password attacks work against various password types:</p>
                        
                        <div style="margin: 20px 0;">
                            <label style="font-weight: 600; display: block; margin-bottom: 10px;">Select a password to test:</label>
                            <select id="testPassword" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 1em;">
                                <option value="password">password (weak)</option>
                                <option value="P@ssw0rd">P@ssw0rd (predictable substitution)</option>
                                <option value="MyDog2023">MyDog2023 (personal info + year)</option>
                                <option value="aB3$xK9mP2qR">aB3$xK9mP2qR (strong 12-char)</option>
                                <option value="Coffee!Morning@7:00AM">Coffee!Morning@7:00AM (strong passphrase)</option>
                            </select>
                        </div>

                        <div class="attack-controls">
                            <button class="attack-btn" onclick="simulateAttack('dictionary')">Dictionary Attack</button>
                            <button class="attack-btn" onclick="simulateAttack('brute')">Brute Force Attack</button>
                            <button class="attack-btn" onclick="simulateAttack('rainbow')">Rainbow Table Attack</button>
                            <button class="attack-btn" onclick="simulateAttack('credential')">Credential Stuffing</button>
                        </div>

                        <div id="attackResult" class="attack-result"></div>
                    </div>

                    <div class="warning-box">
                        <h3>‚ö†Ô∏è The Offline Attack Threat</h3>
                        <p>Most modern password attacks are <span class="term" data-tooltip="Offline attacks occur when attackers steal encrypted password files and crack them on their own systems without triggering security alerts.">offline attacks</span>, where attackers:</p>
                        <ol>
                            <li>Steal password <span class="term" data-tooltip="A hash is a one-way mathematical function that converts passwords into fixed-length strings of characters.">hash</span> files from compromised systems</li>
                            <li>Use powerful computers to crack passwords without detection</li>
                            <li>Face no account lockouts or rate limiting</li>
                            <li>Can crack billions of passwords per second with specialized hardware</li>
                        </ol>
                    </div>

                    <h3>Brute Force Attack Speed</h3>
                    <div class="info-box">
                        <h3>Time to Crack Passwords (2024 Estimates)</h3>
                        <ul>
                            <li><strong>8 characters, lowercase only:</strong> Instantly</li>
                            <li><strong>8 characters, mixed case + numbers:</strong> 7 minutes</li>
                            <li><strong>8 characters, all types:</strong> 39 minutes</li>
                            <li><strong>12 characters, all types:</strong> 3,000 years</li>
                            <li><strong>15 characters, all types:</strong> 1 billion years</li>
                        </ul>
                        <p><em>These times decrease as computing power increases!</em></p>
                    </div>

                    <div class="scenario-box">
                        <h3>Real-World Scenario: The Rainbow Table Attack</h3>
                        <p><strong>Situation:</strong> A hacker steals a database containing password hashes from a company that didn't use <span class="term" data-tooltip="Salting adds random data to passwords before hashing, making rainbow tables ineffective.">salting</span>.</p>
                        <p><strong>Attack Process:</strong></p>
                        <ol>
                            <li>Attacker uses precomputed rainbow tables containing billions of password hashes</li>
                            <li>Compares stolen hashes against rainbow table entries</li>
                            <li>Finds matches instantly for common passwords</li>
                            <li>Gains access to thousands of accounts within hours</li>
                        </ol>
                        <p><strong>Defense:</strong> Implementing password salting makes rainbow tables useless, as each password has a unique hash even if the passwords are identical.</p>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: Which attack method uses precomputed hash values?</div>
                        <ul class="quiz-options" data-answer="3">
                            <li data-value="1">Brute force attack</li>
                            <li data-value="2">Dictionary attack</li>
                            <li data-value="3">Rainbow table attack</li>
                            <li data-value="4">Social engineering</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Protecting Passwords -->
            <div class="section">
                <div class="section-header">
                    <h2>üõ°Ô∏è Protecting Password Digests</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Organizations must implement technical controls to protect stored passwords from compromise. Even if attackers steal password databases, proper protection makes password cracking extremely difficult.</p>

                    <h3>Password Hashing</h3>
                    <p>Passwords should never be stored in <span class="term" data-tooltip="Cleartext means storing data in readable, unencrypted format.">cleartext</span>. Instead, they're converted to <span class="term" data-tooltip="A hash digest is the output of a hash function - a fixed-length string that represents the password.">hash digests</span> using <span class="term" data-tooltip="A cryptographic hash function is a mathematical algorithm that converts any input into a fixed-size output that cannot be reversed.">cryptographic hash functions</span>.</p>

                    <div class="info-box">
                        <h3>How Password Hashing Works</h3>
                        <ol>
                            <li>User creates password: "MyP@ssw0rd!"</li>
                            <li>System applies hash function: SHA-256</li>
                            <li>Result stored: "5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8"</li>
                            <li>Original password is never stored</li>
                            <li>When user logs in, their entered password is hashed and compared to stored hash</li>
                        </ol>
                        <p><strong>Key Property:</strong> Hash functions are one-way - you cannot reverse the hash to get the original password.</p>
                    </div>

                    <h3>Password Salting</h3>
                    <p>A <span class="term" data-tooltip="A salt is random data added to a password before hashing to ensure unique hashes even for identical passwords.">salt</span> is a random string added to passwords before hashing. This prevents rainbow table attacks and makes identical passwords have different hashes.</p>

                    <div class="success-box">
                        <h3>‚úÖ Salting Example</h3>
                        <p><strong>Without Salt:</strong></p>
                        <p>User A password: "password" ‚Üí Hash: e2fc714c4727ee9395f3</p>
                        <p>User B password: "password" ‚Üí Hash: e2fc714c4727ee9395f3</p>
                        <p><em>Same hash! Attacker cracks one, gets both.</em></p>
                        
                        <p style="margin-top: 15px;"><strong>With Salt:</strong></p>
                        <p>User A: "password" + salt "xK9m" ‚Üí Hash: a7c4d8e9f1b2c3d4e5f6</p>
                        <p>User B: "password" + salt "pL3r" ‚Üí Hash: 3f7e8d9c2a1b4e6d8f9a</p>
                        <p><em>Different hashes! Each must be cracked individually.</em></p>
                    </div>

                    <h3>Key Stretching</h3>
                    <p><span class="term" data-tooltip="Key stretching uses specialized algorithms that intentionally take longer to compute, slowing down password cracking attempts.">Key stretching</span> algorithms like <span class="term" data-tooltip="PBKDF2 (Password-Based Key Derivation Function 2) applies the hash function thousands of times to slow down attackers.">PBKDF2</span> and <span class="term" data-tooltip="bcrypt is a password hashing function designed to be slow and adaptive to increasing computing power.">bcrypt</span> intentionally slow down the hashing process:</p>

                    <ul>
                        <li>Performs thousands or millions of hash iterations</li>
                        <li>Legitimate user experiences negligible delay (milliseconds)</li>
                        <li>Attacker cracking billions of passwords faces massive slowdown</li>
                        <li>Makes brute force attacks computationally infeasible</li>
                    </ul>

                    <div class="info-box">
                        <h3>Industry Best Practices for Password Storage</h3>
                        <ol>
                            <li>Generate cryptographically random salt (minimum 128 bits)</li>
                            <li>Combine salt with user's plaintext password</li>
                            <li>Apply PBKDF2-HMAC-SHA-256 with 30,000+ iterations</li>
                            <li>Store iteration count, salt, and resulting hash digest</li>
                            <li>Never store passwords in cleartext or using simple MD5/SHA-1</li>
                        </ol>
                    </div>

                    <!-- NEW: Password Policy Configurator -->
                    <div class="policy-configurator">
                        <h3>üîß Interactive Password Policy Configurator</h3>
                        <p>Configure your organization's password policy and see the security impact:</p>

                        <div class="policy-option">
                            <label>Minimum Password Length:</label>
                            <input type="number" id="policyLength" value="8" min="4" max="30">
                        </div>

                        <div class="policy-option">
                            <label>Require Uppercase Letters:</label>
                            <input type="checkbox" id="policyUppercase" checked>
                        </div>

                        <div class="policy-option">
                            <label>Require Lowercase Letters:</label>
                            <input type="checkbox" id="policyLowercase" checked>
                        </div>

                        <div class="policy-option">
                            <label>Require Numbers:</label>
                            <input type="checkbox" id="policyNumbers" checked>
                        </div>

                        <div class="policy-option">
                            <label>Require Special Characters:</label>
                            <input type="checkbox" id="policySpecial" checked>
                        </div>

                        <div class="policy-option">
                            <label>Maximum Password Age (days):</label>
                            <input type="number" id="policyMaxAge" value="90" min="0" max="365">
                        </div>

                        <div class="policy-option">
                            <label>Password History (remember last N):</label>
                            <input type="number" id="policyHistory" value="24" min="0" max="50">
                        </div>

                        <div class="policy-option">
                            <label>Account Lockout Threshold:</label>
                            <input type="number" id="policyLockout" value="5" min="0" max="10">
                        </div>

                        <button class="btn" onclick="evaluatePolicy()" style="margin-top: 20px; width: 100%;">Evaluate Policy Strength</button>

                        <div id="policyResult" class="policy-result" style="display: none;"></div>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: What is the primary purpose of password salting?</div>
                        <ul class="quiz-options" data-answer="4">
                            <li data-value="1">To make passwords longer</li>
                            <li data-value="2">To encrypt the password</li>
                            <li data-value="3">To speed up authentication</li>
                            <li data-value="4">To ensure identical passwords have different hashes</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Tokens and OTP -->
            <div class="section">
                <div class="section-header">
                    <h2>üé´ Token-Based Authentication (What You Have)</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Token-based authentication uses physical or software tokens to generate <span class="term" data-tooltip="A One-Time Password (OTP) is a temporary code that can only be used once or for a limited time period.">One-Time Passwords (OTPs)</span> that change frequently, providing stronger security than static passwords.</p>

                    <h3>Types of Tokens</h3>
                    <div class="biometric-grid">
                        <div class="biometric-card">
                            <h4>Hardware Security Token</h4>
                            <p>Physical device (key fob) with a display showing rotating codes. Highly secure but can be lost or stolen.</p>
                            <p><strong>Example:</strong> RSA SecurID</p>
                        </div>
                        <div class="biometric-card">
                            <h4>Software Security Token</h4>
                            <p>Mobile app generating OTP codes. More convenient and cost-effective than hardware tokens.</p>
                            <p><strong>Example:</strong> Google Authenticator, Microsoft Authenticator</p>
                        </div>
                        <div class="biometric-card">
                            <h4>SMS-Based Tokens</h4>
                            <p>Codes sent via text message. Convenient but vulnerable to SIM swapping attacks.</p>
                            <p><strong>Security Note:</strong> Not recommended for high-security applications</p>
                        </div>
                    </div>

                    <h3>How OTPs Work</h3>
                    <div class="info-box">
                        <h3>Time-Based One-Time Password (TOTP)</h3>
                        <ol>
                            <li>User and authentication server share a secret key</li>
                            <li>Algorithm combines secret key with current time</li>
                            <li>Generates a 6-8 digit code that changes every 30-60 seconds</li>
                            <li>User enters displayed code along with password</li>
                            <li>Server generates same code using same algorithm and verifies match</li>
                        </ol>
                        <p><strong>Advantage:</strong> Even if someone learns today's code, it's useless in 60 seconds.</p>
                    </div>

                    <div class="info-box">
                        <h3>HMAC-Based One-Time Password (HOTP)</h3>
                        <p>Event-driven OTP that changes based on a counter rather than time:</p>
                        <ul>
                            <li>Generates new code each time button is pressed</li>
                            <li>Doesn't require time synchronization</li>
                            <li>Each code can only be used once</li>
                            <li>Counter increments with each use</li>
                        </ul>
                    </div>

                    <h3>Advantages of Token Authentication</h3>
                    <div class="success-box">
                        <ul>
                            <li><strong>Dynamic Codes:</strong> Tokens change frequently, limiting exposure window</li>
                            <li><strong>Attack Resistance:</strong> Stolen codes expire quickly</li>
                            <li><strong>Phishing Resistance:</strong> Codes can't be reused by attackers</li>
                            <li><strong>Multi-Factor:</strong> Combines with passwords for strong MFA</li>
                            <li><strong>Obvious Theft:</strong> User notices if physical token is stolen</li>
                        </ul>
                    </div>

                    <div class="scenario-box">
                        <h3>Real-World Scenario: Banking Authentication</h3>
                        <p><strong>Challenge:</strong> A bank needs to secure online transactions worth millions of dollars.</p>
                        <p><strong>Solution:</strong> Implement TOTP-based two-factor authentication:</p>
                        <ol>
                            <li>Customer downloads bank's authenticator app</li>
                            <li>App is linked to customer account via QR code</li>
                            <li>During login: Customer enters username and password</li>
                            <li>Bank requests 6-digit TOTP code from authenticator app</li>
                            <li>Code must be entered within 30-second window</li>
                            <li>Even if password is compromised, attacker cannot access account</li>
                        </ol>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: What makes TOTP more secure than static passwords?</div>
                        <ul class="quiz-options" data-answer="2">
                            <li data-value="1">It's longer than regular passwords</li>
                            <li data-value="2">It changes every 30-60 seconds</li>
                            <li data-value="3">It uses encryption</li>
                            <li data-value="4">It's stored securely</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Smart Cards -->
            <div class="section">
                <div class="section-header">
                    <h2>üí≥ Smart Card Authentication</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p><span class="term" data-tooltip="A smart card is a physical card with an embedded integrated circuit chip that stores and processes authentication information.">Smart cards</span> provide highly secure authentication by storing digital certificates and cryptographic keys on tamper-resistant hardware.</p>

                    <h3>Types of Smart Cards</h3>
                    <div class="biometric-grid">
                        <div class="biometric-card">
                            <h4>Contact Smart Cards</h4>
                            <p>Require physical insertion into a card reader. A metallic pad on the card makes electrical contact with the reader.</p>
                            <p><strong>Use Case:</strong> High-security government and military applications</p>
                        </div>
                        <div class="biometric-card">
                            <h4>Contactless Smart Cards</h4>
                            <p>Use <span class="term" data-tooltip="RFID (Radio-Frequency Identification) allows wireless communication between card and reader.">RFID</span> or <span class="term" data-tooltip="NFC (Near Field Communication) is a short-range wireless technology for contactless communication.">NFC</span> technology for wireless communication with reader.</p>
                            <p><strong>Use Case:</strong> Building access control, payment systems</p>
                        </div>
                        <div class="biometric-card">
                            <h4>PIV Cards</h4>
                            <p><span class="term" data-tooltip="Personal Identity Verification (PIV) is a US government standard for smart card authentication.">Personal Identity Verification</span> cards used by federal employees and contractors.</p>
                            <p><strong>Features:</strong> Photo ID, barcode, magnetic strip, and smart chip</p>
                        </div>
                    </div>

                    <h3>Smart Card Security Features</h3>
                    <ul>
                        <li><strong>Cryptographic Operations:</strong> Performs encryption/decryption on-card</li>
                        <li><strong>Tamper-Resistant:</strong> Physically difficult to extract keys</li>
                        <li><strong>Multi-Factor:</strong> Requires PIN + physical card possession</li>
                        <li><strong>Digital Certificates:</strong> Stores X.509 certificates for PKI authentication</li>
                        <li><strong>Non-Exportable Keys:</strong> Private keys never leave the card</li>
                    </ul>

                    <div class="info-box">
                        <h3>Common Access Card (CAC)</h3>
                        <p>The US Department of Defense standard identification for active-duty military, contractors, and civilian employees:</p>
                        <ul>
                            <li>Contains multiple authentication certificates</li>
                            <li>Requires PIN for use</li>
                            <li>Integrates with PKI infrastructure</li>
                            <li>Used for physical access, network login, and email signing</li>
                            <li>Meets FIPS 201 and PIV standards</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h3>‚ö†Ô∏è Smart Card Limitations</h3>
                        <ul>
                            <li><strong>Cost:</strong> Expensive to deploy and manage</li>
                            <li><strong>Lost/Stolen:</strong> Requires secure revocation process</li>
                            <li><strong>Infrastructure:</strong> Needs card readers and certificate authority</li>
                            <li><strong>User Training:</strong> More complex than passwords</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Biometric Authentication -->
            <div class="section">
                <div class="section-header">
                    <h2>üëÅÔ∏è Biometric Authentication (What You Are)</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p><span class="term" data-tooltip="Biometrics use unique physical or behavioral characteristics to verify identity.">Biometric authentication</span> verifies identity using inherent physical or behavioral characteristics that are difficult to forge or share.</p>

                    <h3>Standard Biometric Methods</h3>
                    <div class="biometric-grid">
                        <div class="biometric-card">
                            <h4>üñêÔ∏è Fingerprint Recognition</h4>
                            <p>Scans unique patterns of ridges and valleys on fingertips.</p>
                            <p><strong>Accuracy:</strong> Very High</p>
                            <p><strong>Cost:</strong> Low to Moderate</p>
                            <p><strong>Use:</strong> Smartphones, laptops, door access</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üëÅÔ∏è Iris Recognition</h4>
                            <p>Analyzes unique patterns in the colored ring around the pupil.</p>
                            <p><strong>Accuracy:</strong> Extremely High</p>
                            <p><strong>Cost:</strong> High</p>
                            <p><strong>Use:</strong> High-security facilities, border control</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üë§ Facial Recognition</h4>
                            <p>Maps facial features using nodal points (eyes, nose, jawline).</p>
                            <p><strong>Accuracy:</strong> High (improving)</p>
                            <p><strong>Cost:</strong> Moderate</p>
                            <p><strong>Use:</strong> Smartphones, surveillance, airport security</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üó£Ô∏è Voice Recognition</h4>
                            <p>Analyzes unique vocal characteristics and speech patterns.</p>
                            <p><strong>Accuracy:</strong> Moderate to High</p>
                            <p><strong>Cost:</strong> Low</p>
                            <p><strong>Use:</strong> Phone banking, voice assistants</p>
                        </div>
                        <div class="biometric-card">
                            <h4>ü´∏ Palm/Vein Recognition</h4>
                            <p>Scans hand geometry or vein patterns beneath skin.</p>
                            <p><strong>Accuracy:</strong> Very High</p>
                            <p><strong>Cost:</strong> Moderate to High</p>
                            <p><strong>Use:</strong> Hospital access, secure facilities</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üëÅÔ∏è Retinal Scan</h4>
                            <p>Maps unique blood vessel patterns at back of eye.</p>
                            <p><strong>Accuracy:</strong> Extremely High</p>
                            <p><strong>Cost:</strong> Very High</p>
                            <p><strong>Use:</strong> Maximum security installations</p>
                        </div>
                    </div>

                    <h3>Cognitive Biometrics</h3>
                    <p><span class="term" data-tooltip="Cognitive biometrics authenticate based on unique thought processes, memories, and perceptions.">Cognitive biometrics</span> use mental characteristics and life experiences:</p>
                    
                    <div class="info-box">
                        <h3>Picture Password Authentication</h3>
                        <p>User selects a personal photo and creates authentication gestures:</p>
                        <ul>
                            <li>Tap specific points on the image in sequence</li>
                            <li>Draw patterns connecting image features</li>
                            <li>Circle recognizable faces or objects</li>
                            <li>Based on personal memories, hard for attackers to guess</li>
                        </ul>
                        <p><strong>Example:</strong> Windows 8/10 Picture Password feature</p>
                    </div>

                    <h3>Behavioral Biometrics (What You Do)</h3>
                    <p><span class="term" data-tooltip="Behavioral biometrics analyze patterns in how users perform actions.">Behavioral biometrics</span> authenticate based on unique action patterns:</p>

                    <div class="biometric-grid">
                        <div class="biometric-card">
                            <h4>‚å®Ô∏è Keystroke Dynamics</h4>
                            <p>Analyzes typing rhythm, speed, and patterns.</p>
                            <p><strong>Metrics:</strong> Dwell time (key press duration) and flight time (time between keys)</p>
                            <p><strong>Accuracy:</strong> Up to 98%</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üñ±Ô∏è Mouse Dynamics</h4>
                            <p>Tracks mouse movement patterns, speed, and click patterns.</p>
                            <p><strong>Continuous Authentication:</strong> Monitors throughout session</p>
                        </div>
                        <div class="biometric-card">
                            <h4>üö∂ Gait Analysis</h4>
                            <p>Recognizes walking patterns and body movement.</p>
                            <p><strong>Use:</strong> Surveillance and continuous monitoring</p>
                        </div>
                        <div class="biometric-card">
                            <h4>‚úçÔ∏è Signature Dynamics</h4>
                            <p>Analyzes pressure, speed, and pen angle during signing.</p>
                            <p><strong>Advantage:</strong> More secure than static signatures</p>
                        </div>
                    </div>

                    <h3>Biometric System Errors</h3>
                    <div class="warning-box">
                        <h3>‚ö†Ô∏è False Acceptance and False Rejection</h3>
                        <p>Biometric systems face two types of errors:</p>
                        <ul>
                            <li><strong><span class="term" data-tooltip="False Acceptance Rate (FAR) - frequency that unauthorized users are incorrectly accepted.">False Acceptance (FAR)</span>:</strong> System incorrectly accepts unauthorized user (security risk)</li>
                            <li><strong><span class="term" data-tooltip="False Rejection Rate (FRR) - frequency that authorized users are incorrectly rejected.">False Rejection (FRR)</span>:</strong> System incorrectly rejects authorized user (usability issue)</li>
                        </ul>
                        <p><strong>Crossover Error Rate (CER):</strong> The point where FAR equals FRR; lower CER indicates better accuracy.</p>
                    </div>

                    <h3>Advantages and Disadvantages of Biometrics</h3>
                    <div class="success-box">
                        <h3>‚úÖ Advantages</h3>
                        <ul>
                            <li>Cannot be easily shared, lost, or forgotten</li>
                            <li>Difficult to forge or steal</li>
                            <li>Convenient - no passwords to remember</li>
                            <li>Strong authentication when combined with other factors</li>
                            <li>Can enable continuous authentication</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h3>‚ùå Disadvantages</h3>
                        <ul>
                            <li><strong>Privacy Concerns:</strong> Collecting and storing biometric data</li>
                            <li><strong>Unchangeable:</strong> Can't reset biometrics if compromised</li>
                            <li><strong>Cost:</strong> Specialized hardware can be expensive</li>
                            <li><strong>Error Rates:</strong> False accepts/rejects cause issues</li>
                            <li><strong>Spoofing Attacks:</strong> Can be tricked with fake fingerprints, photos</li>
                            <li><strong>Environmental Factors:</strong> Injuries, lighting, backgrounds affect accuracy</li>
                        </ul>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: Which biometric type analyzes typing patterns?</div>
                        <ul class="quiz-options" data-answer="3">
                            <li data-value="1">Cognitive biometrics</li>
                            <li data-value="2">Standard biometrics</li>
                            <li data-value="3">Behavioral biometrics</li>
                            <li data-value="4">Physiological biometrics</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Geolocation -->
            <div class="section">
                <div class="section-header">
                    <h2>üìç Geolocation Authentication (Where You Are)</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p><span class="term" data-tooltip="Geolocation identifies a user's physical location using GPS, IP addresses, or cellular towers.">Geolocation</span> adds a location-based authentication factor, verifying users are accessing systems from expected locations.</p>

                    <h3>How Geolocation Authentication Works</h3>
                    <ul>
                        <li><strong>GPS Coordinates:</strong> Mobile devices provide precise location data</li>
                        <li><strong>IP Geolocation:</strong> Determines approximate location from IP address</li>
                        <li><strong>Cellular Tower Triangulation:</strong> Uses mobile network data</li>
                        <li><strong>Wi-Fi Positioning:</strong> Identifies location based on nearby Wi-Fi networks</li>
                    </ul>

                    <div class="info-box">
                        <h3>Geofencing</h3>
                        <p><span class="term" data-tooltip="Geofencing creates virtual boundaries where authentication is required or restricted.">Geofencing</span> establishes virtual perimeters:</p>
                        <ul>
                            <li><strong>Allow Lists:</strong> Only allow access from specific locations</li>
                            <li><strong>Block Lists:</strong> Deny access from high-risk countries</li>
                            <li><strong>Step-Up Authentication:</strong> Require additional factors for unusual locations</li>
                            <li><strong>Impossible Travel:</strong> Detect login from two distant locations in short timeframe</li>
                        </ul>
                    </div>

                    <!-- NEW: Interactive Decision Scenario -->
                    <div class="decision-scenario">
                        <h3>üéØ Security Decision Scenario: Suspicious Login Attempt</h3>
                        <p><strong>Situation:</strong> You're the security analyst monitoring authentication logs. You receive an alert:</p>
                        <div class="info-box">
                            <p><strong>Alert Details:</strong></p>
                            <ul>
                                <li>User: sarah.chen@company.com</li>
                                <li>Last successful login: New York, NY (2 hours ago)</li>
                                <li>Current login attempt: Moscow, Russia</li>
                                <li>Authentication method: Correct password</li>
                                <li>Device: Unknown mobile device</li>
                            </ul>
                        </div>
                        <p><strong>What should you do?</strong></p>
                        
                        <div class="scenario-choices">
                            <div class="choice-btn" onclick="makeDecision(1, this)">
                                <strong>Option 1:</strong> Allow the login - the password is correct
                            </div>
                            <div class="choice-btn" onclick="makeDecision(2, this)">
                                <strong>Option 2:</strong> Block immediately and lock the account
                            </div>
                            <div class="choice-btn" onclick="makeDecision(3, this)">
                                <strong>Option 3:</strong> Block login, require step-up MFA, and alert user
                            </div>
                            <div class="choice-btn" onclick="makeDecision(4, this)">
                                <strong>Option 4:</strong> Allow but monitor the session closely
                            </div>
                        </div>

                        <div id="scenarioFeedback" class="scenario-feedback"></div>
                    </div>

                    <div class="scenario-box">
                        <h3>Real-World Scenario: Banking Fraud Prevention</h3>
                        <p><strong>Situation:</strong> Bank customer typically accesses account from New York City.</p>
                        <p><strong>Alert Triggers:</strong></p>
                        <ul>
                            <li>Login attempt detected from Moscow, Russia</li>
                            <li>Impossible to physically travel there since last login</li>
                            <li>System flags as suspicious activity</li>
                        </ul>
                        <p><strong>Security Response:</strong></p>
                        <ol>
                            <li>Block the suspicious login attempt</li>
                            <li>Send alert to customer's registered phone</li>
                            <li>Require step-up authentication (OTP + security questions)</li>
                            <li>If customer confirms it wasn't them, lock account</li>
                        </ol>
                    </div>

                    <h3>Use Cases for Geolocation</h3>
                    <div class="success-box">
                        <ul>
                            <li><strong>Fraud Detection:</strong> Identify unauthorized access attempts</li>
                            <li><strong>Compliance:</strong> Restrict access to specific countries/regions</li>
                            <li><strong>Risk-Based Authentication:</strong> Increase security for unusual locations</li>
                            <li><strong>Physical Security:</strong> Verify employees are on-site</li>
                            <li><strong>Geofencing:</strong> Enable features only in specific locations</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h3>‚ö†Ô∏è Limitations of Geolocation</h3>
                        <ul>
                            <li><strong>VPN Bypass:</strong> Users can mask their location with VPNs</li>
                            <li><strong>Privacy Concerns:</strong> Tracking user location raises privacy issues</li>
                            <li><strong>Accuracy:</strong> IP geolocation can be imprecise</li>
                            <li><strong>Legitimate Travel:</strong> May inconvenience traveling users</li>
                            <li><strong>Proxy Servers:</strong> Can show incorrect locations</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Single Sign-On -->
            <div class="section">
                <div class="section-header">
                    <h2>üîì Single Sign-On (SSO)</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p><span class="term" data-tooltip="Single Sign-On (SSO) allows users to authenticate once and access multiple systems without re-authenticating.">Single Sign-On (SSO)</span> streamlines authentication by allowing users to log in once and access multiple applications without repeated authentication.</p>

                    <h3>Benefits of SSO</h3>
                    <div class="success-box">
                        <ul>
                            <li><strong>Improved User Experience:</strong> One set of credentials for multiple systems</li>
                            <li><strong>Reduced Password Fatigue:</strong> Fewer passwords to remember</li>
                            <li><strong>Increased Security:</strong> Users can maintain one strong password</li>
                            <li><strong>Reduced Help Desk Costs:</strong> Fewer password reset requests</li>
                            <li><strong>Centralized Access Control:</strong> Easier to manage permissions</li>
                            <li><strong>Better Compliance:</strong> Centralized auditing and monitoring</li>
                        </ul>
                    </div>

                    <h3>Identity Management Concepts</h3>
                    <p><span class="term" data-tooltip="Identity Management (IdM) manages user identities and access across multiple systems.">Identity Management (IdM)</span> and <span class="term" data-tooltip="Federated Identity Management (FIM) extends identity management across organizational boundaries.">Federated Identity Management (FIM)</span> enable SSO:</p>

                    <ul>
                        <li><strong>Identity Provider (IdP):</strong> Authenticates users and provides identity assertions</li>
                        <li><strong>Service Provider (SP):</strong> Accepts identity assertions and grants access</li>
                        <li><strong>Federation:</strong> Trust relationship between organizations</li>
                        <li><strong>Identity Broker:</strong> Mediates between multiple IdPs and SPs</li>
                    </ul>

                    <h3>Popular SSO Protocols and Standards</h3>
                    <div class="biometric-grid">
                        <div class="biometric-card">
                            <h4>OAuth 2.0</h4>
                            <p>Authorization framework allowing third-party applications limited access to user accounts.</p>
                            <p><strong>Use:</strong> "Sign in with Google/Facebook"</p>
                            <p><strong>Note:</strong> Provides authorization, not authentication</p>
                        </div>
                        <div class="biometric-card">
                            <h4>OpenID Connect</h4>
                            <p>Authentication layer built on OAuth 2.0 providing identity verification.</p>
                            <p><strong>Use:</strong> Modern web and mobile SSO</p>
                            <p><strong>Features:</strong> ID tokens, user info endpoint</p>
                        </div>
                        <div class="biometric-card">
                            <h4>SAML 2.0</h4>
                            <p><span class="term" data-tooltip="Security Assertion Markup Language (SAML) is an XML-based standard for exchanging authentication data.">Security Assertion Markup Language</span> for enterprise SSO.</p>
                            <p><strong>Use:</strong> Enterprise applications, cloud services</p>
                            <p><strong>Features:</strong> XML-based assertions</p>
                        </div>
                        <div class="biometric-card">
                            <h4>Shibboleth</h4>
                            <p>Open-source SAML-based SSO system used in education and research.</p>
                            <p><strong>Use:</strong> University systems, academic resources</p>
                            <p><strong>Features:</strong> Multi-institution federation</p>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>How SSO Works: Example Workflow</h3>
                        <ol>
                            <li>User attempts to access Application A</li>
                            <li>Application A redirects to Identity Provider (IdP)</li>
                            <li>User authenticates with IdP (username/password + MFA)</li>
                            <li>IdP creates secure token and sends to Application A</li>
                            <li>Application A validates token and grants access</li>
                            <li>User later accesses Application B</li>
                            <li>Application B checks with IdP for existing authentication</li>
                            <li>IdP confirms user is authenticated and sends token</li>
                            <li>Application B grants access without requiring re-authentication</li>
                        </ol>
                    </div>

                    <div class="warning-box">
                        <h3>‚ö†Ô∏è SSO Security Considerations</h3>
                        <ul>
                            <li><strong>Single Point of Failure:</strong> Compromised SSO credentials expose all connected systems</li>
                            <li><strong>Strong Primary Authentication:</strong> Must use MFA for SSO login</li>
                            <li><strong>Session Management:</strong> Implement appropriate timeout and logout procedures</li>
                            <li><strong>Token Security:</strong> Protect authentication tokens from interception</li>
                            <li><strong>Trust Relationships:</strong> Carefully manage federated identity partnerships</li>
                        </ul>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: What is the main advantage of SSO?</div>
                        <ul class="quiz-options" data-answer="2">
                            <li data-value="1">It eliminates the need for passwords</li>
                            <li data-value="2">Users authenticate once to access multiple systems</li>
                            <li data-value="3">It provides stronger encryption</li>
                            <li data-value="4">It automatically updates all passwords</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Account Management -->
            <div class="section">
                <div class="section-header">
                    <h2>‚öôÔ∏è Account Management Best Practices</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Proper account management is essential for maintaining security across an organization. Effective policies prevent unauthorized access and ensure accountability.</p>

                    <h3>Group Policy and Account Settings</h3>
                    <p>Organizations should use <span class="term" data-tooltip="Group Policy allows administrators to set security and configuration policies for multiple users simultaneously.">Group Policy</span> to enforce security requirements consistently:</p>

                    <div class="info-box">
                        <h3>Password Policy Settings (Microsoft Active Directory)</h3>
                        <ul>
                            <li><strong>Minimum Password Length:</strong> Require 15+ characters</li>
                            <li><strong>Password Complexity:</strong> Enforce mixed case, numbers, symbols</li>
                            <li><strong>Password History:</strong> Remember last 24 passwords to prevent reuse</li>
                            <li><strong>Maximum Password Age:</strong> 90-180 days (or never for high-entropy passwords)</li>
                            <li><strong>Minimum Password Age:</strong> Prevent rapid password changes to circumvent history</li>
                            <li><strong>Store Passwords Using Reversible Encryption:</strong> Disabled (use hashing instead)</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h3>Account Lockout Policy</h3>
                        <ul>
                            <li><strong>Account Lockout Threshold:</strong> Lock after 3-5 failed attempts</li>
                            <li><strong>Account Lockout Duration:</strong> 15-30 minutes</li>
                            <li><strong>Reset Account Lockout Counter:</strong> After 15-30 minutes</li>
                        </ul>
                        <p><strong>Purpose:</strong> Prevents brute force attacks while minimizing user impact</p>
                    </div>

                    <h3>Account Types and Management</h3>
                    <div class="warning-box">
                        <h3>‚ö†Ô∏è High-Risk Account Types to Avoid</h3>
                        <ul>
                            <li><strong>Shared Accounts:</strong> Never allow multiple users to share one account (no accountability)</li>
                            <li><strong>Generic Accounts:</strong> Avoid generic usernames like "admin" or "test"</li>
                            <li><strong>Guest Accounts:</strong> Disable guest accounts or implement strict controls</li>
                            <li><strong>Default Accounts:</strong> Change or disable default system accounts</li>
                        </ul>
                    </div>

                    <h3>Privileged Account Management</h3>
                    <p><span class="term" data-tooltip="Privileged accounts have elevated permissions to perform administrative tasks.">Privileged accounts</span> require special attention due to their extensive permissions:</p>

                    <div class="success-box">
                        <h3>‚úÖ Privileged Account Best Practices</h3>
                        <ul>
                            <li><strong>Separate Admin Accounts:</strong> Administrators should have separate standard and admin accounts</li>
                            <li><strong>Just-In-Time Access:</strong> Grant privileges only when needed, revoke after task completion</li>
                            <li><strong>Enhanced Monitoring:</strong> Log and audit all privileged account activities</li>
                            <li><strong>Multi-Factor Authentication:</strong> Always require MFA for privileged access</li>
                            <li><strong>Strong Passwords:</strong> Enforce higher password standards</li>
                            <li><strong>Regular Reviews:</strong> Audit who has privileged access and why</li>
                            <li><strong>Privileged Access Workstations:</strong> Dedicated secure systems for admin tasks</li>
                        </ul>
                    </div>

                    <h3>Account Lifecycle Management</h3>
                    <div class="info-box">
                        <h3>Onboarding New Users</h3>
                        <ol>
                            <li>Create account with principle of least privilege</li>
                            <li>Assign to appropriate security groups</li>
                            <li>Enforce strong password on first login</li>
                            <li>Require password change after initial setup</li>
                            <li>Enable MFA enrollment</li>
                            <li>Document account creation and permissions</li>
                        </ol>
                    </div>

                    <div class="info-box">
                        <h3>Offboarding Departing Users</h3>
                        <ol>
                            <li><strong>Disable</strong> account immediately upon departure (don't delete yet)</li>
                            <li>Revoke access to all systems and applications</li>
                            <li>Collect physical tokens, smart cards, devices</li>
                            <li>Transfer data ownership to manager</li>
                            <li>Audit account activity before termination</li>
                            <li>After retention period, delete account and data</li>
                        </ol>
                        <p><strong>Important:</strong> Disable rather than delete accounts initially to preserve audit trails and allow data recovery if needed.</p>
                    </div>

                    <h3>Account Monitoring and Auditing</h3>
                    <ul>
                        <li><strong>Failed Login Attempts:</strong> Monitor for brute force attacks</li>
                        <li><strong>Unusual Login Times:</strong> Alert on off-hours access</li>
                        <li><strong>Geographic Anomalies:</strong> Detect impossible travel scenarios</li>
                        <li><strong>Privileged Activity:</strong> Log all administrative actions</li>
                        <li><strong>Dormant Accounts:</strong> Regular review and disabling of inactive accounts</li>
                        <li><strong>Group Membership Changes:</strong> Alert on permission modifications</li>
                    </ul>

                    <h3>Password Recovery and Reset</h3>
                    <div class="warning-box">
                        <h3>‚ö†Ô∏è Secure Password Reset Procedures</h3>
                        <ul>
                            <li><strong>Verify Identity:</strong> Use out-of-band verification (call back to registered number)</li>
                            <li><strong>Security Questions:</strong> Use as one factor, but not alone (easily researched)</li>
                            <li><strong>Time-Limited Tokens:</strong> Password reset links should expire quickly (15-30 minutes)</li>
                            <li><strong>One-Time Use:</strong> Reset tokens can only be used once</li>
                            <li><strong>Email Security:</strong> Ensure email account is secure before resetting via email</li>
                            <li><strong>Force Change:</strong> Require immediate password change after reset</li>
                            <li><strong>Log All Resets:</strong> Maintain audit trail of password reset requests</li>
                        </ul>
                    </div>

                    <div class="scenario-box">
                        <h3>Real-World Scenario: Transitive Trust Vulnerability</h3>
                        <p><strong>Environment:</strong> Corporate network with parent and child domains in Active Directory.</p>
                        <p><strong>Vulnerability:</strong> <span class="term" data-tooltip="Transitive trust automatically creates two-way trust relationships between parent and child domains.">Transitive trust</span> automatically allows authentication between domains.</p>
                        <p><strong>Attack Scenario:</strong></p>
                        <ol>
                            <li>Attacker compromises low-security child domain account</li>
                            <li>Uses transitive trust to access parent domain resources</li>
                            <li>Escalates privileges through trusted relationship</li>
                            <li>Gains access to sensitive parent domain data</li>
                        </ol>
                        <p><strong>Mitigation:</strong></p>
                        <ul>
                            <li>Implement selective authentication on trusts</li>
                            <li>Use SID filtering to prevent privilege escalation</li>
                            <li>Monitor cross-domain access attempts</li>
                            <li>Apply principle of least privilege to trust relationships</li>
                        </ul>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">Knowledge Check: Why should accounts be disabled rather than deleted when employees leave?</div>
                        <ul class="quiz-options" data-answer="3">
                            <li data-value="1">It's easier than deleting</li>
                            <li data-value="2">They might return to work</li>
                            <li data-value="3">To preserve audit trails and allow data recovery</li>
                            <li data-value="4">Deleting accounts causes system errors</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Final Assessment -->
            <div class="section">
                <div class="section-header">
                    <h2>üìù Final Knowledge Assessment</h2>
                    <span class="toggle">‚ñº</span>
                </div>
                <div class="section-content">
                    <p>Test your understanding of authentication and account management concepts:</p>

                    <div class="quiz">
                        <div class="quiz-question">1. Which authentication factor combines "what you know" with "what you have"?</div>
                        <ul class="quiz-options" data-answer="4">
                            <li data-value="1">Password and PIN</li>
                            <li data-value="2">Fingerprint and iris scan</li>
                            <li data-value="3">Username and password</li>
                            <li data-value="4">Password and OTP token</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">2. What is the primary purpose of key stretching algorithms like PBKDF2?</div>
                        <ul class="quiz-options" data-answer="2">
                            <li data-value="1">To make passwords longer</li>
                            <li data-value="2">To slow down password cracking attempts</li>
                            <li data-value="3">To encrypt passwords</li>
                            <li data-value="4">To store passwords securely</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">3. Which biometric method analyzes typing rhythm and patterns?</div>
                        <ul class="quiz-options" data-answer="3">
                            <li data-value="1">Fingerprint recognition</li>
                            <li data-value="2">Facial recognition</li>
                            <li data-value="3">Keystroke dynamics</li>
                            <li data-value="4">Voice recognition</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">4. What does TOTP stand for?</div>
                        <ul class="quiz-options" data-answer="1">
                            <li data-value="1">Time-Based One-Time Password</li>
                            <li data-value="2">Token-Operated Time Protocol</li>
                            <li data-value="3">Timed Output Transfer Process</li>
                            <li data-value="4">Two-Option Token Password</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>

                    <div class="quiz">
                        <div class="quiz-question">5. What is the main security risk of Single Sign-On (SSO)?</div>
                        <ul class="quiz-options" data-answer="4">
                            <li data-value="1">It's too expensive to implement</li>
                            <li data-value="2">It requires too much training</li>
                            <li data-value="3">It doesn't work with biometrics</li>
                            <li data-value="4">Compromised credentials expose all connected systems</li>
                        </ul>
                        <div class="quiz-feedback"></div>
                    </div>

                    <div class="success-box" style="margin-top: 30px;">
                        <h3>üéì Congratulations on Completing This Lesson!</h3>
                        <p>You've learned about:</p>
                        <ul>
                            <li>The five types of authentication credentials</li>
                            <li>Password security and common attacks</li>
                            <li>Token-based and multi-factor authentication</li>
                            <li>Biometric authentication methods</li>
                            <li>Single Sign-On technologies</li>
                            <li>Account management best practices</li>
                        </ul>
                        <p><strong>Next Steps:</strong> Review the CompTIA Security+ objectives related to identity and access management, and practice implementing these concepts in lab environments.</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Accessibility Controls
        document.getElementById('highContrastBtn').addEventListener('click', function() {
            document.body.classList.toggle('high-contrast');
            this.classList.toggle('active');
        });

        document.getElementById('largeFontBtn').addEventListener('click', function() {
            const currentSize = parseFloat(window.getComputedStyle(document.body).fontSize);
            if (this.classList.contains('active')) {
                document.body.style.fontSize = '16px';
                this.classList.remove('active');
            } else {
                document.body.style.fontSize = '20px';
                this.classList.add('active');
            }
        });

        // Section toggle functionality
        document.querySelectorAll('.section-header').forEach(header => {
            header.addEventListener('click', function() {
                const content = this.nextElementSibling;
                const toggle = this.querySelector('.toggle');
                
                this.classList.toggle('active');
                content.classList.toggle('active');
                
                // Update progress
                updateProgress();
            });
        });

        // Auto-open first section
        document.querySelector('.section-header').click();

        // Improved Tooltip functionality with better positioning
        const tooltip = document.getElementById('tooltip');
        document.querySelectorAll('.term').forEach(term => {
            term.addEventListener('mouseenter', function(e) {
                const text = this.getAttribute('data-tooltip');
                tooltip.textContent = text;
                tooltip.style.display = 'block';
                positionTooltip(e, this);
            });

            term.addEventListener('mousemove', function(e) {
                positionTooltip(e, this);
            });

            term.addEventListener('mouseleave', function() {
                tooltip.style.display = 'none';
            });
        });

        function positionTooltip(e, element) {
            const tooltipRect = tooltip.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            
            // Calculate position
            let x = e.clientX;
            let y = e.clientY - tooltipRect.height - 15;
            
            // Adjust if tooltip goes off right edge
            if (x + tooltipRect.width / 2 > window.innerWidth - 10) {
                x = window.innerWidth - tooltipRect.width - 10;
            }
            
            // Adjust if tooltip goes off left edge
            if (x - tooltipRect.width / 2 < 10) {
                x = tooltipRect.width / 2 + 10;
            }
            
            // If tooltip would go off top, show below instead
            if (y < 10) {
                y = e.clientY + 15;
                tooltip.classList.remove('position-top');
                tooltip.classList.add('position-bottom');
            } else {
                tooltip.classList.remove('position-bottom');
                tooltip.classList.add('position-top');
            }
            
            tooltip.style.left = (x - tooltipRect.width / 2) + 'px';
            tooltip.style.top = y + 'px';
        }

        // Quiz functionality
        document.querySelectorAll('.quiz-options').forEach(optionsList => {
            const correctAnswer = optionsList.getAttribute('data-answer');
            const options = optionsList.querySelectorAll('li');
            const feedback = optionsList.nextElementSibling;

            options.forEach(option => {
                option.addEventListener('click', function() {
                    // Prevent multiple answers
                    if (optionsList.classList.contains('answered')) return;
                    optionsList.classList.add('answered');

                    const selectedValue = this.getAttribute('data-value');
                    
                    if (selectedValue === correctAnswer) {
                        this.classList.add('correct');
                        feedback.className = 'quiz-feedback show correct';
                        feedback.innerHTML = '<strong>‚úì Correct!</strong> Great job! You understand this concept.';
                    } else {
                        this.classList.add('incorrect');
                        // Show correct answer
                        options.forEach(opt => {
                            if (opt.getAttribute('data-value') === correctAnswer) {
                                opt.classList.add('correct');
                            }
                        });
                        feedback.className = 'quiz-feedback show incorrect';
                        feedback.innerHTML = '<strong>‚úó Incorrect.</strong> Review the material and try to understand why the correct answer is highlighted in green.';
                    }
                });
            });
        });

        // Enhanced Password strength checker
        const passwordInput = document.getElementById('passwordInput');
        const strengthMeter = document.getElementById('strengthMeter');
        const strengthFeedback = document.getElementById('strengthFeedback');
        const passwordDetails = document.getElementById('passwordDetails');

        if (passwordInput) {
            passwordInput.addEventListener('input', function() {
                const password = this.value;
                const strength = calculatePasswordStrength(password);
                
                strengthMeter.style.width = strength.percent + '%';
                strengthMeter.style.background = strength.color;
                strengthFeedback.textContent = strength.text;
                strengthFeedback.style.color = strength.color;
                
                // Show detailed analysis
                if (password.length > 0) {
                    passwordDetails.innerHTML = `
                        Length: ${password.length} characters<br>
                        Has uppercase: ${/[A-Z]/.test(password) ? '‚úì' : '‚úó'}<br>
                        Has lowercase: ${/[a-z]/.test(password) ? '‚úì' : '‚úó'}<br>
                        Has numbers: ${/[0-9]/.test(password) ? '‚úì' : '‚úó'}<br>
                        Has symbols: ${/[^a-zA-Z0-9]/.test(password) ? '‚úì' : '‚úó'}
                    `;
                } else {
                    passwordDetails.innerHTML = '';
                }
            });
        }

        function calculatePasswordStrength(password) {
            let strength = 0;
            const checks = {
                length: password.length >= 15,
                lowercase: /[a-z]/.test(password),
                uppercase: /[A-Z]/.test(password),
                numbers: /[0-9]/.test(password),
                symbols: /[^a-zA-Z0-9]/.test(password),
                longLength: password.length >= 20
            };

            // Calculate strength
            if (checks.length) strength += 20;
            if (checks.lowercase) strength += 15;
            if (checks.uppercase) strength += 15;
            if (checks.numbers) strength += 15;
            if (checks.symbols) strength += 20;
            if (checks.longLength) strength += 15;

            // Determine color and message
            let color, text;
            if (strength < 30) {
                color = '#f44336';
                text = 'Very Weak - Easily cracked';
            } else if (strength < 50) {
                color = '#ff9800';
                text = 'Weak - Vulnerable to attacks';
            } else if (strength < 70) {
                color = '#ffc107';
                text = 'Moderate - Could be stronger';
            } else if (strength < 85) {
                color = '#8bc34a';
                text = 'Strong - Good password';
            } else {
                color = '#4caf50';
                text = 'Very Strong - Excellent password!';
            }

            return {
                percent: strength,
                color: color,
                text: text
            };
        }

        // Attack Simulator
        function simulateAttack(attackType) {
            const password = document.getElementById('testPassword').value;
            const resultDiv = document.getElementById('attackResult');
            
            let result = {
                success: false,
                time: '',
                description: ''
            };

            switch(attackType) {
                case 'dictionary':
                    if (password === 'password' || password === 'MyDog2023') {
                        result.success = true;
                        result.time = 'Instantly';
                        result.description = 'This password was found in a common password dictionary. It would be cracked immediately.';
                    } else {
                        result.success = false;
                        result.time = 'N/A';
                        result.description = 'This password is not in common dictionaries. A dictionary attack would fail.';
                    }
                    break;
                
                case 'brute':
                    if (password.length < 10) {
                        result.success = true;
                        result.time = 'Minutes to hours';
                        result.description = 'Short passwords can be cracked quickly with brute force. This password would likely be compromised.';
                    } else if (password.length < 15) {
                        result.success = true;
                        result.time = 'Days to months';
                        result.description = 'This password would eventually be cracked, but it would take significant time.';
                    } else {
                        result.success = false;
                        result.time = 'Thousands of years';
                        result.description = 'This password is long enough that brute force would be infeasible with current technology.';
                    }
                    break;
                
                case 'rainbow':
                    if (password === 'password' || password === 'P@ssw0rd') {
                        result.success = true;
                        result.time = 'Instantly';
                        result.description = 'Without salting, this password hash would be in rainbow tables. Cracked immediately.';
                    } else {
                        result.success = false;
                        result.time = 'N/A';
                        result.description = 'This password likely isn\'t in precomputed rainbow tables. If salting is used, this attack fails completely.';
                    }
                    break;
                
                case 'credential':
                    if (password === 'password' || password === 'P@ssw0rd' || password === 'MyDog2023') {
                        result.success = true;
                        result.time = 'Instantly';
                        result.description = 'If this password was reused and appeared in a breach database, credential stuffing would succeed immediately.';
                    } else {
                        result.success = false;
                        result.time = 'N/A';
                        result.description = 'This password doesn\'t appear in known breach databases. Credential stuffing would fail.';
                    }
                    break;
            }

            // Display result
            resultDiv.className = 'attack-result show ' + (result.success ? 'success' : 'failed');
            resultDiv.innerHTML = `
                <h4>${result.success ? '‚ö†Ô∏è Attack Successful!' : '‚úÖ Attack Failed!'}</h4>
                <p><strong>Time to Crack:</strong> ${result.time}</p>
                <p>${result.description}</p>
            `;
        }

        // Password Policy Configurator
        function evaluatePolicy() {
            const minLength = parseInt(document.getElementById('policyLength').value);
            const requireUpper = document.getElementById('policyUppercase').checked;
            const requireLower = document.getElementById('policyLowercase').checked;
            const requireNumbers = document.getElementById('policyNumbers').checked;
            const requireSpecial = document.getElementById('policySpecial').checked;
            const maxAge = parseInt(document.getElementById('policyMaxAge').value);
            const history = parseInt(document.getElementById('policyHistory').value);
            const lockout = parseInt(document.getElementById('policyLockout').value);

            let score = 0;
            let issues = [];
            let strengths = [];

            // Evaluate length
            if (minLength >= 15) {
                score += 30;
                strengths.push('‚úì Excellent password length requirement');
            } else if (minLength >= 12) {
                score += 20;
                strengths.push('‚úì Good password length');
            } else if (minLength >= 8) {
                score += 10;
                issues.push('‚ö†Ô∏è Password length could be longer (recommend 15+)');
            } else {
                issues.push('‚ùå Password length is too short (minimum should be 12-15)');
            }

            // Evaluate complexity
            let complexityCount = 0;
            if (requireUpper) complexityCount++;
            if (requireLower) complexityCount++;
            if (requireNumbers) complexityCount++;
            if (requireSpecial) complexityCount++;

            if (complexityCount === 4) {
                score += 25;
                strengths.push('‚úì Full complexity requirements enabled');
            } else if (complexityCount >= 3) {
                score += 15;
                issues.push('‚ö†Ô∏è Consider requiring all character types');
            } else {
                score += 5;
                issues.push('‚ùå Insufficient complexity requirements');
            }

            // Evaluate password age
            if (maxAge === 0 || maxAge > 180) {
                score += 15;
                strengths.push('‚úì Good password age policy (no expiration or long period)');
            } else if (maxAge >= 90) {
                score += 10;
                strengths.push('‚úì Reasonable password age');
            } else {
                score += 5;
                issues.push('‚ö†Ô∏è Frequent password changes can lead to weaker passwords');
            }

            // Evaluate history
            if (history >= 24) {
                score += 15;
                strengths.push('‚úì Excellent password history depth');
            } else if (history >= 12) {
                score += 10;
                strengths.push('‚úì Good password history');
            } else {
                score += 5;
                issues.push('‚ö†Ô∏è Password history could be deeper (recommend 24)');
            }

            // Evaluate lockout
            if (lockout >= 3 && lockout <= 5) {
                score += 15;
                strengths.push('‚úì Good account lockout threshold');
            } else if (lockout > 5) {
                score += 10;
                issues.push('‚ö†Ô∏è Lockout threshold might be too high');
            } else {
                score += 5;
                issues.push('‚ö†Ô∏è Lockout threshold might be too aggressive');
            }

            // Determine overall strength
            let strengthLevel, strengthClass, recommendation;
            if (score >= 80) {
                strengthLevel = 'Strong';
                strengthClass = 'policy-strength-strong';
                recommendation = 'Your password policy is strong and follows security best practices.';
            } else if (score >= 60) {
                strengthLevel = 'Moderate';
                strengthClass = 'policy-strength-moderate';
                recommendation = 'Your password policy is reasonable but could be improved in some areas.';
            } else {
                strengthLevel = 'Weak';
                strengthClass = 'policy-strength-weak';
                recommendation = 'Your password policy needs significant improvements to meet security standards.';
            }

            // Display result
            const resultDiv = document.getElementById('policyResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h4>Policy Strength: <span class="policy-strength-indicator ${strengthClass}">${strengthLevel}</span></h4>
                <p>${recommendation}</p>
                
                ${strengths.length > 0 ? `
                    <div style="margin-top: 15px;">
                        <strong>Strengths:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            ${strengths.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                    </div>
                ` : ''}
                
                ${issues.length > 0 ? `
                    <div style="margin-top: 15px;">
                        <strong>Areas for Improvement:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            ${issues.map(i => `<li>${i}</li>`).join('')}
                        </ul>
                    </div>
                ` : ''}
            `;
        }

        // Decision Scenario
        function makeDecision(choice, element) {
            // Prevent multiple selections
            const scenario = element.parentElement;
            if (scenario.classList.contains('answered')) return;
            scenario.classList.add('answered');

            const feedbackDiv = document.getElementById('scenarioFeedback');
            element.classList.add('selected');

            let feedback = '';
            let isCorrect = false;

            switch(choice) {
                case 1:
                    element.classList.add('incorrect');
                    feedback = `
                        <h4 style="color: #c62828;">‚ùå Incorrect Decision</h4>
                        <p><strong>Why this is wrong:</strong> While the password is correct, this login shows clear signs of compromise:</p>
                        <ul>
                            <li>Impossible travel (can't be in NY and Moscow 2 hours apart)</li>
                            <li>Unknown device</li>
                            <li>High-risk geographic location</li>
                        </ul>
                        <p>Allowing this login would likely grant an attacker access to the account.</p>
                    `;
                    break;
                
                case 2:
                    element.classList.add('incorrect');
                    feedback = `
                        <h4 style="color: #c62828;">‚ö†Ô∏è Partially Correct</h4>
                        <p><strong>Concern:</strong> While blocking is good, immediately locking the account without verification might be too aggressive:</p>
                        <ul>
                            <li>Could be a false positive (VPN, traveling colleague)</li>
                            <li>Denies service without user confirmation</li>
                            <li>No opportunity to gather more information</li>
                        </ul>
                        <p>A better approach would include user verification before locking.</p>
                    `;
                    break;
                
                case 3:
                    element.classList.add('correct');
                    isCorrect = true;
                    feedback = `
                        <h4 style="color: #2e7d32;">‚úÖ Correct Decision!</h4>
                        <p><strong>Why this is the best choice:</strong></p>
                        <ul>
                            <li>Blocks the suspicious login immediately</li>
                            <li>Requires additional verification (step-up MFA)</li>
                            <li>Alerts the legitimate user via registered contact</li>
                            <li>Allows user to confirm if the login is legitimate</li>
                            <li>Provides opportunity to lock account if confirmed malicious</li>
                        </ul>
                        <p><strong>This balances security with usability</strong> - protecting against compromise while allowing legitimate access if the user is actually traveling.</p>
                    `;
                    break;
                
                case 4:
                    element.classList.add('incorrect');
                    feedback = `
                        <h4 style="color: #c62828;">‚ùå Incorrect Decision</h4>
                        <p><strong>Why this is risky:</strong></p>
                        <ul>
                            <li>Allows potential attacker immediate access</li>
                            <li>Monitoring alone won't prevent data theft</li>
                            <li>By the time suspicious activity is detected, damage may be done</li>
                            <li>Doesn't verify the user's identity</li>
                        </ul>
                        <p>Security should be proactive, not reactive. Always verify suspicious logins before granting access.</p>
                    `;
                    break;
            }

            feedbackDiv.className = 'scenario-feedback show ' + (isCorrect ? 'correct' : 'incorrect');
            feedbackDiv.style.background = isCorrect ? '#e8f5e9' : '#ffebee';
            feedbackDiv.style.borderLeft = isCorrect ? '5px solid #4caf50' : '5px solid #f44336';
            feedbackDiv.innerHTML = feedback;
        }

        // Progress tracking
        function updateProgress() {
            const totalSections = document.querySelectorAll('.section').length;
            const openedSections = document.querySelectorAll('.section-header.active').length;
            const progressPercent = (openedSections / totalSections) * 100;
            
            document.getElementById('progressFill').style.width = progressPercent + '%';
        }

        // Smooth scrolling for better UX
        document.querySelectorAll('.section-header').forEach((header, index) => {
            header.addEventListener('click', function() {
                setTimeout(() => {
                    this.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            });
        });

        // Keyboard navigation for accessibility
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                tooltip.style.display = 'none';
            }
        });
    </script>
</body>
</html>